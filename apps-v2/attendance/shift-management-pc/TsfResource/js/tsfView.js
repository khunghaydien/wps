function _base64ToArrayBuffer(e){for(var t=window.atob(e),s=t.length,a=new Uint8Array(s),o=0;o<s;o++)a[o]=t.charCodeAt(o);return a.buffer}teasp.Tsf={ROOT_AREA_ID:"tsfArea",BODY_CELL:"bodyCell",HANDLEBAR_CONTAINER:"handlebarContainer",HKEY_HOLD_CSS:"ts-row-seq",JOB_CODE_NAME_DIV:" ",EXP_PRE_FORM1:"出張・交通費",EXP_PRE_FORM2:"会議・交際費",EXP_PRE_FORM3:"一般経費",EXP_PRE_FORM4:"仮払申請",JPY:"JPY",ITEM_EXTERNAL:"external",formParams:{
ListExpPreApply:{discernment:"expPreApplyList",objectName:"AtkExpPreApply__c",type:"table",formCss:"ts-exp-pre-apply-list",rowLimit:20,stereoType:!0,piw:!0,fields:[{label:"ID",apiKey:"Id",domId:"ExpPre{0}ListId",domType:"text",hidden:!0},{label:"経費事前申請名",apiKey:"Name",domId:"ExpPre{0}ListName",domType:"text",hidden:!0},{label:"生成日時",apiKey:"CreatedDate",domId:"ExpPre{0}ListCreatedDate",domType:"datetime",hidden:!0},{
label:"最終更新日時",apiKey:"LastModifiedDate",domId:"ExpPre{0}ListLastModifiedDate",domType:"datetime",hidden:!0},{label:"社員ID",apiKey:"EmpId__c",domId:"ExpPre{0}ListEmpId__c",domType:"text",hidden:!0},{label:"帰着予定日",apiKey:"EndDate__c",domId:"ExpPre{0}ListEndDate__c",domType:"date",hidden:!0},{label:"精算申請状態",apiKey:"_childStatus",domId:"ExpPre{0}List_ChildStatus",domType:"text",hidden:!0},{label:"申請",
msgId:"apply_btn_title",apiKey:"StatusD__c",domId:"ExpPre{0}ListStatus",domType:"status",width:24,sortable:!0},{label:"申請日付",msgId:"tf10001290",apiKey:"ApplyTime__c",domId:"ExpPre{0}ListApplyTime",domType:"datetime",dspType:"date",width:76,sortable:!0},{label:"申請番号",msgId:"expApplyNo_label",apiKey:"ExpPreApplyNo__c",domId:"ExpPre{0}ListExpPreApplyNo",domType:"text",width:76,sortable:!0,link:!0},{label:"件名",
msgId:"tk10004320",apiKey:"Title__c",domId:"ExpPre{0}ListTitle",domType:"text",width:"25%",sortable:!0,link:!0},{label:"社員名",msgId:"empName_label",apiKey:"EmpId__r.Name",domId:"ExpPre{0}ListEmpName",domType:"text",width:"10%",sortable:!0},{label:"種別",msgId:"tk10000262",apiKey:"Type__c",domId:"ExpPre{0}ListType",domType:"select",width:"12%",sortable:!0,pickList:[{v:"",n:""},{v:"出張・交通費",msgId:"tf10001410"},{v:"会議・交際費",
msgId:"tf10000600"},{v:"一般経費",msgId:"tf10001420"},{v:"仮払申請",msgId:"tf10006120"}]},{label:"予定日",msgId:"tf10000620",apiKey:"StartDate__c",domId:"ExpPre{0}ListStartDate",domType:"date",width:76,sortable:!0},{label:"精算",msgId:"tf10000630",apiKey:"_payStatus",domId:"ExpPre{0}ListPayStatus",domType:"status",width:24},{label:"金額",msgId:"expCost_head",apiKey:"TotalAmount__c",domId:"ExpPre{0}ListTotalAmount",
domType:"currency",width:50,sortable:!0},{label:"仮払金額",msgId:"tf10000530",apiKey:"ProvisionalPaymentAmount__c",domId:"ExpPre{0}ListProvisionalPaymentAmount",domType:"currency",width:50,sortable:!0}],foots:[{colSpan:7},{colSpan:2,name:"合計",align:"center"},{},{}],sortKeys:[{apiKey:"ExpPreApplyNo__c",desc:!0}],filts:[{apiKey:"_childStatus",value:"精算済み以外"}],childFilts:[{filtVal:"StatusD__c = '精算済み'",nega:!0}],children:{
ExpApplications__r:{fields:[{apiKey:"Id"},{apiKey:"StatusD__c"}]}}},ListExpApply:{discernment:"expApplyList",objectName:"AtkExpApply__c",type:"table",formCss:"ts-exp-apply-list",rowLimit:20,stereoType:!0,irregularType:"expApplyList",piw:!0,fields:[{label:"ID",apiKey:"Id",domId:"ExpList{0}ListId",domType:"text",hidden:!0},{label:"経費申請名",apiKey:"Name",domId:"ExpList{0}ListName",domType:"text",hidden:!0},{label:"生成日時",
apiKey:"CreatedDate",domId:"ExpList{0}ListCreatedDate",domType:"datetime",hidden:!0},{label:"最終更新日時",apiKey:"LastModifiedDate",domId:"ExpList{0}ListLastModifiedDate",domType:"datetime",hidden:!0},{label:"社員ID",apiKey:"EmpId__c",domId:"ExpList{0}ListEmpId__c",domType:"text",hidden:!0},{label:"ステータス",apiKey:"StatusC__c",domId:"ExpList{0}ListStatusC",domType:"status",hidden:!0},{label:"申請",msgId:"apply_btn_title",
apiKey:"StatusD__c",domId:"ExpList{0}ListStatus",domType:"status",width:30,sortable:!0,subType:"status"},{label:"申請日付",msgId:"tf10001290",apiKey:"ApplyTime__c",domId:"ExpList{0}ListApplyTime",domType:"datetime",dspType:"date",width:76,sortable:!0},{label:"申請番号",msgId:"expApplyNo_label",apiKey:"ExpApplyNo__c",domId:"ExpList{0}ListExpApplyNo",domType:"text",width:100,sortable:!0,link:!0},{label:"社員コード",
msgId:"empCode_label",apiKey:"EmpId__r.EmpCode__c",domId:"ExpList{0}ListEmpCode",domType:"text",width:"9%",sortable:!0},{label:"社員名",msgId:"empName_label",apiKey:"EmpId__r.Name",domId:"ExpList{0}ListEmpName",domType:"text",width:"10%",sortable:!0},{label:"支払日",msgId:"tf10000590",apiKey:"payDate__c",domId:"ExpList{0}payDate",domType:"date",width:76,sortable:!0},{label:"日付(from)",msgId:"tf10000640",
apiKey:"StartDate__c",domId:"ExpList{0}ListStartDate",domType:"date",width:76,sortable:!0},{label:"日付(to)",msgId:"tf10000650",apiKey:"EndDate__c",domId:"ExpList{0}ListEndDate",domType:"date",width:76,sortable:!0},{label:"事前申請番号",msgId:"tf10001100",apiKey:"ExpPreApplyId__r.ExpPreApplyNo__c",domId:"ExpList{0}ExpPreApplyNo",domType:"text",width:100,sortable:!0,align:"center"},{label:"件名",msgId:"tk10004320",
apiKey:"TitleD__c",domId:"ExpList{0}Title",domType:"text",width:130,sortable:!0},{label:"金額",msgId:"expCost_head",apiKey:"TotalCost__c",domId:"ExpList{0}ListTotalCost",domType:"currency",width:50,sortable:!0},{label:"仮払金額",msgId:"tf10000530",apiKey:"ProvisionalPaymentAmount__c",domId:"ExpList{0}ListProvisionalPaymentAmount",domType:"currency",width:50,sortable:!0}],sortKeys:[{apiKey:"ExpApplyNo__c",desc:!0}],filts:[{
filtVal:"Removed__c = false",fix:!0},{apiKey:"StatusD__c",value:"精算済み以外"}]},ListExpPay1:{discernment:"expPayList1",objectName:"AtkExpApply__c",type:"table",formCss:"ts-exp-pay-list1",rowLimit:200,pageLimit:10,stereoType:!0,payManage:1,fields:[{label:"ID",apiKey:"Id",domId:"ExpPay1{0}Id",domType:"text",hidden:!0},{label:"経費申請名",apiKey:"Name",domId:"ExpPay1{0}Name",domType:"text",hidden:!0},{label:"生成日時",
apiKey:"CreatedDate",domId:"ExpPay1{0}CreatedDate",domType:"datetime",hidden:!0},{label:"最終更新日時",apiKey:"LastModifiedDate",domId:"ExpPay1{0}LastModifiedDate",domType:"datetime",hidden:!0},{label:"社員ID",apiKey:"EmpId__c",domId:"ExpPay1{0}EmpId__c",domType:"text",hidden:!0},{label:"日付",apiKey:"EndDate__c",domId:"ExpPay1{0}EndDate__c",domType:"date",hidden:!0},{check:!0,domId:"ExpPay1{0}_Check",domType:"checkbox",
width:24,paychk:!0},{label:"申請",msgId:"apply_btn_title",apiKey:"StatusD__c",domId:"ExpPay1{0}Status",domType:"status",width:24,sortable:!0},{label:"申請日付",msgId:"tf10001290",apiKey:"ApplyTime__c",domId:"ExpPay1{0}ApplyTime",domType:"datetime",dspType:"date",width:76,sortable:!0},{label:"申請番号",msgId:"expApplyNo_label",apiKey:"ExpApplyNo__c",domId:"ExpPay1{0}ExpApplyNo",domType:"text",width:"8%",sortable:!0,link:!0},{
label:"部署名",msgId:"tk10000335",apiKey:"DeptId__r.Name",domId:"ExpPay1{0}DeptName",domType:"text",width:"15%",sortable:!0},{label:"社員コード",msgId:"empCode_label",apiKey:"EmpId__r.EmpCode__c",domId:"ExpPay1{0}EmpCode",domType:"text",width:"10%",sortable:!0},{label:"社員名",msgId:"empName_label",apiKey:"EmpId__r.Name",domId:"ExpPay1{0}EmpName",domType:"text",width:"10%",sortable:!0},{label:"本人立替金額",msgId:"tf10000660",
apiKey:"AmountDueToPay__c",domId:"ExpPay1{0}AmountDueToPay",domType:"currency",width:72,sortable:!0},{label:"件名",msgId:"tk10004320",apiKey:"TitleD__c",domId:"ExpPay1{0}Title",domType:"text",width:"20%",sortable:!0},{label:"種別",msgId:"tk10000262",apiKey:"TypeD__c",domId:"ExpPay1{0}Type",domType:"select",width:"12%",sortable:!0,pickList:[{v:"",n:""},{v:"出張・交通費",msgId:"tf10001410"},{v:"会議・交際費",msgId:"tf10000600"},{
v:"一般経費",msgId:"tf10001420"},{v:"仮払申請",msgId:"tf10006120"}]},{label:"利用日付",msgId:"tf10000670",apiKey:"StartDate__c",domId:"ExpPay1{0}StartDate",domType:"date",width:76,sortable:!0},{label:"仮払金額",msgId:"tf10000530",apiKey:"ProvisionalPaymentAmount__c",domId:"ExpPay1{0}ProvisionalPaymentAmount",domType:"currency",width:72,sortable:!0},{label:"精算実行者",msgId:"tf10011070",apiKey:"SetPaidActorId__r.Name",
domId:"ExpPay1{0}SetPaidActor",domType:"text",width:72,sortable:!0,mask:2},{label:"精算実行日時",msgId:"tf10011080",apiKey:"SetPaidTime__c",domId:"ExpPay1{0}SetPaidTime",domType:"datetime",width:76,sortable:!0,mask:2}],foots:[],filts:[{filtVal:"Removed__c = false",fix:!0},{filtVal:"StatusC__c in ('承認済み','確定済み')",fix:!0,mask:1},{filtVal:"StatusC__c = '精算済み'",fix:!0,mask:2}],sortKeys:[{apiKey:"ExpApplyNo__c",desc:!0}]},
searchExpPay1:{title:["tf10002070","tf10002080"],formCss:"ts-dialog-search-expPay1",type:"searchCondition",fields:[{label:"申請日付範囲",msgId:"tf10000680",apiKey:"ApplyTime__c",domId:"SearchExpApplyTime",domType:"dateRange",width:108,name:"pay1ApplyTime",dataType:"dateTime"},{label:"申請番号",msgId:"expApplyNo_label",apiKey:"ExpApplyNo__c",domId:"SearchExpApplyNo",domType:"text",width:300,matchType:2},{label:"部署名",
msgId:"tk10000335",apiKey:"EmpId__r.DeptId__r.Name",domId:"SearchExpDeptName",domType:"deptb",width:350,matchType:3,defaultChks:{checkDeptApply:!0,checkDeptLayer:!0},optKeys:["DeptId__r.Name like '%{0}%'",
"(EmpId__r.DeptId__r.Name like '%{0}%' or EmpId__r.DeptId__r.ParentId__r.Name like '%{0}%' or EmpId__r.DeptId__r.ParentId__r.ParentId__r.Name like '%{0}%' or EmpId__r.DeptId__r.ParentId__r.ParentId__r.ParentId__r.Name like '%{0}%')",
"(DeptId__r.Name like '%{0}%' or DeptId__r.ParentId__r.Name like '%{0}%' or DeptId__r.ParentId__r.ParentId__r.Name like '%{0}%' or DeptId__r.ParentId__r.ParentId__r.ParentId__r.Name like '%{0}%')"]},{label:"社員コード",msgId:"empCode_label",apiKey:"EmpId__r.EmpCode__c",domId:"SearchExpEmpCode",domType:"text",width:150,matchType:1},{label:"社員名",msgId:"empName_label",apiKey:"EmpId__r.Name",domId:"SearchExpEmpName",
domType:"text",width:300,matchType:3},{label:"本人立替金額範囲",msgId:"tf10000690",apiKey:"AmountDueToPay__c",domId:"SearchExpAmountDueToPay",domType:"currencyRange",width:120,minus:!0},{label:"件名",msgId:"tk10004320",apiKey:"TitleD__c",domId:"SearchExpTitle",domType:"text",width:350,matchType:3},{label:"種別",msgId:"tk10000262",apiKey:"TypeD__c",domId:"SearchExpType",domType:"select",width:200,pickList:[{v:"",n:""},{
v:"出張・交通費",msgId:"tf10001410"},{v:"会議・交際費",msgId:"tf10000600"},{v:"一般経費",msgId:"tf10001420"},{v:"仮払申請",msgId:"tf10006120"}]},{label:"利用日付範囲",msgId:"tf10000700",apiKey:"_startEnd",domId:"SearchExpDate",domType:"dateRange",width:108,name:"pay1Date",colNames:["StartDate__c","EndDate__c"]},{label:"仮払金額範囲",msgId:"tf10000710",apiKey:"ProvisionalPaymentAmount__c",domId:"SearchExpProvisionalPaymentAmount",
domType:"currencyRange",width:120},{label:"精算実行者",msgId:"tf10011070",apiKey:"SetPaidActorId__r.Name",domId:"SearchSetPaidActorName",domType:"text",width:300,matchType:3,mask:2},{label:"精算実行日範囲",msgId:"tf10011090",apiKey:"SetPaidTime__c",domId:"SearchSetPaidTime",domType:"dateRange",width:108,name:"pay1SetPaidTime",dataType:"dateTime",mask:2}]},PrintExpPay1:{discernment:"printExpPay1",objectName:"AtkExpApply__c",
type:"table",formCss:"ts-print-exp-pay-list1",rowLimit:2e3,stereoType:!0,payManage:1,fields:[{label:"ID",apiKey:"Id",domId:"PrintExpPay1{0}Id",hidden:!0},{label:"経費申請名",apiKey:"Name",domId:"PrintExpPay1{0}Name",hidden:!0},{label:"生成日時",apiKey:"CreatedDate",domId:"PrintExpPay1{0}CreatedDate",hidden:!0},{label:"最終更新日時",apiKey:"LastModifiedDate",domId:"PrintExpPay1{0}LastModifiedDate",hidden:!0},{label:"社員ID",
apiKey:"EmpId__c",domId:"PrintExpPay1{0}EmpId__c",hidden:!0},{label:"部署コード",apiKey:"EmpId__r.DeptId__r.DeptCode__c",domId:"PrintExpPay1{0}DeptCode",hidden:!0},{label:"部署名",apiKey:"EmpId__r.DeptId__r.Name",domId:"PrintExpPay1{0}DeptName",hidden:!0},{label:"社員コード",apiKey:"EmpId__r.EmpCode__c",domId:"PrintExpPay1{0}EmpCode",hidden:!0},{label:"社員名",apiKey:"EmpId__r.Name",domId:"PrintExpPay1{0}EmpName",hidden:!0},{
label:"StatusC",apiKey:"StatusC__c",domId:"PrintExpPay1{0}StatusC",hidden:!0},{label:"StatusD",apiKey:"StatusD__c",domId:"PrintExpPay1{0}StatusD",hidden:!0},{label:"申請番号",msgId:"expApplyNo_label",apiKey:"ExpApplyNo__c",domId:"PrintExpPay1{0}ExpApplyNo",domType:"text",width:"20%",align:"center"},{label:"金額",msgId:"expCost_head",apiKey:"AmountDueToPay__c",domId:"PrintExpPay1{0}TotalCost",domType:"currency",width:"10%"}
,{label:"精算日",msgId:"payDate_label",apiKey:"payDate__c",domId:"PrintExpPay1{0}payDate",domType:"date",width:"10%"},{label:"備考(精算時)",msgId:"tf10000720",apiKey:"payMethod__c",domId:"PrintExpPay1{0}payMethod",domType:"text",width:"30%"},{label:"申請日時",msgId:"applyTime_label",apiKey:"ApplyTime__c",domId:"PrintExpPay1{0}ApplyTime",domType:"datetime",width:"10%"},{label:"承認日時",msgId:"tk10000070",apiKey:"ApproveTime__c",
domId:"PrintExpPay1{0}ApproveTime",domType:"datetime",width:"10%"},{label:"ステータス",msgId:"status_btn_title",apiKey:"_status",domId:"PrintExpPay1{0}Status",domType:"text",width:"10%",align:"center"}],sortKeys:[{apiKey:"EmpId__r.EmpCode__c"},{apiKey:"EmpId__r.Name"},{apiKey:"ExpApplyNo__c"}]},ListExpPay2:{discernment:"expPayList2",objectName:"AtkEmpExp__c",type:"table",formCss:"ts-exp-pay-list2",rowLimit:200,
pageLimit:10,stereoType:!0,fields:[{label:"ID",apiKey:"Id",domId:"ExpPay2{0}Id",domType:"text",hidden:!0},{label:"経費明細名",apiKey:"Name",domId:"ExpPay2{0}Name",domType:"text",hidden:!0},{label:"生成日時",apiKey:"CreatedDate",domId:"ExpPay2{0}CreatedDate",domType:"datetime",hidden:!0},{label:"最終更新日時",apiKey:"LastModifiedDate",domId:"ExpPay2{0}LastModifiedDate",domType:"datetime",hidden:!0},{label:"社員ID",apiKey:"EmpId__c",
domId:"ExpPay2{0}EmpId__c",domType:"text",hidden:!0},{label:"経費申請ID",apiKey:"ExpApplyId__c",domId:"ExpPay2{0}ExpApplyId",domType:"text",hidden:!0},{check:!0,domId:"ExpPay2{0}_Check",domType:"checkbox",width:24,paychk:!0},{label:"申請",msgId:"apply_btn_title",apiKey:"ExpApplyId__r.StatusD__c",domId:"ExpPay2{0}Status",domType:"status",width:30,sortable:!0},{label:"支払先",msgId:"tf10000580",apiKey:"PayeeId__r.Name",
domId:"ExpPay2{0}PayeeName",domType:"text",width:"15%",sortable:!0},{label:"支払日",msgId:"tf10000590",apiKey:"PaymentDate__c",domId:"ExpPay2{0}PaymentDate",domType:"date",width:76,sortable:!0},{label:"申請番号",msgId:"expApplyNo_label",apiKey:"ExpApplyId__r.ExpApplyNo__c",domId:"ExpPay2{0}ExpApplyNo",domType:"text",width:100,sortable:!0,link:!0},{label:"部署名",msgId:"tk10000335",apiKey:"ExpApplyId__r.DeptId__r.Name",
domId:"ExpPay2{0}DeptName",domType:"text",width:"15%",sortable:!0},{label:"社員コード",msgId:"empCode_label",apiKey:"EmpId__r.EmpCode__c",domId:"ExpPay2{0}EmpCode",domType:"text",width:"10%",sortable:!0},{label:"社員名",msgId:"empName_label",apiKey:"EmpId__r.Name",domId:"ExpPay2{0}EmpName",domType:"text",width:"10%",sortable:!0},{label:"金額",msgId:"expCost_head",apiKey:"Cost__c",domId:"ExpPay2{0}Cost",domType:"currency",
width:72,sortable:!0},{label:"件名",msgId:"tk10004320",apiKey:"ExpApplyId__r.TitleD__c",domId:"ExpPay2{0}Title",domType:"text",width:"15%",sortable:!0},{label:"種別",msgId:"tk10000262",apiKey:"ExpApplyId__r.TypeD__c",domId:"ExpPay2{0}PreType",domType:"select",width:"10%",sortable:!0,pickList:[{v:"",n:""},{v:"出張・交通費",msgId:"tf10001410"},{v:"会議・交際費",msgId:"tf10000600"},{v:"一般経費",msgId:"tf10001420"},{v:"仮払申請",
msgId:"tf10006120"}]},{label:"利用日付",msgId:"tf10000670",apiKey:"Date__c",domId:"ExpPay2{0}Date",domType:"date",width:76,sortable:!0},{label:"精算実行者",msgId:"tf10011070",apiKey:"SetPaidActorId__r.Name",domId:"ExpPay2{0}SetPaidActor",domType:"text",width:72,sortable:!0,mask:2},{label:"精算実行日時",msgId:"tf10011080",apiKey:"SetPaidTime__c",domId:"ExpPay2{0}SetPaidTime",domType:"datetime",width:76,sortable:!0,mask:2}],foots:[],
filts:[{filtVal:"ExpApplyId__r.Removed__c = false",fix:!0},{filtVal:"ExpApplyId__r.StatusC__c in ('承認済み','確定済み','精算済み')",fix:!0},{filtVal:"PayeeId__r.PayeeType__c = '2'",fix:!0},{filtVal:"IsPaid__c = false",fix:!0,mask:1},{filtVal:"IsPaid__c = true",fix:!0,mask:2}],sortKeys:[{apiKey:"ExpApplyId__r.ExpApplyNo__c",desc:!0},{apiKey:"Date__c"},{apiKey:"Order__c"},{apiKey:"Id"}]},searchExpPay2:{title:["tf10002070",
"tf10002090"],formCss:"ts-dialog-search-expPay2",type:"searchCondition",fields:[{label:"支払先",msgId:"tf10000580",apiKey:"PayeeId__r.Name",domId:"SearchExpPayeeName",domType:"text",width:300,matchType:3},{label:"支払日範囲",msgId:"tf10000730",apiKey:"PaymentDate__c",domId:"SearchExpPaymentDate",domType:"dateRange",width:108,name:"pay2PayDate"},{label:"申請番号",msgId:"expApplyNo_label",apiKey:"ExpApplyId__r.ExpApplyNo__c",
domId:"SearchExpApplyNo",domType:"text",width:300,matchType:2},{label:"部署名",msgId:"tk10000335",apiKey:"EmpId__r.DeptId__r.Name",domId:"SearchExpDeptName",domType:"deptb",width:350,matchType:3,defaultChks:{checkDeptApply:!0,checkDeptLayer:!0},optKeys:["ExpApplyId__r.DeptId__r.Name like '%{0}%'",
"(EmpId__r.DeptId__r.Name like '%{0}%' or EmpId__r.DeptId__r.ParentId__r.Name like '%{0}%' or EmpId__r.DeptId__r.ParentId__r.ParentId__r.Name like '%{0}%' or EmpId__r.DeptId__r.ParentId__r.ParentId__r.ParentId__r.Name like '%{0}%')",
"(ExpApplyId__r.DeptId__r.Name like '%{0}%' or ExpApplyId__r.DeptId__r.ParentId__r.Name like '%{0}%' or ExpApplyId__r.DeptId__r.ParentId__r.ParentId__r.Name like '%{0}%' or ExpApplyId__r.DeptId__r.ParentId__r.ParentId__r.ParentId__r.Name like '%{0}%')"]},{label:"社員コード",msgId:"empCode_label",apiKey:"EmpId__r.EmpCode__c",domId:"SearchExpEmpCode",domType:"text",width:150,matchType:1},{label:"社員名",msgId:"empName_label",
apiKey:"EmpId__r.Name",domId:"SearchExpEmpName",domType:"text",width:300,matchType:3},{label:"金額範囲",msgId:"tf10000740",apiKey:"Cost__c",domId:"SearchExpCost",domType:"currencyRange",width:120,minus:!0},{label:"件名",msgId:"tk10004320",apiKey:"ExpApplyId__r.TitleD__c",domId:"SearchExpTitle",domType:"text",width:300,matchType:3},{label:"種別",msgId:"tk10000262",apiKey:"ExpApplyId__r.TypeD__c",domId:"SearchExpType",
domType:"select",width:200,pickList:[{v:"",n:""},{v:"出張・交通費",msgId:"tf10001410"},{v:"会議・交際費",msgId:"tf10000600"},{v:"一般経費",msgId:"tf10001420"},{v:"仮払申請",msgId:"tf10006120"}]},{label:"利用日付範囲",msgId:"tf10000700",apiKey:"Date__c",domId:"SearchExpDate",domType:"dateRange",width:108,name:"date"},{label:"精算実行者",msgId:"tf10011070",apiKey:"SetPaidActorId__r.Name",domId:"SearchSetPaidActorName",domType:"text",width:300,
matchType:3,mask:2},{label:"精算実行日範囲",msgId:"tf10011090",apiKey:"SetPaidTime__c",domId:"SearchSetPaidTime",domType:"dateRange",width:108,name:"pay2SetPaidTime",dataType:"dateTime",mask:2}]},PrintExpPay2:{discernment:"printExpPay2",objectName:"AtkEmpExp__c",type:"table",formCss:"ts-print-exp-pay-list2",rowLimit:2e3,fields:[{label:"ID",apiKey:"Id",domId:"PrintExpPay2{0}Id",hidden:!0},{label:"経費申請名",
apiKey:"ExpApplyId__r.Name",domId:"PrintExpPay2{0}Name",hidden:!0},{label:"生成日時",apiKey:"CreatedDate",domId:"PrintExpPay2{0}CreatedDate",hidden:!0},{label:"最終更新日時",apiKey:"LastModifiedDate",domId:"PrintExpPay2{0}LastModifiedDate",hidden:!0},{label:"支払い済み",apiKey:"IsPaid__c",domId:"PrintExpPay2{0}IsPaid",hidden:!0},{label:"支払先",apiKey:"PayeeId__r.Name",domId:"PrintExpPay2{0}PayeeName",hidden:!0},{label:"支払日",
apiKey:"PaymentDate__c",domId:"PrintExpPay2{0}PaymentDate",hidden:!0},{label:"社員ID",apiKey:"EmpId__c",domId:"PrintExpPay2{0}EmpId__c",hidden:!0},{label:"部署コード",apiKey:"EmpId__r.DeptId__r.DeptCode__c",domId:"PrintExpPay2{0}DeptCode",hidden:!0},{label:"部署名",apiKey:"EmpId__r.DeptId__r.Name",domId:"PrintExpPay2{0}DeptName",hidden:!0},{label:"社員コード",apiKey:"EmpId__r.EmpCode__c",domId:"PrintExpPay2{0}EmpCode",hidden:!0},{
label:"社員名",apiKey:"EmpId__r.Name",domId:"PrintExpPay2{0}EmpName",hidden:!0},{label:"StatusC",apiKey:"ExpApplyId__r.StatusC__c",domId:"PrintExpPay2{0}StatusC",hidden:!0},{label:"申請番号",msgId:"expApplyNo_label",apiKey:"ExpApplyId__r.ExpApplyNo__c",domId:"PrintExpPay2{0}ExpApplyNo",domType:"text",width:"20%",align:"center"},{label:"金額",msgId:"expCost_head",apiKey:"Cost__c",domId:"PrintExpPay2{0}TotalCost",
domType:"currency",width:"10%"},{label:"精算日",msgId:"payDate_label",apiKey:"_payDate",domId:"PrintExpPay2{0}payDate",domType:"date",width:"10%"},{label:"備考(精算時)",msgId:"tf10000720",apiKey:"_payNote",domId:"PrintExpPay2{0}payMethod",domType:"text",width:"30%"},{label:"申請日時",msgId:"applyTime_label",apiKey:"ExpApplyId__r.ApplyTime__c",domId:"PrintExpPay2{0}ApplyTime",domType:"datetime",width:"10%"},{label:"承認日時",
msgId:"tk10000070",apiKey:"ExpApplyId__r.ApproveTime__c",domId:"PrintExpPay2{0}ApproveTime",domType:"datetime",width:"10%"},{label:"ステータス",msgId:"status_btn_title",apiKey:"_status",domId:"PrintExpPay2{0}Status",domType:"text",width:"10%",align:"center"}],sortKeys:[{apiKey:"EmpId__r.EmpCode__c"},{apiKey:"EmpId__r.Name"},{apiKey:"ExpApplyId__r.ExpApplyNo__c"}]},ListExpPay3:{discernment:"expPayList3",
objectName:"AtkEmpExp__c",type:"table",formCss:"ts-exp-pay-list3",rowLimit:200,pageLimit:10,stereoType:!0,fields:[{label:"ID",apiKey:"Id",domId:"ExpPay3{0}Id",domType:"text",hidden:!0},{label:"経費明細名",apiKey:"Name",domId:"ExpPay3{0}Name",domType:"text",hidden:!0},{label:"生成日時",apiKey:"CreatedDate",domId:"ExpPay3{0}CreatedDate",domType:"datetime",hidden:!0},{label:"最終更新日時",apiKey:"LastModifiedDate",
domId:"ExpPay3{0}LastModifiedDate",domType:"datetime",hidden:!0},{label:"社員ID",apiKey:"EmpId__c",domId:"ExpPay3{0}EmpId__c",domType:"text",hidden:!0},{label:"経費申請ID",apiKey:"ExpApplyId__c",domId:"ExpPay3{0}ExpApplyId",domType:"text",hidden:!0},{check:!0,domId:"ExpPay3{0}_Check",domType:"checkbox",width:24,paychk:!0},{label:"申請",msgId:"apply_btn_title",apiKey:"ExpApplyId__r.StatusD__c",domId:"ExpPay3{0}Status",
domType:"status",width:30,sortable:!0},{label:"カード名",msgId:"tf10000750",apiKey:"PayeeId__r.Name",domId:"ExpPay3{0}CardName",domType:"text",width:"15%",sortable:!0},{label:"支払日",msgId:"tf10000590",apiKey:"PaymentDate__c",domId:"ExpPay3{0}PaymentDate",domType:"date",width:76,sortable:!0},{label:"申請番号",msgId:"expApplyNo_label",apiKey:"ExpApplyId__r.ExpApplyNo__c",domId:"ExpPay3{0}ExpApplyNo",domType:"text",width:100,
sortable:!0,link:!0},{label:"部署名",msgId:"tk10000335",apiKey:"ExpApplyId__r.DeptId__r.Name",domId:"ExpPay3{0}DeptName",domType:"text",width:"15%",sortable:!0},{label:"社員コード",msgId:"empCode_label",apiKey:"EmpId__r.EmpCode__c",domId:"ExpPay3{0}EmpCode",domType:"text",width:"10%",sortable:!0},{label:"社員名",msgId:"empName_label",apiKey:"EmpId__r.Name",domId:"ExpPay3{0}EmpName",domType:"text",width:"10%",sortable:!0},{
label:"金額",msgId:"expCost_head",apiKey:"Cost__c",domId:"ExpPay3{0}Cost",domType:"currency",width:72,sortable:!0},{label:"摘要",msgId:"tk10000097",apiKey:"Detail__c",domId:"ExpPay3{0}Note",domType:"text",width:"15%",sortable:!0},{label:"利用日付",msgId:"tf10000670",apiKey:"Date__c",domId:"ExpPay3{0}Date",domType:"date",width:76,sortable:!0},{label:"精算実行者",msgId:"tf10011070",apiKey:"SetPaidActorId__r.Name",
domId:"ExpPay3{0}SetPaidActor",domType:"text",width:72,sortable:!0,mask:2},{label:"精算実行日時",msgId:"tf10011080",apiKey:"SetPaidTime__c",domId:"ExpPay3{0}SetPaidTime",domType:"datetime",width:76,sortable:!0,mask:2}],foots:[],filts:[{filtVal:"ExpApplyId__r.Removed__c = false",fix:!0},{filtVal:"ExpApplyId__r.StatusC__c in ('承認済み','確定済み','精算済み')",fix:!0},{filtVal:"PayeeId__r.PayeeType__c = '3'",fix:!0},{
filtVal:"IsPaid__c = false",fix:!0,mask:1},{filtVal:"IsPaid__c = true",fix:!0,mask:2}],sortKeys:[{apiKey:"ExpApplyId__r.ExpApplyNo__c",desc:!0},{apiKey:"Date__c"},{apiKey:"Order__c"},{apiKey:"Id"}]},searchExpPay3:{title:["tf10002070","tf10002100"],formCss:"ts-dialog-search-expPay2",type:"searchCondition",fields:[{label:"カード名",msgId:"tf10000750",apiKey:"PayeeId__r.Name",domId:"SearchExpPayeeName",domType:"text",
width:300,matchType:3},{label:"支払日範囲",msgId:"tf10000730",apiKey:"PaymentDate__c",domId:"SearchExpPaymentDate",domType:"dateRange",width:108,name:"pay3PayDate"},{label:"申請番号",msgId:"expApplyNo_label",apiKey:"ExpApplyId__r.ExpApplyNo__c",domId:"SearchExpApplyNo",domType:"text",width:300,matchType:2},{label:"部署名",msgId:"tk10000335",apiKey:"EmpId__r.DeptId__r.Name",domId:"SearchExpDeptName",domType:"deptb",width:350,
matchType:3,defaultChks:{checkDeptApply:!0,checkDeptLayer:!0},optKeys:["ExpApplyId__r.DeptId__r.Name like '%{0}%'","(EmpId__r.DeptId__r.Name like '%{0}%' or EmpId__r.DeptId__r.ParentId__r.Name like '%{0}%' or EmpId__r.DeptId__r.ParentId__r.ParentId__r.Name like '%{0}%' or EmpId__r.DeptId__r.ParentId__r.ParentId__r.ParentId__r.Name like '%{0}%')",
"(ExpApplyId__r.DeptId__r.Name like '%{0}%' or ExpApplyId__r.DeptId__r.ParentId__r.Name like '%{0}%' or ExpApplyId__r.DeptId__r.ParentId__r.ParentId__r.Name like '%{0}%' or ExpApplyId__r.DeptId__r.ParentId__r.ParentId__r.ParentId__r.Name like '%{0}%')"]},{label:"社員コード",msgId:"empCode_label",apiKey:"EmpId__r.EmpCode__c",domId:"SearchExpEmpCode",domType:"text",width:150,matchType:1},{label:"社員名",msgId:"empName_label",
apiKey:"EmpId__r.Name",domId:"SearchExpEmpName",domType:"text",width:300,matchType:3},{label:"金額範囲",msgId:"tf10000740",apiKey:"Cost__c",domId:"SearchExpCost",domType:"currencyRange",width:120,minus:!0},{label:"摘要",msgId:"tk10000097",apiKey:"Detail__c",domId:"SearchExpTitle",domType:"text",width:300,matchType:3},{label:"利用日付範囲",msgId:"tf10000700",apiKey:"Date__c",domId:"SearchExpDate",domType:"dateRange",width:108,
name:"pay3Date"},{label:"精算実行者",msgId:"tf10011070",apiKey:"SetPaidActorId__r.Name",domId:"SearchSetPaidActorName",domType:"text",width:300,matchType:3,mask:2},{label:"精算実行日範囲",msgId:"tf10011090",apiKey:"SetPaidTime__c",domId:"SearchSetPaidTime",domType:"dateRange",width:108,name:"pay3SetPaidTime",dataType:"dateTime",mask:2}]},PrintExpPay3:{discernment:"printExpPay3",objectName:"AtkEmpExp__c",type:"table",
formCss:"ts-print-exp-pay-list3",rowLimit:2e3,fields:[{label:"ID",apiKey:"Id",domId:"PrintExpPay3{0}Id",hidden:!0},{label:"経費申請名",apiKey:"ExpApplyId__r.Name",domId:"PrintExpPay3{0}Name",hidden:!0},{label:"生成日時",apiKey:"CreatedDate",domId:"PrintExpPay3{0}CreatedDate",hidden:!0},{label:"最終更新日時",apiKey:"LastModifiedDate",domId:"PrintExpPay3{0}LastModifiedDate",hidden:!0},{label:"支払い済み",apiKey:"IsPaid__c",
domId:"PrintExpPay3{0}IsPaid",hidden:!0},{label:"支払先",apiKey:"PayeeId__r.Name",domId:"PrintExpPay3{0}PayeeName",hidden:!0},{label:"支払日",apiKey:"PaymentDate__c",domId:"PrintExpPay3{0}PaymentDate",hidden:!0},{label:"社員ID",apiKey:"EmpId__c",domId:"PrintExpPay3{0}EmpId__c",hidden:!0},{label:"部署コード",apiKey:"EmpId__r.DeptId__r.DeptCode__c",domId:"PrintExpPay3{0}DeptCode",hidden:!0},{label:"部署名",
apiKey:"EmpId__r.DeptId__r.Name",domId:"PrintExpPay3{0}DeptName",hidden:!0},{label:"社員コード",apiKey:"EmpId__r.EmpCode__c",domId:"PrintExpPay3{0}EmpCode",hidden:!0},{label:"社員名",apiKey:"EmpId__r.Name",domId:"PrintExpPay3{0}EmpName",hidden:!0},{label:"StatusC",apiKey:"ExpApplyId__r.StatusC__c",domId:"PrintExpPay3{0}StatusC",hidden:!0},{label:"申請番号",msgId:"expApplyNo_label",apiKey:"ExpApplyId__r.ExpApplyNo__c",
domId:"PrintExpPay3{0}ExpApplyNo",domType:"text",width:"20%",align:"center"},{label:"金額",msgId:"expCost_head",apiKey:"Cost__c",domId:"PrintExpPay3{0}TotalCost",domType:"currency",width:"10%"},{label:"精算日",msgId:"payDate_label",apiKey:"_payDate",domId:"PrintExpPay3{0}payDate",domType:"date",width:"10%"},{label:"備考(精算時)",msgId:"tf10000720",apiKey:"_payNote",domId:"PrintExpPay3{0}payMethod",domType:"text",width:"30%"},{
label:"申請日時",msgId:"applyTime_label",apiKey:"ExpApplyId__r.ApplyTime__c",domId:"PrintExpPay3{0}ApplyTime",domType:"datetime",width:"10%"},{label:"承認日時",msgId:"tk10000070",apiKey:"ExpApplyId__r.ApproveTime__c",domId:"PrintExpPay3{0}ApproveTime",domType:"datetime",width:"10%"},{label:"ステータス",msgId:"status_btn_title",apiKey:"_status",domId:"PrintExpPay3{0}Status",domType:"text",width:"10%",align:"center"}],sortKeys:[{
apiKey:"EmpId__r.EmpCode__c"},{apiKey:"EmpId__r.Name"},{apiKey:"ExpApplyId__r.ExpApplyNo__c"}]},ListExpPay4:{discernment:"expPayList4",objectName:"AtkExpPreApply__c",type:"table",formCss:"ts-exp-pay-list4",rowLimit:200,pageLimit:10,stereoType:!0,fields:[{label:"ID",apiKey:"Id",domId:"ExpPay4{0}Id",domType:"text",hidden:!0},{label:"経費事前申請名",apiKey:"Name",domId:"ExpPay4{0}Name",domType:"text",hidden:!0},{label:"生成日時",
apiKey:"CreatedDate",domId:"ExpPay4{0}CreatedDate",domType:"datetime",hidden:!0},{label:"最終更新日時",apiKey:"LastModifiedDate",domId:"ExpPay4{0}LastModifiedDate",domType:"datetime",hidden:!0},{label:"社員ID",apiKey:"EmpId__c",domId:"ExpPay4{0}EmpId__c",domType:"text",hidden:!0},{label:"帰着予定日",apiKey:"EndDate__c",domId:"ExpPay4{0}EndDate__c",domType:"date",hidden:!0},{check:!0,domId:"ExpPay4{0}_Check",domType:"checkbox",
width:24,paychk:!0},{label:"申請",msgId:"apply_btn_title",apiKey:"StatusD__c",domId:"ExpPay4{0}Status",domType:"status",width:24,sortable:!0},{label:"申請番号",msgId:"expApplyNo_label",apiKey:"ExpPreApplyNo__c",domId:"ExpPay4{0}ExpPreApplyNo",domType:"text",width:100,sortable:!0,link:!0},{label:"部署名",msgId:"tk10000335",apiKey:"DeptId__r.Name",domId:"ExpPay4{0}DeptName",domType:"text",width:"15%",sortable:!0},{
label:"社員コード",msgId:"empCode_label",apiKey:"EmpId__r.EmpCode__c",domId:"ExpPay4{0}EmpCode",domType:"text",width:"10%",sortable:!0},{label:"社員名",msgId:"empName_label",apiKey:"EmpId__r.Name",domId:"ExpPay4{0}EmpName",domType:"text",width:"15%",sortable:!0},{label:"仮払金額",msgId:"tf10000530",apiKey:"ProvisionalPaymentAmount__c",domId:"ExpPay4{0}ProvisionalPaymentAmount",domType:"currency",width:72,sortable:!0},{
label:"件名",msgId:"tk10004320",apiKey:"Title__c",domId:"ExpPay4{0}Title",domType:"text",width:"20%",sortable:!0},{label:"種別",msgId:"tk10000262",apiKey:"Type__c",domId:"ExpPay4{0}Type",domType:"select",width:"6%",sortable:!0,pickList:[{v:"",n:""},{v:"出張・交通費",msgId:"tf10001410"},{v:"会議・交際費",msgId:"tf10000600"},{v:"一般経費",msgId:"tf10001420"},{v:"仮払申請",msgId:"tf10006120"}]},{label:"利用日付",msgId:"tf10000670",
apiKey:"StartDate__c",domId:"ExpPay4{0}StartDate",domType:"date",width:76,sortable:!0},{label:"精算実行者",msgId:"tf10011070",apiKey:"SetPaidActorId__r.Name",domId:"ExpPay1{0}SetPaidActor",domType:"text",width:72,sortable:!0,mask:2},{label:"精算実行日時",msgId:"tf10011080",apiKey:"SetPaidTime__c",domId:"ExpPay4{0}SetPaidTime",domType:"datetime",width:76,sortable:!0,mask:2}],foots:[],filts:[{
filtVal:"StatusC__c in ('承認済み','確定済み')",fix:!0,mask:1},{filtVal:"StatusC__c = '精算済み'",fix:!0,mask:2},{filtVal:"ProvisionalPaymentAmount__c > 0",fix:!0}],sortKeys:[{apiKey:"ExpPreApplyNo__c",desc:!0}]},searchExpPay4:{title:["tf10002070","tf10002110"],formCss:"ts-dialog-search-expPay4",type:"searchCondition",fields:[{label:"申請番号",msgId:"expApplyNo_label",apiKey:"ExpPreApplyNo__c",domId:"SearchExpPreApplyNo",
domType:"text",width:300,matchType:2},{label:"部署名",msgId:"tk10000335",apiKey:"EmpId__r.DeptId__r.Name",domId:"SearchExpDeptName",domType:"deptb",width:350,matchType:3,defaultChks:{checkDeptApply:!0,checkDeptLayer:!0},optKeys:["DeptId__r.Name like '%{0}%'",
"(EmpId__r.DeptId__r.Name like '%{0}%' or EmpId__r.DeptId__r.ParentId__r.Name like '%{0}%' or EmpId__r.DeptId__r.ParentId__r.ParentId__r.Name like '%{0}%' or EmpId__r.DeptId__r.ParentId__r.ParentId__r.ParentId__r.Name like '%{0}%')",
"(DeptId__r.Name like '%{0}%' or DeptId__r.ParentId__r.Name like '%{0}%' or DeptId__r.ParentId__r.ParentId__r.Name like '%{0}%' or DeptId__r.ParentId__r.ParentId__r.ParentId__r.Name like '%{0}%')"]},{label:"社員コード",msgId:"empCode_label",apiKey:"EmpId__r.EmpCode__c",domId:"SearchExpEmpCode",domType:"text",width:150,matchType:1},{label:"社員名",msgId:"empName_label",apiKey:"EmpId__r.Name",domId:"SearchExpEmpName",
domType:"text",width:300,matchType:3},{label:"仮払金額範囲",msgId:"tf10000710",apiKey:"ProvisionalPaymentAmount__c",domId:"SearchExpProvisionalPaymentAmount",domType:"currencyRange",width:120},{label:"件名",msgId:"tk10004320",apiKey:"Title__c",domId:"SearchExpTitle",domType:"text",width:300,matchType:3},{label:"種別",msgId:"tk10000262",apiKey:"Type__c",domId:"SearchExpType",domType:"select",width:200,pickList:[{v:"",n:""},{
v:"出張・交通費",msgId:"tf10001410"},{v:"会議・交際費",msgId:"tf10000600"},{v:"一般経費",msgId:"tf10001420"},{v:"仮払申請",msgId:"tf10006120"}]},{label:"利用日付範囲",msgId:"tf10000700",apiKey:"_startEnd",domId:"SearchExpDate",domType:"dateRange",width:108,name:"pay4Date",colNames:["StartDate__c","EndDate__c"]},{label:"精算実行者",msgId:"tf10011070",apiKey:"SetPaidActorId__r.Name",domId:"SearchSetPaidActorName",domType:"text",width:300,
matchType:3,mask:2},{label:"精算実行日範囲",msgId:"tf10011090",apiKey:"SetPaidTime__c",domId:"SearchSetPaidTime",domType:"dateRange",width:108,name:"pay4SetPaidTime",dataType:"dateTime",mask:2}]},PrintExpPay4:{discernment:"printExpPay4",objectName:"AtkExpPreApply__c",type:"table",formCss:"ts-print-exp-pay-list4",rowLimit:2e3,fields:[{label:"ID",apiKey:"Id",domId:"PrintExpPay4{0}Id",hidden:!0},{label:"経費申請名",apiKey:"Name",
domId:"PrintExpPay4{0}Name",hidden:!0},{label:"生成日時",apiKey:"CreatedDate",domId:"PrintExpPay4{0}CreatedDate",hidden:!0},{label:"最終更新日時",apiKey:"LastModifiedDate",domId:"PrintExpPay4{0}LastModifiedDate",hidden:!0},{label:"社員ID",apiKey:"EmpId__c",domId:"PrintExpPay4{0}EmpId__c",hidden:!0},{label:"部署コード",apiKey:"EmpId__r.DeptId__r.DeptCode__c",domId:"PrintExpPay4{0}DeptCode",hidden:!0},{label:"部署名",
apiKey:"EmpId__r.DeptId__r.Name",domId:"PrintExpPay4{0}DeptName",hidden:!0},{label:"社員コード",apiKey:"EmpId__r.EmpCode__c",domId:"PrintExpPay4{0}EmpCode",hidden:!0},{label:"社員名",apiKey:"EmpId__r.Name",domId:"PrintExpPay4{0}EmpName",hidden:!0},{label:"StatusC",apiKey:"StatusC__c",domId:"PrintExpPay4{0}StatusC",hidden:!0},{label:"StatusD",apiKey:"StatusD__c",domId:"PrintExpPay4{0}StatusD",hidden:!0},{label:"申請番号",
msgId:"expApplyNo_label",apiKey:"ExpPreApplyNo__c",domId:"PrintExpPay4{0}ExpApplyNo",domType:"text",width:"20%",align:"center"},{label:"金額",msgId:"expCost_head",apiKey:"ProvisionalPaymentAmount__c",domId:"PrintExpPay4{0}TotalCost",domType:"currency",width:"10%"},{label:"精算日",msgId:"payDate_label",apiKey:"_payDate",domId:"PrintExpPay4{0}payDate",domType:"date",width:"10%"},{label:"備考(精算時)",msgId:"tf10000720",
apiKey:"_payNote",domId:"PrintExpPay4{0}payMethod",domType:"text",width:"30%"},{label:"申請日時",msgId:"applyTime_label",apiKey:"ApplyTime__c",domId:"PrintExpPay4{0}ApplyTime",domType:"datetime",width:"10%"},{label:"承認日時",msgId:"tk10000070",apiKey:"ApproveTime__c",domId:"PrintExpPay4{0}ApproveTime",domType:"datetime",width:"10%"},{label:"ステータス",msgId:"status_btn_title",apiKey:"_status",domId:"PrintExpPay4{0}Status",
domType:"text",width:"10%",align:"center"}],sortKeys:[{apiKey:"EmpId__r.EmpCode__c"},{apiKey:"EmpId__r.Name"},{apiKey:"ExpPreApplyNo__c"}]},ListExpJsNavi:{discernment:"expJsNavi",objectName:"AtkJsNaviInvoice__c",type:"table",formCss:"ts-exp-jsnavi-list",rowLimit:50,irregularType:"jsNaviList",stereoType:!0,fields:[{label:"ID",apiKey:"Id",domId:"ExpJsNavi{0}Id",domType:"text",hidden:!0},{label:"経費申請名",apiKey:"Name",
domId:"ExpJsNavi{0}Name",domType:"text",hidden:!0},{label:"生成日時",apiKey:"CreatedDate",domId:"ExpJsNavi{0}CreatedDate",domType:"datetime",hidden:!0},{label:"最終更新日時",apiKey:"LastModifiedDate",domId:"ExpJsNavi{0}LastModifiedDate",domType:"datetime",hidden:!0},{label:"社員ID",apiKey:"EmpId__c",domId:"ExpJsNavi{0}EmpId__c",domType:"text",hidden:!0},{label:"事前申請ID",apiKey:"ExpPreApplyId__c",domId:"ExpJsNavi{0}ExpPreApplyId",
domType:"text",hidden:!0},{label:"事前申請番号",apiKey:"ExpPreApplyNo__c",domId:"ExpJsNavi{0}ExpPreApplyNo",domType:"text",hidden:!0},{label:"経費申請ID",apiKey:"ExpApplyId__c",domId:"ExpJsNavi{0}ExpApplyId",domType:"text",hidden:!0},{label:"経費申請番号",apiKey:"ExpApplyNo__c",domId:"ExpJsNavi{0}ExpApplyNo",domType:"text",hidden:!0},{label:"経費申請ステータス",apiKey:"ExpApplyId__r.Status__c",domId:"ExpJsNavi{0}ExpApplyStatus",
domType:"text",hidden:!0},{label:"ステータス",msgId:"status_btn_title",apiKey:"_ApprovalStatus",domId:"ExpJsNavi{0}ApprovalStatus",domType:"text",width:10,align:"center"},{label:"請求明細",msgId:"jt18000110",apiKey:"_DetailLink",domId:"ExpJsNavi{0}DetailLink",domType:"text",width:15,align:"center",link:!0},{label:"経費申請番号",msgId:"expApplyNo_label",apiKey:"_ApplyNo",domId:"ExpJsNavi{0}ApplyNo",domType:"text",width:15,link:!0},{
label:"事前申請番号",msgId:"expPreApplyNo_label",apiKey:"_PreApplyNo",domId:"ExpJsNavi{0}PreApplyNo",domType:"text",width:15,link:!0},{label:"部署名",msgId:"tk10000335",apiKey:"deptName",domId:"ExpJsNavi{0}DeptName",domType:"text",width:"15%"},{label:"社員コード",msgId:"empCode_label",apiKey:"EmpCode__c",domId:"ExpJsNavi{0}EmpCode",domType:"text",width:"10%"},{label:"社員名",msgId:"empName_label",apiKey:"empName",
domId:"ExpJsNavi{0}EmpName",domType:"text",width:"15%"},{label:"利用金額",msgId:"jt18000050",apiKey:"useAmount",domId:"ExpJsNavi{0}UseAmount",domType:"currency",width:72},{label:"請求金額合計",msgId:"jt18000060",apiKey:"totalInvoiceAmount",domId:"ExpJsNavi{0}TotalInvoiceAmount",domType:"currency",width:72}],foots:[],filts:[],sortKeys:[{apiKey:"ExpApplyId__c",desc:!1}]},searchExpJsNavi:{title:["jt18000090"],
formCss:"ts-dialog-search-expJsNavi",type:"searchCondition",fields:[{label:"利用日付範囲",msgId:"tf10000700",apiKey:"_startEnd",domId:"SearchJsNaviDate",domType:"dateRange",width:108,name:"useDate",colNames:["Date__c","Date__c"]},{label:"申請番号",msgId:"expApplyNo_label",apiKey:"ExpApplyId__r.ExpApplyNo__c",domId:"SearchJsNaviApplyNo",domType:"text",width:300,matchType:2},{label:"部署名",msgId:"tk10000335",
apiKey:"EmpId__r.DeptId__r.Name",domId:"SearchJsNaviDeptName",domType:"depta",width:350,matchType:3,optKey:"ExpApplyId__r.DeptId__r.Name",defaultChk:!0},{label:"社員コード",msgId:"empCode_label",apiKey:"EmpId__r.EmpCode__c",domId:"SearchJsNaviEmpCode",domType:"text",width:150,matchType:1},{label:"社員名",msgId:"empName_label",apiKey:"EmpId__r.Name",domId:"SearchJsNaviEmpName",domType:"text",width:300,matchType:3}]},
ListExpJsNaviDetail:{discernment:"expJsNaviDetail",objectName:"AtkJsNaviInvoice__c",type:"table",formCss:"ts-exp-jsnavi-list",rowLimit:30,irregularType:"jsNaviList",stereoType:!0,fields:[{label:"ID",apiKey:"Id",domId:"ExpJsNavi{0}Id",domType:"text",hidden:!0},{label:"経費申請名",apiKey:"Name",domId:"ExpJsNavi{0}Name",domType:"text",hidden:!0},{label:"生成日時",apiKey:"CreatedDate",domId:"ExpJsNavi{0}CreatedDate",
domType:"datetime",hidden:!0},{label:"最終更新日時",apiKey:"LastModifiedDate",domId:"ExpJsNavi{0}LastModifiedDate",domType:"datetime",hidden:!0},{label:"社員ID",apiKey:"EmpId__c",domId:"ExpJsNavi{0}EmpId__c",domType:"text",hidden:!0},{label:"事前申請ID",apiKey:"ExpPreApplyId__c",domId:"ExpJsNavi{0}ExpPreApplyId",domType:"text",hidden:!0},{label:"事前申請番号",apiKey:"ExpPreApplyNo__c",domId:"ExpJsNavi{0}ExpPreApplyNo",domType:"text",
hidden:!0},{label:"経費申請ID",apiKey:"ExpApplyId__c",domId:"ExpJsNavi{0}ExpApplyId",domType:"text",hidden:!0},{label:"経費申請番号",apiKey:"ExpApplyNo__c",domId:"ExpJsNavi{0}ExpApplyNo",domType:"text",hidden:!0},{label:"経費申請ステータス",apiKey:"ExpApplyId__r.Status__c",domId:"ExpJsNavi{0}ExpApplyStatus",domType:"text",hidden:!0},{label:"利用日付",msgId:"tf10000670",apiKey:"Date__c",domId:"ExpJsNavi{0}ApplyTime",domType:"date",width:80,
sortable:!0},{label:"事前申請番号",msgId:"expPreApplyNo_label",apiKey:"_PreApplyNo",domId:"ExpJsNavi{0}PreApplyNo",domType:"text",width:"10%",link:!0},{label:"部署名",msgId:"tk10000335",apiKey:"EmpId__r.DeptId__r.Name",domId:"ExpJsNavi{0}DeptName",domType:"text",width:"15%",sortable:!0},{label:"社員コード",msgId:"empCode_label",apiKey:"EmpId__r.EmpCode__c",domId:"ExpJsNavi{0}EmpCode",domType:"text",width:"5%",sortable:!0},{
label:"社員名",msgId:"empName_label",apiKey:"EmpId__r.Name",domId:"ExpJsNavi{0}EmpName",domType:"text",width:"10%",sortable:!0},{label:"利用先名称",msgId:"jt18000040",apiKey:"UseName__c",domId:"ExpJsNavi{0}UseName",domType:"text",width:"15%"},{label:"出発地",msgId:"jt18000160",apiKey:"StartPlace__c",domId:"ExpJsNavi{0}StartPlace",domType:"text",width:"10%"},{label:"到着地",msgId:"jt18000170",apiKey:"EndPlace__c",
domId:"ExpJsNavi{0}EndPlace",domType:"text",width:"10%"},{label:"ステータス",msgId:"status_btn_title",apiKey:"Status__c",domId:"ExpJsNavi{0}Status",domType:"text",width:"10%",sortable:!0},{label:"請求金額",msgId:"jt18000060",apiKey:"InvoiceAmount__c",domId:"ExpJsNavi{0}UseAmount",domType:"currency",width:72,sortable:!0},{label:"備考",msgId:"expNote_head",apiKey:"Note__c",domId:"ExpJsNavi{0}Note",domType:"text",width:"25%"}],
foots:[],filts:[],sortKeys:[{apiKey:"Date__c",desc:!1}]},ListEmpTable:{discernment:"ListEmpTable",objectName:"AtkEmp__c",type:"table",formCss:"ts-emp-list",rowLimit:50,empList:!0,fields:[{label:"ID",apiKey:"Id",domId:"Emp{0}Id",domType:"text",hidden:!0},{label:"社員コード",msgId:"empCode_label",apiKey:"EmpCode__c",domId:"Emp{0}Code",domType:"text",width:100,sortable:!0,link:!0},{label:"社員名",msgId:"empName_label",
apiKey:"Name",domId:"Emp{0}Name",domType:"text",width:120,sortable:!0,link:!0},{label:"上長",msgId:"tm10011000",apiKey:"Manager__r.Name",domId:"Emp{0}Manager",domType:"text",width:120,sortable:!0},{label:"部署",msgId:"dept_label",apiKey:"DeptId__r.Name",domId:"Emp{0}DeptName",domType:"text",width:150,sortable:!0},{label:"勤務体系",msgId:"empType_label",apiKey:"EmpTypeId__r.Name",domId:"Emp{0}EmpTypeName",domType:"text",
width:150,sortable:!0}],sortKeys:[{apiKey:"EmpCode__c"}],filts:[],childFilts:[],children:{}},ListEmpTable2:{discernment:"ListEmpTable2",objectName:"AtkEmp__c",type:"table",formCss:"ts-emp-list",rowLimit:50,empList:!0,fields:[{label:"ID",apiKey:"Id",domId:"Emp{0}Id",domType:"text",hidden:!0},{label:"UserId",apiKey:"UserId__c",domId:"Emp{0}UserId",domType:"text",hidden:!0},{label:"Manager",apiKey:"Manager__c",
domId:"Emp{0}Manager0",domType:"text",hidden:!0},{label:"Dm0",apiKey:"DeptId__r.ManagerId__c",domId:"Emp{0}Dm0",domType:"text",hidden:!0},{label:"Dm1",apiKey:"DeptId__r.Manager1Id__c",domId:"Emp{0}Dm1",domType:"text",hidden:!0},{label:"Dm2",apiKey:"DeptId__r.Manager2Id__c",domId:"Emp{0}Dm2",domType:"text",hidden:!0},{label:"Dpm0",apiKey:"DeptId__r.ParentId__r.ManagerId__c",domId:"Emp{0}Dpm0",domType:"text",hidden:!0}
,{label:"Dpm1",apiKey:"DeptId__r.ParentId__r.Manager1Id__c",domId:"Emp{0}Dpm1",domType:"text",hidden:!0},{label:"Dpm2",apiKey:"DeptId__r.ParentId__r.Manager2Id__c",domId:"Emp{0}Dpm2",domType:"text",hidden:!0},{label:"Dppm0",apiKey:"DeptId__r.ParentId__r.ParentId__r.ManagerId__c",domId:"Emp{0}Dppm0",domType:"text",hidden:!0},{label:"Dppm1",apiKey:"DeptId__r.ParentId__r.ParentId__r.Manager1Id__c",domId:"Emp{0}Dppm1",
domType:"text",hidden:!0},{label:"Dppm2",apiKey:"DeptId__r.ParentId__r.ParentId__r.Manager2Id__c",domId:"Emp{0}Dppm2",domType:"text",hidden:!0},{label:"Dpppm0",apiKey:"DeptId__r.ParentId__r.ParentId__r.ParentId__r.ManagerId__c",domId:"Emp{0}Dpppm0",domType:"text",hidden:!0},{label:"Dpppm1",apiKey:"DeptId__r.ParentId__r.ParentId__r.ParentId__r.Manager1Id__c",domId:"Emp{0}Dpppm1",domType:"text",hidden:!0},{
label:"Dpppm2",apiKey:"DeptId__r.ParentId__r.ParentId__r.ParentId__r.Manager2Id__c",domId:"Emp{0}Dpppm2",domType:"text",hidden:!0},{label:"社員コード",msgId:"empCode_label",apiKey:"EmpCode__c",domId:"Emp{0}Code",domType:"text",width:95,sortable:!0,link:!0},{label:"社員名",msgId:"empName_label",apiKey:"Name",domId:"Emp{0}Name",domType:"text",width:105,sortable:!0,link:!0},{label:"ステータス",msgId:"status_btn_title",
apiKey:"_status",domId:"Emp{0}Status",domType:"text",width:70,align:"center"},{label:"上長",msgId:"tm10011000",apiKey:"Manager__r.Name",domId:"Emp{0}Manager",domType:"text",width:105,sortable:!0},{label:"部署",msgId:"dept_label",apiKey:"DeptId__r.Name",domId:"Emp{0}DeptName",domType:"text",width:135,sortable:!0},{label:"勤務体系",msgId:"empType_label",apiKey:"EmpTypeId__r.Name",domId:"Emp{0}EmpTypeName",domType:"text",
width:130,sortable:!0}],sortKeys:[{apiKey:"EmpCode__c"}],filts:[],childFilts:[],children:{}},form0:{areaId:"expApplyForm0",sectionTitle:null,sectionTitles:{detail:"empExp_caption"},objectName:"AtkExpApply__c",fields:[{label:"_uniqKey",apiKey:"_uniqKey",domId:"Form0_UNIQ",domType:"text",hidden:!0},{label:"ID",apiKey:"Id",domId:"Form0Id",domType:"text",hidden:!0,fix:"Id"},{label:"社員ID",apiKey:"EmpId__c",
domId:"Form0EmpId",domType:"text",hidden:!0,fix:"Id"},{label:"経費費目表示区分",apiKey:"EmpId__r.ExpItemClass__c",domId:"Form0EmpExpItemClass",domType:"text",hidden:!0,fix:"Id"},{label:"経費事前申請ID",apiKey:"ExpPreApplyId__c",domId:"Form0ExpPreApplyId",domType:"text",hidden:!0,fix:"Id"},{label:"稟議ID",apiKey:"ApplyId__c",domId:"Form0ApplyId",domType:"text",hidden:!0,fix:"Id"},{label:"合計金額",apiKey:"TotalAmount__c",
domId:"Form0TotalAmount",domType:"currency",hidden:!0,fix:"Id"}]},form1:{areaId:"expPreApplyForm1",title:"tf10002120",sectionTitle:"tf10002150",sectionTitles:{detail:"tf10002160"},objectName:"AtkExpPreApply__c",fields:[{label:"_uniqKey",apiKey:"_uniqKey",domId:"Form1_UNIQ",domType:"text",hidden:!0},{label:"ID",apiKey:"Id",domId:"Form1Id",domType:"text",hidden:!0},{label:"社員ID",apiKey:"EmpId__c",domId:"Form1EmpId",
domType:"text",hidden:!0,fix:"Id"},{label:"経費費目表示区分",apiKey:"EmpId__r.ExpItemClass__c",domId:"Form1EmpExpItemClass",domType:"text",hidden:!0},{label:"経費事前申請種別",apiKey:"Type__c",domId:"Form1Type",domType:"text",hidden:!0},{label:"合計金額",apiKey:"TotalAmount__c",domId:"Form1TotalAmount",domType:"currency",hidden:!0},{label:"仮払金額",apiKey:"ProvisionalPaymentAmount__c",domId:"Form1TotalProvisional",domType:"currency",
hidden:!0},{label:"取引先ID",apiKey:"AccountId__c",domId:"Form1AccountId",domType:"text",hidden:!0},{label:"ジョブコード",apiKey:"ChargeJobId__r.JobCode__c",domId:"Form1JobCode",domType:"text",hidden:!0},{label:"有効開始日",apiKey:"ChargeJobId__r.StartDate__c",domId:"Form1JobStartDate",domType:"date",hidden:!0},{label:"有効終了日",apiKey:"ChargeJobId__r.EndDate__c",domId:"Form1JobEndDate",domType:"date",hidden:!0},{label:"ジョブ有効",
apiKey:"ChargeJobId__r.Active__c",domId:"Form1JobActive",domType:"checkbox",hidden:!0},{label:"ステータス",apiKey:"StatusD__c",domId:"Form1Status",domType:"text",hidden:!0},{label:"手配予定金額",apiKey:"PlannedAmount__c",domId:"Form1PlannedAmount",domType:"currency",hidden:!0},{label:"出張種別",msgId:"tf10000760",apiKey:"DestinationType__c",domId:"Form1DestinationType",domType:"select",width:440,required:1,pickList:[{v:"",n:""},{
v:"1",msgId:"tf10001960"},{v:"2",msgId:"tf10001970"},{v:"3",msgId:"tf10001980"}]},{label:"件名",msgId:"tk10004320",apiKey:"Title__c",domId:"Form1Title",domType:"text",width:440,maxLen:40,required:1},{label:"取引先",msgId:"tk10000122",apiKey:"AccountName__c",domId:"Form1AccountName",domType:"text",width:440,maxLen:80,browse:"find"},{label:"ジョブ",msgId:"job_label",apiKey:"ChargeJobId__c",domId:"Form1Job",domType:"select",
width:440,browse:"find",dispField:{apiKey:"ChargeJobId__r.Name",codeKey:"ChargeJobId__r.JobCode__c"}},{label:"出発予定日",msgId:"tf10000770",apiKey:"StartDate__c",domId:"Form1StartDate",domType:"date",width:108,maxLen:12,name:"form1StartDate",browse:"cal",noNL:!0,required:2},{label:"出発予定時刻",msgId:"tf10000780",apiKey:"DepartureTime__c",domId:"Form1DepartureTime",domType:"time",width:60,maxLen:5,lw:100,noNL:!0},{
label:"出発区分",msgId:"tf10000790",apiKey:"DepartureType__c",domId:"Form1DepartureType",domType:"select",width:134,lw:70,required:1,pickList:[{v:"",n:""},{v:"0",msgId:"tf10001990"},{v:"1",msgId:"tk10004680"}]},{label:"帰着予定日",msgId:"tf10000800",apiKey:"EndDate__c",domId:"Form1EndDate",domType:"date",width:108,maxLen:12,name:"form1EndDate",browse:"cal",noNL:!0,required:2},{label:"帰着予定時刻",msgId:"tf10000810",
apiKey:"ReturnTime__c",domId:"Form1ReturnTime",domType:"time",width:60,maxLen:5,lw:100,noNL:!0},{label:"帰着区分",msgId:"tf10000820",apiKey:"ReturnType__c",domId:"Form1ReturnType",domType:"select",width:134,lw:70,required:1,pickList:[{v:"",n:""},{v:"0",msgId:"tf10001990"},{v:"1",msgId:"tk10004690"}]},{label:"出張先会社名",msgId:"tf10000830",apiKey:"DestinationName__c",domId:"Form1DestinationName",domType:"text",width:440,
maxLen:80},{label:"出張先住所",msgId:"tf10000840",apiKey:"DestinationAddress__c",domId:"Form1DestinationAddress",domType:"text",width:440,maxLen:255},{label:"内容",msgId:"tf10000850",apiKey:"Content__c",domId:"Form1Content",domType:"textarea",width:440,maxLen:32768,required:1}]},form2:{areaId:"expPreApplyForm2",title:"tf10002130",sectionTitle:"tf10002150",objectName:"AtkExpPreApply__c",fields:[{label:"_uniqKey",
apiKey:"_uniqKey",domId:"Form2_UNIQ",domType:"text",hidden:!0},{label:"ID",apiKey:"Id",domId:"Form2Id",domType:"text",hidden:!0},{label:"社員ID",apiKey:"EmpId__c",domId:"Form2EmpId",domType:"text",hidden:!0,fix:"Id"},{label:"経費費目表示区分",apiKey:"EmpId__r.ExpItemClass__c",domId:"Form2EmpExpItemClass",domType:"text",hidden:!0},{label:"経費事前申請種別",apiKey:"Type__c",domId:"Form2Type",domType:"text",hidden:!0},{label:"仮払金額",
apiKey:"ProvisionalPaymentAmount__c",domId:"Form1TotalProvisional",domType:"currency",hidden:!0},{label:"予定日",apiKey:"EndDate__c",domId:"Form2EndDate",domType:"date",hidden:!0},{label:"取引先ID",apiKey:"AccountId__c",domId:"Form2AccountId",domType:"text",hidden:!0},{label:"ジョブコード",apiKey:"ChargeJobId__r.JobCode__c",domId:"Form2JobCode",domType:"text",hidden:!0},{label:"有効開始日",apiKey:"ChargeJobId__r.StartDate__c",
domId:"Form2JobStartDate",domType:"date",hidden:!0},{label:"有効終了日",apiKey:"ChargeJobId__r.EndDate__c",domId:"Form2JobEndDate",domType:"date",hidden:!0},{label:"ジョブ有効",apiKey:"ChargeJobId__r.Active__c",domId:"Form2JobActive",domType:"checkbox",hidden:!0},{label:"ステータス",apiKey:"StatusD__c",domId:"Form2Status",domType:"text",hidden:!0},{label:"件名",msgId:"tk10004320",apiKey:"Title__c",domId:"Form2Title",domType:"text",
width:400,maxLen:40,required:1},{label:"取引先",msgId:"tk10000122",apiKey:"AccountName__c",domId:"Form2AccountName",domType:"text",width:400,maxLen:80,browse:"find"},{label:"ジョブ",msgId:"job_label",apiKey:"ChargeJobId__c",domId:"Form2Job",domType:"select",width:400,browse:"find",dispField:{apiKey:"ChargeJobId__r.Name",codeKey:"ChargeJobId__r.JobCode__c"}},{label:"費目",msgId:"expItem_head",apiKey:"SocialExpItemId__c",
domId:"Form2SocialExpItemId",domType:"select",width:400,required:1,dispField:{apiKey:"SocialExpItemId__r.Name"}},{label:"予定日",msgId:"tf10000620",apiKey:"StartDate__c",domId:"Form2StartDate",domType:"date",width:108,maxLen:12,name:"form2Date",browse:"cal",required:2},{label:"内容",msgId:"tf10000850",apiKey:"Content__c",domId:"Form2Content",domType:"textarea",width:400,maxLen:32768,required:1},{label:"金額",
msgId:"expCost_head",apiKey:"TotalAmount__c",domId:"Form2TotalAmount",domType:"currency",width:120,maxLen:17,required:1},{label:"社内参加者人数",msgId:"tf10000860",apiKey:"OurNumber__c",domId:"Form2OurNumber__c",domType:"number",width:80,maxLen:3,required:1,tooltipMsgId:"tf10001853"},{label:"社内参加者",msgId:"tf10011030",apiKey:"InternalParticipants__c",domId:"Form2InternalParticipants__c",domType:"textarea",width:400,
maxLen:1e3},{label:"社外参加者人数",msgId:"tf10000870",apiKey:"TheirNumber__c",domId:"Form2TheirNumber__c",domType:"number",width:80,maxLen:3,required:1},{label:"社外参加者",msgId:"tf10011040",apiKey:"ExternalParticipants__c",domId:"Form2ExternalParticipants__c",domType:"textarea",width:400,maxLen:1e3},{label:"店舗名",msgId:"tf10011010",apiKey:"PlaceName__c",domId:"Form2PlaceName__c",domType:"text",width:400,maxLen:80},{
label:"店舗所在地",msgId:"tf10011020",apiKey:"PlaceAddress__c",domId:"Form2PlaceAddress__c",domType:"textarea",width:400,maxLen:256},{label:"合計人数",msgId:"tf10000880",apiKey:"_totalNumber",domId:"Form2TotalNumber",domType:"number",width:80,ro:!0}]},form3:{areaId:"expPreApplyForm3",title:"tf10002140",sectionTitle:"tf10002150",sectionTitles:{detail:"tf10002170"},objectName:"AtkExpPreApply__c",fields:[{label:"_uniqKey",
apiKey:"_uniqKey",domId:"Form3_UNIQ",domType:"text",hidden:!0},{label:"ID",apiKey:"Id",domId:"Form3Id",domType:"text",hidden:!0},{label:"社員ID",apiKey:"EmpId__c",domId:"Form3EmpId",domType:"text",hidden:!0,fix:"Id"},{label:"経費費目表示区分",apiKey:"EmpId__r.ExpItemClass__c",domId:"Form3EmpExpItemClass",domType:"text",hidden:!0},{label:"経費事前申請種別",apiKey:"Type__c",domId:"Form3Type",domType:"text",hidden:!0},{label:"合計金額",
apiKey:"TotalAmount__c",domId:"Form3TotalAmount",domType:"currency",hidden:!0},{label:"仮払金額",apiKey:"ProvisionalPaymentAmount__c",domId:"Form3TotalProvisional",domType:"currency",hidden:!0},{label:"予定日",apiKey:"EndDate__c",domId:"Form3EndDate",domType:"date",hidden:!0},{label:"取引先ID",apiKey:"AccountId__c",domId:"Form3AccountId",domType:"text",hidden:!0},{label:"ジョブコード",apiKey:"ChargeJobId__r.JobCode__c",
domId:"Form3JobCode",domType:"text",hidden:!0},{label:"有効開始日",apiKey:"ChargeJobId__r.StartDate__c",domId:"Form3JobStartDate",domType:"date",hidden:!0},{label:"有効終了日",apiKey:"ChargeJobId__r.EndDate__c",domId:"Form3JobEndDate",domType:"date",hidden:!0},{label:"ジョブ有効",apiKey:"ChargeJobId__r.Active__c",domId:"Form3JobActive",domType:"checkbox",hidden:!0},{label:"ステータス",apiKey:"StatusD__c",domId:"Form3Status",
domType:"text",hidden:!0},{label:"件名",msgId:"tk10004320",apiKey:"Title__c",domId:"Form3Title",domType:"text",width:400,maxLen:40,required:1},{label:"取引先",msgId:"tk10000122",apiKey:"AccountName__c",domId:"Form3AccountName",domType:"text",width:400,maxLen:80,browse:"find"},{label:"ジョブ",msgId:"job_label",apiKey:"ChargeJobId__c",domId:"Form3Job",domType:"select",width:400,browse:"find",dispField:{
apiKey:"ChargeJobId__r.Name",codeKey:"ChargeJobId__r.JobCode__c"}},{label:"予定日",msgId:"tf10000620",apiKey:"StartDate__c",domId:"Form3StartDate",domType:"date",width:108,name:"form3Date",browse:"cal",required:2},{label:"内容",msgId:"tf10000850",apiKey:"Content__c",domId:"Form3Content",domType:"textarea",width:400,maxLen:32768,required:1}]},form4:{areaId:"expPreApplyForm4",title:"tf10006120",sectionTitle:"tf10002150",
sectionTitles:{detail:"tf10002170"},objectName:"AtkExpPreApply__c",fields:[{label:"_uniqKey",apiKey:"_uniqKey",domId:"Form4_UNIQ",domType:"text",hidden:!0},{label:"ID",apiKey:"Id",domId:"Form4Id",domType:"text",hidden:!0},{label:"社員ID",apiKey:"EmpId__c",domId:"Form4EmpId",domType:"text",hidden:!0,fix:"Id"},{label:"経費費目表示区分",apiKey:"EmpId__r.ExpItemClass__c",domId:"Form4EmpExpItemClass",domType:"text",hidden:!0},{
label:"経費事前申請種別",apiKey:"Type__c",domId:"Form4Type",domType:"text",hidden:!0},{label:"合計金額",apiKey:"TotalAmount__c",domId:"Form4TotalAmount",domType:"currency",hidden:!0},{label:"仮払金額",apiKey:"ProvisionalPaymentAmount__c",domId:"Form1TotalProvisional",domType:"currency",hidden:!0},{label:"申請日",apiKey:"StartDate__c",domId:"Form4StartDate",domType:"date",hidden:!0},{label:"申請日",apiKey:"EndDate__c",domId:"Form4EndDate",
domType:"date",hidden:!0},{label:"取引先ID",apiKey:"AccountId__c",domId:"Form4AccountId",domType:"text",hidden:!0},{label:"ジョブコード",apiKey:"ChargeJobId__r.JobCode__c",domId:"Form4JobCode",domType:"text",hidden:!0},{label:"有効開始日",apiKey:"ChargeJobId__r.StartDate__c",domId:"Form4JobStartDate",domType:"date",hidden:!0},{label:"有効終了日",apiKey:"ChargeJobId__r.EndDate__c",domId:"Form4JobEndDate",domType:"date",hidden:!0},{
label:"ジョブ有効",apiKey:"ChargeJobId__r.Active__c",domId:"Form4JobActive",domType:"checkbox",hidden:!0},{label:"ステータス",apiKey:"StatusD__c",domId:"Form4Status",domType:"text",hidden:!0},{label:"件名",msgId:"tk10004320",apiKey:"Title__c",domId:"Form4Title",domType:"text",width:400,maxLen:40,required:1},{label:"取引先",msgId:"tk10000122",apiKey:"AccountName__c",domId:"Form4AccountName",domType:"text",width:400,maxLen:80,
browse:"find"},{label:"ジョブ",msgId:"job_label",apiKey:"ChargeJobId__c",domId:"Form4Job",domType:"select",width:400,browse:"find",dispField:{apiKey:"ChargeJobId__r.Name",codeKey:"ChargeJobId__r.JobCode__c"}},{label:"処理日",msgId:"tf10006100",apiKey:"ApplyDate__c",domId:"Form4ApplyDate",domType:"date",width:108,name:"Form4Date",browse:"cal",required:2},{label:"内容",msgId:"tf10000850",apiKey:"Content__c",
domId:"Form4Content",domType:"textarea",width:400,maxLen:32768,required:1}]},formT:{areaId:"expApplyFormT",sectionTitle:"empExp_caption"},sectionJtb:{discernment:"jtbDetail",title:"jt12000060",formCss:"ts-section-jtb",objectName:"AtkEmpExp__c",relationshipName:"ExpJsNavi__r",child:!0,fields:[{label:"_uniqKey",apiKey:"_uniqKey",domId:"SecJtb{0}_UNIQ",domType:"text",hidden:!0},{label:"ID",apiKey:"Id",
domId:"SecJtb{0}Id",domType:"text",hidden:!0},{label:"経費事前申請ID",apiKey:"ExpPreApplyId__c",domId:"SecJtb{0}ExpPreApplyId",domType:"text",hidden:!0},{label:"処理番号",apiKey:"OperationNo__c",domId:"SecJtb{0}OperationNo",domType:"text",hidden:!0},{label:"副番号",apiKey:"SubNo__c",domId:"SecJtb{0}SubNo",domType:"text",hidden:!0},{label:"取得データ",apiKey:"Route__c",domId:"SecJtb{0}Route",domType:"text",hidden:!0},{label:"費目",
apiKey:"ExpItemId__c",domId:"SecJtbl{0}ExpItem",domType:"text",hidden:!0},{label:"日付",msgId:"date_head",apiKey:"Date__c",domId:"SecJtb{0}Date",domType:"date",width:90,maxLen:12,format:"M/d+",hiddenPlus:!0,ro:!0},{label:"交通機関名",msgId:"jt12000090",apiKey:"Transport__c",domId:"SecJtb{0}Type",domType:"text",width:150,ro:!0},{label:"ステータス",msgId:"status_btn_title",apiKey:"Status__c",domId:"SecJtb{0}Status",domType:"text",
width:100,ro:!0},{label:"金額",msgId:"tf10000950",apiKey:"Cost__c",domId:"SecJtb{0}Cost",domType:"currency",width:90,ro:!0},{label:"内容",msgId:"tf10000850",apiKey:"Content__c",domId:"SecJtb{0}Content",domType:"text",width:300,maxLen:1e3,ro:!0},{label:"備考",msgId:"expNote_head",apiKey:"Note__c",domId:"SecJtb{0}Note",domType:"text",width:250,maxLen:1e3,ro:!0}]},sectionAllowance:{discernment:"allowance",title:"tf10002180",
formCss:"ts-section-allowance",objectName:"AtkExpPreApplyDay__c",relationshipName:"ExpPreApplyDay__r",child:!0,fields:[{label:"_uniqKey",apiKey:"_uniqKey",domId:"SecAllow{0}_UNIQ",domType:"text",hidden:!0},{label:"ID",apiKey:"Id",domId:"SecAllow{0}Id",domType:"text",hidden:!0},{label:"経費事前申請ID",apiKey:"ExpPreApplyId__c",domId:"SecAllow{0}ExpPreApplyId",domType:"text",hidden:!0,fix:"Id"},{label:"日付",msgId:"date_head",
apiKey:"Date__c",domId:"SecAllow{0}Date",domType:"date",width:108,maxLen:12,format:"M/d+",hiddenPlus:!0,ro:!0},{label:"日当",msgId:"tf10000890",apiKey:"AllowanceItemId__c",domId:"SecAllow{0}Allow",domType:"select",width:200,dispField:{apiKey:"AllowanceItemId__r.Name"}},{label:"宿泊",msgId:"tf10000900",apiKey:"HotelItemId__c",domId:"SecAllow{0}Hotel",domType:"select",width:200,dispField:{apiKey:"HotelItemId__r.Name"}},{
label:"備考",msgId:"expNote_head",apiKey:"Note__c",domId:"SecAllow{0}Note",domType:"text",width:250,maxLen:255}]},sectionCoupon:{discernment:"coupon",title:"tf10002190",formCss:"ts-section-coupon",objectName:"AtkExpPreApply__c",virChild:!0,virMax:2,fields:[{label:"_uniqKey",apiKey:"_uniqKey",domId:"SectCoupon{0}_UNIQ",domType:"text",hidden:!0},{check:!0,domId:"Coupon{0}Check_",domType:"checkbox",width:24},{label:"乗車日",
msgId:"tf10000910",apiKey:"couponDate",apiName:"Coupon{0}Date__c",domId:"SectCoupon{0}Date",domType:"date",width:108,maxLen:12,name:"coupon{0}Date",browse:"cal"},{label:"回数券種別",msgId:"tf10000920",apiKey:"couponName",apiName:"Coupon{0}Name__c",domId:"SectCoupon{0}Name",domType:"select",width:300,required:1,dispField:{apiKey:"couponName"}},{label:"枚数",msgId:"tf10000930",apiKey:"couponQuantity",
apiName:"Coupon{0}Quantity__c",domId:"SectCoupon{0}Quant",domType:"number",width:50,maxLen:2,required:1},{label:"備考",msgId:"expNote_head",apiKey:"couponNote",apiName:"Coupon{0}Note__c",domId:"SectCoupon{0}Note",domType:"text",width:250,maxLen:255}]},sectionDetail:{discernment:"detail",title:null,formCss:"ts-section-detail",objectName:"AtkEmpExp__c",relationshipName:"EmpExp__r",child:!0,fields:[{label:"_uniqKey",
apiKey:"_uniqKey",domId:"SectDetail{0}_UNIQ",domType:"text",hidden:!0},{label:"ID",apiKey:"Id",domId:"SectDetail{0}Id",domType:"text",hidden:!0},{label:"削除フラグ",apiKey:"_removed",domId:"SectDetail{0}_Removed",domType:"checkbox",hidden:!0},{label:"JsNavi差分フラグ",apiKey:"_diffJsNavi",domId:"SectDetail{0}_DiffJsNavi",domType:"checkbox",hidden:!0},{label:"JsNavi追加フラグ",apiKey:"_addJsNavi",domId:"SectDetail{0}_AddJsNavi",
domType:"checkbox",hidden:!0},{label:"JsNavi実績データ",apiKey:"JsNaviActualId__c",domId:"SectDetail{0}JsNaviActualId",domType:"text",hidden:!0},{check:!0,domId:"SectDetail{0}Check_",domType:"checkbox",width:24},{label:"利用日",msgId:"tf10000940",apiKey:"Date__c",domId:"SectDetail{0}Date",domType:"date",width:108,ro:!0,required:1,link:!0,name:"detail{0}Date",browse:"cal"},{label:"費目",msgId:"expItem_head",
apiKey:"ExpItemId__c",domId:"SectDetail{0}ExpItem",domType:"select",width:100,ro:!0,required:1,link:!0,dispField:{apiKey:"ExpItemId__r.Name"}},{label:"内容",msgId:"tf10000850",domId:"SectDetail{0}Content",domType:"route",width:"30%",ro:!0},{label:"金額",msgId:"tf10000950",apiKey:"Cost__c",domId:"SectDetail{0}Cost",domType:"currency",width:110,ro:!0,required:1},{label:"ジョブ",msgId:"job_label",apiKey:"JobId__c",
domId:"SectDetail{0}JobId",domType:"select",width:"20%",ro:!0,dispField:{apiKey:"JobId__r.Name",codeKey:"JobId__r.JobCode__c"}},{label:"備考",msgId:"expNote_head",apiKey:"Detail__c",domId:"SectDetail{0}Detail",domType:"text",width:200,ro:!0}]},sectionForeign:{discernment:"foreign",title:"tf10001970",formCss:"ts-section-foreign",objectName:"AtkExpPreApply__c",fields:[{label:"_uniqKey",apiKey:"_uniqKey",
domId:"SectForeign_UNIQ",domType:"text",hidden:!0},{label:"現地受入部署",msgId:"tf10000960",apiKey:"OverseaOption1__c",domId:"SectForeignOverseaOption1",domType:"text",width:200,maxLen:80,areaKey:"z1"},{label:"パスポート申請",msgId:"tf10000970",apiKey:"OverseaCheckList1__c",domId:"SectForeignOverseaCheckList1",domType:"select",width:120,areaKey:"z1",pickList:[{v:"",n:""},{v:"1",msgId:"tm10010590"},{v:"0",msgId:"tm10010600"}]},{
label:"健康診断実施",msgId:"tf10000980",apiKey:"OverseaCheckList3__c",domId:"SectForeignOverseaCheckList3",domType:"select",width:120,areaKey:"z1",pickList:[{v:"",n:""},{v:"1",msgId:"tm10010590"},{v:"0",msgId:"tm10010600"}]},{label:"産業医への確認",msgId:"tf10000990",apiKey:"OverseaCheckList4__c",domId:"SectForeignOverseaCheckList4",domType:"select",width:120,areaKey:"z1",pickList:[{v:"",n:""},{v:"0",msgId:"tf10002000"},{v:"1",
msgId:"tf10002010"}]},{label:"渡航準備金申請",msgId:"tf10001000",apiKey:"TravelAllowance__c",domId:"SectForeignTravelAllowance",domType:"currency",width:120,maxLen:17,areaKey:"z1"},{label:"責任者名",msgId:"tf10001010",apiKey:"OverseaOption2__c",domId:"SectForeignOverseaOption2",domType:"text",width:200,maxLen:80,areaKey:"z2"},{label:"ビザ申請",msgId:"tf10001020",apiKey:"OverseaCheckList2__c",domId:"SectForeignOverseaCheckList2",
domType:"select",width:120,areaKey:"z2",pickList:[{v:"",n:""},{v:"1",msgId:"tm10010590"},{v:"0",msgId:"tm10010600"}]},{label:"保険申請",msgId:"tf10001030",apiKey:"OverseaCheckList5__c",domId:"SectForeignOverseaCheckList5",domType:"select",width:120,areaKey:"z2",pickList:[{v:"",n:""},{v:"1",msgId:"tm10010590"},{v:"0",msgId:"tm10010600"}]}]},sectionProvisional:{discernment:"provisional",title:"tf10002200",
formCss:"ts-section-provisional",objectName:"AtkExpPreApply__c",fields:[{label:"_uniqKey",apiKey:"_uniqKey",domId:"SectProvisional_UNIQ",domType:"text",hidden:!0},{label:"仮払申請内容",msgId:"tf10001040",apiKey:"ProvisionalPaymentApplication__c",domId:"SectProvisionalPaymentApplication",domType:"textarea",width:320,maxLen:255,areaKey:"z1",required:1},{label:"仮払希望日",msgId:"tf10006130",apiKey:"ExpectedPayDate__c",
domId:"SectProvisionalPaymentExPayDate",domType:"date",width:108,maxLen:17,areaKey:"z1",name:"PaymentDate",browse:"cal"},{label:"仮払金額",msgId:"tf10001050",apiKey:"ProvisionalPaymentAmount__c",domId:"SectProvisionalPaymentAmount",domType:"currency",width:120,maxLen:17,areaKey:"z2",required:1}]},sectionTicket:{discernment:"ticket",title:"tf10002210",formCss:"ts-section-ticket",objectName:"AtkExpPreApply__c",virChild:!0,
virMax:5,fields:[{label:"_uniqKey",apiKey:"_uniqKey",domId:"SectTicket{0}_UNIQ",domType:"text",hidden:!0},{check:!0,domId:"SectTicket{0}Check_",domType:"checkbox",width:24},{label:"乗車日",msgId:"tf10000910",apiKey:"ticketDate",apiName:"Ticket{0}Date__c",domId:"SectTicket{0}Date",domType:"date",width:108,maxLen:17,required:1,name:"ticket{0}Date",browse:"cal"},{label:"区間",msgId:"tf10001060",apiKey:"ticketRoute",
apiName:"Ticket{0}Route__c",domId:"SectTicket{0}Route",domType:"text",width:200,maxLen:80,required:1},{label:"希望列車名/便名",msgId:"tf10001070",apiKey:"ticketRequest1",apiName:"Ticket{0}Request1st__c",domId:"SectTicket{0}Request1",domType:"text",width:124,maxLen:80,headSpan:3,placeholder:{msgId:"tf10002020"}},{label:"",apiKey:"ticketRequest2",apiName:"Ticket{0}Request2nd__c",domId:"SectTicket{0}Request2",domType:"text",
width:124,maxLen:80,headSpan:0,placeholder:{msgId:"tf10002030"}},{label:"",apiKey:"ticketRequest3",apiName:"Ticket{0}Request3rd__c",domId:"SectTicket{0}Request3",domType:"text",width:124,maxLen:80,headSpan:0,placeholder:{msgId:"tf10002040"}},{label:"希望席",msgId:"tf10001080",apiKey:"ticketSeat",apiName:"Ticket{0}Seat__c",domId:"SectTicket{0}Seat",domType:"text",width:180,maxLen:80},{label:"備考",msgId:"expNote_head",
apiKey:"ticketNote",apiName:"Ticket{0}Note__c",domId:"SectTicket{0}Note",domType:"text",width:"auto",maxLen:255}]},sectionEmp:{discernment:"emp",title:"empInfo_label",formCss:"ts-section-emp",objectName:"AtkEmp__c",readOnly:!0,fields:[{label:"_uniqKey",apiKey:"_uniqKey",domId:"Emp_UNIQ",domType:"text",hidden:!0},{label:"EmpId",apiKey:"Id",domId:"EmpId",domType:"text",hidden:!0},{label:"写真",msgId:"tf10001090",
apiKey:"UserId__r.SmallPhotoUrl",domId:"EmpPhoto",domType:"photo",width:80,areaKey:"z1"},{label:"社員名",msgId:"empName_label",apiKey:"Name",domId:"EmpName",domType:"text",width:200,areaKey:"z2"},{label:"部署",msgId:"dept_label",apiKey:"DeptId__r.Name",domId:"EmpDeptName",domType:"text",width:300,areaKey:"z2"}]},sectionExpHead:{discernment:"expHead",title:"",formCss:"ts-section-exp-head",objectName:"AtkExpPreApply__c",
readOnly:!0,fields:[{label:"_uniqKey",apiKey:"_uniqKey",domId:"Emp_UNIQ",domType:"text",hidden:!0},{label:"事前申請番号",msgId:"tf10001100",apiKey:"ExpPreApplyId__r.ExpPreApplyNo__c",domId:"ExpPreApplyNo",domType:"text",width:"auto",areaKey:"z1",link:!0},{label:"件名",msgId:"tk10004320",apiKey:"ExpPreApplyId__r.Title__c",domId:"ExpPreApplyTitle",domType:"text",width:"auto",areaKey:"z2",link:!0},{label:"種別",
msgId:"tk10000262",apiKey:"ExpPreApplyId__r.Type__c",domId:"ExpPreApplyType",domType:"select",width:"auto",areaKey:"z3",pickList:[{v:"",n:""},{v:"出張・交通費",msgId:"tf10001410"},{v:"会議・交際費",msgId:"tf10000600"},{v:"一般経費",msgId:"tf10001420"},{v:"仮払申請",msgId:"tf10006120"}]},{label:"合計金額",msgId:"tf10001110",apiKey:"ExpPreApplyId__r.TotalAmount__c",domId:"ExpPreApplyTotalAmount",domType:"currency",width:120,areaKey:"z2"},{
label:"仮払金額",msgId:"tf10000530",apiKey:"ExpPreApplyId__r.ProvisionalPaymentAmount__c",domId:"ExpPreApplyProvisionalPaymentAmount",domType:"currency",width:120,areaKey:"z3"}]},sectionExpHeadJtb:{discernment:"expHeadJtb",title:"",formCss:"ts-section-exp-head",objectName:"AtkExpPreApply__c",readOnly:!0,fields:[{label:"_uniqKey",apiKey:"_uniqKey",domId:"Emp_UNIQ",domType:"text",hidden:!0},{label:"事前申請番号",
msgId:"tf10001100",apiKey:"ExpPreApplyId__r.ExpPreApplyNo__c",domId:"ExpPreApplyNo",domType:"text",width:"auto",areaKey:"z1",link:!0},{label:"件名",msgId:"tk10004320",apiKey:"ExpPreApplyId__r.Title__c",domId:"ExpPreApplyTitle",domType:"text",width:"auto",areaKey:"z2",link:!0},{label:"種別",msgId:"tk10000262",apiKey:"ExpPreApplyId__r.Type__c",domId:"ExpPreApplyType",domType:"select",width:"auto",areaKey:"z3",pickList:[{
v:"",n:""},{v:"出張・交通費",msgId:"tf10001410"},{v:"会議・交際費",msgId:"tf10000600"},{v:"一般経費",msgId:"tf10001420"},{v:"仮払申請",msgId:"tf10006120"}]},{label:"合計金額",msgId:"tf10001110",apiKey:"ExpPreApplyId__r.TotalAmount__c",domId:"ExpPreApplyTotalAmount",domType:"currency",width:120,areaKey:"z1"},{label:"仮払金額",msgId:"tf10000530",apiKey:"ExpPreApplyId__r.ProvisionalPaymentAmount__c",domId:"ExpPreApplyProvisionalPaymentAmount",
domType:"currency",width:120,areaKey:"z2"},{label:"内 手配予定金額",msgId:"jt13000080",apiKey:"ExpPreApplyId__r.PlannedAmount__c",domId:"JsNaviPlannedAmount",domType:"currency",width:120,areaKey:"z3"},{label:"手配実績金額",msgId:"jt13000090",apiKey:"_jsNaviActualAmount",domId:"JsNaviActualAmount",domType:"currency",width:120,areaKey:"z3"}]},sectionExpRingi:{discernment:"expRingi",title:"tk10004350",formCss:"ts-section-exp-ringi",
objectName:"AtkExpApply__c",dock:"tail",readOnly:!0,fields:[{label:"_uniqKey",apiKey:"_uniqKey",domId:"Apply_UNIQ",domType:"text",hidden:!0},{label:"申請No",msgId:"tk10004310",apiKey:"ApplyId__r.ApplicationNo__c",domId:"ApplyApplicationNo",domType:"text",width:"auto",lw:80,areaKey:"z1",link:!0},{label:"種別",msgId:"tk10000262",apiKey:"ApplyId__r.Type__c",domId:"ApplyType",domType:"text",width:"auto",lw:80,areaKey:"z2"},{
label:"件名",msgId:"tk10004320",apiKey:"ApplyId__r.Name",domId:"ApplyName",domType:"text",width:"auto",lw:80,areaKey:"z1",link:!0}]},sectionExpAttach:{discernment:"expAttach",title:"tk10000077",formCss:"ts-section-exp-attach",objectName:"AtkExpApply__c",dock:"tail",readOnly:!0,fields:[{label:"_uniqKey",apiKey:"_uniqKey",domId:"Apply_UNIQ",domType:"text",hidden:!0}]},sectionExpComment:{discernment:"expComment",title:"",
formCss:"ts-section-exp-comment",objectName:"AtkExpApply__c",readOnly:!0,fields:[{label:"_uniqKey",apiKey:"_uniqKey",domId:"Emp_UNIQ",domType:"text",hidden:!0},{label:"コメント",msgId:"comment_head",apiKey:"Comment__c",domId:"ExpApplyComment",domType:"text",width:"700px",maxLen:32e3,areaKey:"z1"}]},sectionExpAssist:{discernment:"expAssist",title:"tk10004350",formCss:"ts-section-exp-assist",objectName:"AtkExpApply__c",
fields:[{label:"_uniqKey",apiKey:"_uniqKey",domId:"Assist_UNIQ",domType:"text",hidden:!0},{label:"件名",msgId:"tk10004320",apiKey:"Title__c",domId:"AssistTitle",domType:"text",width:400,areaKey:"z0"},{label:"精算区分",msgId:"tf10006080",apiKey:"ExpenseType__c",domId:"AssistExpenseType",domType:"select",width:200,required:1},{label:"精算方法",msgId:"tf10006090",apiKey:"PayExpItemId__c",domId:"AssistPayExpItemId",
domType:"select",width:200,required:1,dispField:{apiKey:"PayExpItemId__r.Name"}},{label:"処理日",msgId:"tf10006100",apiKey:"ApplyDate__c",domId:"AssistApplyDate",domType:"date",width:108,name:"ApplyDate",browse:"cal"},{label:"支払予定日",msgId:"tf10006110",apiKey:"ExpectedPayDate__c",domId:"AssistExPayDate",domType:"date",width:108,name:"PayDate",browse:"cal"},{label:"仮払申請",msgId:"tf10006120",
apiKey:"ProvisionalPaymentId__c",domId:"AssistProvisionalPaymentId",domType:"select",width:200,browse:"find",dispField:{apiKey:"ProvisionalPaymentId__r.Title__c"}},{label:"負担部署",msgId:"tf10006000",apiKey:"ChargeDeptId__c",domId:"AssistChargeDeptId",domType:"select",width:200,browse:"find",dispField:{apiKey:"ChargeDeptId__r.Name",codeKey:"ChargeDeptId__r.DeptCode__c"}},{label:"ジョブ",msgId:"job_label",
apiKey:"ChargeJobId__c",domId:"AssistChargeJobId",domType:"select",width:200,browse:"find",dispField:{apiKey:"ChargeJobId__r.Name",codeKey:"ChargeJobId__r.JobCode__c"}},{label:"",apiKey:"ExtraItem1__c",domId:"AssistExtraItem1",domType:"text",width:150,maxLen:255},{label:"",apiKey:"ExtraItem2__c",domId:"AssistExtraItem2",domType:"text",width:150,maxLen:255}]},sectionExpFilter:{discernment:"expFilter",
title:"ci00000200",formCss:"ts-section-exp-filter",fields:[{label:"_uniqKey",apiKey:"_uniqKey",domId:"Filter_UNIQ",domType:"text",hidden:!0},{label:"精算区分",msgId:"tf10006080",apiKey:"ExpenseType__c",domId:"FilterExpenseType",domType:"select",width:200,defaultIsTop:!0}]},searchExpPreApply:{title:["tf10002070","tf10002220"],formCss:"ts-dialog-search-expPreApply",type:"searchCondition",fields:[{label:"申請番号",
msgId:"expApplyNo_label",apiKey:"ExpPreApplyNo__c",domId:"SearchExpPreApplyNo",domType:"text",width:300,matchType:2},{label:"社員名",msgId:"empName_label",apiKey:"EmpId__r.Name",domId:"SearchExpPreEmpName",domType:"text",width:300,matchType:3},{label:"申請日付範囲",msgId:"tf10000680",apiKey:"ApplyTime__c",domId:"SearchExpPreApplyTime",domType:"dateRange",width:108,name:"searchApplyTime",dataType:"dateTime"},{label:"件名",
msgId:"tk10004320",apiKey:"Title__c",domId:"SearchExpPreTitle",domType:"text",width:300,matchType:3},{label:"種別",msgId:"tk10000262",apiKey:"Type__c",domId:"SearchExpPreType",domType:"select",width:280,pickList:[{v:"",n:""},{v:"出張・交通費",msgId:"tf10001410"},{v:"会議・交際費",msgId:"tf10000600"},{v:"一般経費",msgId:"tf10001420"},{v:"仮払申請",msgId:"tf10006120"}]},{label:"利用日付範囲",msgId:"tf10000700",apiKey:"_startEnd",
domId:"SearchExpPreDate",domType:"dateRange",width:108,name:"searchDate",colNames:["StartDate__c","EndDate__c"]},{label:"事前申請状態",msgId:"tf10001120",apiKey:"StatusD__c",domId:"SearchExpPreStatus",domType:"select",width:280,subType:"status",pickList:[{v:"",n:""},{v:"精算済み以外",msgId:"tf10001950"},{v:"精算済み",msgId:"reimbursement_label"},{v:"承認済み",msgId:"tm10003480"},{v:"承認待ち",msgId:"waitApproval_label"},{v:"申請取消",
msgId:"tm10003500"},{v:"却下",msgId:"tm10003490"},{v:"未申請",msgId:"tm10003560"}]},{label:"精算申請状態",msgId:"tf10001130",apiKey:"_childStatus",domId:"SearchExpPreExpApplyStatus",domType:"select",width:280,subType:"status",pickList:[{v:"",n:""},{v:"精算済み以外",msgId:"tf10001950"},{v:"精算済み",msgId:"reimbursement_label"},{v:"承認済み",msgId:"tm10003480"},{v:"承認待ち",msgId:"waitApproval_label"},{v:"申請取消",msgId:"tm10003500"},{v:"却下",
msgId:"tm10003490"},{v:"未申請",msgId:"tm10003560"}]},{label:"金額範囲",msgId:"tf10000740",apiKey:"TotalAmount__c",domId:"SearchExpPreTotalAmount",domType:"currencyRange",width:120},{label:"仮払金額範囲",msgId:"tf10000710",apiKey:"ProvisionalPaymentAmount__c",domId:"SearchExpPreProvisionalPaymentAmount",domType:"currencyRange",width:120}]},searchExpApply:{title:["tf10002070","empExp_caption"],formCss:"ts-dialog-search-expApply",
type:"searchCondition",fields:[{label:"精算申請番号",msgId:"tf10000550",apiKey:"ExpApplyNo__c",domId:"SearchExpApplyNo",domType:"text",width:300,matchType:2},{label:"申請日付範囲",msgId:"tf10000680",apiKey:"ApplyTime__c",domId:"SearchExpApplyTime",domType:"dateRange",width:108,name:"searchApplyTime",dataType:"dateTime"},{label:"利用日付範囲",msgId:"tf10000700",apiKey:"_startEnd",domId:"SearchExpDate",domType:"dateRange",width:108,
name:"searchDate",colNames:["StartDate__c","EndDate__c"]},{label:"事前申請番号",msgId:"tf10001100",apiKey:"ExpPreApplyId__r.ExpPreApplyNo__c",domId:"SearchExpPreApplyNo",domType:"text",width:300,matchType:2},{label:"件名",msgId:"tk10004320",apiKey:"TitleD__c",domId:"SearchTitle",domType:"text",width:300,matchType:3},{label:"種別",msgId:"tk10000262",apiKey:"TypeD__c",domId:"SearchExpPreType",domType:"select",width:280,
pickList:[{v:"",n:""},{v:"出張・交通費",msgId:"tf10001410"},{v:"会議・交際費",msgId:"tf10000600"},{v:"一般経費",msgId:"tf10001420"},{v:"仮払申請",msgId:"tf10006120"}]},{label:"精算申請状態",msgId:"tf10001130",apiKey:"StatusD__c",domId:"SearchExpStatus",domType:"select",width:280,subType:"status",pickList:[{v:"",n:""},{v:"精算済み以外",msgId:"tf10001950"},{v:"精算済み",msgId:"reimbursement_label"},{v:"承認済み",msgId:"tm10003480"},{v:"承認待ち",
msgId:"waitApproval_label"},{v:"申請取消",msgId:"tm10003500"},{v:"却下",msgId:"tm10003490"},{v:"未申請",msgId:"tm10003560"}]},{label:"金額範囲",msgId:"tf10000740",apiKey:"TotalCost__c",domId:"SearchExpTotalCost",domType:"currencyRange",width:120},{label:"仮払金額範囲",msgId:"tf10000710",apiKey:"ProvisionalPaymentAmount__c",domId:"SearchExpProvisionalPaymentAmount",domType:"currencyRange",width:120}]},dialogDetail:{fields:[{label:"ID",
apiKey:"Id",domId:"DlgDetailId",domType:"text",hidden:!0},{label:"支払先ID",apiKey:"PayeeId__c",domId:"DlgDetailPayeeId",domType:"text",hidden:!0},{label:"支払種別",apiKey:"PayeeId__r.PayeeType__c",domId:"DlgDetailPayeeType",domType:"text",hidden:!0},{label:"支払先精算区分",apiKey:"PayeeId__r.ExpenseType__c",domId:"DlgDetailPayExpenseType",domType:"text",hidden:!0},{label:"消費税",apiKey:"TaxRate__c",domId:"DlgDetailTaxRate",
domType:"text",hidden:!0},{label:"利用日",msgId:"tf10000940",apiKey:"Date__c",domId:"DlgDetailDate",domType:"date",width:108,maxLen:12,name:"dlgDetailDate",browse:"cal",required:1},{label:"費目",msgId:"expItem_head",apiKey:"ExpItemId__c",domId:"DlgDetailExpItem",domType:"select",width:350,required:1,browse:"find",dispField:{apiKey:"ExpItemId__r.Name"}},{label:"経路",msgId:"route_head",apiKey:"_route",
domId:"DlgDetail_Route",domType:"route",width:350,required:1},{label:"単価",msgId:"tm20004720",apiKey:"UnitPrice__c",domId:"DlgDetailUnitPrice",domType:"currency",width:120,maxLen:17,required:1},{label:"数量",msgId:"tm20004730",apiKey:"Quantity__c",domId:"DlgDetailQuantity",domType:"number",width:80,maxLen:13,required:1,suffix:{apiKey:"ExpItemId__r.UnitName__c"}},{label:"金額",msgId:"expCost_head",apiKey:"Cost__c",
domId:"DlgDetailCost",domType:"currency",width:120,maxLen:17,required:1},{label:"消費税",msgId:"tax_label",apiKey:"_tax",domId:"DlgDetail_Tax",domType:"tax",width:350,required:1},{label:"外貨",msgId:"tf10001140",apiKey:"_foreign",domId:"DlgDetail_Foreign",domType:"foreign",width:350,required:1},{label:"発行者（店名）",msgId:"expPublisher_head",apiKey:"Publisher__c",domId:"DlgDetailPublisher",domType:"text",width:370,maxLen:255,
required:1},{label:"ジョブ",msgId:"job_label",apiKey:"JobId__c",domId:"DlgDetailJob",domType:"select",width:350,required:1,browse:"find",dispField:{apiKey:"JobId__r.Name",codeKey:"JobId__r.JobCode__c"}},{label:"支払種別",msgId:"tf10001150",apiKey:"_payment",domId:"DlgDetail_Payment",domType:"payment",width:200,required:1},{label:"支払先名",msgId:"tf10001160",apiKey:"PayeeId__r.Name",domId:"DlgDetailPayeeName",domType:"text",
width:350,maxLen:80,browse:"find",selectIn:1,required:1},{label:"支払日",msgId:"tf10000590",apiKey:"PaymentDate__c",domId:"DlgDetailPaymentDate",domType:"date",width:108,maxLen:12,name:"dlgDetailPaymentDate",browse:"cal"},{label:"請求書URL",msgId:"ex00001241",apiKey:"InvoiceURL__c",domId:"DlgDetailInvoiceURL",domType:"text",width:370,maxLen:2e3},{label:"負担部署",msgId:"tf10006000",apiKey:"ChargeDeptId__c",
domId:"DlgDetailChargeDept",domType:"select",width:350,required:1,browse:"find",dispField:{apiKey:"ChargeDeptId__r.Name",codeKey:"ChargeDeptId__r.DeptCode__c"}},{label:"社内参加者人数",msgId:"tf10000860",apiKey:"InternalParticipantsNumber__c",domId:"DlgDetailIntParticNumber",domType:"number",width:80,maxLen:3,required:1},{label:"社内参加者",msgId:"tm20004741",apiKey:"InternalParticipants__c",domId:"DlgDetailIntPartic",
domType:"textarea",width:370,maxLen:1e3},{label:"社外参加者人数",msgId:"tf10000870",apiKey:"ExternalParticipantsNumber__c",domId:"DlgDetailExtParticNumber",domType:"number",width:80,maxLen:3,required:1},{label:"社外参加者",msgId:"tm20004742",apiKey:"ExternalParticipants__c",domId:"DlgDetailExtPartic",domType:"textarea",width:370,maxLen:1e3},{label:"店舗名",msgId:"tf10011010",apiKey:"PlaceName__c",domId:"DlgDetailPlaceName",
domType:"text",width:370,maxLen:80},{label:"店舗所在地",msgId:"tf10011020",apiKey:"PlaceAddress__c",domId:"DlgDetailPlaceAddress",domType:"textarea",width:370,maxLen:255},{label:"人数割（税抜）",msgId:"tf10011020",apiKey:"AmountPerParticipant__c",domId:"DlgDetailAmountPerParticipant",domType:"currency",hidden:!0},{label:"拡張項目1",msgId:"tk10000715",apiKey:"ExtraItem1__c",domId:"DlgDetailExtraItem1",domType:"text",width:350,
maxLen:255},{label:"拡張項目2",msgId:"tk10000721",apiKey:"ExtraItem2__c",domId:"DlgDetailExtraItem2",domType:"text",width:350,maxLen:255},{label:"備考",msgId:"expNote_head",apiKey:"Detail__c",domId:"DlgDetailDetail",domType:"textarea",width:370,maxLen:255}]},dialogExpImport:{fields:[{label:"社員ID",apiKey:"EmpId__c",domId:"DlgExpImportEmpId",domType:"text",hidden:!0,fix:"EmpId__c"},{label:"ジョブコード",
apiKey:"JobId__r.JobCode__c",domId:"DlgExpImportJobCode",domType:"text",hidden:!0},{label:"有効開始日",apiKey:"JobId__r.StartDate__c",domId:"DlgExpImportJobStartDate",domType:"date",hidden:!0},{label:"有効終了日",apiKey:"JobId__r.EndDate__c",domId:"DlgExpImportJobEndDate",domType:"date",hidden:!0},{label:"ジョブ有効",apiKey:"JobId__r.Active__c",domId:"DlgExpImportJobActive",domType:"checkbox",hidden:!0},{label:"負担部署コード",
apiKey:"ChargeDeptId__r.DeptCode__c",domId:"DlgExpImportChargeDeptCode",domType:"text",hidden:!0},{label:"負担部署名",apiKey:"ChargeDeptId__r.Name",domId:"DlgExpImportChargeDeptName",domType:"text",hidden:!0},{label:"費目",msgId:"expItem_head",apiKey:"ExpItemId__c",domId:"DlgExpImportItem",domType:"select",width:350,browse:"find",dispField:{apiKey:"ExpItemId__r.Name"},required:1},{label:"ジョブ",msgId:"job_label",
apiKey:"JobId__c",domId:"DlgExpImportJob",domType:"select",width:350,required:1,browse:"find",dispField:{apiKey:"JobId__r.Name",codeKey:"JobId__r.JobCode__c"}},{label:"負担部署",msgId:"tf10006000",apiKey:"ChargeDeptId__c",domId:"DlgExpImportChargeDept",domType:"select",width:350,required:1,browse:"find",dispField:{apiKey:"ChargeDeptId__r.Name",codeKey:"ChargeDeptId__r.DeptCode__c"}},{label:"社内参加者人数",msgId:"tf10000860",
apiKey:"InternalParticipantsNumber__c",domId:"DlgDetailIntParticNumber",domType:"number",width:80,maxLen:3,required:1},{label:"社内参加者",msgId:"tm20004741",apiKey:"InternalParticipants__c",domId:"DlgDetailIntPartic",domType:"textarea",width:370,maxLen:1e3},{label:"社外参加者人数",msgId:"tf10000870",apiKey:"ExternalParticipantsNumber__c",domId:"DlgDetailExtParticNumber",domType:"number",width:80,maxLen:3,required:1},{
label:"社外参加者",msgId:"tm20004742",apiKey:"ExternalParticipants__c",domId:"DlgDetailExtPartic",domType:"textarea",width:370,maxLen:1e3},{label:"店舗名",msgId:"tf10011010",apiKey:"PlaceName__c",domId:"DlgDetailPlaceName",domType:"text",width:370,maxLen:80},{label:"店舗所在地",msgId:"tf10011020",apiKey:"PlaceAddress__c",domId:"DlgDetailPlaceAddress",domType:"textarea",width:370,maxLen:255},{label:"拡張項目1",msgId:"tk10000715",
apiKey:"ExtraItem1__c",domId:"DlgExpImportExtraItem1",domType:"text",width:350,maxLen:255},{label:"拡張項目2",msgId:"tk10000721",apiKey:"ExtraItem2__c",domId:"DlgExpImportExtraItem2",domType:"text",width:350,maxLen:255},{label:"備考",msgId:"expNote_head",apiKey:"Detail__c",domId:"DlgExpImportDetail",domType:"textarea",width:370,maxLen:255}]},dialogJsNaviImport:{fields:[{label:"社員ID",apiKey:"EmpId__c",
domId:"DlgJsNaviImportEmpId",domType:"text",hidden:!0,fix:"EmpId__c"},{label:"ジョブコード",apiKey:"JobId__r.JobCode__c",domId:"DlgJsNaviImportJobCode",domType:"text",hidden:!0},{label:"有効開始日",apiKey:"JobId__r.StartDate__c",domId:"DlgJsNaviImportJobStartDate",domType:"date",hidden:!0},{label:"有効終了日",apiKey:"JobId__r.EndDate__c",domId:"DlgJsNaviImportJobEndDate",domType:"date",hidden:!0},{label:"ジョブ有効",
apiKey:"JobId__r.Active__c",domId:"DlgJsNaviImportJobActive",domType:"checkbox",hidden:!0},{label:"負担部署コード",apiKey:"ChargeDeptId__r.DeptCode__c",domId:"DlgJsNaviImportChargeDeptCode",domType:"text",hidden:!0},{label:"負担部署名",apiKey:"ChargeDeptId__r.Name",domId:"DlgJsNaviImportChargeDeptName",domType:"text",hidden:!0},{label:"費目",msgId:"expItem_head",apiKey:"ExpItemId__c",domId:"DlgJsNaviImportItem",domType:"select",
width:350,browse:"find",dispField:{apiKey:"ExpItemId__r.Name"},required:1},{label:"ジョブ",msgId:"job_label",apiKey:"JobId__c",domId:"DlgJsNaviImportJob",domType:"select",width:350,required:1,browse:"find",dispField:{apiKey:"JobId__r.Name",codeKey:"JobId__r.JobCode__c"}},{label:"負担部署",msgId:"tf10006000",apiKey:"ChargeDeptId__c",domId:"DlgJsNaviImportChargeDept",domType:"select",width:350,required:1,browse:"find",
dispField:{apiKey:"ChargeDeptId__r.Name",codeKey:"ChargeDeptId__r.DeptCode__c"}},{label:"拡張項目1",msgId:"tk10000715",apiKey:"ExtraItem1__c",domId:"DlgJsNaviImportExtraItem1",domType:"text",width:350,maxLen:255},{label:"拡張項目2",msgId:"tk10000721",apiKey:"ExtraItem2__c",domId:"DlgJsNaviImportExtraItem2",domType:"text",width:350,maxLen:255},{label:"備考",msgId:"expNote_head",apiKey:"Detail__c",domId:"DlgJsNaviImportDetail",
domType:"textarea",width:370,maxLen:255}]},dialogEkitanSetting:{fields:[{label:"社員ID",apiKey:"EmpId__c",domId:"DlgExpImportEmpId",domType:"text",hidden:!0,fix:"EmpId__c"},{label:"登録定期区間コード",apiKey:"commuterRouteCode",domId:"DlgEkitanRouteCode",domType:"text",hidden:!0},{label:"経由駅で乗り換え",apiKey:"commuterRouteTransfer",domId:"DlgEkitanRouteTransfer",domType:"checkbox",hidden:!0},{label:"地域",msgId:"area_label",
apiKey:"ekitanArea",domId:"DlgEkitanArea",domType:"select",width:"auto",pickList:[{v:"-1",msgId:"tm20007010"},{v:"0",msgId:"tm20007020"},{v:"1",msgId:"tm20007030"},{v:"2",msgId:"tm20007040"},{v:"3",msgId:"tm20007050"},{v:"4",msgId:"tm20007060"},{v:"5",msgId:"tm20007070"},{v:"6",msgId:"tm20007080"},{v:"7",msgId:"tm20007090"},{v:"8",msgId:"tm20007100"},{v:"9",msgId:"tm20007110"}]},{label:"特急/新幹線",
msgId:"paidExpress_label",apiKey:"usePaidExpress",domId:"DlgEkitanExpress",domType:"radio",name:"usePaidExpress",pickList:[{v:"1",msgId:"tk10000404"},{v:"0",msgId:"tk10000405"}]},{label:"特急料金",msgId:"reservedSheet_label",apiKey:"useReservedSheet",domId:"DlgEkitanSheet",domType:"radio",name:"useReservedSheet",pickList:[{v:"0",msgId:"tk10000406"},{v:"1",msgId:"tk10000407"}]},{label:"優先する航空会社",
msgId:"preferredAirLine_label",apiKey:"preferredAirLine",domId:"DlgEkitanAirLine",domType:"radio",name:"preferredAirLine",pickList:[{v:"0",msgId:"tm10010150"},{v:"1",msgId:"tf10000240"},{v:"2",msgId:"tf10000241"},{v:"4",msgId:"tf10000242"}]},{label:"検索結果のソート",msgId:"routePreference_label",apiKey:"routePreference",domId:"DlgEkitanPreference",domType:"select",width:"auto",pickList:[{v:"0",msgId:"routeSortTime_label"},{
v:"1",msgId:"routeSortCost_label"},{v:"2",msgId:"routeSortChange_label"},{v:"3",msgId:"routeSortCommuter_label"}]},{label:"定期区間の取扱",msgId:"excludeCommuter_label",apiKey:"excludeCommuterRoute",domId:"DlgEkitanExclude",domType:"radio",name:"excludeCommuterRoute",pickList:[{v:"0",msgId:"tk10000408"},{v:"1",msgId:"tk10000409"}]},{label:"登録定期区間",msgId:"commuterRoute_label",apiKey:"commuterRouteNote",
domId:"DlgEkitanRouteNote",domType:"text",width:200,ro:!0},{label:"経路",msgId:"route_head",apiKey:"commuterRouteRoute",domId:"DlgEkitanRouteRoute",domType:"text",width:400,ro:!0}]},payOption:{fields:[{label:"精算方法",msgId:"tk10000781",apiKey:"expItemId",domId:"PayOptionExpItem",domType:"select",width:300,required:1,dispField:{apiKey:"ExpItemId__r.Name"}},{label:"精算日",msgId:"payDate_label",apiKey:"payDate",
domId:"PayOptionPayDate",domType:"date",width:108,required:1,maxLen:12,name:"payDate",browse:"cal"},{label:"備考(精算時)",msgId:"tf10000720",apiKey:"payMethod",domId:"PayOptionPayMethod",domType:"textarea",width:300,maxLen:80},{label:"全銀データ出力",msgId:"tk10000779",apiKey:"zgDataCheck",domId:"PayOptionZgDataCheck",domType:"checkbox",width:32},{label:"振込元",msgId:"tk10000786",apiKey:"sourceAccountId",
domId:"PayOptionZgAccount",domType:"select",width:300,required:1,dispField:{apiKey:"Name"}},{label:"仕訳データCSV出力",msgId:"tf10010810",apiKey:"outputJournal",domId:"PayOptionOutputJournal",domType:"checkbox",width:32}]},cardStatement:{discernment:"cardStatement",objectName:"AtkCardStatementLine__c",type:"table",title:"tf10001500",formCss:"ts-dialog-card-state",rowLimit:50,fields:[{label:"ID",apiKey:"Id",
domId:"CardState{0}Id",domType:"text",hidden:!0},{label:"名称",apiKey:"Name",domId:"CardState{0}Name",domType:"text",hidden:!0},{label:"レコードタイプ名",apiKey:"RecordType.Name",domId:"CardState{0}RecordType",domType:"text",hidden:!0},{label:"支払種別",apiKey:"PayeeId__r.PayeeType__c",domId:"CardState{0}PayeeType",domType:"text",hidden:!0},{label:"精算区分",apiKey:"PayeeId__r.ExpenseType__c",domId:"CardState{0}ExpenseType",
domType:"text",hidden:!0},{check:!0,domId:"CardState{0}_Check",domType:"checkbox",width:24},{label:"利用日付",msgId:"tf10000670",apiKey:"Date__c",domId:"CardState{0}Date",domType:"date",width:90,sortable:!0},{label:"摘要",msgId:"tk10000097",apiKey:"Note__c",domId:"CardState{0}Note",domType:"text",width:120,sortable:!0},{label:"金額",msgId:"expCost_head",apiKey:"Amount__c",domId:"CardState{0}Amount",domType:"currency",
width:90,sortable:!0},{label:"発行者（店名）",msgId:"expPublisher_head",apiKey:"Publisher__c",domId:"CardState{0}Publisher",domType:"text",width:120,sortable:!0},{label:"支払先名",msgId:"tf10001160",apiKey:"PayeeId__r.Name",domId:"CardState{0}PayeeName",domType:"text",width:100,sortable:!0},{label:"支払日",msgId:"tf10000590",apiKey:"PaymentDate__c",domId:"CardState{0}PaymentDate",domType:"date",width:90,sortable:!0},{label:"通貨名",
msgId:"currency_label",apiKey:"FCName__c",domId:"CardState{0}FCName",domType:"text",width:60,sortable:!0},{label:"外貨金額",msgId:"tf10001170",apiKey:"FCAmount__c",domId:"CardState{0}FCAmount",domType:"currency",width:120,decimal:"6,2",sortable:!0},{label:"レート",msgId:"tf10001180",apiKey:"FCRate__c",domId:"CardState{0}FCRate",domType:"currency",width:100,decimal:"6,2",sortable:!0},{label:"レート適用日",msgId:"tf10001190",
apiKey:"FCDate__c",domId:"CardState{0}FCDate",domType:"date",width:90,sortable:!0},{label:"処理日付",msgId:"tf10001200",apiKey:"ProcessDate__c",domId:"CardState{0}ProcessDate",domType:"date",width:90,sortable:!0}],searchFields:[{label:"支払日",msgId:"tf10000590",apiKey:"PaymentDate__c",domId:"CardStateDate",domType:"dateFrom",width:108,name:"paymentDate",lw:"auto",wr:!0}],filts:[{filtVal:"EmpId__c = '{0}'",filtKey:"empId",
fix:!0},{filtVal:"RecordType.Name in ('カード明細', null)",filtKey:"recordType",fix:!0},{filtVal:"Removed__c = false",filtKey:"removed",fix:!0}],sortKeys:[{apiKey:"Date__c",desc:!0},{apiKey:"PaymentDate__c",desc:!0},{apiKey:"Id",desc:!0}],children:{EmpExp__r:{fields:[{apiKey:"Id"}]}},buttons:[{key:"expImport",labelId:"tf10002260"},{key:"close",labelId:"cancel_btn_title"}]},receipts:{discernment:"receipts",
objectName:"AtkCardStatementLine__c",type:"table",title:"tf10004950",formCss:"ts-dialog-receipts",rowLimit:50,fields:[{label:"ID",apiKey:"Id",domId:"Receipt{0}Id",domType:"text",hidden:!0},{label:"名称",apiKey:"Name",domId:"Receipt{0}Name",domType:"text",hidden:!0},{label:"レコードタイプ名",apiKey:"RecordType.Name",domId:"Receipt{0}RecordType",domType:"text",hidden:!0},{label:"リクエストID",apiKey:"ForeignId__c",
domId:"Receipt{0}ForeignId",domType:"text",hidden:!0},{label:"ステータス",apiKey:"Status__c",domId:"Receipt{0}Status",domType:"text",hidden:!0},{label:"削除フラグ",apiKey:"Removed__c",domId:"Receipt{0}Removed",domType:"checkbox",hidden:!0},{check:!0,domId:"Receipt{0}_Check",domType:"checkbox",width:24},{label:"利用日付",msgId:"tf10000670",apiKey:"Date__c",domId:"Receipt{0}Date",domType:"date",width:90,sortable:!0},{
label:"発行者（店名）",msgId:"tf10004960",apiKey:"Publisher__c",domId:"Receipt{0}Publisher",domType:"text",width:180,sortable:!0},{label:"摘要",msgId:"tk10000097",apiKey:"Note__c",domId:"Receipt{0}Note",domType:"text",width:160,sortable:!0},{label:"金額",msgId:"expCost_head",apiKey:"Amount__c",domId:"Receipt{0}Amount",domType:"currency",width:90,sortable:!0},{label:"添付",msgId:"tf10005020",apiKey:"Attachments",
domId:"Receipt{0}Attachments",domType:"children",width:50},{label:"連絡欄",msgId:"tf10004970",apiKey:"Message__c",domId:"Receipt{0}Message",domType:"text",width:180,sortable:!0,headCss:"head-caution"},{label:"領収書画像の縦幅",apiKey:"ImageHeight__c",domId:"Receipt{0}ImageHeight",domType:"text",hidden:!0},{label:"領収書画像の横幅",apiKey:"ImageWidth__c",domId:"Receipt{0}ImageWidth",domType:"text",hidden:!0},{label:"領収書画像の階調",
apiKey:"BitsPerSample__c",domId:"Receipt{0}BitsPerSample",domType:"text",hidden:!0},{label:"領収書画像の色情報",apiKey:"ColorType__c",domId:"Receipt{0}ColorType",domType:"text",hidden:!0}],searchFields:[{label:"ステータス",msgId:"status_btn_title",apiKey:"Status__c",domId:"ReceiptStatus",domType:"select",width:"auto",lw:"auto",wr:!0,noNL:!0,pickList:[{v:"2",msgId:"tf10004990"},{v:"0",msgId:"tf10005000"},{v:"9",msgId:"tf10005010"}]
}],filts:[{filtVal:"EmpId__c = '{0}'",filtKey:"empId",fix:!0},{filtVal:"RecordType.Name = '領収書'",filtKey:"recordType",fix:!0},{filtVal:"Removed__c = false",filtKey:"removed",fix:!0}],sortKeys:[{apiKey:"Date__c",desc:!0},{apiKey:"Id",desc:!0}],children:{EmpExp__r:{fields:[{apiKey:"Id"}]},Attachments:{fields:[{apiKey:"Id"}]}}},actualExpense:{discernment:"actualExpense",objectName:"AtkJsNaviActual__c",type:"table",
title:"jt13000010",formCss:"ts-dialog-jtb",rowLimit:100,fields:[{label:"ID",apiKey:"Id",domId:"Jtb{0}Id",domType:"text",hidden:!0},{label:"名称",apiKey:"Name",domId:"Jtb{0}Name",domType:"text",hidden:!0},{label:"支払先ID",apiKey:"PayeeId__c",domId:"Jtb{0}PayeeId",domType:"text",hidden:!0},{label:"支払種別",apiKey:"PayeeId__r.PayeeType__c",domId:"Jtb{0}PayeeType",domType:"text",hidden:!0},{label:"支払先名",
apiKey:"PayeeId__r.Name",domId:"Jtb{0}PayeeName",domType:"text",hidden:!0},{label:"支払先精算区分",apiKey:"PayeeId__r.ExpenseType__c",domId:"Jtb{0}PayeeExpenseType",domType:"text",hidden:!0},{label:"ユーザーID",apiKey:"JsNaviId__c",domId:"Jtb{0}UserId",domType:"text",hidden:!0},{label:"処理番号",apiKey:"OperationNo__c",domId:"Jtb{0}OperationNo",domType:"text",hidden:!0},{label:"副番号",apiKey:"SubNo__c",domId:"Jtb{0}SubNo",
domType:"text",hidden:!0},{label:"出張手配SeqNo",apiKey:"SeqNo__c",domId:"Jtb{0}SeqNo",domType:"text",hidden:!0},{label:"旅行番号",apiKey:"TravelNo__c",domId:"Jtb{0}TravelNo",domType:"text",hidden:!0},{label:"枝番",apiKey:"BranchNo__c",domId:"Jtb{0}BranchNo",domType:"text",hidden:!0},{label:"発注機能コード",apiKey:"FunctionCode__c",domId:"Jtb{0}FunctionCode",domType:"text",hidden:!0},{label:"システム区分",apiKey:"SystemType__c",
domId:"Jtb{0}SystemType",domType:"text",hidden:!0},{label:"サービス名称",apiKey:"Data01__c",domId:"Jtb{0}ServiceName",domType:"text",hidden:!0},{label:"出発地",apiKey:"Data03__c",domId:"Jtb{0}StartName",domType:"text",hidden:!0},{label:"到着地",apiKey:"Data04__c",domId:"Jtb{0}EndName",domType:"text",hidden:!0},{label:"ステータス",apiKey:"Data11__c",domId:"Jtb{0}Status",domType:"text",hidden:!0},{label:"削除フラグ",apiKey:"Removed__c",
domId:"Jtb{0}Removed",domType:"checkbox",hidden:!0},{check:!0,domId:"Jtb{0}_Check",domType:"checkbox",width:24},{label:"出発日",msgId:"jt13000150",apiKey:"StartDate__c",domId:"Jtb{0}Date",domType:"date",width:90,sortable:!0},{label:"内容",msgId:"tf10000850",apiKey:"PayContent__c",domId:"Jtb{0}Content",domType:"text",width:300},{label:"金額",msgId:"expCost_head",apiKey:"Amount__c",domId:"Jtb{0}Amount",domType:"currency",
width:90,sortable:!0}],searchFields:[{label:"出発日",msgId:"jt13000150",apiKey:"StartDate__c",domId:"startDate",domType:"dateFrom",width:108,name:"startDate",lw:"auto",wr:!0,noNL:!0}],filts:[{filtVal:"EmpId__c = '{0}'",filtKey:"empId",fix:!0},{filtVal:"ExpPreApplyId__c = null",filtKey:"expPreApplyId",fix:!0},{filtVal:"Removed__c = false",filtKey:"removed",fix:!0}],sortKeys:[{apiKey:"StartDate__c",desc:!0},{apiKey:"Id",
desc:!0}],children:{},buttons:[{key:"expImport",labelId:"tf10002260"},{key:"close",labelId:"cancel_btn_title"}]},expHistory:{discernment:"expHistory",objectName:"AtkEmpExp__c",type:"table",title:"tf10003570",selType:"radio",formCss:"ts-dialog-exp-history",rowLimit:20,rowDisp:12,fields:[{label:"ID",apiKey:"Id",domId:"HistExp{0}Id",domType:"text",hidden:!0},{label:"社員ID",apiKey:"EmpId__c",domId:"HistExp{0}EmpId",
domType:"text",hidden:!0,fix:"EmpId__c"},{label:"名称",apiKey:"Name",domId:"HistExp{0}Name",domType:"text",hidden:!0},{label:"経費申請ID",apiKey:"ExpApplyId__c",domId:"HistExp{0}ExpApplyId",domType:"text",hidden:!0},{label:"経費事前申請ID",apiKey:"ExpApplyId__r.ExpPreApplyId__c",domId:"HistExp{0}ExpPreApplyId",domType:"text",hidden:!0},{label:"カード明細ID",apiKey:"CardStatementLineId__c",domId:"HistExp{0}CardStatementLineId",
domType:"text",hidden:!0},{label:"交通費種別",apiKey:"TransportType__c",domId:"HistExp{0}TransportType",domType:"text",hidden:!0},{label:"発駅コード",apiKey:"startCode__c",domId:"HistExp{0}startCode",domType:"text",hidden:!0},{label:"着駅コード",apiKey:"endCode__c",domId:"HistExp{0}endCode",domType:"text",hidden:!0},{label:"往復フラグ",apiKey:"roundTrip__c",domId:"HistExp{0}roundTrip",domType:"checkbox",hidden:!0},{label:"経路",
apiKey:"Route__c",domId:"HistExp{0}Route",domType:"text",hidden:!0},{label:"通貨名",apiKey:"CurrencyName__c",domId:"HistExp{0}CurrencyName",domType:"text",hidden:!0},{label:"換算レート",apiKey:"CurrencyRate__c",domId:"HistExp{0}CurrencyRate",domType:"currency",hidden:!0,decimal:"6,2"},{label:"現地金額",apiKey:"ForeignAmount__c",domId:"HistExp{0}ForeignAmount",domType:"currency",hidden:!0,decimal:"6,2"},{label:"領収書あり",
apiKey:"Receipt__c",domId:"HistExp{0}Receipt",domType:"checkbox",hidden:!0},{label:"消費税自動計算",apiKey:"TaxAuto__c",domId:"HistExp{0}TaxAuto",domType:"checkbox",hidden:!0},{label:"消費税率",apiKey:"TaxRate__c",domId:"HistExp{0}TaxRate",domType:"number",hidden:!0},{label:"消費税タイプ",apiKey:"TaxType__c",domId:"HistExp{0}TaxType",domType:"text",hidden:!0},{label:"消費税額",apiKey:"Tax__c",domId:"HistExp{0}Tax",domType:"currency",
hidden:!0},{label:"税抜金額",apiKey:"WithoutTax__c",domId:"HistExp{0}WithoutTax",domType:"currency",hidden:!0},{label:"拡張項目1",apiKey:"ExtraItem1__c",domId:"HistExp{0}ExtraItem1",domType:"text",hidden:!0},{label:"拡張項目2",apiKey:"ExtraItem2__c",domId:"HistExp{0}ExtraItem2",domType:"text",hidden:!0},{label:"外部入力元",apiKey:"Item__c",domId:"HistExp{0}Item",domType:"text",hidden:!0},{label:"ジョブ",apiKey:"JobId__c",
domId:"HistExp{0}JobId",domType:"text",hidden:!0},{label:"支払先ID",apiKey:"PayeeId__c",domId:"HistExp{0}PayeeId",domType:"text",hidden:!0},{label:"支払先名",apiKey:"PayeeId__r.Name",domId:"HistExp{0}PayeeName",domType:"text",hidden:!0},{label:"支払日",apiKey:"PaymentDate__c",domId:"HistExp{0}PaymentDate",domType:"date",hidden:!0},{label:"支払種別",apiKey:"PayeeId__r.PayeeType__c",domId:"HistExp{0}PayeeType",domType:"text",
hidden:!0},{label:"支払先精算区分",apiKey:"PayeeId__r.ExpenseType__c",domId:"HistExp{0}PayeeExpenseType",domType:"text",hidden:!0},{label:"数量",apiKey:"Quantity__c",domId:"HistExp{0}Quantity",domType:"number",hidden:!0},{label:"単価",apiKey:"UnitPrice__c",domId:"HistExp{0}UnitPrice",domType:"currency",hidden:!0},{label:"ジョブコード",apiKey:"JobId__r.JobCode__c",domId:"HistExp{0}JobCode",domType:"text",hidden:!0},{label:"有効開始日",
apiKey:"JobId__r.StartDate__c",domId:"HistExp{0}JobStartDate",domType:"date",hidden:!0},{label:"有効終了日",apiKey:"JobId__r.EndDate__c",domId:"HistExp{0}JobEndDate",domType:"date",hidden:!0},{label:"ジョブ有効",apiKey:"JobId__r.Active__c",domId:"HistExp{0}JobActive",domType:"checkbox",hidden:!0},{label:"並び順",apiKey:"Order__c",domId:"HistExp{0}Order",domType:"number",hidden:!0},{label:"数量単位",apiKey:"ExpItemId__r.UnitName__c",
domId:"HistExp{0}UnitName",domType:"text",hidden:!0},{label:"支払い済み",apiKey:"IsPaid__c",domId:"HistExp{0}IsPaid",domType:"checkbox",hidden:!0},{label:"削除フラグ",apiKey:"_removed",domId:"HistExp{0}_Removed",domType:"checkbox",hidden:!0},{label:"事前申請明細ID",apiKey:"PreEmpExpId__c",domId:"HistExp{0}PreEmpExpId",domType:"text",hidden:!0},{label:"事前申請費目ID",apiKey:"PreExpItemId__c",domId:"HistExp{0}PreExpItemId",domType:"text",
hidden:!0},{label:"ジョブ",msgId:"job_label",apiKey:"JobId__r.Name",domId:"HistExp{0}JobName",domType:"text",hidden:!0},{label:"出発",msgId:"stationFrom_label",apiKey:"startName__c",domId:"HistExp{0}startName",domType:"text",hidden:!0},{label:"到着",msgId:"stationTo_label",apiKey:"endName__c",domId:"HistExp{0}endName",domType:"text",hidden:!0},{label:"負担部署",apiKey:"ChargeDeptId__c",domId:"HistExp{0}ChargeDeptId",
domType:"text",hidden:!0},{label:"負担部署コード",apiKey:"ChargeDeptId__r.DeptCode__c",domId:"HistExp{0}ChargeDeptCode",domType:"text",hidden:!0},{label:"負担部署名",apiKey:"ChargeDeptId__r.Name",domId:"HistExp{0}ChargeDeptName",domType:"text",hidden:!0},{check:!0,domId:"HistExp{0}Check_",domType:"checkbox",width:24},{label:"利用日",msgId:"tf10000940",apiKey:"Date__c",domId:"HistExp{0}Date",domType:"date",width:90,sortable:!0},{
label:"費目",msgId:"expItem_head",apiKey:"ExpItemId__r.Name",domId:"HistExp{0}ExpItem",domType:"select",width:130,sortable:!0},{label:"内容",msgId:"tf10000850",domId:"HistExp{0}Content",domType:"route",width:280},{label:"金額",msgId:"tf10000950",apiKey:"Cost__c",domId:"HistExp{0}Cost",domType:"currency",width:110,sortable:!0},{label:"備考",msgId:"expNote_head",apiKey:"Detail__c",domId:"HistExp{0}Detail",domType:"text",
width:170,sortable:!0},{label:"社内参加者人数",msgId:"tf10000860",apiKey:"InternalParticipantsNumber__c",domId:"HistExp{0}InternalParticipantsNumber",domType:"number",hidden:!0},{label:"社内参加者",msgId:"tm20004741",apiKey:"InternalParticipants__c",domId:"HistExp{0}InternalParticipants",domType:"textarea",hidden:!0},{label:"社外参加者人数",msgId:"tf10000870",apiKey:"ExternalParticipantsNumber__c",
domId:"HistExp{0}ExternalParticipantsNumber",domType:"number",hidden:!0},{label:"社外参加者",msgId:"tm20004742",apiKey:"ExternalParticipants__c",domId:"HistExp{0}ExternalParticipants",domType:"textarea",hidden:!0},{label:"店舗名",msgId:"tf10011010",apiKey:"PlaceName__c",domId:"HistExp{0}PlaceName",domType:"text",hidden:!0},{label:"店舗所在地",msgId:"tf10011020",apiKey:"PlaceAddress__c",domId:"HistExp{0}PlaceAddress",
domType:"textarea",hidden:!0},{label:"人数割金額",msgId:"tf10000871",apiKey:"AmountPerParticipant__c",domId:"HistExp{0}AmountPerParticipant",domType:"currency",hidden:!0},{label:"発行者（店名）",msgId:"expPublisher_head",apiKey:"Publisher__c",domId:"HistExp{0}Publisher",domType:"text",hidden:!0}],searchFields:[{label:"範囲",msgId:"tk10001028",apiKey:"ExpPreApplyId__c",domId:"HistExpPreApply",domType:"select",width:"auto",
lw:"auto",wr:!0,noNL:!0,subType:"noope",pickList:[{v:"!=null",msgId:"tk10004031"},{v:"=null",msgId:"empExp_label"}]},{label:"費目",msgId:"expItem_head",apiKey:"ExpItemId__c",domId:"HistExpItem",domType:"select",width:160,lw:"auto",wr:!0,noNL:!0,optall:!0},{label:"駅名",msgId:"tf10003580",apiKey:"_station",domId:"HistStation",domType:"text",width:90,lw:"auto",wr:!0,noNL:!0},{label:"備考",msgId:"expNote_head",
apiKey:"Detail__c",domId:"HistDetail",domType:"text",width:140,lw:"auto",wr:!0,noNL:!0,matchType:3}],filts:[{filtVal:"EmpId__c = '{0}'",filtKey:"empId",fix:!0},{filtVal:"Item__c <> 'JTB'",fix:!0}],sortKeys:[{apiKey:"Date__c",desc:!0},{apiKey:"Order__c"},{apiKey:"Id"}],buttons:[{key:"histImport",labelId:"tf10002260"},{key:"close",labelId:"cancel_btn_title"}]},externalExpense:{discernment:"externalExpense",
objectName:"ExternalICExpense__c",type:"table",title:"pit10001010",formCss:"ts-dialog-pitt-state",rowLimit:50,fields:[{label:"ID",apiKey:"Id",domId:"ExtExp{0}Id",domType:"text",hidden:!0},{label:"Name",apiKey:"Name",domId:"ExtExp{0}Name",domType:"text",hidden:!0},{label:"登録日時",apiKey:"RegistrationDate__c",domId:"ExtExp{0}RegistrationDate",domType:"datetime",hidden:!0},{label:"ステータス",apiKey:"Status__c",
domId:"ExtExp{0}Status",domType:"text",hidden:!0},{check:!0,domId:"ExtExp{0}_Check",domType:"checkbox",width:24},{label:"利用日",msgId:"tf10000940",apiKey:"UsageDate__c",domId:"ExtExp{0}UsageDate",domType:"date",width:100,sortable:!0},{label:"経費種別",msgId:"pit10001020",apiKey:"UsageType__c",domId:"ExtExp{0}UsageType",domType:"text",width:130,sortable:!0},{label:"利用金額",msgId:"jt18000050",apiKey:"Amount__c",
domId:"ExtExp{0}Amount",domType:"currency",width:90,sortable:!0},{label:"入場駅",msgId:"pit10001030",apiKey:"StationNameFrom__c",domId:"ExtExp{0}StationNameFrom",domType:"text",width:140,sortable:!0},{label:"出場駅",msgId:"pit10001050",apiKey:"StationNameTo__c",domId:"ExtExp{0}StationNameTo",domType:"text",width:140,sortable:!0}],filts:[{filtVal:"EmpId__c = '{0}'",filtKey:"empId",fix:!0},{filtVal:"UsageType__c != '物販'",
filtKey:"usageType",fix:!0},{filtVal:"Status__c = '未処理'",filtKey:"status",fix:!0}],sortKeys:[{apiKey:"UsageDate__c",desc:!0},{apiKey:"RegistrationDate__c",desc:!0},{apiKey:"Id",desc:!0}],children:{EmpExps__r:{fields:[{apiKey:"Id"}]}},buttons:[{key:"expImport",labelId:"tf10002260"},{key:"close",labelId:"cancel_btn_title"}]},jobs:{discernment:"jobs",objectName:"AtkJob__c",type:"table",title:"searchJob_label",
selType:"radio",formCss:"ts-dialog-job",rowLimit:50,jobList:!0,fields:[{label:"ID",apiKey:"Id",domId:"Job{0}Id",domType:"text",hidden:!0},{label:"アクティブ",apiKey:"Active__c",domId:"Job{0}Active",domType:"checkbox",hidden:!0},{check:!0,domId:"Job{0}_Check",domType:"checkbox",width:24},{label:"主担当部署",msgId:"tk10000849",apiKey:"DeptId__r.Name",domId:"Job{0}DeptName",domType:"text",width:180,sortable:!0},{label:"ジョブコード",
msgId:"tm20001020",apiKey:"JobCode__c",domId:"Job{0}Code",domType:"text",width:130,sortable:!0},{label:"ジョブ名",msgId:"jobName_head",apiKey:"Name",domId:"Job{0}Name",domType:"text",width:250,sortable:!0},{label:"有効開始日",msgId:"yuqStartDate_head",apiKey:"StartDate__c",domId:"Job{0}StartDate",domType:"date",width:90,sortable:!0},{label:"有効終了日",msgId:"tk10000356",apiKey:"EndDate__c",domId:"Job{0}EndDate",domType:"date",
width:90,sortable:!0}],sortKeys:[{apiKey:"JobCode__c"}],searchFields:[{label:"主担当部署",msgId:"tk10000849",apiKey:"DeptId__c",domId:"JobListDeptId",domType:"select",width:300,lw:"auto",wr:!0,noNL:!0,minusIsNull:!0,dispField:{apiKey:"DeptId__r.Name",codeKey:"DeptId__r.DeptCode__c"}},{label:"日付",msgId:"date_head",apiKey:"_date",domId:"JobListDate",domType:"date",width:108,lw:"auto",wr:!0,name:"jobValidDate",browse:"cal",
colNames:["StartDate__c","EndDate__c"]},{label:"ジョブコード",msgId:"tm20001020",apiKey:"JobCode__c",domId:"JobListCode",domType:"text",width:100,lw:"auto",wr:!0,matchType:1,noNL:!0},{label:"ジョブ名",msgId:"jobName_head",apiKey:"Name",domId:"JobListName",domType:"text",width:240,lw:"auto",wr:!0,matchType:3},{label:"ジョブ割当区分",apiKey:"_jobAssignClass",domId:"JobListClass",domType:"filt",hidden:!0}]},depts:{discernment:"depts",
objectName:"AtkDept__c",type:"table",title:"tk10001038",selType:"radio",formCss:"ts-dialog-dept",rowLimit:50,fields:[{label:"ID",apiKey:"Id",domId:"Dept{0}Id",domType:"text",hidden:!0},{label:"経費費目表示区分",apiKey:"ExpItemClass__c",domId:"Dept{0}ExpItemClass",domType:"text",hidden:!0},{check:!0,domId:"Dept{0}_Check",domType:"checkbox",width:24},{label:"部署コード",msgId:"tk10000069",apiKey:"DeptCode__c",domId:"Dept{0}Code",
domType:"text",width:110,sortable:!0},{label:"部署名",msgId:"tk10000335",apiKey:"Name",domId:"Dept{0}Name",domType:"text",width:210,sortable:!0},{label:"上位部署名",msgId:"tk10000337",apiKey:"ParentId__r.Name",domId:"Dept{0}ParentName",domType:"text",width:200,sortable:!0},{label:"有効開始日",msgId:"yuqStartDate_head",apiKey:"StartDate__c",domId:"Dept{0}StartDate",domType:"date",width:90,sortable:!0},{label:"有効終了日",
msgId:"tk10000356",apiKey:"EndDate__c",domId:"Dept{0}EndDate",domType:"date",width:90,sortable:!0}],sortKeys:[{apiKey:"DeptCode__c"}],searchFields:[{label:"部署コード",msgId:"tk10000069",apiKey:"DeptCode__c",domId:"DeptListCode",domType:"text",width:80,lw:"auto",wr:!0,matchType:1,noNL:!0},{label:"部署名",msgId:"tk10000335",apiKey:"Name",domId:"DeptListName",domType:"text",width:100,lw:"auto",wr:!0,matchType:3,noNL:!0},{
label:"上位部署名",msgId:"tk10000337",apiKey:"ParentId__r.Name",domId:"DeptListPname",domType:"text",width:100,lw:"auto",wr:!0,matchType:3,noNL:!0},{label:"日付",msgId:"date_head",apiKey:"_date",domId:"DeptListDate",domType:"date",width:108,lw:"auto",wr:!0,name:"deptValidDate",browse:"cal",colNames:["StartDate__c","EndDate__c"]}]},accounts:{discernment:"accounts",objectName:"Account",type:"table",selType:"radio",
title:"tf10002230",formCss:"ts-dialog-account",rowLimit:50,fields:[{label:"ID",apiKey:"Id",domId:"Account{0}Id",domType:"text",hidden:!0},{check:!0,domId:"Account{0}_Check",domType:"checkbox",width:24},{label:"取引先名",msgId:"tk10003250",apiKey:"Name",domId:"Account{0}Name",domType:"text",width:500,sortable:!0}],sortKeys:[{apiKey:"Name"}],searchFields:[{label:"取引先名",msgId:"tk10003250",apiKey:"Name",
domId:"AccountListName",domType:"text",width:150,lw:"auto",wr:!0,matchType:3}]},processInstanceSteps:{discernment:"processInstanceStep",objectName:"ProcessInstanceStep",type:"table",title:"approvalHistory_label",formCss:"ts-dialog-processIntanceStep",rowLimit:100,rowDisp:6,fields:[{label:"Id",apiKey:"Id",domId:"ProcessInstance{0}Id",domType:"text",hidden:!0},{label:"TargetObjectId",
apiKey:"ProcessInstance.TargetObjectId",domId:"ProcessInstance{0}TargetObjectId",domType:"text",hidden:!0},{label:"承認者ID",apiKey:"ActorId",domId:"ProcessInstance{0}ActorId",domType:"text",hidden:!0},{label:"割当先ID",apiKey:"OriginalActorId",domId:"ProcessInstance{0}OriginalActorId",domType:"text",hidden:!0},{label:"日付",msgId:"date_head",apiKey:"CreatedDate",domId:"ProcessInstance{0}CreatedDate",domType:"datetime",
width:130},{label:"状況",msgId:"statusj_head",apiKey:"StepStatus",domId:"ProcessInstance{0}StepStatus",domType:"text",width:130,align:"center"},{label:"割り当て先",msgId:"tf10001210",apiKey:"OriginalActor.Name",domId:"ProcessInstance{0}OriginalActorName",domType:"text",width:100,align:"center"},{label:"承認者",msgId:"tk10000071",apiKey:"Actor.Name",domId:"ProcessInstance{0}ActorName",domType:"text",width:100,align:"center"},{
label:"コメント",msgId:"comment_head",apiKey:"Comments",domId:"ProcessInstance{0}Comments",domType:"text",width:240}],sortKeys:[{apiKey:"CreatedDate",desc:!0}]},expApplyList:{discernment:"AtkExpApply",objectName:"AtkExpApply__c",type:"table",selType:"radio",title:"expApplyList_caption",formCss:"ts-dialog-expApply",rowLimit:8,rowDisp:8,irregularType:"expApplyList",fields:[{check:!0,domId:"ExpApply{0}_Check",
domType:"checkbox",width:24},{label:"Id",apiKey:"Id",domId:"ExpApply{0}Id",domType:"text",hidden:!0},{label:"Name",apiKey:"Name",domId:"ExpApply{0}Name",domType:"text",hidden:!0},{label:"状態",msgId:"tf10001230",apiKey:"StatusC__c",domId:"ExpApply{0}Status",domType:"status",width:30,sortable:!0},{label:"精算申請番号",msgId:"tf10000550",apiKey:"ExpApplyNo__c",domId:"ExpApply{0}ExpApplyNo",domType:"text",width:100,sortable:!0,
align:"center"},{label:"精算申請日付",msgId:"tf10001220",apiKey:"ApplyTime__c",domId:"ExpApply{0}ApplyTime",domType:"datetime",width:124,sortable:!0},{label:"事前申請番号",msgId:"tf10001100",apiKey:"ExpPreApplyId__r.ExpPreApplyNo__c",domId:"ExpApply{0}ExpPreApplyNo",domType:"text",width:100,sortable:!0,align:"center"},{label:"件名",msgId:"tk10004320",apiKey:"TitleD__c",domId:"ExpApply{0}ExpTitle",domType:"text",width:130,
sortable:!0},{label:"日付(from)",msgId:"tf10000640",apiKey:"StartDate__c",domId:"ExpApply{0}StartDate",domType:"date",width:82,sortable:!0},{label:"日付(to)",msgId:"tf10000650",apiKey:"EndDate__c",domId:"ExpApply{0}EndDate",domType:"date",width:82,sortable:!0},{label:"件数",msgId:"rowCount_head",apiKey:"Count__c",domId:"ExpApply{0}Count",domType:"number",width:46,sortable:!1},{label:"金額",msgId:"expCost_head",
apiKey:"TotalCost__c",domId:"ExpApply{0}TotalCost",domType:"currency",width:108,sortable:!0}],sortKeys:[{apiKey:"ApplyTime__c",desc:!0}],children:{EmpExp__r:{fields:[{apiKey:"Id"}]}}},payeeList:{discernment:"AtkPayee",objectName:"AtkPayee__c",type:"table",selType:"radio",title:"tf10000580",formCss:"ts-dialog-payee",rowLimit:20,rowDisp:10,fields:[{check:!0,domId:"Payee{0}_Check",domType:"checkbox",width:24},{
label:"Id",apiKey:"Id",domId:"Payee{0}Id",domType:"text",hidden:!0},{label:"精算区分",apiKey:"ExpenseType__c",domId:"Payee{0}ExpenseType",domType:"text",hidden:!0},{label:"支払先コード",msgId:"ci00000150",apiKey:"ZGRecipientCode__c",domId:"Payee{0}ZGRecipientCode",domType:"text",width:110,sortable:!0},{label:"支払先名",msgId:"tf10001160",apiKey:"Name",domId:"Payee{0}Name",domType:"text",width:120,sortable:!0},{label:"自動引落",
msgId:"tf10001240",apiKey:"AutoWithdrawal__c",domId:"Payee{0}AutoWithdrawal",domType:"checkbox",width:60,sortable:!0},{label:"支払種別",msgId:"tf10001150",apiKey:"PayeeType__c",domId:"Payee{0}PayeeType",domType:"select",width:120,sortable:!0,pickList:[{v:"1",msgId:"tf10001350"},{v:"2",msgId:"tf10001370"},{v:"3",msgId:"tf10001380"}]},{label:"支払日",msgId:"tf10000590",apiKey:"PaymentDay__c",domId:"Payee{0}PaymentDay",
domType:"text",width:50,sortable:!0,align:"center"},{label:"支払条件",msgId:"tf10001250",apiKey:"PaymentTerms__c",domId:"Payee{0}PaymentTerms",domType:"text",width:100,sortable:!0},{label:"振込先口座番号",msgId:"tk10000427",apiKey:"ZGRecipientAccountNo__c",domId:"Payee{0}ZGRecipientAccountNo",domType:"text",width:100,sortable:!0},{label:"振込先銀行名",msgId:"tk10000421",apiKey:"ZGRecipientBankName__c",
domId:"Payee{0}ZGRecipientBankName",domType:"text",width:130,sortable:!0},{label:"振込先支店名",msgId:"tk10000423",apiKey:"ZGRecipientBranchName__c",domId:"Payee{0}ZGRecipientBranchName",domType:"text",width:120,sortable:!0}],sortKeys:[{apiKey:"ZGRecipientCode__c"}],searchFields:[{label:"支払先コード",msgId:"ci00000150",apiKey:"ZGRecipientCode__c",domId:"PayeeRecipientCode",domType:"text",width:100,lw:"auto",wr:!0,matchType:0,
noNL:!0},{label:"支払先名",msgId:"tf10001160",apiKey:"Name",domId:"PayeeSearchName",domType:"text",width:120,lw:"auto",wr:!0,matchType:3,noNL:!0},{label:"支払種別",apiKey:"PayeeType__c",domId:"PayeePayeeType",domType:"text",hidden:!0},{label:"精算区分",apiKey:"ExpenseType__c",domId:"PayeeExpenseType",domType:"text",hidden:!0,nullspec:!0,findmid:","}],filts:[]},commuterPass:{fields:[{label:"社員ID",apiKey:"empId",
domId:"CommuterPassEmpId",domType:"text",hidden:!0},{label:"定期区間履歴ID",apiKey:"id",domId:"CommuterPassId",domType:"text",hidden:!0},{label:"経路コード",apiKey:"routeCode",domId:"CommuterPassRouteCode",domType:"text",hidden:!0},{label:"定期券金額",apiKey:"passFare",domId:"CommuterPassFare",domType:"currency",hidden:!0},{label:"定期券期間",apiKey:"passPeriod",domId:"CommuterPassPeriod",domType:"text",hidden:!0},{label:"ステータス",
apiKey:"status",domId:"CommuterPassStatus",domType:"text",hidden:!0},{label:"定期区間の取扱",apiKey:"excludeCommuterRoute",domId:"CommuterPassExcludeCommuterRoute",domType:"text",hidden:!0},{label:"経由駅で乗り換え",apiKey:"transfer",domId:"CommuterPassTransfer",domType:"checkbox",hidden:!0},{label:"開始日",msgId:"tf10000180",apiKey:"startDate",domId:"CommuterPassStartDate",domType:"date",width:108,maxLen:12,name:"commuterStartDate",
browse:"cal",required:1},{label:"種別",msgId:"tk10000262",apiKey:"purpose",domId:"CommuterPassPurpose",domType:"radio",name:"commuterPassPurpose",pickList:[{v:"1",msgId:"tf10000440"},{v:"0",msgId:"tf10000450"}]},{label:"定期区間",msgId:"tk10000447",apiKey:"routeDescription",domId:"CommuterPassRouteDescription",domType:"text",width:280,ro:!0},{label:"経路",msgId:"route_head",apiKey:"route",domId:"CommuterPassRouteText",
domType:"text",width:340,ro:!0},{label:"コメント",msgId:"comment_head",apiKey:"note",domId:"CommuterPassComment",domType:"textarea",width:300,maxLen:255}]},commuterPassList:{discernment:"AtkCommuterPass",objectName:"AtkCommuterPass__c",type:"table",title:"tf10002240",formCss:"ts-dialog-commuter-pass",rowLimit:20,rowDisp:6,fields:[{label:"ID",apiKey:"Id",domId:"CommuterPass{0}Id",domType:"text",hidden:!0},{label:"経路コード",
apiKey:"RouteCode__c",domId:"CommuterPass{0}RouteCode",domType:"text",hidden:!0},{label:"経路",apiKey:"Route__c",domId:"CommuterPass{0}Route",domType:"text",hidden:!0},{label:"定期券金額",apiKey:"PassFare__c",domId:"CommuterPass{0}Fare",domType:"currency",hidden:!0},{label:"定期券期間",apiKey:"PassPeriod__c",domId:"CommuterPass{0}Period",domType:"text",hidden:!0},{label:"開始日",msgId:"tf10000180",apiKey:"StartDate__c",
domId:"CommuterPass{0}StartDate",domType:"date",width:108,sortable:!0},{label:"定期区間",msgId:"tk10000447",apiKey:"RouteDescription__c",domId:"CommuterPass{0}RouteDescription",domType:"text",width:180,sortable:!0},{label:"コメント",msgId:"comment_head",apiKey:"Note__c",domId:"CommuterPass{0}Note",domType:"text",width:200},{label:"ステータス",msgId:"status_btn_title",apiKey:"Status__c",domId:"CommuterPass{0}Status",
domType:"select",width:90,sortable:!0,align:"center",link:!0,pickList:[{v:"",n:""},{v:"未確定",msgId:"notFix_label"},{v:"未申請",msgId:"tm10003560"},{v:"精算済み",msgId:"reimbursement_label"},{v:"承認済み",msgId:"tm10003480"},{v:"確定済み",msgId:"fixed_label"},{v:"承認待ち",msgId:"waitApproval_label"},{v:"申請取消",msgId:"tm10003500"},{v:"確定取消",msgId:"cancelFix_btn_title"},{v:"却下",msgId:"tm10003490"},{v:"却下済み",msgId:"rejected_label"}]}],
sortKeys:[{apiKey:"StartDate__c",desc:!0},{apiKey:"CreatedDate",desc:!0}],filts:[{filtVal:"EmpId__c = '{0}'",filtKey:"empId",fix:!0}]},ringiInfo:{fields:[{label:"稟議ID",apiKey:"Id",domId:"RingiId",domType:"text",hidden:!0},{label:"所有者ID",apiKey:"OwnerId",domId:"RingiOwnerId",domType:"text",hidden:!0},{label:"申請No",msgId:"tk10004310",apiKey:"ApplicationNo__c",domId:"RingiApplicationNo",domType:"text",width:"auto",
lw:100,ro:!0,link:!0},{label:"種別",msgId:"tk10000262",apiKey:"Type__c",domId:"RingiType",domType:"text",width:"auto",lw:100,ro:!0},{label:"件名",msgId:"tk10004320",apiKey:"Name",domId:"RingiName",domType:"text",width:"auto",lw:100,ro:!0}]},ringiList:{discernment:"AtkApply",objectName:"AtkApply__c",type:"table",selType:"radio",title:"tf10002250",formCss:"ts-dialog-ringo",rowLimit:20,rowDisp:10,fields:[{check:!0,
domId:"Ringi{0}_Check",domType:"checkbox",width:24},{label:"Id",apiKey:"Id",domId:"Ringi{0}Id",domType:"text",hidden:!0},{label:"申請No",msgId:"tk10004310",apiKey:"ApplicationNo__c",domId:"Ringi{0}ApplicationNo",domType:"text",width:110,sortable:!0,link:!0},{label:"種別",msgId:"tk10000262",apiKey:"Type__c",domId:"Ringi{0}Type",domType:"select",width:100,sortable:!0},{label:"件名",msgId:"tk10004320",apiKey:"Name",
domId:"Ringi{0}Name",domType:"text",width:200,sortable:!0},{label:"申請者",msgId:"tk10000067",apiKey:"Owner.Name",domId:"Ringi{0}OwnerName",domType:"text",width:100,sortable:!0,align:"center"},{label:"作成日時",msgId:"tf10001270",apiKey:"CreatedDate",domId:"Ringi{0}CreatedDate",domType:"datetime",width:132,sortable:!0},{label:"決裁日",msgId:"tf10001280",apiKey:"ApplicationDate__c",domId:"Ringi{0}ApplicationDate",
domType:"date",width:80,sortable:!0},{label:"ステータス",msgId:"status_btn_title",apiKey:"Status__c",domId:"Ringi{0}Status",domType:"select",width:80,sortable:!0,align:"center",pickList:[{v:"",n:""},{v:"未確定",msgId:"notFix_label"},{v:"未申請",msgId:"tm10003560"},{v:"精算済み",msgId:"reimbursement_label"},{v:"承認済み",msgId:"tm10003480"},{v:"確定済み",msgId:"fixed_label"},{v:"承認待ち",msgId:"waitApproval_label"},{v:"申請取消",msgId:"tm10003500"
},{v:"確定取消",msgId:"cancelFix_btn_title"},{v:"却下",msgId:"tm10003490"},{v:"却下済み",msgId:"rejected_label"}]}],sortKeys:[{apiKey:"CreatedDate",desc:!0}],searchFields:[{label:"申請No",msgId:"tk10004310",apiKey:"ApplicationNo__c",domId:"RingiSearchApplicationNo",domType:"text",width:90,lw:"auto",wr:!0,matchType:1,noNL:!0},{label:"種別",msgId:"tk10000262",apiKey:"Type__c",domId:"RingiSearchType",domType:"select",width:140,
lw:"auto",wr:!0,noNL:!0},{label:"件名",msgId:"tk10004320",apiKey:"Name",domId:"RingiSearchName",domType:"text",width:120,lw:"auto",wr:!0,matchType:3,noNL:!0},{label:"申請者",msgId:"tk10000067",apiKey:"Owner.Name",domId:"RingiSearchOwnerName",domType:"text",width:90,lw:"auto",wr:!0,matchType:3,noNL:!0}]},provisionalPayments:{discernment:"provisionalPayments",objectName:"AtkExpPreApply__c",type:"table",title:"tf10006140",
selType:"radio",formCss:"ts-dialog-provisional-pays",rowLimit:20,fields:[{label:"ID",apiKey:"Id",domId:"ProvisionalPay{0}Id",domType:"text",hidden:!0},{label:"申請名",apiKey:"Name",domId:"ProvisionalPay{0}Name",domType:"text",hidden:!0},{check:!0,domId:"Dept{0}_Check",domType:"checkbox",width:24},{label:"事前申請番号",msgId:"tf10001100",apiKey:"ExpPreApplyNo__c",domId:"ProvisionalPay{0}ExpPreApplyNo",domType:"text",width:100,
sortable:!0},{label:"件名",msgId:"tk10004320",apiKey:"Title__c",domId:"ProvisionalPay{0}Title",domType:"text",width:210,sortable:!0},{label:"仮払希望日",msgId:"tf10006130",apiKey:"ExpectedPayDate__c",domId:"ProvisionalPay{0}ExPayDate",domType:"date",width:90,sortable:!0},{label:"仮払金額",msgId:"tf10001050",apiKey:"ProvisionalPaymentAmount__c",domId:"ProvisionalPay{0}Amount",domType:"currency",width:120,sortable:!0}],sortKeys:[
{apiKey:"ExpPreApplyNo__c"}],searchFields:[],filts:[{filtVal:"EmpId__c = '{0}'",filtKey:"empId",fix:!0},{filtVal:"RecordType.Name = '仮払申請'",filtKey:"recordType",fix:!0},{filtVal:"StatusC__c in ('承認済み','確定済み', '精算済み', '仕訳済み')",fix:!0},{filtVal:"AdjustmentDone__c = false",fix:!0}],children:{AdjustmentExpApply__r:{fields:[{apiKey:"Id"}]},ExpApplications__r:{fields:[{apiKey:"Id"}]}}},expItems:{discernment:"expItems",
objectName:"AtkExpItem__c",type:"table",selType:"radio",title:"tf10006790",formCss:"ts-dialog-expItem",rowLimit:20,rowDisp:12,fields:[{check:!0,domId:"ExpItem{0}_Check",domType:"checkbox",width:24},{label:"Id",apiKey:"Id",domId:"ExpItem{0}Id",domType:"text",hidden:!0},{label:"費目種別",apiKey:"TransportType__c",domId:"ExpItem{0}TransportType",domType:"text",notUse:!0},{label:"手当種別",apiKey:"AllowanceFlag__c",
domId:"ExpItem{0}AllowanceFlag",domType:"text",notUse:!0},{label:"精算区分",apiKey:"ExpenseType__c",domId:"ExpItem{0}ExpenseType",domType:"text",notUse:!0},{label:"使用制限あり",apiKey:"RestrictTargetEmployee__c",domId:"ExpItem{0}RestrictTargetEmployee",domType:"text",notUse:!0},{label:"使用可能社員",apiKey:"TargetEmployee__c",domId:"ExpItem{0}TargetEmployee",domType:"text",notUse:!0},{label:"表示名",msgId:"tk10000690",apiKey:"Name",
domId:"ExpItem{0}Name",domType:"text",width:150,sortable:!0},{label:"コード",msgId:"code_head",apiKey:"Code__c",domId:"ExpItem{0}Code",domType:"text",width:110,sortable:!0},{label:"費目名",msgId:"tm20004560",apiKey:"ItemName__c",domId:"ExpItem{0}ItemName",domType:"text",width:150,sortable:!0},{label:"補助科目コード",msgId:"tk10000707",apiKey:"AuxCode__c",domId:"ExpItem{0}AuxCode",domType:"text",width:110,sortable:!0},{
label:"補助科目名",msgId:"tm20004575",apiKey:"AuxTitle__c",domId:"ExpItem{0}AuxTitle",domType:"text",width:150,sortable:!0}],sortKeys:[{apiKey:"Code__c"}],searchFields:[{label:"表示名",msgId:"tk10000690",apiKey:"Name",domId:"ExpItemSearchName",domType:"text",width:110,lw:"auto",wr:!0,matchType:3,noNL:!0},{label:"費目名",msgId:"tm20004560",apiKey:"ItemName__c",domId:"ExpItemSearchItemName",domType:"text",width:110,lw:"auto",
wr:!0,matchType:3,noNL:!0},{label:"コード",msgId:"code_head",apiKey:"Code__c",domId:"ExpItemSearchCode",domType:"text",width:100,lw:"auto",wr:!0,matchType:3,noNL:!0},{label:"費目ID",apiKey:"Id",domId:"ExpItemSearchId",domType:"array",hidden:!0}],filts:[{filtVal:"Removed__c = false",fix:!0},{filtVal:"ForAdjustment__c = false",fix:!0},{filtVal:"ForPayable__c = false",fix:!0}]},csvUpload:{discernment:"csvUpload",
objectName:"AtkEmpExp__c",type:"table",title:"tf10001500",formCss:"ts-csv-upload",fields:[]}}},teasp.Tsf.Dom=function(){this.eventHandles={},this.comboBoxes={},this.menus={},this.tooltips={}},teasp.Tsf.Dom.init=function(){require(["dojo/date/locale","dojo/window","dojo/store/Memory","dijit/Tooltip","dijit/TooltipDialog","dijit/Menu","dijit/Calendar","dijit/Dialog","dijit/form/ComboBox"]),dojo.addClass(document.body,
"claro"),dojo.style(dojo.body(),{fontSize:"13px"})},teasp.Tsf.Dom.byId=function(e){return dojo.byId(teasp.Tsf.Dom.cleanId(e))},teasp.Tsf.Dom.query=function(e,t){return dojo.query(e,t)},teasp.Tsf.Dom.node=function(e,t){e=dojo.query(e,t);return e&&e.length?e[0]:null},teasp.Tsf.Dom.append=function(e,t){t&&(dojo.isArray(t)?dojo.forEach(t,function(e){this.appendChild(e)},e):e.appendChild(t))},teasp.Tsf.Dom.hitch=function(
e,t){return dojo.hitch(e,t)},teasp.Tsf.Dom.style=function(e,t,s){dojo.query(e).style(t,s)},teasp.Tsf.Dom.setAttr=function(e,t,s){dojo.query(e).forEach(function(e){dojo.setAttr(e,t,s)})},teasp.Tsf.Dom.setAttr2=function(e,t,s,a){dojo.query(e,t).forEach(function(e){dojo.setAttr(e,s,a)})},teasp.Tsf.Dom.getAttr=function(e,t){return dojo.getAttr(e,t)},teasp.Tsf.Dom.html=function(e,t,s){dojo.query(e,t).forEach(function(e){
e.innerHTML=s||""})},teasp.Tsf.Dom.empty=function(e){if(e)return"string"==typeof e&&(e=teasp.Tsf.Dom.cleanId(e)),dojo.empty(e)},teasp.Tsf.Dom.destroy=function(e){return"string"==typeof e&&(e=teasp.Tsf.Dom.cleanId(e)),dojo.destroy(e)},teasp.Tsf.Dom.nextSibling=function(e){if(e.nextElementSibling)return e.nextElementSibling;for(;(e=e.nextSibling)&&1!==e.nodeType;);return e},teasp.Tsf.Dom.previousSibling=function(e){if(
e.previousElementSibling)return e.previousElementSibling;for(;(e=e.previousSibling)&&1!==e.nodeType;);return e},teasp.Tsf.Dom.isVisible=function(e){return"none"!=dojo.style(e,"display")},teasp.Tsf.Dom.show=function(e,t,s){e&&dojo.query(e,t).forEach(function(e){dojo.style(e,"display",s?"":"none")})},teasp.Tsf.Dom.style=function(e,t,s){dojo.style(e,t,s)},teasp.Tsf.Dom.hasClass=function(e,t){return dojo.hasClass(e,t)},
teasp.Tsf.Dom.toggleClass=function(e,t,s){return dojo.toggleClass(e,t,s)},teasp.Tsf.Dom.addClass=function(e,t){return e?dojo.addClass(e,t):null},teasp.Tsf.Dom.place=function(e,t,s){return dojo.place(e,t,s)},teasp.Tsf.Dom.disconnect=function(e){dojo.disconnect(e)},teasp.Tsf.Dom.toDom=function(e){return dojo.toDom(e)},teasp.Tsf.Dom.cleanId=function(e){return"#"==e.substring(0,1)?e.substring(1):e},
teasp.Tsf.Dom.getAncestorByTagName=function(e,t){for(var s=null,a=e;null!=a&&"BODY"!=a.tagName;){if(a.tagName==t){s=a;break}a=a.parentNode}return s},teasp.Tsf.Dom.getAncestorByCssName=function(e,t){for(var s=null,a=e;null!=a&&"BODY"!=a.tagName;){if(dojo.hasClass(a,t)){s=a;break}a=a.parentNode}return s},teasp.Tsf.Dom.setDigitValue=function(e,t){e=dijit.byId(e);e&&e.setValue(t)},
teasp.Tsf.Dom.createStoreMemory=function(e){var t=0;return dojo.forEach(e,function(e){e.score=++t}),new dojo.store.Memory({data:e,idProperty:"name"})},teasp.Tsf.Dom.setStoreMemory=function(e,t){if(t&&0<t.length){var s=0,a={};dojo.forEach(t,function(e){a[e.code]||(e.score=++s,a[e.code]=1)});for(var o=t.length-1;0<=o;o--)t[o].score||t.splice(o,1);e.data=t}},teasp.Tsf.Dom.prototype._mem=function(e,t,s){t=t||"_DEFAULT";
return e[t]||(e[t]=[]),teasp.Tsf.util.isArray(s)?e[t]=e[t].concat(s):e[t].push(s),s},teasp.Tsf.Dom.prototype._disconnect=function(e,t){e[t]&&(dojo.forEach(e[t],function(e){dojo.disconnect(e)}),delete e[t])},teasp.Tsf.Dom.prototype._destroy=function(e,t){e[t]&&(dojo.forEach(e[t],function(e){e.destroy(!0)}),delete e[t])},teasp.Tsf.Dom.prototype.freeBy=function(e){this._disconnect(this.eventHandles,e),this._destroy(
this.comboBoxes,e),this._destroy(this.menus,e),this._destroy(this.tooltips,e)},teasp.Tsf.Dom.prototype.free=function(){var e=null;for(e in this.eventHandles)this._disconnect(this.eventHandles,e);for(e in this.comboBoxes)this._destroy(this.comboBoxes,e);for(e in this.menus)this._destroy(this.menus,e);for(e in this.tooltips)this._destroy(this.tooltips,e);this.eventHandles={},this.comboBoxes={},this.menus={},
this.tooltips={}},teasp.Tsf.Dom.prototype.connect=function(e,t,s,a,o){var i;return"string"==typeof e&&(e=dojo.byId(e)),dojo.isArray(e)?(i=[],dojo.forEach(e,function(e){i.push(dojo.connect(e,t,s,a))},this),0<i.length?this._mem(this.eventHandles,o,i):[]):e?this._mem(this.eventHandles,o,dojo.connect(e,t,s,a)):void 0},teasp.Tsf.Dom.prototype.create=function(e,t,s,a){return dojo.create(e,t,s,a)},
teasp.Tsf.Dom.prototype.createMenu=function(e,t,s){var a=new dijit.Menu({targetNodeIds:e,leftClickToOpen:!0,refocus:!1});return dojo.forEach(t,function(e){e.separator?a.addChild(new dijit.MenuSeparator):a.addChild(new dijit.MenuItem({label:e.name,onClick:e.method,disabled:e.disabled||!1}))}),a.startup(),this._mem(this.menus,s,a)},teasp.Tsf.Dom.prototype.createComboBox=function(e,t,s){e=new dijit.form.ComboBox(e,t);
return e.startup(),this._mem(this.comboBoxes,s,e)},teasp.Tsf.Dom.prototype.createTooltip=function(e,t){e=new dijit.Tooltip(e);return e.startup(),this._mem(this.tooltips,t,e)},teasp.Tsf.Dom.pushEvent=function(e,t){var s;e.fireEvent&&dojo.isIE<=8?e.fireEvent(t):(t={onclick:"click"}[t]||t,(s=document.createEvent("MouseEvents")).initEvent(t,!1,!0),e.dispatchEvent(s))},teasp.Tsf.Dom.setlimitChars=function(s,e,a,o){
!dojo.isIE||9<=dojo.isIE||dojo.forEach(e,function(e){var t;a?(t=a.getFcById(e.id))&&s.connect(e,"onkeyup",null,function(e){teasp.Tsf.Dom.limitChars(e.target,t.getMaxLength())}):s.connect(e,"onkeyup",null,function(e){teasp.Tsf.Dom.limitChars(e.target,o)})})},teasp.Tsf.Dom.setLineFeed=function(s,e,a){dojo.forEach(e,function(e){var t=a.getFcById(e.id);t&&t.isNoLf()&&(s.connect(e,"onkeydown",null,function(e){if(
13==e.which)return event.preventDefault(),!1}),s.connect(e,"onblur",null,function(e){e.target.value=e.target.value.replace(/\r?\n/g,"")}))})},teasp.Tsf.Dom.limitChars=function(e,t){e.value.length>t&&(e.value=e.value.substr(0,t)),e.focus()},teasp.Tsf.Dom.stringRep=function(e,t){return dojo.string.rep(e,t)},teasp.Tsf.Dom.getBox=function(){return dojo.window.getBox()},teasp.Tsf.Dom.clone=function(e){return dojo.clone(e)
},teasp.Tsf.Dom.top=function(e){var t=0;return e&&(t=e.offsetTop,e.offsetParent&&(t+=teasp.Tsf.Dom.top(e.offsetParent))),t},teasp.Tsf.Dom.setUIBlock=function(e){var t=dojo.query(".ts-uiblock"),t=(t=t.length?t[0]:null)||dojo.create("div",{className:"ts-uiblock"},document.body),s=teasp.Tsf.Dom.getBox(),a=dojo.byId("contentWrapper"),o=Math.max(s.w,Math.max(a&&a.clientWidth||0,document.body.offsetWidth)),s=Math.max(s.h,
Math.max(a&&a.clientHeight||0,document.body.offsetHeight));dojo.style(t,"width",o+"px"),dojo.style(t,"height",s+"px"),dojo.style(t,"display",e?"":"none")},teasp.Tsf.Dom.setBusyPanel=function(e,t){var s,a,o,i=dojo.query(".ts-busy-panel"),i=i.length?i[0]:null;e&&(a=teasp.Tsf.Dom.getBox(),s=Math.max((a.w-240)/2,0),a=Math.max((a.h-80)/2,0),
s+=document.documentElement&&document.documentElement.scrollLeft||document.body.scrollLeft||0,a+=document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop||0,i?(dojo.style(i,"left",s+"px"),dojo.style(i,"top",a+"px"),(o=teasp.Tsf.Dom.node("button",i))&&teasp.Tsf.Dom.style(o,"display","")):(i=dojo.create("div",{className:"ts-busy-panel",style:"left:"+s+"px;top:"+a+"px;"},document.body),
dojo.create("div",{innerHTML:t.message||"",className:"busy-message"},i),dojo.create("div",{innerHTML:t.btnLabel||""},dojo.create("button",{className:"std-button1"},i))),t&&t.domHelper&&t.method&&t.hkey&&(t.domHelper.freeBy(t.hkey),dojo.query("button",i).forEach(function(e){t.domHelper.connect(e,"onclick",t.context,t.method,t.hkey)},this))),teasp.Tsf.Dom.setUIBlock(e),i&&dojo.style(i,"display",e?"":"none")},
teasp.Tsf.ObjBase=function(){},teasp.Tsf.ObjBase.createList=function(t,e,s,a,o){var i=[],e=(teasp.Tsf.util.isArray(e)?i=e:i.push(e),[]);return dojo.forEach(i,function(e){this.push(new teasp.Tsf[tsfManager.getTarget(t)](e,s,a,o))},e),e},teasp.Tsf.ObjBase.merge=function(e,t){var s={};return dojo.forEach(t,function(e){for(var t=this.length-1;0<=t;t--)if(this[t].equalId(e.getId())){this.splice(t,1,e),s[e.getId()]=1;break
}},e),dojo.forEach(t,function(e){s[e.getId()]||this.push(e)},e),e},teasp.Tsf.ObjBase.getCancelApplyLabel=function(e){return e==teasp.constant.STATUS_APPROVE?teasp.message.getLabel("tk10000741"):e==teasp.constant.STATUS_ADMIT?teasp.message.getLabel("cancelFix_btn_title"):teasp.message.getLabel("cancelApply_btn_title")},teasp.Tsf.ObjBase.RepStatus=function(e){return(e||teasp.constant.STATUS_NOTREQUEST
)!=teasp.constant.STATUS_NOTREQUEST||tsfManager.isExpWorkflow()?e:teasp.constant.STATUS_NOTADMIT},teasp.Tsf.ObjBase.prototype.mergePiwks=function(e){for(var t=this.isCancelApplyWait()?this.getCancelApplyId():this.obj.Id,s=0;s<e.length;s++)t==e[s].ProcessInstance.TargetObjectId&&(this.obj._piwk=!0)},teasp.Tsf.ObjBase.prototype.getRights=function(){return this.rights},teasp.Tsf.ObjBase.prototype.setRights=function(e){
this.rights=e},teasp.Tsf.ObjBase.prototype.isRightOn=function(e){return 0!=(this.rights&e)},teasp.Tsf.ObjBase.prototype.getDataObj=function(){return this.obj||{}},teasp.Tsf.ObjBase.prototype.getValue=function(e){return teasp.Tsf.ObjBase.getValue(this.obj,e)},teasp.Tsf.ObjBase.prototype.getId=function(){return this.obj.Id||null},teasp.Tsf.ObjBase.prototype.equalId=function(e){return teasp.Tsf.util.equalId(this.obj.Id,
e)},teasp.Tsf.ObjBase.prototype.getEmpId=function(){return this.obj.EmpId__c||null},teasp.Tsf.ObjBase.prototype.getCancelApplyId=function(){return this.obj.ExpCancelApplyId__c||null},teasp.Tsf.ObjBase.prototype.createNewObj=function(e){return null},teasp.Tsf.ObjBase.prototype.getEmpName=function(){return this.obj.EmpId__r.Name||""},teasp.Tsf.ObjBase.prototype.getEmpExpItemClass=function(){
return this.obj.EmpId__r.ExpItemClass__c||""},teasp.Tsf.ObjBase.prototype.getDeptId=function(e){return this.obj.DeptId__c||!e&&tsfManager.getTargetEmp().getDeptId()||null},teasp.Tsf.ObjBase.prototype.getDept=function(e){return this.obj.DeptId__r||!e&&tsfManager.getTargetEmp().getDept()||null},teasp.Tsf.ObjBase.prototype.getDeptName=function(e){
return this.obj.DeptId__r&&this.obj.DeptId__r.Name||!e&&tsfManager.getTargetEmp().getDeptName()||null},teasp.Tsf.ObjBase.prototype.getDeptExpItemClass=function(e){return this.obj.DeptId__r&&this.obj.DeptId__r.ExpItemClass__c||!e&&tsfManager.getTargetEmp().getDeptExpItemClass()||null},teasp.Tsf.ObjBase.prototype.getLastModifiedDate=function(){return this.obj.LastModifiedDate},
teasp.Tsf.ObjBase.prototype.getLastModifiedBy=function(){return this.obj.LastModifiedBy&&this.obj.LastModifiedBy.Name||null},teasp.Tsf.ObjBase.prototype.getStartDate=function(){return this.obj.StartDate__c&&"number"==typeof this.obj.StartDate__c&&(this.obj.StartDate__c=teasp.util.date.formatDate(this.obj.StartDate__c)),this.obj.StartDate__c},teasp.Tsf.ObjBase.prototype.getEndDate=function(){
return this.obj.EndDate__c&&"number"==typeof this.obj.EndDate__c&&(this.obj.EndDate__c=teasp.util.date.formatDate(this.obj.EndDate__c)),this.obj.EndDate__c},teasp.Tsf.ObjBase.changeStatus=function(e,t){e=e||teasp.constant.STATUS_NOTREQUEST;return e!=teasp.constant.STATUS_NOTREQUEST||tsfManager.isExpWorkflow()?e:teasp.constant.STATUS_NOTADMIT},teasp.Tsf.ObjBase.prototype.getStatus=function(e){
return teasp.Tsf.ObjBase.changeStatus(this.obj.StatusC__c,e)},teasp.Tsf.ObjBase.prototype.getStatusD=function(e){return teasp.Tsf.ObjBase.changeStatus(this.obj.StatusD__c,e)},teasp.Tsf.ObjBase.prototype.isRemoved=function(){return!1},teasp.Tsf.ObjBase.prototype.getCancelApplyStatus=function(){return this.obj.ExpCancelApplyId__r&&this.obj.ExpCancelApplyId__r.Status__c||null},
teasp.Tsf.ObjBase.prototype.isCancelApplyWait=function(){return teasp.constant.STATUS_WAIT==this.getCancelApplyStatus()},teasp.Tsf.ObjBase.prototype.getTypeName=function(){return teasp.constant.EXP_FORM0},teasp.Tsf.ObjBase.STATUS_ICON_MAP={"未申請":"sts004","承認待ち":"sts008","承認済み":"sts005","確定済み":"sts005","申請済み":"sts005","精算済み":"sts003","却下":"sts006","申請取消":"sts004","仕訳済み":"sts010","取消伝票承認済み":"sts011","取消伝票承認待ち":"sts012"
},teasp.Tsf.ObjBase.prototype.getStatusIcon=function(){return teasp.Tsf.ObjBase.STATUS_ICON_MAP[this.getStatusD(!0)]},teasp.Tsf.ObjBase.prototype.getApplyButtonLabel=function(){return!this.isManifestEditMode()&&this.isEditable(!1,!0)?teasp.message.getLabel(tsfManager.isExpWorkflow()?"applyx_btn_title":"fix_btn_title"):null},teasp.Tsf.ObjBase.prototype.isApproved=function(){
return teasp.constant.STATUS_APPROVES.contains(this.getStatus())||this.isPaid()},teasp.Tsf.ObjBase.prototype.isWait=function(){return teasp.constant.STATUS_WAIT==this.getStatus()},teasp.Tsf.ObjBase.prototype.isReject=function(){return teasp.constant.STATUS_REJECTS.contains(this.getStatus())},teasp.Tsf.ObjBase.prototype.isCancel=function(){return teasp.constant.STATUS_CANCELS.contains(this.getStatus())},
teasp.Tsf.ObjBase.prototype.isPaid=function(){return teasp.constant.STATUS_PAYD==this.getStatus()},teasp.Tsf.ObjBase.prototype.isEditableStatus=function(){return teasp.constant.STATUS_EDITABLE.contains(this.getStatus())},teasp.Tsf.ObjBase.prototype.isValidCancelApply=function(){return this.obj.StatusD__c==teasp.constant.STATUS_CANCEL_WAIT||this.obj.StatusD__c==teasp.constant.STATUS_CANCEL_APPROVE},
teasp.Tsf.ObjBase.prototype.setMode=function(e){this.mode=e},teasp.Tsf.ObjBase.prototype.getMode=function(){return this.mode},teasp.Tsf.ObjBase.prototype.isManifestEditMode=function(){return this.mode&&!teasp.Tsf.Manager.isReadMode(this.getMode())},teasp.Tsf.ObjBase.prototype.isStrongCancel=function(){return this.obj.ExpCancelApplyId__c&&teasp.constant.STATUS_APPROVES.contains(this.obj.ExpCancelApplyId__r.Status__c)}
,teasp.Tsf.ObjBase.prototype.isReadMode=function(e){return!this.isRightOn(teasp.constant.P_E|teasp.constant.P_AX)||(!!this.isStrongCancel()||!this.isManifestEditMode()&&(!e&&tsfManager.isReadMode()))},teasp.Tsf.ObjBase.prototype.isReadOnly=function(){return!this.isManifestEditMode()&&(!!this.isReadMode()||!this.isEditable())},teasp.Tsf.ObjBase.prototype.isEditable=function(e,t){return!this.isReadMode(t)&&(!(
!e||!this.isManifestEditMode())||this.isEditableStatus())},teasp.Tsf.ObjBase.prototype.getCancelLabel=function(){return this.isCancelApplyWait()?teasp.message.getLabel("tf10006230"):teasp.Tsf.ObjBase.getCancelApplyLabel(this.getStatus())},teasp.Tsf.ObjBase.prototype.isCancelable=function(){return!this.isReadMode()&&(this.isPaid()?!!tsfManager.isUseExpCancelApply():this.isApproved()?tsfManager.isUseExpCancelApply(
)||tsfManager.isExpAdmin():!this.isEditable())},teasp.Tsf.ObjBase.prototype.isUnknotable=function(){return!1},teasp.Tsf.ObjBase.prototype.getUnknotWarning=function(){return null},teasp.Tsf.ObjBase.prototype.isChangableEditMode=function(){return!this.isPaid()&&(!teasp.constant.STATUS_FIX.contains(this.getCancelApplyStatus())&&(!this.isManifestEditMode()&&(!!(this.isEditableStatus()&&this.isRightOn(
teasp.constant.P_E|teasp.constant.P_AX)&&tsfManager.isReadMode())||(!(this.isEditableStatus()||!tsfManager.isAllowEditExpAdmin()||!tsfManager.isExpAdmin())||!(!this.isWait()||!tsfManager.isAllowEditManager())&&(e=teasp.constant.P_MA|teasp.constant.P_DM|teasp.constant.P_D1|teasp.constant.P_D2|teasp.constant.P_SS|teasp.constant.P_AD|teasp.constant.P_AE|teasp.constant.P_AX,e&=~teasp.constant.P_ME,this.isRightOn(e))))));
var e},teasp.Tsf.ObjBase.prototype.isDeletable=function(){if(!this.getId()||tsfManager.isReadMode()||!this.isEditableStatus())return!1;if(this.isValidCancelApply())return!1;var e=teasp.constant.P_E|teasp.constant.P_MA|teasp.constant.P_DM|teasp.constant.P_D1|teasp.constant.P_D2|teasp.constant.P_SS|teasp.constant.P_AD|teasp.constant.P_AE|teasp.constant.P_AX;return this.isRightOn(e)},
teasp.Tsf.ObjBase.prototype.isCopyable=function(){if(!this.getId())return!1;var e=teasp.constant.P_E|teasp.constant.P_MA|teasp.constant.P_DM|teasp.constant.P_D1|teasp.constant.P_D2|teasp.constant.P_SS|teasp.constant.P_AD|teasp.constant.P_AE|teasp.constant.P_AX;return this.isRightOn(e)},teasp.Tsf.ObjBase.prototype.isApplyable=function(){return this.isEditable()},teasp.Tsf.ObjBase.prototype.getStatusInfo=function(){
return{text:teasp.constant.getDisplayStatus(this.getStatusD(!0)),icon:this.getStatusIcon()}},teasp.Tsf.ObjBase.prototype.isPiwk=function(){return!this.isManifestEditMode()&&this.obj._piwk||!1},teasp.Tsf.ObjBase.prototype.setTrashBox=function(t,e){this.trashs||(this.trashs={}),this.trashs[t]||(this.trashs[t]={}),dojo.forEach(e,function(e){e.Id&&(this.trashs[t][e.Id]=e)},this)},
teasp.Tsf.ObjBase.prototype.getRemoveIdList=function(e){var t,s=[],a=this.trashs&&this.trashs[e]||{};for(t in a)a.hasOwnProperty(t)&&s.push(t);return s},teasp.Tsf.ObjBase.prototype.clearTrashs=function(e){this.trashs&&(this.trashs[e]={})},teasp.Tsf.ObjBase.prototype.isRemovedExp=function(e){return!!(this.trashs&&this.trashs[teasp.Tsf.formParams.sectionDetail.discernment]||{})[e]},
teasp.Tsf.ObjBase.prototype.getSectionValuesByUniqKey=function(e,t){for(var s=this.getSectionValues(e),a=s.length-1;0<=a;a--){var o=s[a];if(o._uniqKey==t)return o}return null},teasp.Tsf.ObjBase.prototype.setSectionValueByUniqKey=function(e,t,s){for(var a=this.getSectionValues(e),o=a.length-1;0<=o;o--)if(a[o]._uniqKey==t){a.splice(o,1,s);break}},teasp.Tsf.ObjBase.prototype.deleteSectionValueByUniqKey=function(e,t){
for(var s=this.getSectionValues(e),a=s.length-1;0<=a;a--)if(s[a]._uniqKey==t){this.setTrashBox(e,s.splice(a,1));break}},teasp.Tsf.ObjBase.prototype.isSolve=function(){return!1},teasp.Tsf.ObjBase.prototype.linkPreApplyAll=function(){},teasp.Tsf.ObjBase.prototype.linkPreApply=function(e){},teasp.Tsf.ObjBase.prototype.getSavedDetails=function(){var e=this.obj.SavedDetails__c;return(
e=e&&"string"==typeof e?this.obj.SavedDetails__c=teasp.Tsf.util.fromJson(e):e)||{}},teasp.Tsf.ObjBase.prototype.getSavedSteps=function(){return this.getSavedDetails().savedStepsV5||[]},teasp.Tsf.ObjBase.prototype.mergeSteps=function(e){var t=this.getSavedSteps(),s=[],t=(dojo.forEach(t,function(e){s.push({CreatedDate:e.createdDate,StepStatus:e.stepStatus,OriginalActor:null,Actor:{Name:e.actorName},Comments:e.comments}
)}),e.concat(s));return dojo.forEach(t,function(e){e.CreatedDate=teasp.util.date.formatDateTime(e.CreatedDate)}),t=t.sort(function(e,t){return e.CreatedDate<t.CreatedDate?1:-1})},teasp.Tsf.ObjBase.prototype.getSectionDetailCount=function(){return 1},teasp.Tsf.ObjBase.prototype.canDiffView=function(){return!1},teasp.Tsf.ObjBase.prototype.getExpPreApplyId=function(){return null},teasp.Tsf.ObjBase.covertEmpExp=function(
e){e.Date__c&&"number"==typeof e.Date__c&&(e.Date__c=teasp.util.date.formatDate(e.Date__c)),e.PaymentDate__c&&"number"==typeof e.PaymentDate__c&&(e.PaymentDate__c=teasp.util.date.formatDate(e.PaymentDate__c))},teasp.Tsf.ObjBase.prototype.createEmpExpFromExp=function(e){var t,s,a,o,i,p=tsfManager.getExpItemById(e.ExpItemId__c),r=teasp.util.date.formatDate(new Date),r={_uniqKey:teasp.Tsf.ExpApply.createUniqKey(),
Id:null,EmpId__c:this.getEmpId(),ExpApplyId__c:this.getId(),ExpApplyId__r:{ExpPreApplyId__c:this.getExpPreApplyId()},ExpItemId__c:p.getId(),ExpItemId__r:{Name:p.getName()},Date__c:r,CardStatementLineId__c:null,Cost__c:e.Cost__c,CurrencyName__c:null,CurrencyRate__c:null,ForeignAmount__c:null,PayeeId__c:null,PayeeId__r:null,PaymentDate__c:null,UnitPrice__c:e.UnitPrice__c||null,Quantity__c:e.Quantity__c||null,
Detail__c:e.Detail__c,IsPaid__c:!1,JobId__c:e.JobId__c||null,JobId__r:e.JobId__r?{JobCode__c:e.JobId__r.JobCode__c||null,Name:e.JobId__r.Name||null,StartDate__c:e.JobId__r.StartDate__c||null,EndDate__c:e.JobId__r.EndDate__c||null}:null,ChargeDeptId__c:e.ChargeDeptId__c||null,ChargeDeptId__r:e.ChargeDeptId__r,Order__c:1,Receipt__c:p.isReceipt(),Item__c:null,TaxAuto__c:e.TaxAuto__c,TaxType__c:null,TaxRate__c:null,
Tax__c:null,WithoutTax__c:null,TransportType__c:e.TransportType__c,startCode__c:e.startCode__c,startName__c:e.startName__c,endCode__c:e.endCode__c,endName__c:e.endName__c,roundTrip__c:e.roundTrip__c,Route__c:e.Route__c,Publisher__c:e.Publisher__c,InternalParticipantsNumber__c:e.InternalParticipantsNumber__c,InternalParticipants__c:e.InternalParticipants__c,
ExternalParticipantsNumber__c:e.ExternalParticipantsNumber__c,ExternalParticipants__c:e.ExternalParticipants__c,PlaceName__c:e.PlaceName__c,PlaceAddress__c:e.PlaceAddress__c,ExtraItem1__c:e.ExtraItem1__c,ExtraItem2__c:e.ExtraItem2__c};return"1"==r.TransportType__c&&r.Date__c!=teasp.util.date.formatDate(e.Date__c)&&(r.TransportType__c="2",r.startCode__c=null,r.endCode__c=null),e.PayeeId__c&&(r.PayeeId__c=e.PayeeId__c,
r.PayeeId__r=e.PayeeId__r?{Name:e.PayeeId__r.Name||null,PayeeType__c:e.PayeeId__r.PayeeType__c||"1",ExpenseType__c:e.PayeeId__r.ExpenseType__c||null}:null),p.isForeignFlag()&&(r.CurrencyName__c=e.CurrencyName__c||null,r.ForeignAmount__c=e.ForeignAmount__c||null,(t=tsfManager.getForeignByName(r.CurrencyName__c))&&r.ForeignAmount__c&&(t=t.getRateByDate(r.Date__c),t=teasp.util.currency.formatDecimal(t,
teasp.constant.CU_DEC_POINT_MIN,teasp.constant.CU_DEC_POINT_MAX),r.CurrencyRate__c=t.n,s=p.getRecalcTarget(),i=teasp.Tsf.ExpDetail.calcForeign(r.Cost__c,t.n,r.ForeignAmount__c,s,"0"!=t.sn1?1:0,p.isAllowMinus()),s?r.Cost__c=i.cost:r.ForeignAmount__c=i.amount)),p.isTaxFlag()&&(r.TaxAuto__c?(t=p.getTaxType()||"0",s=p.isAllowMinus(),a=tsfManager.getTaxRoundFlag(),p=p.getTaxRate(r.Date__c),o=r.Cost__c,
i=teasp.Tsf.ExpDetail.calcTax(o,0,0,0,t,p,e.TaxAuto__c,a,s),r.TaxType__c=t,r.TaxRate__c=p,r.Tax__c=i.tax,r.WithoutTax__c=i.withoutTax):(r.TaxType__c=e.TaxType__c,r.TaxRate__c=e.TaxRate__c,r.Tax__c=e.Tax__c,r.WithoutTax__c=e.WithoutTax__c)),r},teasp.Tsf.ObjBase.prototype.addElement=function(e){},teasp.Tsf.ObjBase.prototype.isCreateFlag=function(){return!0},teasp.Tsf.ObjBase.prototype.getAttachments=function(){
return this.obj.Attachments||[]},teasp.Tsf.ObjBase.prototype.setAttachments=function(e){this.obj.Attachments=e},teasp.Tsf.ObjBase.prototype.getApplyTime=function(){return this.obj.ApplyTime__c?teasp.util.date.formatDateTime(this.obj.ApplyTime__c,"SLA-HM"):""},teasp.Tsf.ObjBase.prototype.getLastApprovedTime=function(){if(this.obj.ExpCancelApplyId__r&&teasp.constant.STATUS_APPROVES.contains(
this.obj.ExpCancelApplyId__r.Status__c))return teasp.util.date.formatDateTime(this.obj.ExpCancelApplyId__r.ApproveTime__c,"SLA-HM");if(!["承認済み","精算済み"].contains(this.obj.StatusC__c))return"";var e=this.steps||[];return 0<e.length?teasp.util.date.formatDateTime(e[0].CreatedDate,"SLA-HM"):""},teasp.Tsf.ObjBase.prototype.getLastApprover=function(){if(this.obj.ExpCancelApplyId__r&&teasp.constant.STATUS_APPROVES.contains(
this.obj.ExpCancelApplyId__r.Status__c))return this.obj.ExpCancelApplyId__r.ApproverId__r&&this.obj.ExpCancelApplyId__r.ApproverId__r.Name||"";if(!["承認済み","精算済み"].contains(this.obj.StatusC__c))return"";var e=this.steps||[];return 0<e.length&&e[0].Actor?e[0].Actor.Name:""},teasp.Tsf.ObjBase.prototype.getProvisionalPaymentId=function(){return this.obj.ProvisionalPaymentId__c||null},
teasp.Tsf.ObjBase.prototype.getComment=function(){return this.obj.Comment__c||null},teasp.Tsf.ObjBase.prototype.getAttachmentAllCount=function(){return 0},teasp.Tsf.ObjBase.prototype.isShowMisMatch=function(){return!!this.isManifestEditMode()||![teasp.constant.STATUS_ADMIT,teasp.constant.STATUS_APPROVE,teasp.constant.STATUS_PAYD,teasp.constant.STATUS_CANCEL_WAIT,teasp.constant.STATUS_CANCEL_APPROVE,
teasp.constant.STATUS_JOURNAL].contains(this.obj.StatusD__c)},teasp.Tsf.ObjBase.prototype.createOrgExpIds=function(e){this.orgExpIds=[],dojo.forEach(e||[],function(e){this.orgExpIds.push(e.Id)},this)},teasp.Tsf.ObjBase.prototype.getRemoveExpIds=function(e){return this.getId()?[]:this.getRemoveIdList(teasp.Tsf.formParams.sectionDetail.discernment)},teasp.Tsf.Dept=function(e){this.dept=e},
teasp.Tsf.Dept.createList=function(e){for(var t=0;t<e.length;t++)e[t].DeptCode__c=e[t].DeptCode__c||e[t].code||"",e[t].order=0;e=e.sort(function(e,t){return e.DeptCode__c<t.DeptCode__c?-1:e.DeptCode__c>t.DeptCode__c?1:0});function n(e,t,s){for(var a=t?t.Id:null,o=0;o<e.length;o++){var i=e[o];if(i.ParentId__c==a){t&&(t.parentFlag=!0,i.parentMap=t.parentMap?teasp.Tsf.Dom.clone(t.parentMap):{},i.parentMap[t.Id]=t.level,
l[a]=t),i.level=t?t.level+1:1;for(var p="",r=1;r<i.level;r++)p+="&nbsp;&nbsp;";i.displayName=p+i.DeptCode__c+"-"+i.Name,i.order=s.order++,n(e,i,s)}}}var l={},s=(n(e,null,{order:1}),e=e.sort(function(e,t){return e.order-t.order}),[]);return dojo.forEach(e,function(e){e.ParentId__c&&!l[e.ParentId__c]||this.push(new teasp.Tsf.Dept(e))},s),s},teasp.Tsf.Dept.getUnderDeptIds=function(e,t){function i(e,t,s){for(
var a=0;a<e.length;a++){var o=e[a];o.getParentId()==t&&(s.push(o.getId()),i(e,o.getId(),s))}}var s=[t];return i(e,t,s),s},teasp.Tsf.Dept.prototype.getId=function(){return this.dept.Id||null},teasp.Tsf.Dept.prototype.getParentId=function(){return this.dept.ParentId__c||null},teasp.Tsf.Dept.prototype.getName=function(){return this.dept.Name||""},teasp.Tsf.Dept.prototype.getDisplayName=function(){
return this.dept.displayName||""},teasp.Tsf.Dept.prototype.getObj=function(){return this.dept},teasp.Tsf.Job=function(e){this.job=e},teasp.Tsf.Job.createListFromJobAssign=function(e){var t=[];if(!e||e.length<=0)return t;var s={};return dojo.forEach(e,function(e){e.JobId__c&&e.JobId__r&&!s[e.JobId__c]&&e.IsAssigned__c&&(t.push(new teasp.Tsf.Job({Id:e.JobId__c,JobCode__c:e.JobId__r.JobCode__c||"",
Name:e.JobId__r.Name||"",IsAssigned__c:e.IsAssigned__c,JobAssignId:e.Id,StartDate__c:e.JobId__r.StartDate__c||null,EndDate__c:e.JobId__r.EndDate__c||null,Active__c:void 0===e.JobId__r.Active__c||e.JobId__r.Active__c})),s[e.JobId__c]=1)}),t},teasp.Tsf.Job.prototype.getId=function(){return this.job.Id||null},teasp.Tsf.Job.prototype.getName=function(){return this.job.Name||""},teasp.Tsf.Job.prototype.getCode=function(){
return this.job.JobCode__c||""},teasp.Tsf.Job.prototype.getDisplayName=function(){return(this.job.JobCode__c||"")+teasp.Tsf.JOB_CODE_NAME_DIV+(this.job.Name||"")},teasp.Tsf.Job.prototype.getStartDate=function(){return this.job.StartDate__c&&"number"==typeof this.job.StartDate__c&&(this.job.StartDate__c=teasp.util.date.formatDate(this.job.StartDate__c)),this.job.StartDate__c},
teasp.Tsf.Job.prototype.getEndDate=function(){return this.job.EndDate__c&&"number"==typeof this.job.EndDate__c&&(this.job.EndDate__c=teasp.util.date.formatDate(this.job.EndDate__c)),this.job.EndDate__c},teasp.Tsf.Job.prototype.activeOnDate=function(e,t){if(!e&&!t)return!0;var s=this.getStartDate(),a=this.getEndDate();return e&&t?(!s||s<=t)&&(!a||e<=a):(e=e||t,(!s||s<=e)&&(!a||e<=a))},
teasp.Tsf.Job.prototype.getObj=function(){return this.job},teasp.Tsf.ExpItem=function(e){this.expItem=e,this.config=e.Config__c&&teasp.Tsf.util.fromJson(e.Config__c)||{},this.EXPITEM_TOOLTIP_HKEY="expItem_toolTip"},teasp.Tsf.ExpItem.createList=function(e,t,s){var a=[];return dojo.forEach(e,function(e){(e.ForAdjustment__c||!1)==t&&(e.ForPayable__c||!1)==s&&this.push(new teasp.Tsf.ExpItem(e))},a),a},
teasp.Tsf.ExpItem.prototype.getId=function(){return this.expItem.Id||null},teasp.Tsf.ExpItem.prototype.getName=function(e){return(this.expItem.Name||"")+(e&&this.expItem.Code__c?teasp.message.getLabel("tk10004860",this.expItem.Code__c):"")},teasp.Tsf.ExpItem.prototype.getItemName=function(){return this.expItem.ItemName__c||""},teasp.Tsf.ExpItem.prototype.getItemNameIdeal=function(e){return(this.expItem.Name||"")+(
e&&this.expItem.ItemCode__c?teasp.message.getLabel("tk10004860",this.expItem.ItemCode__c):"")},teasp.Tsf.ExpItem.prototype.getAccountName=function(e){return(this.expItem.ItemName__c||"")+(e&&this.expItem.Code__c?teasp.message.getLabel("tk10004860",this.expItem.Code__c):"")},teasp.Tsf.ExpItem.prototype.getItemCode=function(){return this.expItem.ItemCode__c||""},teasp.Tsf.ExpItem.prototype.getAuxTitle=function(e){
return(this.expItem.AuxTitle__c||"")+(e&&this.expItem.AuxCode__c?teasp.message.getLabel("tk10004860",this.expItem.AuxCode__c):"")},teasp.Tsf.ExpItem.prototype.isRemoved=function(){return this.expItem.Removed__c||!1},teasp.Tsf.ExpItem.prototype.isAllowance=function(){return"1"==this.expItem.AllowanceFlag__c},teasp.Tsf.ExpItem.prototype.isHotel=function(){return"2"==this.expItem.AllowanceFlag__c},
teasp.Tsf.ExpItem.prototype.isSocial=function(){return"3"==this.expItem.AllowanceFlag__c},teasp.Tsf.ExpItem.prototype.getTransportType=function(){return this.expItem.TransportType__c||"0"},teasp.Tsf.ExpItem.prototype.isEkitanType=function(){return"1"==this.expItem.TransportType__c},teasp.Tsf.ExpItem.prototype.isHideWhenReadingICExpenses=function(){return this.expItem.HideWhenReadingICExpenses__c||!1},
teasp.Tsf.ExpItem.prototype.getItemTypeName=function(){switch(this.getTransportType()){case"1":return teasp.message.getLabel("tm20004430");case"2":return teasp.message.getLabel("tm20004440");default:return this.isAllowance()?teasp.message.getLabel("tf10000020"):this.isHotel()?teasp.message.getLabel("tf10000030"):this.isSocial()?teasp.message.getLabel("tf10000600"):teasp.message.getLabel("tm20004450")}},
teasp.Tsf.ExpItem.prototype.isReceipt=function(){return this.expItem.Receipt__c||!1},teasp.Tsf.ExpItem.prototype.isTaxFlag=function(){return this.expItem.TaxFlag__c||!1},teasp.Tsf.ExpItem.prototype.getTaxType=function(){return"string"!=typeof this.expItem.TaxType__c?null:parseInt(this.expItem.TaxType__c,10)},teasp.Tsf.ExpItem.prototype.getDefaultTaxRate=function(e){if(!this.expItem.DefaultTaxRate__c
)return e?teasp.message.getLabel("tf10010610"):null;var t=parseInt(this.expItem.DefaultTaxRate__c,10);return e?t+"%":t},teasp.Tsf.ExpItem.prototype.getSelectableTaxRate=function(e){if(!this.selectableTaxRate){for(var t=(this.expItem.SelectableTaxRate__c||"").split(/;/),s=[],a=0;a<t.length;a++){var o=t[a];/^\d+$/.test(o)&&(o=parseInt(o,10),s.indexOf(o)<0&&s.push(o))}s=s.sort(function(e,t){return t-e}),
this.selectableTaxRate=s}var i=this.selectableTaxRate;if(e){srates=[];for(a=0;a<i.length;a++)srates.push(i[a]+"%");return srates.join(",")}return i},teasp.Tsf.ExpItem.prototype.getSelectableTaxRateEx=function(e){var t=teasp.Tsf.Dom.clone(this.getSelectableTaxRate()),s=[];if(null===this.getDefaultTaxRate()?s=[10,8]:s.push(this.getDefaultTaxRate()),"number"==typeof e&&s.push(e),s.length){for(var a=0;a<s.length;a++
)t.indexOf(s[a])<0&&t.push(s[a]);t=t.sort(function(e,t){return t-e})}return t},teasp.Tsf.ExpItem.prototype.getTaxRate=function(e,t){var s=this.getDefaultTaxRate();if(null!==s)return"number"==typeof t&&0<=this.getSelectableTaxRate().indexOf(t)?t:s;t=e?"string"==typeof e?teasp.util.date.parseDate(e):e:new Date;return 2019<t.getFullYear()||2019<=t.getFullYear()&&10<=t.getMonth()+1?10:2014<t.getFullYear(
)||2014<=t.getFullYear()&&4<=t.getMonth()+1?8:5},teasp.Tsf.ExpItem.prototype.getTaxTypeName=function(){switch(this.getTaxType()){case 1:return teasp.message.getLabel("tm20001210");case 2:return teasp.message.getLabel("tm20001220");default:return teasp.message.getLabel("tm20001230")}},teasp.Tsf.ExpItem.prototype.getTaxRoundName=function(){switch(tsfManager.getTaxRoundFlag()){case 1:return teasp.message.getLabel(
"tm20004380");case 2:return teasp.message.getLabel("tm20004390");default:return teasp.message.getLabel("tm20004400")}},teasp.Tsf.ExpItem.prototype.getTaxCode=function(e,t){var s=null;if(e&&"number"==typeof t)if(e<"2019-10-01")switch(t){case 0:s=this.expItem.TaxCode2014_00__c||"";break;case 5:s=this.expItem.TaxCode2014_05__c||"";break;case 8:s=this.expItem.TaxCode2014_08__c||"";break;case 10:
s=this.expItem.TaxCode2019_10__c||""}else switch(t){case 0:s=this.expItem.TaxCode2019_00__c||"";break;case 5:s=this.expItem.TaxCode2019_05__c||"";break;case 8:s=this.expItem.TaxCode2019_08__c||"";break;case 10:s=this.expItem.TaxCode2019_10__c||""}return s||this.expItem.TaxCode__c||""},teasp.Tsf.ExpItem.prototype.isAllowMinus=function(){return this.expItem.AllowMinus__c||!1},
teasp.Tsf.ExpItem.prototype.isAmountReadOnly=function(){return this.isFixAmount()||this.isEnableQuantity()},teasp.Tsf.ExpItem.prototype.isFixAmount=function(){return this.expItem.FixAmount__c||!1},teasp.Tsf.ExpItem.prototype.getCost=function(e,t){return t&&"number"!=typeof this.expItem.Cost__c?null:e&&this.isForeignFlag()&&this.getCurrencyName()?(t=tsfManager.getForeignByName(this.getCurrencyName()))?(
t=t.getRateByDate(e),e=this.expItem.Cost__c||0,teasp.Tsf.ExpDetail.calcForeign(0,t,e,2,0,this.isAllowMinus()).cost):0:this.expItem.Cost__c||0},teasp.Tsf.ExpItem.prototype.getCostFormat=function(e){var t,s=this.expItem.Cost__c||0;return this.isForeignFlag()&&this.getCurrencyName()?(t=tsfManager.getForeignByName(this.getCurrencyName()),teasp.util.currency.formatDecimal(s,teasp.constant.CU_DEC_POINT_MIN,
teasp.constant.CU_DEC_POINT_MAX,!0).str+(t&&t.getYomi()||"")):teasp.Tsf.Currency.formatMoney(s,teasp.Tsf.Currency.S_YEN,!0,!0)+(!e&&this.isFixAmount()?teasp.message.getLabel("tk10004860",teasp.message.getLabel("tm20004585")):"")},teasp.Tsf.ExpItem.prototype.isForeignFlag=function(){return this.expItem.ForeignFlag__c||!1},teasp.Tsf.ExpItem.prototype.getCurrencyName=function(){return this.expItem.CurrencyName__c||null}
,teasp.Tsf.ExpItem.prototype.isEnableQuantity=function(){return this.expItem.EnableQuantity__c||!1},teasp.Tsf.ExpItem.prototype.getUnitName=function(){return this.expItem.UnitName__c||null},teasp.Tsf.ExpItem.prototype.getNote=function(){return this.expItem.Note__c||""},teasp.Tsf.ExpItem.prototype.isRestrictTargetEmployee=function(){return this.expItem.RestrictTargetEmployee__c||!1},
teasp.Tsf.ExpItem.prototype.isSelectable=function(e){return!this.isRestrictTargetEmployee()||!(!e||!this.expItem.TargetEmployee__c)&&(this.targetEmployees||(this.targetEmployees=this.expItem.TargetEmployee__c.split(/,/)),this.targetEmployees.contains(e))},teasp.Tsf.ExpItem.prototype.checkExpenseType=function(e){return!this.expItem.ExpenseType__c||(this.expenseTypes||(
this.expenseTypes=this.expItem.ExpenseType__c.split(/,/)),this.expenseTypes.contains(e))},teasp.Tsf.ExpItem.prototype.getTargetEmployee=function(){return this.expItem.TargetEmployee__c||""},teasp.Tsf.ExpItem.prototype.isUseExtraItem1=function(){return this.expItem.UseExtraItem1__c||!1},teasp.Tsf.ExpItem.prototype.isUseExtraItem2=function(){return this.expItem.UseExtraItem2__c||!1},
teasp.Tsf.ExpItem.prototype.getExtraItem=function(e){return 1==e&&this.isUseExtraItem1()?{name:this.expItem.ExtraItem1Name__c||"",require:this.expItem.ExtraItem1Require__c||!1,width:(this.expItem.ExtraItem1Width__c||130)+"px",widthN:this.expItem.ExtraItem1Width__c||0,maxLength:this.expItem.ExtraItem1LimitLength__c||255,note:(this.expItem.ExtraItem1Note__c||"").replace(/\r?\n/g,"<br/>")}:2==e&&this.isUseExtraItem2()?{
name:this.expItem.ExtraItem2Name__c||"",require:this.expItem.ExtraItem2Require__c||!1,width:(this.expItem.ExtraItem2Width__c||130)+"px",widthN:this.expItem.ExtraItem2Width__c||0,maxLength:this.expItem.ExtraItem2LimitLength__c||255,note:(this.expItem.ExtraItem2Note__c||"").replace(/\r?\n/g,"<br/>")}:null},teasp.Tsf.ExpItem.prototype.getRecalcTarget=function(){return this.getCost()&&!this.getCurrencyName(
)||this.isEkitanType()?0:2},teasp.Tsf.ExpItem.prototype.isForPayable=function(){return this.expItem.ForPayable__c||!1},teasp.Tsf.ExpItem.prototype.isRequireChargeJob=function(){var e=this.config.requireChargeJob;return e||tsfManager.getInfo().isRequireChargeJob()},teasp.Tsf.ExpItem.prototype.getToolTip=function(e,t,s){var a=null,a=tsfManager.getInfo().isExpItemRevise()?[{n:teasp.message.getLabel("tf10007850"),
v:this.getItemNameIdeal(!0)},{n:teasp.message.getLabel("tf10007870"),v:this.getAccountName(!0)}]:[{n:teasp.message.getLabel("tm20004560"),v:this.getItemName()},{n:teasp.message.getLabel("tm20004570"),v:this.getName(!0)}],o=this.getAuxTitle(!0),i=(o&&a.push({n:teasp.message.getLabel("tm20004575"),v:o}),e?a.push({n:teasp.message.getLabel("tk10005460"),v:this.getTaxCode()}):(a.push({n:teasp.message.getLabel("tm20004640"
),v:this.getItemTypeName()}),(o=this.getCostFormat())&&a.push({n:teasp.message.getLabel("tm20004580"),v:o}),a.push({n:teasp.message.getLabel("tm20004586"),v:teasp.message.getLabel(this.isAllowMinus()?"tm20004360":"tm20004370")}),a.push({n:teasp.message.getLabel("taxOn_btn_title"),v:teasp.message.getLabel(this.isTaxFlag()?"tm20004360":"tm20004370")}),this.isTaxFlag()&&(a.push({n:teasp.message.getLabel("tk10000076"),
v:this.getTaxTypeName()}),a.push({n:teasp.message.getLabel("tf10010590"),v:this.getDefaultTaxRate(!0)}),a.push({n:teasp.message.getLabel("tf10010600"),v:this.getSelectableTaxRate(!0)||teasp.message.getLabel("tm10010150")}),a.push({n:teasp.message.getLabel("tm20004620"),v:this.getTaxRoundName()})),a.push({n:teasp.message.getLabel("tk10005460"),v:this.getTaxCode(t,s)}),a.push({n:teasp.message.getLabel("tm20004630"),
v:teasp.message.getLabel(this.isForeignFlag()?"tm20004360":"tm20004370")}),this.isForeignFlag()&&a.push({n:teasp.message.getLabel("tf10000150"),v:this.getCurrencyName()||""}),a.push({n:teasp.message.getLabel("tm20004730"),v:teasp.message.getLabel(this.isEnableQuantity()?"tm10010140":"tm10010150")}),this.isEnableQuantity()&&a.push({n:teasp.message.getLabel("tf10000040"),v:this.getUnitName()||""}),a.push({
n:teasp.message.getLabel("tf10000050"),v:teasp.message.getLabel(this.isRestrictTargetEmployee()?"tm10010140":"tm10010150")}),a.push({n:teasp.message.getLabel("receipt_btn_title"),v:teasp.message.getLabel(this.isReceipt()?"tm20004340":"tm20004350")}),this.isUseExtraItem1()&&a.push({n:teasp.message.getLabel("tm20004576"),v:this.getExtraItem(1).name}),this.isUseExtraItem2()&&a.push({n:teasp.message.getLabel("tm20004577"
),v:this.getExtraItem(2).name})),a.push({n:teasp.message.getLabel("tm20004650"),v:this.getNote()}),"");return dojo.forEach(a,function(e){e&&(i+='<tr><td style="min-width:80px;">'+(e.n||"")+"</td><td>"+(e.v||"")+"</td></tr>")}),'<div style="overflow:hidden;padding:0px;margin:0px;"><table class="ts-expItem-tip">'+i+"</table></div>"},teasp.Tsf.ExpItem.prototype.getInternalParticipantsTemplateText=function(){
return this.expItem.InternalParticipantsTemplateText__c||""},teasp.Tsf.ExpItem.prototype.getExternalParticipantsTemplateText=function(){return this.expItem.ExternalParticipantsTemplateText__c||""},teasp.Tsf.ExpItem.prototype.isValidInternalParticipants=function(){return"string"==typeof this.expItem.InternalParticipants__c},teasp.Tsf.ExpItem.prototype.isValidExternalParticipants=function(){
return"string"==typeof this.expItem.ExternalParticipants__c},teasp.Tsf.ExpItem.prototype.isInternalParticipants=function(){return"string"==typeof this.expItem.InternalParticipants__c&&!(!this.isSocial()||"1"!==this.expItem.InternalParticipants__c)},teasp.Tsf.ExpItem.prototype.isExternalParticipants=function(){return"string"==typeof this.expItem.ExternalParticipants__c&&!(!this.isSocial(
)||"1"!==this.expItem.ExternalParticipants__c)},teasp.Tsf.ExpItem.prototype.isPlace=function(){return"string"==typeof this.expItem.Place__c&&!(!this.isSocial()||"1"!==this.expItem.Place__c)},teasp.Tsf.ForeignCurrency=function(e){this.obj=e},teasp.Tsf.ForeignCurrency.NONE="---",teasp.Tsf.ForeignCurrency.createList=function(e){var s={},t=(dojo.forEach(e,function(e){var t;e.Name&&(t=e.Name.toLowerCase(),(s[t]||(
s[t]=new teasp.Tsf.ForeignCurrency(e))).addChild(e))}),[]);for(i in s)t.push(i);var t=t.sort(function(e,t){return e<t?-1:1}),a=[];a.unshift(new teasp.Tsf.ForeignCurrency({}));for(var o=0;o<t.length;o++){var i=t[o],p=s[i];p.sortChildren(),a.push(p)}return a},teasp.Tsf.ForeignCurrency.prototype.getId=function(){return this.obj.Id||""},teasp.Tsf.ForeignCurrency.prototype.getName=function(){
return this.obj.Name||teasp.Tsf.ForeignCurrency.NONE},teasp.Tsf.ForeignCurrency.prototype.addChild=function(e){this.rates||(this.rates=[]),this.rates.push(new teasp.Tsf.ForeignCurrency(e))},teasp.Tsf.ForeignCurrency.prototype.sortChildren=function(){this.rates&&(this.rates=this.rates.sort(function(e,t){return e.compareDate(t.getStartDate())}))},teasp.Tsf.ForeignCurrency.prototype.getRateByDate=function(e){if(
!this.rates)return 1;for(var t=null,s=0;s<this.rates.length;s++){var a=this.rates[s];if(!a.getStartDate()||0<=a.compareDate(e)){t=a;break}}return t?t.getRate():1},teasp.Tsf.ForeignCurrency.prototype.getRate=function(){return this.obj.Rate__c||1},teasp.Tsf.ForeignCurrency.prototype.getYomi=function(){return this.obj.Yomi__c||""},teasp.Tsf.ForeignCurrency.prototype.compareDate=function(e){var t=this.getStartDate();
return!t&&e?1:t&&!e?-1:t==e?0:t<e?1:-1},teasp.Tsf.ForeignCurrency.prototype.getStartDate=function(){return"number"==typeof this.obj.StartDate__c&&(this.obj.StartDate__c=teasp.util.date.formatDate(this.obj.StartDate__c)),this.obj.StartDate__c},teasp.Tsf.Emp=function(e){e=e||{};this.org=e,this.emp=e.emp||{},this.setCommuterPasses(e.commuterPasses||[]),this.jobAssigns=teasp.Tsf.Job.createListFromJobAssign(
e.jobAssigns||[]),this.approverSet=e.approverSet||[]},teasp.Tsf.Emp.prototype.getJobAssigns=function(){return this.jobAssigns},teasp.Tsf.Emp.prototype.getEmp=function(){return this.emp},teasp.Tsf.Emp.prototype.clone=function(){return new teasp.Tsf.Emp(this.org)},teasp.Tsf.Emp.prototype.getEmpId=function(){return this.emp.Id||""},teasp.Tsf.Emp.prototype.getEmpName=function(){return this.emp.Name||""},
teasp.Tsf.Emp.prototype.getEmpCode=function(){return this.emp.EmpCode__c||""},teasp.Tsf.Emp.prototype.getUserId=function(){return this.emp.UserId__c||null},teasp.Tsf.Emp.prototype.getFullPhotoUrl=function(){return(this.emp.UserId__r?this.emp.UserId__r.FullPhotoUrl:null)||""},teasp.Tsf.Emp.prototype.getSmallPhotoUrl=function(){return(this.emp.UserId__r?this.emp.UserId__r.SmallPhotoUrl:null)||""},
teasp.Tsf.Emp.prototype.getDeptId=function(){return this.emp.DeptId__c||null},teasp.Tsf.Emp.prototype.getDept=function(){return this.emp.DeptId__r||null},teasp.Tsf.Emp.prototype.getDeptName=function(){return this.emp.DeptId__r&&this.emp.DeptId__r.Name||null},teasp.Tsf.Emp.prototype.getDeptCode=function(){return this.emp.DeptId__r&&this.emp.DeptId__r.DeptCode__c||null},
teasp.Tsf.Emp.prototype.getDeptExpItemClass=function(){return this.emp.DeptId__r&&this.emp.DeptId__r.ExpItemClass__c||null},teasp.Tsf.Emp.prototype.getEmpTypeName=function(){return(this.emp.EmpTypeId__r?this.emp.EmpTypeId__r.Name:null)||""},teasp.Tsf.Emp.prototype.getManagerId=function(){return this.emp.Manager__c||null},teasp.Tsf.Emp.prototype.isExpAdmin=function(){return this.emp.IsExpAdmin__c||!1},
teasp.Tsf.Emp.prototype.isAdmin=function(){return this.emp.IsAdmin__c||!1},teasp.Tsf.Emp.prototype.isAllEditor=function(){return this.emp.IsAllEditor__c||!1},teasp.Tsf.Emp.prototype.isAllReader=function(){return this.emp.IsAllReader__c||!1},teasp.Tsf.Emp.prototype.isDeptAdmin=function(){return this.emp.IsDeptAdmin__c||!1},teasp.Tsf.Emp.prototype.isJobAdmin=function(){return this.emp.IsJobAdmin__c||!1},
teasp.Tsf.Emp.prototype.getExpHistory=function(){return this.emp.ExpHistory__c?"string"==typeof this.emp.ExpHistory__c&&(this.emp.ExpHistory__c=teasp.Tsf.util.fromJson(this.emp.ExpHistory__c)):this.emp.ExpHistory__c={},this.emp.ExpHistory__c},teasp.Tsf.Emp.prototype.isCommuterRouteLock=function(){return this.emp.CommuterRouteLock__c||!1},teasp.Tsf.Emp.prototype.isUsingReceiptSystem=function(){
return this.emp.UsingReceiptSystem__c||!1},teasp.Tsf.Emp.prototype.isUsingJsNaviSystem=function(){return this.emp.UsingJsNaviSystem__c||!1},teasp.Tsf.Emp.prototype.isUsingConnectIC=function(){return this.emp.UsingConnectIC__c||!1},teasp.Tsf.Emp.prototype.getExpConfigEx=function(e){var t=teasp.Tsf.Dom.clone(this.getExpConfig()),e=this.getCommuterPass(e),s=!this.getCommuterPasses().length,a=s&&t.commuterRouteCode||null
,s=s&&t.commuterRouteNote||null;return t.commuterRouteCode=e?e.getRouteCode():a,t.commuterRouteNote=e?e.getRouteDescription():s,t.commuterRouteRoute=e?e.getRoute():null,t.commuterRouteTransfer=e&&e.getTransfer()||!1,t},teasp.Tsf.Emp.prototype.getExpConfig=function(){return this.emp.ExpConfig__c?"string"==typeof this.emp.ExpConfig__c&&(this.emp.ExpConfig__c=teasp.Tsf.util.fromJson(this.emp.ExpConfig__c)
):this.emp.ExpConfig__c={ekitanArea:-1,usePaidExpress:!0,useReservedSheet:!1,preferredAirLine:0,routePreference:0,excludeCommuterRoute:!0,commuterRouteCode:null,commuterRouteNote:null},this.emp.ExpConfig__c},teasp.Tsf.Emp.prototype.setExpConfig=function(e){this.emp.ExpConfig__c=e},teasp.Tsf.Emp.prototype.getCommuterPass=function(e){for(var t=this.getCommuterPasses(),s=0;s<t.length;s++){var a=t[s];if(a.isValid()&&(
!e||!a.getStartDate()||a.getStartDate()<=e))return a}return null},teasp.Tsf.Emp.prototype.getCommuterPasses=function(){return this.commuterPasses},teasp.Tsf.Emp.prototype.setCommuterPasses=function(e){this.commuterPasses=teasp.Tsf.CommuterPass.createList(e||[])},teasp.Tsf.Emp.prototype.mergeCommuterPassStatus=function(a){dojo.forEach(this.commuterPasses,function(e){for(var t=0;t<a.length;t++){var s=a[t];e.getId(
)==s.Id&&e.getStatus()!=s.Status__c&&e.setStatus(s.Status__c)}})},teasp.Tsf.Emp.prototype.getStationHist=function(){return this.getExpHistory().stationHist||[]},teasp.Tsf.Emp.prototype.setExpHistory=function(e,t){var s=this.getExpHistory();s.stationHist||(s.stationHist=[]),s.routeHist||(s.routeHist=[]);for(var a=s.stationHist.length-1;0<=a;a--)for(var o=s.stationHist[a],i=0;i<e.length;i++)if(e[i].name==o.name){
s.stationHist.splice(a,1);break}s.stationHist=e.concat(s.stationHist);for(a=s.routeHist.length-1;0<=a;a--)if(t==(o=s.routeHist[a])){s.routeHist.splice(a,1);break}s.routeHist.unshift(t),20<s.stationHist.length&&s.stationHist.splice(20,s.stationHist.length),10<s.routeHist.length&&s.routeHist.splice(10,s.routeHist.length)},teasp.Tsf.Emp.prototype.getExpItemClass=function(){return this.emp.ExpItemClass__c||""},
teasp.Tsf.Emp.prototype.getPayExpItemId=function(){return this.emp.PayExpItemId__c||""},teasp.Tsf.Emp.prototype.getApproverId=function(e){for(var t=null,s=0;s<this.approverSet.length;s++){var a=this.approverSet[s];if(a&&a.Type__c==e){t=a.Id;break}}return t},teasp.Tsf.Emp.prototype.getApproverNames=function(e){this.approvers||(this.approvers={});var t=this.approvers[e];if(!t){for(var s=0;s<this.approverSet.length;s++
){var a=this.approverSet[s];if(a&&a.Type__c==e){t=[a.Approver1__r?{id:a.Approver1__r.Id,name:a.Approver1__r.Name}:null,a.Approver2__r?{id:a.Approver2__r.Id,name:a.Approver2__r.Name}:null,a.Approver3__r?{id:a.Approver3__r.Id,name:a.Approver3__r.Name}:null,a.Approver4__r?{id:a.Approver4__r.Id,name:a.Approver4__r.Name}:null,a.Approver5__r?{id:a.Approver5__r.Id,name:a.Approver5__r.Name}:null,a.Approver6__r?{
id:a.Approver6__r.Id,name:a.Approver6__r.Name}:null,a.Approver7__r?{id:a.Approver7__r.Id,name:a.Approver7__r.Name}:null,a.Approver8__r?{id:a.Approver8__r.Id,name:a.Approver8__r.Name}:null,a.Approver9__r?{id:a.Approver9__r.Id,name:a.Approver9__r.Name}:null,a.Approver10__r?{id:a.Approver10__r.Id,name:a.Approver10__r.Name}:null];break}}this.approvers[e]=t=t||[]}for(var o=[],i=null,s=0;s<t.length;s++){var p=t[s];
!p||i&&i==p.id||(o.push(p.name),i=i||p.id)}return o.join(", ")},teasp.Tsf.Emp.prototype.setApproverSet=function(e){this.approverSet=e||[],this.approvers={}},teasp.Tsf.Emp.prototype.getStartEndByYearMonth=function(e){return teasp.util.searchYearMonthDate(this.emp.EmpTypeId__r?this.emp.EmpTypeId__r.ConfigBaseId__r.InitialDateOfMonth__c:1,this.emp.EmpTypeId__r?this.emp.EmpTypeId__r.ConfigBaseId__r.MarkOfMonth__c:1,e)},
teasp.Tsf.Emp.prototype.getConfig=function(){return this.emp.Config__c&&"string"==typeof this.emp.Config__c&&(this.emp.Config__c=teasp.Tsf.util.fromJson(this.emp.Config__c)),this.emp.Config__c||null},teasp.Tsf.Emp.prototype.getExpenseTypes=function(){var e=this.getConfig();return e&&e.expenseTypes||[]},teasp.Tsf.Emp.prototype.getEmpJobSearchCondition=function(){
return this.emp.JobAssignClass__c?"(JobAssignClass__c like '%:"+this.emp.JobAssignClass__c+":%' or JobAssignClass__c = null)":"JobAssignClass__c = null"},teasp.Tsf.Emp.prototype.isMatchEmpJobAssignClass=function(e){if(!e)return!0;for(var t=e.split(/:/),s=t.length-1;0<=s;s--)t[s].trim()||t.splice(s,1);return t.contains(this.emp.JobAssignClass__c)},teasp.Tsf.User=function(e){this.user=e&&e.length?e[0]:e||{}},
teasp.Tsf.User.prototype.getId=function(){return this.user.Id},teasp.Tsf.User.prototype.getName=function(){return this.user.Name||""},teasp.Tsf.User.prototype.isSysAdmin=function(){return this.user.Profile.PermissionsModifyAllData||!1},teasp.Tsf.Common=function(e){this.common=e||{},this.common.Config__c&&"string"==typeof this.common.Config__c&&(this.common.Config__c=teasp.Tsf.util.fromJson(this.common.Config__c))},
teasp.Tsf.Common.prototype.getExpPreApplyConfigs=function(){if(!this.expPreApplyConfigs){var e,t=this.common.ExpPreApplyConfig__c,s=this.common.ExpPreApplyConfig__c=teasp.constant.getExpPreApplyConfig("string"==typeof t?teasp.Tsf.util.fromJson(t):t),a=("number"!=typeof s.requireChargeJob&&(s.requireChargeJob=this.common.RequireExpLinkJob__c?2:1),"number"!=typeof s.requireChargeDept&&(
s.requireChargeDept=this.common.RequireChargeDept__c?1:0),1e3),o=[];for(e in s){var i=s[e];i&&"object"==typeof i&&!dojo.isArray(i)&&!i.removed&&i.view&&(void 0===i.order&&(i.order=a++),i.key=e,i.name=i.msgId?teasp.message.getLabel(i.msgId):e,o.push(i))}o=o.sort(function(e,t){return e.order-t.order}),s.views=o,this.expPreApplyConfigs=s}return this.expPreApplyConfigs},
teasp.Tsf.Common.prototype.getExpPreApplyConfigByName=function(e){return this.getExpPreApplyConfigs(),this.common.ExpPreApplyConfig__c[e]||{}},teasp.Tsf.Common.prototype.getExpPreApplyConfigByView=function(e){for(var t=this.getExpPreApplyConfigs().views,s=0;s<t.length;s++)if(t[s].view==e)return t[s];return null},teasp.Tsf.Common.prototype.getExpCouponList=function(){var e;return this.expCouponList||(
e=this.common.ExpCouponList__c||"",this.expCouponList=e.split(/\r?\n/)),this.expCouponList},teasp.Tsf.Common.prototype.getTaxRoundFlag=function(){return parseInt(this.common.TaxRoundFlag__c||"0",10)},teasp.Tsf.Common.prototype.getTicketPeriod=function(){return this.common.TicketPeriod__c||"1"},teasp.Tsf.Common.prototype.isExpWorkflow=function(){return this.common.ExpWorkflow__c||!1},
teasp.Tsf.Common.prototype.isUseExpApproverSet=function(){return this.isExpWorkflow()&&this.common.UseExpApproverSet__c||!1},teasp.Tsf.Common.prototype.isCommuterPassWorkflow=function(){return this.common.CommuterPassWorkflow__c||!1},teasp.Tsf.Common.prototype.isAllowEditExpAdmin=function(){return this.common.AllowEditExpAdmin__c||!1},teasp.Tsf.Common.prototype.isAllowEditManager=function(){
return this.common.AllowEditManager__c||!1},teasp.Tsf.Common.prototype.isOutputJournal=function(){return"0"!=this.common.OutputJournal__c},teasp.Tsf.Common.prototype.isRequireNote=function(e){if(!e||!this.common.RequireNote__c)return!1;var t=(this.common.RequireNoteOption__c||"").split(",");return!!(1==t.length&&!t[0]||t.contains("all")||t.contains(e))},teasp.Tsf.Common.prototype.isRequireChargeJob=function(){
return this.getExpPreApplyConfigs().requireChargeJob},teasp.Tsf.Common.prototype.isRequireChargeDept=function(){return this.getExpPreApplyConfigs().requireChargeDept},teasp.Tsf.Common.prototype.getExpCountLimit=function(){return this.getExpPreApplyConfigs().expCountLimit||100},teasp.Tsf.Common.prototype.isExpLinkDocument=function(){return this.common.ExpLinkDocument__c||!1},
teasp.Tsf.Common.prototype.getUseEkitan=function(){return"利用しない"==this.common.UseEkitan__c?0:"string"!=typeof this.common.EkitanICCardMode__c?this.common.CheckWorkingTime__c?2:1:"1"==this.common.EkitanICCardMode__c?2:1},teasp.Tsf.Common.prototype.getHelpLink=function(){return this.common.HelpLink__c||null},teasp.Tsf.Common.prototype.getLocalKey=function(){return(this.common.LocalKey__c||""
)+"000000000000000000000000000000"},teasp.Tsf.Common.prototype.isAllowMinusApply=function(){return"1"==this.getLocalKey().substring(14,15)},teasp.Tsf.Common.prototype.getExpStartDate=function(){return this.common.ExpStartDate__c||0},teasp.Tsf.Common.prototype.getSocialExpenseItemId=function(){return this.common.SocialExpenseItemId__c||null},teasp.Tsf.Common.prototype.getRevision=function(){
return this.common.Revision__c||null},teasp.Tsf.Common.prototype.isDisabledTimeReport=function(){return this.common.DisabledTimeReport__c||!1},teasp.Tsf.Common.prototype.isUsingReceiptSystem=function(){return this.common.UsingReceiptSystem__c||!1},teasp.Tsf.Common.prototype.isUsingJsNaviSystem=function(){return this.common.UsingJsNaviSystem__c||!1},teasp.Tsf.Common.prototype.isUseConnectICExpense=function(){
return this.common.UseConnectICExpense__c||!1},teasp.Tsf.Common.prototype.isUseScannerStorage=function(){return this.common.UseScannerStorage__c||!1},teasp.Tsf.Common.prototype.getExtraItemOutputDataName1=function(){return this.common.ExtraItemOutputDataName1__c||null},teasp.Tsf.Common.prototype.getExtraItemOutputDataName2=function(){return this.common.ExtraItemOutputDataName2__c||null},
teasp.Tsf.Common.prototype.isUseExpCancelApply=function(){return this.common.UseExpCancelApply__c||!1},teasp.Tsf.Common.prototype.getJtbExpItems=function(){return this.common.Config__c&&this.common.Config__c.jtbExpItem||{}},teasp.Tsf.Common.prototype.isUseJsNaviDummy=function(){return this.common.Config__c&&this.common.Config__c.useJsNaviDummy||!1},teasp.Tsf.Common.prototype.getExpenseAreaReferWidth=function(){
return this.common.Config__c&&this.common.Config__c.expenseAreaReferWidth||768},teasp.Tsf.Common.prototype.getExpenseAreaMinWidth=function(){return this.common.Config__c&&this.common.Config__c.expenseAreaMinWidth||1024},teasp.Tsf.Common.prototype.isUseExpPayPrint=function(){return this.common.Config__c&&this.common.Config__c.useExpPayPrint||!1},teasp.Tsf.Common.prototype.isUseExpEntryData=function(){
return this.common.Config__c&&this.common.Config__c.useExpEntryData||!1},teasp.Tsf.Common.prototype.getExpEntryDataUrl=function(){return this.common.Config__c&&this.common.Config__c.expEntryDataUrl||""},teasp.Tsf.Common.prototype.getExpPayCountMax=function(){var e=this.common.Config__c&&this.common.Config__c.expPayCountMax;return"number"==typeof e?e:2e3},teasp.Tsf.Common.prototype.isExpCancelable=function(){if(
null==this.common.Config__c||null==this.common.Config__c.expCancelDeadline)return!1;var e=new Date(this.common.Config__c.expCancelDeadline+"T00:00:00+0900");return e.setDate(e.getDate()+1),new Date<e},teasp.Tsf.EmpExp=function(e,t,s){this.obj=teasp.Tsf.Dom.clone(e||{}),this.pre=t||!1,this.hist=s||!1},teasp.Tsf.EmpExp.prototype=new teasp.Tsf.ObjBase,teasp.Tsf.EmpExp.MISMATCH_EXPENSE_TYPE=1,
teasp.Tsf.EmpExp.MISMATCH_EXPITEM_CLASS=2,teasp.Tsf.EmpExp.MISMATCH_PAY_TYPE=4,teasp.Tsf.EmpExp.MISMATCH_PAY_EXPENSE_TYPE=8,teasp.Tsf.EmpExp.MISMATCH_MASK=15,teasp.Tsf.EmpExp.EMPTY_JOB=16,teasp.Tsf.EmpExp.EMPTY_CHARGE_DEPT=32,teasp.Tsf.EmpExp.EMPTY_ROUTE=64,teasp.Tsf.EmpExp.EMPTY_EXTRA1=128,teasp.Tsf.EmpExp.EMPTY_EXTRA2=256,teasp.Tsf.EmpExp.EMPTY_MASK=496,teasp.Tsf.EmpExp.JTB_ACTUAL_OLD=512,
teasp.Tsf.EmpExp.isSpice=function(e){return e&&"spice"==e},teasp.Tsf.EmpExp.isExternalExpense=function(e){return e&&e==teasp.Tsf.ITEM_EXTERNAL},teasp.Tsf.EmpExp.isUber=function(e){return e&&"uber"==e},teasp.Tsf.EmpExp.isJtb=function(e){return e&&"JTB"==e},teasp.Tsf.EmpExp.convertExps=function(e){dojo.forEach(e||[],function(e){if(teasp.Tsf.EmpExp.isUber(e.Item__c)&&e.Route__c&&(!e.startName__c||!e.endName__c)){
var t=e.Route__c;try{"string"==typeof t&&(t=dojo.fromJson(t)),e.startName__c||(e.startName__c=t.fromAddress||""),e.endName__c||(e.endName__c=t.toAddress||"")}catch(e){}}t=e.ExternalICExpenseId__r&&e.ExternalICExpenseId__r.UsageDate__c||null;t&&"number"==typeof t&&(e.ExternalICExpenseId__r.UsageDate__c=teasp.util.date.formatDate(t))})},teasp.Tsf.EmpExp.prototype.isRemoved=function(){
return this.obj&&this.obj._removed||!1},teasp.Tsf.EmpExp.prototype.isFix=function(){return!!(this.obj&&this.obj.ExpApplyId__r&&this.obj.ExpApplyId__r.StatusC__c)&&/^(承認待ち|承認済み|確定済み)$/.test(this.obj.ExpApplyId__r.StatusC__c)},teasp.Tsf.EmpExp.prototype.isInExpApply=function(){return this.obj&&this.obj.ExpApplyId__r},teasp.Tsf.EmpExp.prototype.getAttachments=function(){return(this.obj||{}).Attachments||[]},
teasp.Tsf.EmpExp.prototype.getContentDocumentLinks=function(){return(this.obj||{}).ContentDocumentLinks||[]},teasp.Tsf.EmpExp.setAttachmentExist=function(e,t,s,a,o){teasp.Tsf.EmpExp.toggleReceiptIcon(t,o),o?((o=(o=(t=s.fetchValue(a).value)?teasp.Tsf.util.fromJson(t):[])&&teasp.Tsf.util.isArray(o)?o:[]).push({Id:"DUMMY"}),s.drawText(e,{Attachments:teasp.Tsf.util.toJson(o)},a)):s.drawText(e,{Attachments:null},a)},
teasp.Tsf.EmpExp.setAttachmentExist2=function(e,t,s,a){teasp.Tsf.EmpExp.toggleReceiptIcon(t,a),a?(t=(t=s.Attachments)&&teasp.Tsf.util.isArray(t)?t:s.Attachments=[]).push({Id:"DUMMY"}):delete s.Attachments},teasp.Tsf.EmpExp.toggleReceiptIcon=function(e,t){e=teasp.Tsf.Dom.node('input[type="button"].pp_ico_receipt'+(t?"":"_a"),e);e&&(teasp.Tsf.Dom.toggleClass(e,"pp_ico_receipt_a",t),teasp.Tsf.Dom.toggleClass(e,
"pp_ico_receipt",!t),e.title=teasp.message.getLabel(t?"attachedReceipt":"nonReceipt"))},teasp.Tsf.EmpExp.diffRoute1=function(e,t){return t?{difference:!(e&&e.startName__c==t.startName__c&&e.endName__c==t.endName__c&&e.roundTrip__c==t.roundTrip__c)}:{difference:!1}},teasp.Tsf.EmpExp.diffRoute2=function(e,t){if(!t)return{difference:!1};e=e?e.Route__c:null,t=t.Route__c;return{difference:!((
e="string"!=typeof e?teasp.Tsf.util.toJson(e):e)==(t="string"!=typeof t?teasp.Tsf.util.toJson(t):t))}},teasp.Tsf.EmpExp.diffQuantity=function(e,t){return t?{difference:!(e&&e.UnitPrice__c==t.UnitPrice__c&&e.Quantity__c==t.Quantity__c)}:{difference:!1}},teasp.Tsf.EmpExp.diffTax=function(e,t){return t?{difference:!(e&&e.Tax__c==t.Tax__c&&e.WithoutTax__c==t.WithoutTax__c)}:{difference:!1}},
teasp.Tsf.EmpExp.diffForeign=function(e,t){return t?{difference:!(e&&e.CurrencyName__c==t.CurrencyName__c&&e.CurrencyRate__c==t.CurrencyRate__c&&e.ForeignAmount__c==t.ForeignAmount__c)}:{difference:!1}},teasp.Tsf.EmpExp.diffPublisher=function(e,t){return t?{difference:!(e&&e.Publisher__c==t.Publisher__c)}:{difference:!1}},teasp.Tsf.EmpExp.diffAmountPerParticipant=function(e,t){return t?{difference:!(
e&&e.WithoutTax__c==t.WithoutTax__c&&e.InternalParticipantsNumber__c==t.InternalParticipantsNumber__c&&e.ExternalParticipantsNumber__c==t.ExternalParticipantsNumber__c)}:{difference:!1}},teasp.Tsf.EmpExp.diffInternalParticipants=function(e,t){return t?{difference:!(e&&e.InternalParticipants__c==t.InternalParticipants__c&&e.InternalParticipantsNumber__c==t.InternalParticipantsNumber__c)}:{difference:!1}},
teasp.Tsf.EmpExp.diffExternalParticipants=function(e,t){return t?{difference:!(e&&e.ExternalParticipants__c==t.ExternalParticipants__c&&e.ExternalParticipantsNumber__c==t.ExternalParticipantsNumber__c)}:{difference:!1}},teasp.Tsf.EmpExp.diffPlace=function(e,t){return t?{difference:!(e&&e.PlaceName__c==t.PlaceName__c&&e.PlaceAddress__c==t.PlaceAddress__c)}:{difference:!1}},teasp.Tsf.EmpExp.diffExtraItem1=function(e,t
){return t?{difference:!(e&&e.ExtraItem1__c==t.ExtraItem1__c)}:{difference:!1}},teasp.Tsf.EmpExp.diffExtraItem2=function(e,t){return t?{difference:!(e&&e.ExtraItem2__c==t.ExtraItem2__c)}:{difference:!1}},teasp.Tsf.EmpExp.diffPayment=function(e,t){return t?("string"!=typeof e.PaymentDate__c&&(e.PaymentDate__c=teasp.util.date.formatDate(e.PaymentDate__c)),"string"!=typeof t.PaymentDate__c&&(
t.PaymentDate__c=teasp.util.date.formatDate(t.PaymentDate__c)),{difference:!(e&&e.PayeeId__c==t.PayeeId__c&&e.PaymentDate__c==t.PaymentDate__c)}):{difference:!1}},teasp.Tsf.EmpExp.diffChargeDept=function(e,t){return t?{difference:!(e&&e.ChargeDeptId__c==t.ChargeDeptId__c)}:{difference:!1}},teasp.Tsf.EmpExp.diffInvoiceURL=function(e,t){return t?{difference:!(e&&e.InvoiceURL__c==t.InvoiceURL__c)}:{difference:!1}},
teasp.Tsf.EmpExp.prototype.isClickableReceipt=function(){return!(this.isRemoved()||this.pre||this.hist)},teasp.Tsf.EmpExp.prototype.isClickableEkitan=function(){return!this.isRemoved()&&!this.hist},teasp.Tsf.EmpExp.prototype.getExpContent=function(s,e,a,o){var i,p,t,r="",n=this.obj,l=[],c=tsfManager.getExpItemById(n.ExpItemId__c);if(!c)return l;"1"!=n.TransportType__c&&"2"!=n.TransportType__c||(h=n.startName__c||"",
f=n.endName__c||"",d=null,n.Route__c&&"string"==typeof(d=n.Route__c)&&(d=dojo.fromJson(d)),(h||f)&&(r+=teasp.message.getLabel(n.roundTrip__c?"tm20009040":"tm20009060",teasp.Tsf.util.entitizf(h),teasp.Tsf.util.entitizf(f)),d&&"1"==d.ICCardMode&&(r+="  "+teasp.message.getLabel("tk10005550")),t=s.create("div",{className:"ts-route-str",innerHTML:r}),teasp.Tsf.Fc.setBackground(t,teasp.Tsf.EmpExp.diffRoute1(n,a)),l.push(t)
),d&&d.route&&(h=new teasp.helper.EkitanRoute(d.route).createSimpleText(),t=s.create("div",{className:"ts-content-detail",innerHTML:teasp.message.getLabel("tm30001045",teasp.Tsf.util.entitizf(h))}),teasp.Tsf.Fc.setBackground(t,teasp.Tsf.EmpExp.diffRoute2(n,a)),l.push(t))),c.isEnableQuantity()&&(t=s.create("div",{className:"ts-content-detail",innerHTML:teasp.message.getLabel("tm20004720")+teasp.message.getLabel(
"tm10001590")+'<span class="ts-currency2">'+teasp.Tsf.Currency.formatMoney(n.UnitPrice__c,teasp.Tsf.Currency.V_YEN,!1,!0)+"</span>&nbsp;&nbsp;&nbsp;"+teasp.message.getLabel("tm20004730")+teasp.message.getLabel("tm10001590")+'<span class="ts-currency2">'+teasp.util.currency.formatDecimal(n.Quantity__c,0,0,!1).str+'</span><span class="ts-currency2">'+teasp.Tsf.util.entitizf(c.getUnitName())+"</span>"}),
teasp.Tsf.Fc.setBackground(t,teasp.Tsf.EmpExp.diffQuantity(n,a)),l.push(t)),c.isTaxFlag()&&(f=teasp.Tsf.ExpDetail.getTaxTypeName(n.TaxType__c),"0"==n.TaxType__c&&n.TaxAuto__c||(f+=teasp.message.getLabel("tm10001590")+'<span class="ts-currency2">'+teasp.Tsf.Currency.formatMoney(n.Tax__c,teasp.Tsf.Currency.V_YEN,!1,!0)+"</span> "+(n.TaxAuto__c?"":teasp.message.getLabel("tm20001200"))+'<span class="ts-currency2">'+(
"number"==typeof n.TaxRate__c?" "+teasp.message.getLabel("tm10001680",n.TaxRate__c+"%"):"")+"</span> "),t=s.create("div",{className:"ts-content-detail",innerHTML:f}),teasp.Tsf.Fc.setBackground(t,teasp.Tsf.EmpExp.diffTax(n,a)),l.push(t)),c.isForeignFlag()&&(t=s.create("div",{className:"ts-content-detail",innerHTML:teasp.message.getLabel("tm20001172",teasp.Tsf.util.entitize(n.CurrencyName__c,
teasp.Tsf.ForeignCurrency.NONE),teasp.util.currency.formatDecimal(n.CurrencyRate__c,teasp.constant.CU_DEC_POINT_MIN,teasp.constant.CU_DEC_POINT_MAX).str,teasp.util.currency.formatDecimal(n.ForeignAmount__c,teasp.constant.CU_DEC_POINT_MIN,teasp.constant.CU_DEC_POINT_MAX,!0).str)}),teasp.Tsf.Fc.setBackground(t,teasp.Tsf.EmpExp.diffForeign(n,a)),l.push(t)),n.Publisher__c&&(t=s.create("div",{
className:"ts-content-detail",innerHTML:teasp.message.getLabel("tm10001070",teasp.message.getLabel("tf10004960"),teasp.Tsf.util.entitizf(n.Publisher__c))}),teasp.Tsf.Fc.setBackground(t,teasp.Tsf.EmpExp.diffPublisher(n,a)),l.push(t)),(c.isInternalParticipants()||c.isExternalParticipants())&&(t=s.create("div",{className:"ts-content-detail",innerHTML:teasp.message.getLabel("tf10011000")+teasp.message.getLabel(
"tm10001590")+'<span class="ts-currency2">'+teasp.Tsf.Currency.formatMoney(n.AmountPerParticipant__c,teasp.Tsf.Currency.V_YEN,!1,!0)+"</span>"}),teasp.Tsf.Fc.setBackground(t,teasp.Tsf.EmpExp.diffAmountPerParticipant(n,a)),l.push(t)),c.isInternalParticipants()&&(t=s.create("div",{className:"ts-content-detail",innerHTML:teasp.message.getLabel("tf10011050",teasp.Tsf.util.entitize(n.InternalParticipantsNumber__c||0))}),
teasp.Tsf.Fc.setBackground(t,teasp.Tsf.EmpExp.diffInternalParticipants(n,a)),l.push(t),n.InternalParticipants__c&&(i=0,p=1,dojo.some(n.InternalParticipants__c.trim().split(/\r?\n/),function(e){var t,e=s.create("div",{className:"ts-content-detail",style:"margin-left:"+p+"em",innerHTML:teasp.Tsf.util.entitizg(e)});if(teasp.Tsf.Fc.setBackground(e,teasp.Tsf.EmpExp.diffInternalParticipants(n,a)),i+=e.innerHTML.length,
!o&&100<i)return t=100-(i-e.innerHTML.length),e.innerHTML=e.innerHTML.substring(0,t)+"...",l.push(e),!0;l.push(e),i++}))),c.isExternalParticipants()&&(t=s.create("div",{className:"ts-content-detail",innerHTML:teasp.message.getLabel("tf10011060",+teasp.Tsf.util.entitize(n.ExternalParticipantsNumber__c||0))}),teasp.Tsf.Fc.setBackground(t,teasp.Tsf.EmpExp.diffExternalParticipants(n,a)),l.push(t),
n.ExternalParticipants__c&&(i=0,p=1,dojo.some(n.ExternalParticipants__c.trim().split(/\r?\n/),function(e){var t,e=s.create("div",{className:"ts-content-detail",style:"margin-left:"+p+"em",innerHTML:teasp.Tsf.util.entitizg(e)});if(teasp.Tsf.Fc.setBackground(e,teasp.Tsf.EmpExp.diffExternalParticipants(n,a)),i+=e.innerHTML.length,!o&&100<i)return t=100-(i-e.innerHTML.length),e.innerHTML=e.innerHTML.substring(0,t)+"...",
l.push(e),!0;l.push(e),i++}))),c.isPlace()&&(m=c.getExtraItem(1),t=s.create("div",{className:"ts-content-detail",innerHTML:teasp.message.getLabel("tm10001070",teasp.message.getLabel("tf10011010"),teasp.Tsf.util.entitizf(n.PlaceName__c))}),teasp.Tsf.Fc.setBackground(t,teasp.Tsf.EmpExp.diffPlace(n,a)),l.push(t),t=s.create("div",{className:"ts-content-detail",innerHTML:teasp.message.getLabel("tf10011020")}),
teasp.Tsf.Fc.setBackground(t,teasp.Tsf.EmpExp.diffPlace(n,a)),i+=t.innerHTML.length,l.push(t),i=0,p=1,n.PlaceAddress__c&&(r=n.PlaceAddress__c.trim().split(/\r?\n/),dojo.some(r,function(e){t=s.create("div",{className:"ts-content-detail",style:"margin-left:"+p+"em",innerHTML:teasp.Tsf.util.entitizg(e)}),teasp.Tsf.Fc.setBackground(t,teasp.Tsf.EmpExp.diffPlace(n,a)),i+=t.innerHTML.length,l.push(t)}))),c.isUseExtraItem1(
)&&(m=c.getExtraItem(1),t=s.create("div",{className:"ts-content-detail",innerHTML:teasp.message.getLabel("tm10001070",teasp.Tsf.util.entitizg(m.name),teasp.Tsf.util.entitizf(n.ExtraItem1__c))}),teasp.Tsf.Fc.setBackground(t,teasp.Tsf.EmpExp.diffExtraItem1(n,a)),l.push(t)),c.isUseExtraItem2()&&(m=c.getExtraItem(2),t=s.create("div",{className:"ts-content-detail",innerHTML:teasp.message.getLabel("tm10001070",
teasp.Tsf.util.entitizg(m.name),teasp.Tsf.util.entitizf(n.ExtraItem2__c))}),teasp.Tsf.Fc.setBackground(t,teasp.Tsf.EmpExp.diffExtraItem2(n,a)),l.push(t)),!teasp.Tsf.EmpExp.isJtb(n.Item__c)&&(n.PaymentDate__c||n.PayeeName__c||n.PayeeId__c)&&(d=teasp.Tsf.util.entitizf(n.PayeeName__c||n.PayeeId__r&&n.PayeeId__r.Name),h=new teasp.Tsf.Fc({apiKey:"PaymentDate__c",domType:"date"}).parseValue(n).dispValue,t=s.create("div",{
className:"ts-content-detail",innerHTML:(d?teasp.message.getLabel("tm10001070",teasp.message.getLabel("tf10000580"),d)+"&nbsp;&nbsp;&nbsp;":"")+(h?teasp.message.getLabel("tm10001070",teasp.message.getLabel("tf10000590"),h):"")}),teasp.Tsf.Fc.setBackground(t,teasp.Tsf.EmpExp.diffPayment(n,a)),l.push(t)),!o&&n.InvoiceURL__c&&(t=s.create("a",{className:"ts-content-detail ts-content-invoiceURL",href:n.InvoiceURL__c,
target:"_blank",innerHTML:teasp.message.getLabel("ex00001241")}),teasp.Tsf.Fc.setBackground(t,teasp.Tsf.EmpExp.diffInvoiceURL(n,a)),l.push(t)),n.ChargeDeptId__c&&(t=s.create("div",{className:"ts-content-detail",innerHTML:teasp.message.getLabel("tm10001070",teasp.message.getLabel("tf10006000"),n.ChargeDeptId__r.Name||"")}),teasp.Tsf.Fc.setBackground(t,teasp.Tsf.EmpExp.diffChargeDept(n,a)),l.push(t)),
teasp.Tsf.EmpExp.isJtb(n.Item__c)&&(f=n.Text__c||"")&&(t=s.create("div",{className:"ts-content-detail",innerHTML:teasp.message.getLabel("jt13000140")+f}),l.push(t)),l.length<=0&&l.push(s.create("div",{innerHTML:"&nbsp;"}));var r=s.create("div",{className:"ts-route-icons"}),c=(l.unshift(r),n.CardStatementLineId__r&&n.CardStatementLineId__r.RecordType&&"領収書"==n.CardStatementLineId__r.RecordType.Name),m=o?"img":"div";
if(n.PayeeId__r&&!teasp.Tsf.EmpExp.isJtb(n.Item__c)&&(n.CardStatementLineId__c&&!c?s.create(m,{className:o?"pic_card2":"pp_ico_card2"},r):"3"==n.PayeeId__r.PayeeType__c?s.create(m,{className:o?"pic_card1":"pp_ico_card1"},r):"2"==n.PayeeId__r.PayeeType__c&&s.create(m,{className:o?"pic_bill":"pp_ico_bill"},r)),teasp.Tsf.EmpExp.isSpice(n.Item__c)?s.create(m,{className:o?"pic_ic":"ts-spice"},r):teasp.Tsf.EmpExp.isJtb(
n.Item__c)?s.create(m,{className:o?"pic_jtb":"pp_ico_jtb_ticket"},r):"1"==n.TransportType__c&&(o?s.create("img",{className:"pic_ekitan"},r):(g=s.create("input",{type:"button",className:"pp_base pp_ico_ekitan"},r),this.isClickableEkitan()?s.connect(g,"onclick",this,function(e){tsfManager.showDialog("ExpRoute",this.obj.Route__c)},e):teasp.Tsf.Dom.style(g,"cursor","default"))),teasp.Tsf.EmpExp.isExternalExpense(
n.Item__c)&&s.create(m,{className:o?"pic_pit":"ts-external"},r),n.Receipt__c){var d=0<this.getAttachments().length||0<this.getContentDocumentLinks().length||!this.obj.Id&&this.obj._temp_attach;if(o){var h="pic_receipt";teasp.Tsf.EmpExp.isUber(n.Item__c)?h+="_u":d&&(h+=c?"_r":"_i"),s.create("img",{className:h},r)}else{var f="",g=(teasp.Tsf.EmpExp.isUber(n.Item__c)?f="_u":d&&(f=c?"_r":"_a"),s.create("input",{
type:"button",className:"pp_ico_receipt"+f,title:teasp.message.getLabel(this.pre?"tf10004690":d?"attachedReceipt":"nonReceipt")},r));if(this.isClickableReceipt())if(this.obj.Id)s.connect(g,"onclick",this,function(e){tsfManager.openExpImageView(this.obj.Id,this.isInExpApply())},e);else if(this.obj._temp_attach)try{var u=teasp.Tsf.util.fromJson(this.obj._temp_attach);s.connect(g,"onclick",this,function(e){
tsfManager.openReceiptImageView(u.Id,u.ParentId)},e)}catch(e){}else s.createTooltip({connectId:g,label:teasp.message.getLabel("tf10001660"),position:["below"],showDelay:200});else teasp.Tsf.Dom.style(g,"cursor","default")}}return l},teasp.Tsf.ExpPreApply=function(e,t,s,a){this.obj=e||{},this.rights=t,this.steps=a,this.obj._uniqKey=teasp.Tsf.ExpPreApply.createUniqKey(),this.mergePiwks(s||[]),
this.approved=this.isApproved(),dojo.forEach(this.obj.ExpPreApplyDay__r||[],function(e){e._uniqKey=teasp.Tsf.ExpPreApply.createUniqKey()},this),dojo.forEach(this.obj.EmpExp__r||[],function(e){e._uniqKey=teasp.Tsf.ExpPreApply.createUniqKey(),teasp.Tsf.ObjBase.covertEmpExp(e)},this),dojo.forEach(this.obj.ExpApplications__r||[],function(e){this.obj._payId=e.Id,this.obj._payStatus=e.StatusC__c},this),this.obj._linked=[],
dojo.forEach(this.obj.AdjustmentExpApply__r||[],function(e){this.obj._linked.push(e)},this),dojo.forEach(this.obj.ExpApplications__r||[],function(e){this.obj._linked.push(e)},this),this.rebirthEmp(),this.rebirthTicket(),this.rebirthCoupon(),this.rebirthForeign(),this.rebirthProvisional()},teasp.Tsf.ExpPreApply.prototype=new teasp.Tsf.ObjBase,teasp.Tsf.ExpPreApply.DESTINATION_TYPE_DOMESTIC="1",
teasp.Tsf.ExpPreApply.DESTINATION_TYPE_OVERSEA="2",teasp.Tsf.ExpPreApply.DESTINATION_TYPE_DAYTRIP="3",teasp.Tsf.ExpPreApply.UNIQ_SEQ=100,teasp.Tsf.ExpPreApply.createUniqKey=function(){return"D"+teasp.Tsf.ExpPreApply.UNIQ_SEQ++},teasp.Tsf.ExpPreApply.rebirthArray=function(e,t,s,a,o){for(var i=[],p=s;p<=a;p++){for(var r,n={},l=0;l<t.length;l++)!(m=t[l]).check&&m.apiKey&&(
"_uniqKey"==m.apiKey?n[m.apiKey]=teasp.Tsf.ExpPreApply.createUniqKey():(r=m.apiName?teasp.Tsf.util.formatString(m.apiName,p):m.apiKey,teasp.Tsf.Fc.setObjValue(n,e,m.apiKey,r)));i.push(n)}if(o)for(var c=i.length-1;0<=c;c--){for(var m,n=i[c],d=!1,l=0;l<t.length;l++)if(n[(m=t[l]).apiKey]&&"_"!=m.apiKey.substring(0,1)){d=!0;break}if(d)break;i.splice(c,1)}return i},teasp.Tsf.ExpPreApply.prototype.rebirthTicket=function(){
this.obj.tickets=teasp.Tsf.ExpPreApply.rebirthArray(this.obj,teasp.Tsf.formParams.sectionTicket.fields,1,5,!0)},teasp.Tsf.ExpPreApply.prototype.rebirthCoupon=function(){this.obj.coupons=teasp.Tsf.ExpPreApply.rebirthArray(this.obj,teasp.Tsf.formParams.sectionCoupon.fields,1,2,!0)},teasp.Tsf.ExpPreApply.prototype.rebirthForeign=function(){this.obj.foreigns=teasp.Tsf.ExpPreApply.rebirthArray(this.obj,
teasp.Tsf.formParams.sectionForeign.fields,1,1)},teasp.Tsf.ExpPreApply.prototype.rebirthProvisional=function(){this.obj.provisionals=teasp.Tsf.ExpPreApply.rebirthArray(this.obj,teasp.Tsf.formParams.sectionProvisional.fields,1,1)},teasp.Tsf.ExpPreApply.prototype.rebirthEmp=function(){this.obj.emps=teasp.Tsf.ExpPreApply.rebirthArray(this.obj,teasp.Tsf.formParams.sectionEmp.fields,1,1)},
teasp.Tsf.ExpPreApply.prototype.getApplyDate=function(){var e;return"number"==typeof this.obj.CreatedDate?teasp.util.date.formatDate(this.obj.CreatedDate,"SLA",0):"object"==typeof(e=new Date(this.obj.CreatedDate))&&e.getFullYear()?e.getFullYear()+"/"+(e.getMonth()<9?"0":"")+(e.getMonth()+1)+"/"+(e.getDate()<10?"0":"")+e.getDate():""},teasp.Tsf.ExpPreApply.prototype.getApplyNo=function(){
return this.obj.ExpPreApplyNo__c||null},teasp.Tsf.ExpPreApply.prototype.getTitle=function(){return this.obj.Title__c||""},teasp.Tsf.ExpPreApply.prototype.getConfig=function(){var e=tsfManager.getExpPreApplyConfigByName(this.getTypeName());return e&&(this.obj.instantFlag=e.instant||!1),e||{}},teasp.Tsf.ExpPreApply.prototype.getTypeName=function(){return this.obj.Type__c||""},
teasp.Tsf.ExpPreApply.prototype.getDestinationType=function(){return this.obj.DestinationType__c||""},teasp.Tsf.ExpPreApply.prototype.setDestinationType=function(e){this.obj.DestinationType__c=e},teasp.Tsf.ExpPreApply.prototype.getDate=function(){return this.fcDate||(this.fcDate=new teasp.Tsf.Fc({apiKey:"StartDate__c",domType:"date"})),this.fcDate.parseValue(this.obj).dispValue},
teasp.Tsf.ExpPreApply.prototype.getStatus=function(e){e=teasp.Tsf.ObjBase.prototype.getStatus.call(this,e);return e&&e!=teasp.constant.STATUS_NOTADMIT?e:teasp.constant.STATUS_NOTREQUEST},teasp.Tsf.ExpPreApply.prototype.isInstant=function(){return this.obj.instantFlag||!1},teasp.Tsf.ExpPreApply.prototype.getApplyButtonLabel=function(){return this.isManifestEditMode()?null:this.isApproved()||this.isInstant(
)?this.getPayId()?teasp.message.getLabel("tf10001530"):0<this.getLinked()?null:teasp.message.getLabel("tf10001520"):teasp.Tsf.ObjBase.prototype.getApplyButtonLabel.call(this)},teasp.Tsf.ExpPreApply.prototype.getPayStatus=function(){return this.obj._payStatus||null},teasp.Tsf.ExpPreApply.prototype.getPayId=function(){return this.obj._payId||null},teasp.Tsf.ExpPreApply.prototype.getLinked=function(){
return this.obj._linked.length},teasp.Tsf.ExpPreApply.prototype.getTotalAmount=function(){return this.fcTotalAmount||(this.fcTotalAmount=new teasp.Tsf.Fc({apiKey:"TotalAmount__c",domType:"currency"})),this.fcTotalAmount.parseValue(this.obj).dispValue},teasp.Tsf.ExpPreApply.prototype.getProvisionalPaymentAmount=function(){return this.fcProvisionalPaymentAmount||(this.fcProvisionalPaymentAmount=new teasp.Tsf.Fc({
apiKey:"ProvisionalPaymentAmount__c",domType:"currency"})),this.fcProvisionalPaymentAmount.parseValue(this.obj).dispValue},teasp.Tsf.ExpPreApply.prototype.getSectionValues=function(e){switch(e){case"jtbDetail":return this.getJtbExps();case"allowance":return this.obj.ExpPreApplyDay__r||[];case"coupon":return this.obj.coupons||[];case"detail":return this.getEmpExps();case"foreign":return this.obj.foreigns||[];
case"provisional":return this.obj.provisionals||[];case"ticket":return this.obj.tickets||[];case"emp":return this.obj.emps||[];case"expAssist":return[this.obj]}return[]},teasp.Tsf.ExpPreApply.prototype.getJtbExps=function(){return this.obj.ExpJsNavi__r||[]},teasp.Tsf.ExpPreApply.prototype.getEmpExps=function(){var e=this.obj.EmpExp__r||[];return dojo.forEach(e,function(e){e._route||(e._route=new teasp.Tsf.EmpExp(e,!0
))},this),e},teasp.Tsf.ExpPreApply.prototype.getSectionValuesByRowIndex=function(e,t){var s=this.getSectionValues(e);return t<s.length?s[t]:"detail"==e?this.createEmpExp():{_uniqKey:teasp.Tsf.ExpPreApply.createUniqKey()}},teasp.Tsf.ExpPreApply.prototype.createEmpExp=function(e){var t=tsfManager.getDefaultChargeDept(),s=tsfManager.isRequireChargeDept(),t={_uniqKey:teasp.Tsf.ExpApply.createUniqKey(),Id:null,
EmpId__c:this.getEmpId(),ExpPreApplyId__c:this.getId(),ChargeDeptId__c:s&&t.ChargeDeptId__c||null,ChargeDeptId__r:s&&t.ChargeDeptId__r||null,IsPaid__c:!1};return e&&(e.ChargeDeptId__c&&s&&(t.ChargeDeptId__c=e.ChargeDeptId__c||null,t.ChargeDeptId__r=e.ChargeDeptId__r||null),e.ChargeJobId__c&&(t.JobId__c=e.ChargeJobId__c||null,t.JobId__r=e.ChargeJobId__r||null),e.PayExpItemId__c&&tsfManager.getInfo().getPayItemById(
e.PayExpItemId__c).isForPayable()&&(t.PayeeId__r={PayeeType__c:"2"}),tsfManager.isDoNotCopyExtraItem()||(t.ExtraItem1__c=e.ExtraItem1__c||null,t.ExtraItem2__c=e.ExtraItem2__c||null)),t},teasp.Tsf.ExpPreApply.prototype.rebuildExpPreApplyDay=function(e,t,s){var a=this.obj.ExpPreApplyDay__r||[],o={},i=(dojo.forEach(a,function(e){"number"==typeof e.Date__c&&(e.Date__c=teasp.util.date.formatDate(e.Date__c)),o[e.Date__c]=e
}),dojo.forEach(s.values,function(e){o[e.Date__c]=e}),[]);if(e&&t)for(var p=e;p<=t;)o[p]?i.push(o[p]):i.push({Id:null,_uniqKey:teasp.Tsf.ExpPreApply.createUniqKey(),ExpPreApplyId__c:this.getId(),Date__c:p}),p=teasp.util.date.addDays(p,1);return this.obj.ExpPreApplyDay__r=i},teasp.Tsf.ExpPreApply.prototype.getAttachmentAllCount=function(){return this.obj.Attachments&&this.obj.Attachments.length||0},
teasp.Tsf.ExpPreApply.JTB_TRANSPORT_MAP={JL:"日本航空(JAL)",NH:"全日空(ANA)",JE:"JR Express",BH:"るるぶトラベル",RT:"他ホテル予約",GT:"GTA",DA:"代理店発注(交通機関)",DB:"代理店発注(宿泊)",DC:"代理店発注(レンタカー)",DD:"代理店発注(その他)",AA:"海外オンライン(交通機関)",AB:"海外オンライン(宿泊)",AC:"海外オンライン(レンタカー)",AD:"海外オンライン(その他)",RA:"ダイナミックパッケージ(交通機関)",RB:"ダイナミックパッケージ(宿泊)",RC:"ダイナミックパッケージ(レンタカー)",RD:"ダイナミックパッケージ(その他)"},teasp.Tsf.ExpApply=function(e,t,s,a){this.obj=e||{},this.rights=t,
this.steps=a,this.obj._uniqKey=teasp.Tsf.ExpApply.createUniqKey(),this.mergePiwks(s||[]),this.approved=this.isApproved(),dojo.forEach(this.obj.EmpExp__r||[],function(e){e._uniqKey=teasp.Tsf.ExpApply.createUniqKey(),teasp.Tsf.ObjBase.covertEmpExp(e)},this),this.rebirthEmp(),this.createOrgExpIds(this.obj.EmpExp__r)},teasp.Tsf.ExpApply.prototype=new teasp.Tsf.ObjBase,teasp.Tsf.ExpApply.UNIQ_SEQ=100,
teasp.Tsf.ExpApply.createUniqKey=function(){return"X"+teasp.Tsf.ExpApply.UNIQ_SEQ++},teasp.Tsf.ExpApply.createList=function(e,t){var s=[];return dojo.forEach(e,function(e){(e.Id==t||!["申請取消","確定取消"].contains(e.StatusC__c)||e.EmpExp__r&&0<e.EmpExp__r.length)&&this.push(new teasp.Tsf.ExpApply(e))},s),s},teasp.Tsf.ExpApply.prototype.rebirthEmp=function(){this.obj.emps=teasp.Tsf.ExpPreApply.rebirthArray(this.obj,
teasp.Tsf.formParams.sectionEmp.fields,1,1)},teasp.Tsf.ExpApply.prototype.getApplyDate=function(){var e;return"number"==typeof this.obj.CreatedDate?teasp.util.date.formatDate(this.obj.CreatedDate,"SLA",0):"object"==typeof(e=new Date(this.obj.CreatedDate))&&e.getFullYear()?e.getFullYear()+"/"+(e.getMonth()<9?"0":"")+(e.getMonth()+1)+"/"+(e.getDate()<10?"0":"")+e.getDate():""},
teasp.Tsf.ExpApply.prototype.getApplyNo=function(){return this.obj.ExpApplyNo__c||null},teasp.Tsf.ExpApply.prototype.getExpPreApplyId=function(){return this.obj.ExpPreApplyId__c||null},teasp.Tsf.ExpApply.prototype.getRingiApplyId=function(){return this.obj.ApplyId__c||null},teasp.Tsf.ExpApply.prototype.getRingiApplyObj=function(){var e=this.obj.ApplyId__r||{};return this.obj.ApplyId__c&&!e.Id&&(
e.Id=this.obj.ApplyId__c),e},teasp.Tsf.ExpApply.prototype.getStatus=function(e){e=teasp.Tsf.ObjBase.prototype.getStatus.call(this,e);return e&&e!=teasp.constant.STATUS_NOTADMIT?e:teasp.constant.STATUS_NOTREQUEST},teasp.Tsf.ExpApply.prototype.isRemoved=function(){return this.obj.Removed__c||!1},teasp.Tsf.ExpApply.prototype.isUnknotable=function(){return!this.getExpPreApplyId()&&this.isReject()},
teasp.Tsf.ExpApply.prototype.getUnknotWarning=function(){return teasp.message.getLabel("tm30001151",this.getApplyNo())},teasp.Tsf.ExpApply.prototype.getConfig=function(){return{view:"Form0"}},teasp.Tsf.ExpApply.prototype.getTotalCost=function(){return this.fcTotalCost||(this.fcTotalCost=new teasp.Tsf.Fc({apiKey:"TotalCost__c",domType:"currency"})),this.fcTotalCost.parseValue(this.obj).dispValue},
teasp.Tsf.ExpApply.prototype.getSectionValues=function(e){switch(e){case"detail":return this.getEmpExps();case"emp":return this.obj.emps||[];case"expAssist":return[this.obj]}return[this.obj]},teasp.Tsf.ExpApply.prototype.getSectionValuesByRowIndex=function(e,t){var s=this.getSectionValues(e);return t<s.length?s[t]:"detail"==e?this.createEmpExp():{_uniqKey:teasp.Tsf.ExpApply.createUniqKey()}},
teasp.Tsf.ExpApply.prototype.createEmpExp=function(e){var t=tsfManager.getDefaultChargeDept(),s=tsfManager.isRequireChargeDept(),t={_uniqKey:teasp.Tsf.ExpApply.createUniqKey(),Id:null,EmpId__c:this.getEmpId(),ExpApplyId__c:this.getId(),ExpApplyId__r:{ExpPreApplyId__c:this.getExpPreApplyId()},ChargeDeptId__c:s&&t.ChargeDeptId__c||null,ChargeDeptId__r:s&&t.ChargeDeptId__r||null,Detail__c:null,JobId__c:null,
Cost__c:null,startName__c:null,startCode__c:null,endName__c:null,endCode__c:null,roundTrip__c:!1,Route__c:null,Receipt__c:!1,TransportType__c:null,CurrencyName__c:null,CurrencyRate__c:0,ForeignAmount__c:0,Tax__c:0,TaxAuto__c:!0,TaxRate__c:0,TaxType__c:null,WithoutTax__c:0,ExtraItem1__c:null,ExtraItem2__c:null,CardStatementLineId__c:null,IsPaid__c:!1,PayeeId__c:null,PaymentDate__c:null,Quantity__c:0,UnitPrice__c:0,
Item__c:null,PreEmpExpId__c:null,PreExpItemId__c:null,Order__c:0};return e&&(e.ChargeDeptId__c&&s&&(t.ChargeDeptId__c=e.ChargeDeptId__c||null,t.ChargeDeptId__r=e.ChargeDeptId__r||null),e.ChargeJobId__c&&(t.JobId__c=e.ChargeJobId__c||null,t.JobId__r=e.ChargeJobId__r||null),e.PayExpItemId__c&&tsfManager.getInfo().getPayItemById(e.PayExpItemId__c).isForPayable()&&(t.PayeeId__r={PayeeType__c:"2"}),
tsfManager.isDoNotCopyExtraItem()||(t.ExtraItem1__c=e.ExtraItem1__c||null,t.ExtraItem2__c=e.ExtraItem2__c||null)),t},teasp.Tsf.ExpApply.prototype.createEmpExpFromCard=function(e,t,s,a,o,i,p,r){var n,l,c="",m="",d=null,h=null,f=null,g=i.Id,u=null,y=null,_=null,T="",D=teasp.util.date.formatDate(i.Date__c),I=null,E=null,b=(i.RecordType&&"領収書"==i.RecordType.Name?(c=i.Note__c||null,E=i.Publisher__c||null,
m=i.Attachments&&0<i.Attachments.length?teasp.Tsf.util.toJson(i.Attachments[0]):null):i.JsNaviId__c?(g=null,u=i.Id,y=i.FunctionCode__c||null,_=i.Data01__c||null,data11=i.Data11__c||null,I=i.SystemType__c||null,c=i.Note__c||null,d=i.Data03__c||null,h=i.Data04__c||null,f="JTB",D=teasp.util.date.formatDate(i.StartDate__c),null!=(b=i.Data11__c||null)&&(T=b,n=null,"JL"==y||"NH"==y?n={"なし":"","取消":"取消"}[b]:"JE"==y?n={
"購入":"購入","取消":"取消","受取":"JR券受取","出１":"出場イレギュラーケース１","出1":"出場イレギュラーケース１","出２":"出場イレギュラーケース２","出2":"出場イレギュラーケース２","出場":"ICカードでの出場","入場":"ICカードでの入場","払戻":"払戻発生"}[b]:"BH"==y?n={NEW:"新規予約",REF:"データ参照",CNL:"取消"}[b]:"DT"==y?n={0:"取消済",1:"旅程表作成中",2:"発注データ送信待ち",3:"手配依頼済",4:"予約回答受信済",5:"最終確認待ち",6:"最終確認送信待ち",7:"最終確認済",8:"最終確認済",9:"切符受渡済"}[b]:"GT"==y?n={NEW:"新規予約済",CHG:"変更済",CXL:"取消済"}[b]:"AD"==y?n={0:"取消済",2:"手配済",9:"実績データ作成済"
}[b]:"DP"==y&&(n={40:"予約済",80:"取消済"}[b]),null!=n&&""!=n&&(T=b+"("+n+")"))):(c=i.Note__c||null,E=i.Publisher__c||null),{_uniqKey:teasp.Tsf.ExpApply.createUniqKey(),Id:null,EmpId__c:this.getEmpId(),ExpApplyId__c:this.getId(),ExpApplyId__r:{ExpPreApplyId__c:this.getExpPreApplyId()},ExpItemId__c:null!=e?e.getId():null,ExpItemId__r:{Name:null!=e?e.getName():null},Date__c:D,CardStatementLineId__c:g,CardStatementLineId__r:{
Name:i.Name,RecordType:{Name:i.RecordType&&i.RecordType.Name||null}},Publisher__c:E,_temp_attach:m,Cost__c:i.Amount__c,CurrencyName__c:i.FCName__c||null,CurrencyRate__c:i.FCRate__c||null,ForeignAmount__c:i.FCAmount__c||null,PayeeId__c:i.PayeeId__c||null,PayeeId__r:i.PayeeId__r?{Name:i.PayeeId__r.Name||null,PayeeType__c:i.PayeeId__r.PayeeType__c||"1",ExpenseType__c:i.PayeeId__r.ExpenseType__c||null}:null,
PayeeName__c:i.PayeeId__r?i.PayeeId__r.Name:null,PaymentDate__c:teasp.util.date.formatDate(i.PaymentDate__c),UnitPrice__c:null!=e&&e.isEnableQuantity()?i.Amount__c:null,Quantity__c:null!=e&&e.isEnableQuantity()?1:null,Detail__c:c,IsPaid__c:!1,JobId__c:t&&t.getId()||null,JobId__r:t?{JobCode__c:t.getCode(),StartDate__c:t.getStartDate(),EndDate__c:t.getEndDate(),Name:t.getName()}:null,ChargeDeptId__c:s.Id||null,
ChargeDeptId__r:s.Id?{DeptCode__c:s.DeptCode__c||null,Name:s.Name||null}:null,Order__c:1,Receipt__c:null!=e?e.isReceipt():null,Item__c:f,TaxType__c:null,TaxAuto__c:!0,TaxRate__c:null,Tax__c:null,WithoutTax__c:null,TransportType__c:null!=e?"1"==e.getTransportType()?"2":e.getTransportType():null,startCode__c:null,startName__c:d,endCode__c:null,endName__c:h,roundTrip__c:!1,Route__c:null,ExtraItem1__c:a||null,
ExtraItem2__c:o||null,ExpenseType__c:p||null,Text__c:T,JsNaviActualId__c:u,JsNaviActualId__r:u?{FunctionCode__c:y,Data01__c:_,SystemType__c:I}:null,InternalParticipantsNumber__c:i.InternalParticipantsNumber__c||null,InternalParticipants__c:i.InternalParticipants__c||null,ExternalParticipantsNumber__c:i.ExternalParticipantsNumber__c||null,ExternalParticipants__c:i.ExternalParticipants__c||null,
PlaceName__c:i.PlaceName__c||null,PlaceAddress__c:i.PlaceAddress__c||null}),d=(t&&!t.activeOnDate(b.Date__c)&&(r.f||(r.f={ids:[],message:teasp.message.getLabel("tf10001810")}),r.f.ids.push(i.Id)),i.Amount__c<0&&e&&!e.isAllowMinus()&&(r.f||(r.f={ids:[],message:teasp.message.getLabel("tf10008850")}),r.f.ids.push(i.Id)),null==e||!e.isForeignFlag(
)||i.FCName__c&&"number"==typeof i.FCRate__c&&"number"==typeof i.FCAmount__c||(i.FCName__c||"number"==typeof i.FCRate__c||"number"==typeof i.FCAmount__c?(r.f||(r.f={ids:[],message:teasp.message.getLabel("tf10008170")}),r.f.ids.push(i.Id),b.CurrencyName__c=null):(n=tsfManager.getForeignByName(teasp.Tsf.JPY))?(D=n.getRateByDate(b.Date__c),g=teasp.util.currency.formatDecimal(D,teasp.constant.CU_DEC_POINT_MIN,
teasp.constant.CU_DEC_POINT_MAX),l=teasp.Tsf.ExpDetail.calcForeign(b.Cost__c,g.n,b.Cost__c,0,0,e.isAllowMinus()),b.CurrencyName__c=teasp.Tsf.JPY,b.CurrencyRate__c=g.n,b.ForeignAmount__c=l.amount):(r.f||(r.f={ids:[],message:teasp.message.getLabel("tf10002050")}),r.f.ids.push(i.Id),b.CurrencyName__c=null)),null!=e&&e.isTaxFlag()&&(E=e.getTaxType()||"0",m=e.isAllowMinus(),c=tsfManager.getTaxRoundFlag(),s=e.getTaxRate(
b.Date__c),f=b.Cost__c,l=teasp.Tsf.ExpDetail.calcTax(f,0,0,0,E,s,!0,c,m),b.TaxType__c=E,b.TaxRate__c="0"!=E?s:null,b.Tax__c=""+l.tax,b.WithoutTax__c=""+l.withoutTax),b.WithoutTax__c||b.Cost__c),h=(teasp.util.currency.string2number(""+b.InternalParticipantsNumber__c).num||0)+(teasp.util.currency.string2number(""+b.ExternalParticipantsNumber__c).num||0);
return b.AmountPerParticipant__c=h?teasp.Tsf.Currency.roundSameAsSalesforce(d/h):null,b},teasp.Tsf.ExpApply.prototype.createEmpExpFromExternalExpense=function(e,t,s,a,o,i,p,r){var n,l=i.Note__c||null,c=teasp.util.date.formatDate(i.UsageDate__c),l={_uniqKey:teasp.Tsf.ExpApply.createUniqKey(),Id:null,EmpId__c:this.getEmpId(),ExpApplyId__c:this.getId(),ExpApplyId__r:{ExpPreApplyId__c:this.getExpPreApplyId()},
ExpItemId__c:null!=e?e.getId():null,ExpItemId__r:{Name:null!=e?e.getName():null},Date__c:c,CardStatementLineId__c:null,CardStatementLineId__r:null,ExternalICExpenseId__c:i.Id,ExternalICExpenseId__r:{UsageDate__c:c,Amount__c:i.Amount__c},Cost__c:i.Amount__c,CurrencyName__c:null,CurrencyRate__c:null,ForeignAmount__c:null,PayeeId__c:null,PayeeId__r:null,PayeeName__c:null,PaymentDate__c:null,
UnitPrice__c:null!=e&&e.isEnableQuantity()?i.Amount__c:null,Quantity__c:null!=e&&e.isEnableQuantity()?1:null,Detail__c:l,IsPaid__c:!1,JobId__c:t&&t.getId()||null,JobId__r:t?{JobCode__c:t.getCode(),StartDate__c:t.getStartDate(),EndDate__c:t.getEndDate(),Name:t.getName()}:null,ChargeDeptId__c:s.Id||null,ChargeDeptId__r:s.Id?{DeptCode__c:s.DeptCode__c||null,Name:s.Name||null}:null,Order__c:1,
Receipt__c:null!=e?e.isReceipt():null,Item__c:teasp.Tsf.ITEM_EXTERNAL,TaxType__c:null,TaxAuto__c:!0,TaxRate__c:null,Tax__c:null,WithoutTax__c:null,TransportType__c:null!=e?"1"==e.getTransportType()?"2":e.getTransportType():null,startCode__c:null,startName__c:i.StationNameFrom__c,endCode__c:null,endName__c:i.StationNameTo__c,roundTrip__c:!1,Route__c:null,ExtraItem1__c:a||null,ExtraItem2__c:o||null,
ExpenseType__c:p||null,JsNaviActualId__c:null,JsNaviActualId__r:null,InternalParticipantsNumber__c:i.InternalParticipantsNumber__c||null,InternalParticipants__c:i.InternalParticipants__c||null,ExternalParticipantsNumber__c:i.ExternalParticipantsNumber__c||null,ExternalParticipants__c:i.ExternalParticipants__c||null,PlaceName__c:i.PlaceName__c||null,PlaceAddress__c:i.PlaceAddress__c||null},o=(t&&!t.activeOnDate(
l.UsageDate__c)&&(r.f||(r.f={ids:[],message:teasp.message.getLabel("tf10001810")}),r.f.ids.push(i.Id)),null!=e&&e.isForeignFlag()&&((s=tsfManager.getForeignByName(teasp.Tsf.JPY))?(a=s.getRateByDate(l.Date__c),o=teasp.util.currency.formatDecimal(a,teasp.constant.CU_DEC_POINT_MIN,teasp.constant.CU_DEC_POINT_MAX),n=teasp.Tsf.ExpDetail.calcForeign(l.Cost__c,o.n,l.Cost__c,0,0,e.isAllowMinus()),
l.CurrencyName__c=teasp.Tsf.JPY,l.CurrencyRate__c=o.n,l.ForeignAmount__c=n.amount):(r.f||(r.f={ids:[],message:teasp.message.getLabel("tf10002050")}),r.f.ids.push(cardObj.Id),l.CurrencyName__c=null)),null!=e&&e.isTaxFlag()&&(p=e.getTaxType()||"0",t=e.isAllowMinus(),i=tsfManager.getTaxRoundFlag(),s=e.getTaxRate(c),a=l.Cost__c,n=teasp.Tsf.ExpDetail.calcTax(a,0,0,0,p,s,!0,i,t),l.TaxType__c=p,l.TaxRate__c="0"!=p?s:null,
l.Tax__c=""+n.tax,l.WithoutTax__c=""+n.withoutTax),l.WithoutTax__c||l.Cost__c),r=(teasp.util.currency.string2number(""+l.InternalParticipantsNumber__c).num||0)+(teasp.util.currency.string2number(""+l.ExternalParticipantsNumber__c).num||0);return l.AmountPerParticipant__c=r?teasp.Tsf.Currency.roundSameAsSalesforce(o/r):null,l},teasp.Tsf.ExpApply.prototype.createEmpExpFromCsv=function(e,t,s){
var a=tsfManager.getExpItemByItemCode(t[e.ITEM_CODE.key]),o=t[e.PAYEE_INFO.key],i=t[e.DEPT_INFO.key],p=t[e.JOB_INFO.key];return{_uniqKey:teasp.Tsf.ExpApply.createUniqKey(),Id:null,EmpId__c:this.getEmpId(),ExpApplyId__c:null,ExpItemId__c:a.getId(),ExpItemId__r:{Name:a.getName()},Date__c:t[e.DATE.key],CardStatementLineId__c:null,Cost__c:teasp.Tsf.util.getNumStr(t[e.COST.key]),
CurrencyName__c:t[e.CURRENCY_NAME.key]||null,CurrencyRate__c:teasp.Tsf.util.getNumStr(t[e.CURRENCY_RATE.key]),ForeignAmount__c:teasp.Tsf.util.getNumStr(t[e.FOREIGN_AMOUNT.key]),PayeeId__c:o&&o.PayeeId||null,PayeeId__r:o?{Name:o.PayeeName||null,PayeeType__c:o.PayeeType||null,ExpenseType__c:o.PayeeExpenseType||null}:null,PayeeName__c:o&&o.PayeeName||null,PaymentDate__c:t[e.PAYMENT_DATE.key]||null,
UnitPrice__c:teasp.Tsf.util.getNumStr(t[e.UNIT_PRICE.key]),Quantity__c:teasp.Tsf.util.getNumStr(t[e.QUANTITY.key]),Detail__c:t[e.DETAIL.key]||null,IsPaid__c:!1,JobId__c:p&&p.JobId||null,JobId__r:p?{JobCode__c:p.JobCode,StartDate__c:p.JobStartDate||null,EndDate__c:p.JobEndDate||null,Name:p.JobName}:null,ChargeDeptId__c:i&&i.ChargeDeptId||null,ChargeDeptId__r:i?{DeptCode:i.ChargeDeptCode,Name:i.ChargeDeptName,
ExpItemClass__c:i.ExpItemClass||null}:null,Order__c:1,Receipt__c:a.isReceipt(),Item__c:"csv",TaxType__c:t[e.TAX_TYPE.key],TaxAuto__c:t[e.TAX_AUTO.key],TaxRate__c:teasp.Tsf.util.parseInt(t[e.TAX_RATE.key]),Tax__c:teasp.Tsf.util.getNumStr(t[e.TAX.key]),WithoutTax__c:teasp.Tsf.util.getNumStr(t[e.WITHOUT_TAX.key]),TransportType__c:t[e.TRANSPORT_TYPE.key],startCode__c:null,startName__c:t[e.START_NAME.key]||null,
endCode__c:null,endName__c:t[e.END_NAME.key]||null,roundTrip__c:t[e.ROUND_TRIP.key]||!1,Route__c:null,ExtraItem1__c:t[e.EXTRA_ITEM_1.key]||null,ExtraItem2__c:t[e.EXTRA_ITEM_2.key]||null,ExpenseType__c:s||null}},teasp.Tsf.ExpApply.prototype.createDayExp=function(e,t,s,a,o){var i=tsfManager.getExpItemById(t);if(!i)return null;var p=teasp.util.date.formatDate(e),t={Id:null,EmpId__c:this.getEmpId(),
ExpApplyId__c:this.getId(),ExpApplyId__r:{ExpPreApplyId__c:this.getExpPreApplyId()},ExpItemId__c:t,ExpItemId__r:{Id:t,Name:i.getName()},TransportType__c:i.getTransportType(),Date__c:p,Cost__c:o||i.getCost(p),JobId__c:s.ChargeJobId__c||null,JobId__r:s.ChargeJobId__r||null,Detail__c:a?a+" "+teasp.util.date.formatDate(e,"SLA"):null};return i.isEnableQuantity()&&(t.UnitPrice__c=t.Cost__c,t.Quantity__c=1),i.isForeignFlag(
)&&(t.ForeignAmount__c=t.Cost__c,t.CurrencyName__c=null,t.CurrencyRate__c=1,i.getCurrencyName()&&(t.ForeignAmount__c=i.getCost(),t.CurrencyName__c=i.getCurrencyName(),o=tsfManager.getForeignByName(t.CurrencyName__c),t.CurrencyRate__c=o?o.getRateByDate(p):1)),i.isTaxFlag()&&(a=i.getTaxType(),e=i.isAllowMinus(),o=tsfManager.getTaxRoundFlag(),p=i.getTaxRate(),p=teasp.Tsf.ExpDetail.calcTax(t.Cost__c||0,0,0,0,a,p,!0,o,e),
t.WithoutTax__c=p.withoutTax,t.Tax__c=p.tax,t.TaxType__c=a,t.TaxAuto__c=!0),i.isInternalParticipants()&&(t.InternalParticipants__c=s.InternalParticipants__c,t.InternalParticipantsNumber__c=s.OurNumber__c),i.isExternalParticipants()&&(t.ExternalParticipants__c=s.ExternalParticipants__c,t.ExternalParticipantsNumber__c=s.TheirNumber__c),i.isPlace()&&(t.PlaceName__c=s.PlaceName__c,t.PlaceAddress__c=s.PlaceAddress__c),t},
teasp.Tsf.ExpApply.prototype.getEmpExps=function(){var e=this.obj.EmpExp__r||[];return dojo.forEach(e,function(e){e._route||(e._route=new teasp.Tsf.EmpExp(e))},this),e},teasp.Tsf.ExpApply.prototype.addEmpExps=function(e){return this.obj.EmpExp__r=(this.obj.EmpExp__r||[]).concat(e),this.obj.EmpExp__r},teasp.Tsf.ExpApply.prototype.setEmpExpComplex=function(e){var t=[],s={};dojo.forEach(e||[],function(e){
e._route=new teasp.Tsf.EmpExp(e),(e.ExpApplyId__c?s[e.ExpApplyId__c]||(s[e.ExpApplyId__c]=[]):t).push(e)}),this.obj.EmpExp__r=t,this.others=s},teasp.Tsf.ExpApply.prototype.getSectionDetailCount=function(){var e,t=1;for(e in this.others)this.others.hasOwnProperty(e)&&t++;return t},teasp.Tsf.ExpApply.prototype.getSectionDetailObjs=function(){var e,t,s,a=[],o=(a.push({values:this.obj.EmpExp__r,id:null,
empId:this.obj.EmpId__c,title:teasp.message.getLabel(tsfManager.isExpWorkflow()?"tf10001490":"tf10001491"),assist:{ChargeDeptId__r:{ExpItemClass__c:tsfManager.getTargetEmp().getDeptExpItemClass()},ExpenseType__c:null}}),teasp.message.getLabel("tf10000550")+" {0}  ({1})");for(e in this.others)this.others.hasOwnProperty(e)&&(s=(t=this.others[e])[0],a.push({values:t,id:s.ExpApplyId__c,empId:s.EmpId__c,
title:teasp.Tsf.util.formatString(o,s.ExpApplyId__r&&s.ExpApplyId__r.ExpApplyNo__c||"-",s.ExpApplyId__r&&teasp.constant.getDisplayStatus(teasp.Tsf.ObjBase.RepStatus(s.ExpApplyId__r.StatusC__c))||teasp.message.getLabel("tf10000550")),assist:{ChargeDeptId__r:s.ExpApplyId__r.ChargeDeptId__r||{ExpItemClass__c:tsfManager.getTargetEmp().getDeptExpItemClass()},ExpenseType__c:s.ExpApplyId__r.ExpenseType__c||null}}));return a
},teasp.Tsf.ExpApply.prototype.isSolve=function(){return!1},teasp.Tsf.ExpApply.prototype.getExpPreApply=function(){return this.expPreApply||null},teasp.Tsf.ExpApply.prototype.setExpPreApply=function(s){this.expPreApply=s,this.expDays=[],this.socialExp=null,dojo.forEach(s.obj.ExpPreApplyDay__r||[],function(e){var t;e.AllowanceItemId__c&&(t=this.createDayExp(e.Date__c,e.AllowanceItemId__c,s.obj,teasp.message.getLabel(
"tf10000890")))&&this.expDays.push(t),e.HotelItemId__c&&(t=this.createDayExp(e.Date__c,e.HotelItemId__c,s.obj,teasp.message.getLabel("tf10000030")))&&this.expDays.push(t)},this),s.obj.SocialExpItemId__c&&(this.socialExp=this.createDayExp(s.obj.StartDate__c,s.obj.SocialExpItemId__c,s.obj,null,s.obj.TotalAmount__c)),this.linkPreApplyAll()},teasp.Tsf.ExpApply.prototype.linkPreApplyAll=function(){for(
var e=this.obj.EmpExp__r||[],t=e.length-1;0<=t;t--)e[t]._removed&&e.splice(t,1);if(dojo.forEach(e,function(e){this.linkPreApply(e)},this),tsfManager.isDiffView()){var s=[],a=this.expPreApply,o=a&&a.obj.EmpExp__r||[];if(this.obj.JsNaviData)for(t=0;t<e.length;t++)"JTB"==e[t].Item__c&&(e[t]._addJsNavi=!0,e[t].jsnaviEqualFlag=!0);for(t=0;t<o.length;t++){var i=o[t];if("JTB"!=i.Item__c){for(
var p=0;p<e.length&&e[p].preObj!=i;p++);p>=e.length&&(i._removed=!0,i.Order__c=e.length+s.length,s.push(i))}}for(t=0;t<this.expDays.length;t++){for(i=this.expDays[t],p=0;p<e.length&&e[p].preObj!=i;p++);p>=e.length&&(i._removed=!0,i.Order__c=e.length+s.length,s.push(i))}if(this.socialExp){for(i=this.socialExp,p=0;p<e.length&&e[p].preObj!=i;p++);p>=e.length&&(i._removed=!0,i.Order__c=e.length+s.length,s.push(i))}e=(
e=e.concat(s)).sort(function(e,t){var s=teasp.util.date.formatDate(e.Date__c),a=teasp.util.date.formatDate(t.Date__c);return s==a?e.Order__c-t.Order__c:s<a?-1:1}),this.obj.EmpExp__r=e}},teasp.Tsf.ExpApply.prototype.linkPreApply=function(e){if(e.PreEmpExpId__c)for(var t=this.expPreApply,s=t&&t.obj.EmpExp__r||[],a=0;a<s.length;a++){var o=s[a];if(e.PreEmpExpId__c==o.Id){e.preObj=o;break}}else if(e.PreExpItemId__c)if(
this.socialExp&&e.PreExpItemId__c==this.socialExp.ExpItemId__c)e.preObj=this.socialExp;else for(var i=teasp.util.date.formatDate(e.Date__c),a=0;a<this.expDays.length;a++)if((o=this.expDays[a]).Date__c==i&&e.PreExpItemId__c==o.ExpItemId__c){e.preObj=o;break}},teasp.Tsf.ExpApply.prototype.canDiffView=function(){return!!this.getExpPreApplyId()},teasp.Tsf.ExpApply.prototype.isCreateFlag=function(){
return this.obj.createFlag||!1},teasp.Tsf.ExpApply.prototype.addElement=function(e){e.createFlag=this.isCreateFlag()},teasp.Tsf.ExpApply.prototype.getPayDate=function(){return teasp.util.date.formatDate(this.obj.payDate__c,"SLA")},teasp.Tsf.ExpApply.prototype.getAttachmentAllCount=function(){var t=0;return t+=this.obj.Attachments&&this.obj.Attachments.length||0,dojo.forEach(this.obj.EmpExp__r||[],function(e){
t+=e.Attachments&&e.Attachments.length||0},this),t},teasp.Tsf.ExpApply.prototype.filterEmpExp=function(e){this.obj.OrgEmpExp__r||(this.obj.OrgEmpExp__r=this.obj.EmpExp__r||[]);var t=e&&e.expenseType||null,s=[];dojo.forEach(this.obj.OrgEmpExp__r,function(e){(e.ExpenseType__c||null)==t&&s.push(teasp.Tsf.Dom.clone(e))},this),this.obj.EmpExp__r=s},teasp.Tsf.ExpApply.prototype.getPullExpenseTypes=function(){
this.expenseTypes||((e=tsfManager.getTargetEmp().getExpenseTypes()||[]).length||(e=tsfManager.getInfo().getExpPreApplyConfigs().expenseTypes||[]),this.expenseTypes=teasp.Tsf.Dom.clone(e));var e,t,s={},a=(dojo.forEach(this.obj.OrgEmpExp__r||[],function(e){var t=e.ExpenseType__c||"";this.isRemovedExp(e.Id)||(s[t]="number"==typeof s[t]?s[t]+1:1)},this),{}),o=(dojo.forEach(this.obj.EmpExp__r||[],function(e){
var t=e.ExpenseType__c||"";this.isRemovedExp(e.Id)||(a[t]="number"==typeof a[t]?a[t]+1:1)},this),teasp.Tsf.util.mixin(s,a));for(t in o)this.expenseTypes.contains(t)||(t?this.expenseTypes.push(t):this.expenseTypes.unshift(t));var i=[];return dojo.forEach(this.expenseTypes,function(e){i.push({v:e,n:(e||teasp.message.getLabel("ci00000220"))+" "+teasp.message.getLabel("tf10009580",o[e]||0)})}),i},
teasp.Tsf.ExpApply.getJtbContent=function(e){return""},teasp.Tsf.CommuterPass=function(e){this.obj=e},teasp.Tsf.CommuterPass.prototype=new teasp.Tsf.ObjBase,teasp.Tsf.CommuterPass.createList=function(e){var t=[];return dojo.forEach(e,function(e){this.push(new teasp.Tsf.CommuterPass(e))},t),t},teasp.Tsf.CommuterPass.isCancelable=function(e,t){for(var s=0;s<e.length;s++){var a=e[s];if(a.getId()==t)return a.isFix();if(
a.isFix())return!1}return!1},teasp.Tsf.CommuterPass.isValid=function(e,t){for(var s=0;s<e.length;s++){var a=e[s];if(a.getId()==t)return a.isValid()}return!1},teasp.Tsf.CommuterPass.getReuseApply=function(e){for(var t=null,s=0;s<e.length;s++){var a=e[s];if(a.isValid())return t;t=a}return t},teasp.Tsf.CommuterPass.getWaitApply=function(e){for(var t=0;t<e.length;t++){var s=e[t];if(s.isWait())return s}return null},
teasp.Tsf.CommuterPass.prototype.getStartDate=function(){return"number"==typeof this.obj.StartDate__c&&(this.obj.StartDate__c=teasp.util.date.formatDate(this.obj.StartDate__c)),this.obj.StartDate__c},teasp.Tsf.CommuterPass.prototype.isValid=function(){return/^(承認済み|確定済み)$/.test(this.obj.Status__c)},teasp.Tsf.CommuterPass.prototype.isWait=function(){return/^承認待ち$/.test(this.obj.Status__c)},
teasp.Tsf.CommuterPass.prototype.isFix=function(){return/^(承認済み|確定済み|承認待ち)$/.test(this.obj.Status__c)},teasp.Tsf.CommuterPass.prototype.setStatus=function(e){this.obj.Status__c=e},teasp.Tsf.CommuterPass.prototype.getPassFare=function(){return this.obj.PassFare__c||0},teasp.Tsf.CommuterPass.prototype.getRouteDescription=function(){return this.obj.RouteDescription__c||teasp.message.getLabel(
this.obj.StartDate__c?"tf10000340":"tm10003580")},teasp.Tsf.CommuterPass.prototype.getRouteCode=function(){return this.obj.RouteCode__c||null},teasp.Tsf.CommuterPass.prototype.getPassPeriod=function(){return this.obj.PassPeriod__c||null},teasp.Tsf.CommuterPass.prototype.getNote=function(){return this.obj.Note__c||null},teasp.Tsf.CommuterPass.prototype.getStatus=function(){return this.obj.Status__c||null},
teasp.Tsf.CommuterPass.prototype.getRoute=function(){return this.obj.Route__c||null},teasp.Tsf.CommuterPass.prototype.getTransfer=function(){return this.obj.Transfer__c||!1},teasp.Tsf.ZGAccount=function(e){this.account=e},teasp.Tsf.ZGAccount.createList=function(e){var t=[];return dojo.forEach(e,function(e){this.push(new teasp.Tsf.ZGAccount(e))},t),t},teasp.Tsf.ZGAccount.prototype.getId=function(){
return this.account.Id||""},teasp.Tsf.ZGAccount.prototype.getName=function(){return this.account.Name||"---"},teasp.Tsf.Attachment=function(e){this.attachment=e},teasp.Tsf.Attachment.createList=function(e){var t=[];return dojo.forEach(e,function(e){this.push(new teasp.Tsf.Attachment(e))},t),t},teasp.Tsf.Attachment.prototype.getId=function(){return this.attachment.Id||""},
teasp.Tsf.Attachment.prototype.getName=function(){return this.attachment.Name||"---"},teasp.Tsf.Attachment.prototype.isImage=function(){return!!/^image/i.test(this.attachment.ContentType)},teasp.Tsf.util={toJson:function(e){return dojo.toJson(e)},fromJson:function(e){return"string"==typeof e?dojo.fromJson(e):e},isArray:function(e){return dojo.isArray(e)},mixin:function(e,t){return dojo.mixin(e,t)},clone:function(e){
return dojo.clone(e)},parseInt:function(e){return"number"==typeof e?e:e&&(e=e.trim(),/^\-?\d+$/.test(e))?parseInt(e,10):null},getNumStr:function(e,t){return"number"==typeof e?""+e:e||(void 0===t?null:t)},formatString:function(){var e="",t=arguments;t[0]&&(e=t[0]||"");for(var s=1;s<t.length;s++)e=e.replace(RegExp("\\{"+(s-1)+"\\}","g"),t[s]);return e},equalId:function(e,t){return(e&&15<=e.length?e.substring(0,15):null
)==(t&&15<=t.length?t.substring(0,15):null)},entitize:function(e,t){return"number"==typeof(e="string"==typeof e?(e=(e=(e=(e=(e=(e=e.replace(/&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/\"/g,"&quot;")).replace(/{/g,"&#123;")).replace(/}/g,"&#125;")).replace(/\'/g,"&#039;"):e)?e:e||t},entitizf:function(e){return teasp.Tsf.util.entitize(e,"")},entitizg:function(e,t){e=teasp.Tsf.util.entitize(e,
"&nbsp;");return t?e.replace(/\r?\n/g,"<br/>"):e},revetize:function(e,t){return(e="string"==typeof e?(e=(e=(e=(e=(e=(e=(e=e.replace(/<br\/?>/gi,"\n")).replace(/&amp;/g,"&")).replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&quot;/g,'"')).replace(/&#123;/g,"{")).replace(/&#125;/g,"}")).replace(/&#039;/g,"'"):e)||t},escapeCsv:function(e){return"string"==typeof e?'"'+e.replace(/"/g,'""')+'"':e},isSforceOne:function(
){return"undefined"!=typeof sforce&&null!=sforce&&0<=navigator.userAgent.indexOf("Salesforce")},console:function(e){"object"==typeof console&&console.log&&console.log(e)}},teasp.Tsf.InfoBase=function(e){},teasp.Tsf.InfoBase.prototype.init=function(e){teasp.util.excludeNameSpace(e),teasp.Tsf.util.console(e),this.loadRes=e,this.common=new teasp.Tsf.Common(e.common),this.targetEmp=new teasp.Tsf.Emp(e.targEmp),
this.sessionEmp=new teasp.Tsf.Emp(e.selfEmp),this.sessionUser=new teasp.Tsf.User(e.sessionUser),this.depts=teasp.Tsf.Dept.createList(e.depts||[]),this.expItems=teasp.Tsf.ExpItem.createList(e.expItems||[],!1,!1),this.payItems=teasp.Tsf.ExpItem.createList(e.expItems||[],!0,!1),this.foreigns=teasp.Tsf.ForeignCurrency.createList(e.foreigns||[]),this.zgAccounts=teasp.Tsf.ZGAccount.createList(e.zgAccounts||[]),
this.atkApplyTypeList=teasp.Tsf.Fp.createPickList(e.atkApplyTypeList||[],!0),this.borderRevNo=e.borderRevNo||null,this.privateOption=e.privateOptions&&0<e.privateOptions.length&&e.privateOptions[0]||{},this.objects=[],this.rights=e.rights||0,this.createCacheDept(),this.patchDef(),this.usingJsNaviFlag=e.usingJsNaviSystem||!1,
this.usingConnectICforPitTouchExpense=e.usingPitTouchSystem&&e.usingConnectICforPitTouchExpense||!1},teasp.Tsf.InfoBase.prototype.setTargetEmp=function(e){this.targetEmp=new teasp.Tsf.Emp(e)},teasp.Tsf.InfoBase.prototype.setTargetSessionEmp=function(){this.targetEmp.getEmpId()!=this.sessionEmp.getEmpId()&&(this.targetEmp=this.sessionEmp.clone())},teasp.Tsf.InfoBase.prototype.isValid=function(e){return!!e},
teasp.Tsf.InfoBase.prototype.getObjById=function(e,t){for(var s=0;s<e.length;s++){var a=e[s];if(a.equalId(t))return a}return null},teasp.Tsf.InfoBase.prototype.createObject=function(e){var t={Id:null,EmpId__c:this.getEmpId(),EmpId__r:{EmpCode__c:this.getEmpCode(),Name:this.getEmpName(),ExpItemClass__c:this.getEmpExpItemClass(),UserId__r:{SmallPhotoUrl:this.getSmallPhotoUrl()}},DeptId__c:this.getDeptId(),
DeptId__r:this.getDept(),Status__c:null},e=(tsfManager.getTarget()==teasp.Tsf.Manager.EXP_PRE_APPLY&&(e=this.getExpPreApplyConfigByView(e),t.Type__c=e.key,t.instantFlag=e.instant||!1),new teasp.Tsf[tsfManager.getTarget()](t));return e.setRights(teasp.constant.P_E|teasp.constant.P_ME),this.objects.push(e),e},teasp.Tsf.InfoBase.prototype.removeObject=function(e){for(var t=this.objects.length-1;0<=t;t--)for(
var s=0;s<e.length;s++)if(this.objects[t].getId()==e[s].Id){this.objects.splice(t,1);break}},teasp.Tsf.InfoBase.prototype.setRecords=function(e,t){return teasp.Tsf.EmpExp.convertExps(e.exps),teasp.Tsf.InfoBase.margeExpRelation(e.records,e.exps),teasp.Tsf.InfoBase.mergeExpJsNaviRelation(e.records,e.jsnaviReserveList),this.objects=teasp.Tsf.ObjBase.merge(this.objects||[],teasp.Tsf.ObjBase.createList(e.target,e.records,
e.rights,e.piwks,e.steps)),this.setTargetEmp(e.targEmp),this.setCacheDeptByRecords(e.records),t?this.getObjById(this.objects,t):null},teasp.Tsf.InfoBase.prototype.setAttachmentExist=function(o,i){dojo.forEach(this.objects,function(e){for(var t=e.getEmpExps(),s=0;s<t.length;s++){var a=t[s];if(a.Id==o){i?(a.Attachments||(a.Attachments=[]),a.Attachments.push({Id:"DUMMY"})):a.Attachments=null;break}}},this)},
teasp.Tsf.InfoBase.prototype.getExpItemById=function(e){for(var t=0;t<this.expItems.length;t++)if(this.expItems[t].getId()==e)return this.expItems[t];return null},teasp.Tsf.InfoBase.prototype.getExpItemByItemCode=function(e){for(var t=0;t<this.expItems.length;t++)if(this.expItems[t].getItemCode()==e)return this.expItems[t];return null},teasp.Tsf.InfoBase.prototype.getPayItemById=function(e){for(
var t=0;t<this.payItems.length;t++)if(this.payItems[t].getId()==e)return this.payItems[t];return null},teasp.Tsf.InfoBase.prototype.getForeignById=function(e){for(var t=null,s=0;s<this.foreigns.length;s++)if(t||this.foreigns[s].getId()||(t=this.foreigns[s]),this.foreigns[s].getId()==e)return this.foreigns[s];return t},teasp.Tsf.InfoBase.prototype.getForeignByName=function(e){for(var t=0;t<this.foreigns.length;t++)if(
this.foreigns[t].getName()==e)return this.foreigns[t];return null},teasp.Tsf.InfoBase.prototype.isLoadError=function(){return"NG"==this.loadRes.result},teasp.Tsf.InfoBase.prototype.getLoadError=function(){return this.loadRes.error},teasp.Tsf.InfoBase.prototype.getLoadRes=function(){return this.loadRes},teasp.Tsf.InfoBase.prototype.getSessionUser=function(){return this.sessionUser},
teasp.Tsf.InfoBase.prototype.getSessionEmp=function(){return this.sessionEmp},teasp.Tsf.InfoBase.prototype.getSessionFullPhotoUrl=function(){return this.sessionEmp.getFullPhotoUrl()},teasp.Tsf.InfoBase.prototype.getSessionSmallPhotoUrl=function(){return this.sessionEmp.getSmallPhotoUrl()},teasp.Tsf.InfoBase.prototype.getSessionEmpId=function(){return this.sessionEmp.getEmpId()},
teasp.Tsf.InfoBase.prototype.getSessionEmpCode=function(){return this.sessionEmp.getEmpCode()},teasp.Tsf.InfoBase.prototype.getSessionEmpName=function(){return this.sessionEmp.getEmpName()},teasp.Tsf.InfoBase.prototype.getSessionDeptId=function(){return this.sessionEmp.getDeptId()},teasp.Tsf.InfoBase.prototype.getSessionDeptCode=function(){return this.sessionEmp.getDeptCode()},
teasp.Tsf.InfoBase.prototype.getSessionDeptName=function(){return this.sessionEmp.getDeptName()},teasp.Tsf.InfoBase.prototype.getSessionEmpTypeName=function(){return this.sessionEmp.getEmpTypeName()},teasp.Tsf.InfoBase.prototype.getTargetEmp=function(){return this.targetEmp},teasp.Tsf.InfoBase.prototype.getFullPhotoUrl=function(){return this.targetEmp.getFullPhotoUrl()},
teasp.Tsf.InfoBase.prototype.getSmallPhotoUrl=function(){return this.targetEmp.getSmallPhotoUrl()},teasp.Tsf.InfoBase.prototype.getEmpId=function(){return this.targetEmp.getEmpId()},teasp.Tsf.InfoBase.prototype.getEmpCode=function(){return this.targetEmp.getEmpCode()},teasp.Tsf.InfoBase.prototype.getEmpName=function(){return this.targetEmp.getEmpName()},teasp.Tsf.InfoBase.prototype.getDeptId=function(){
return this.targetEmp.getDeptId()},teasp.Tsf.InfoBase.prototype.getDept=function(){return this.targetEmp.getDept()},teasp.Tsf.InfoBase.prototype.getDeptCode=function(){return this.targetEmp.getDeptCode()},teasp.Tsf.InfoBase.prototype.getDeptName=function(){return this.targetEmp.getDeptName()},teasp.Tsf.InfoBase.prototype.getEmpTypeName=function(){return this.targetEmp.getEmpTypeName()},
teasp.Tsf.InfoBase.prototype.getStationFromHist=function(){return this.targetEmp.getStationHist()},teasp.Tsf.InfoBase.prototype.getStationToHist=function(){return this.targetEmp.getStationHist()},teasp.Tsf.InfoBase.prototype.getEmpExpHistory=function(){return this.targetEmp.getExpHistory()},teasp.Tsf.InfoBase.prototype.getEmpExpConfig=function(e){return this.targetEmp.getExpConfigEx(e)},
teasp.Tsf.InfoBase.prototype.getEmpCommuterPasses=function(){return this.targetEmp.getCommuterPasses()},teasp.Tsf.InfoBase.prototype.getEmpExpItemClass=function(){return this.targetEmp.getExpItemClass()},teasp.Tsf.InfoBase.prototype.getEmpJobAssigns=function(){return this.targetEmp.getJobAssigns()},teasp.Tsf.InfoBase.prototype.getEmpUserId=function(){return this.targetEmp.getUserId()},
teasp.Tsf.InfoBase.prototype.getPayExpItemId=function(){return this.targetEmp.getPayExpItemId()},teasp.Tsf.InfoBase.prototype.getEmpJobSearchCondition=function(){return this.targetEmp.getEmpJobSearchCondition()},teasp.Tsf.InfoBase.prototype.getDepts=function(){return this.depts},teasp.Tsf.InfoBase.prototype.getForeigns=function(){return this.foreigns},teasp.Tsf.InfoBase.prototype.getZgAccounts=function(){
return this.zgAccounts},teasp.Tsf.InfoBase.prototype.getObjects=function(){return this.objects},teasp.Tsf.InfoBase.prototype.getObjectById=function(e){return this.getObjById(this.objects,e)},teasp.Tsf.InfoBase.prototype.getCommon=function(){return this.common},teasp.Tsf.InfoBase.prototype.getExpCouponList=function(){return this.common.getExpCouponList()},teasp.Tsf.InfoBase.prototype.getExpPreApplyConfigs=function(){
return this.common.getExpPreApplyConfigs()},teasp.Tsf.InfoBase.prototype.getHelpLink=function(){return this.common.getHelpLink()},teasp.Tsf.InfoBase.prototype.isAllowEditExpAdmin=function(){return this.common.isAllowEditExpAdmin()},teasp.Tsf.InfoBase.prototype.isAllowEditManager=function(){return this.common.isAllowEditManager()},teasp.Tsf.InfoBase.prototype.isRequireChargeJob=function(){
return this.common.isRequireChargeJob()},teasp.Tsf.InfoBase.prototype.isRequireChargeDept=function(){return this.common.isRequireChargeDept()},teasp.Tsf.InfoBase.prototype.getExpCountLimit=function(){return this.common.getExpCountLimit()},teasp.Tsf.InfoBase.prototype.isExpLinkDocument=function(){return this.common.isExpLinkDocument()},teasp.Tsf.InfoBase.prototype.isAllowMinusApply=function(){
return this.common.isAllowMinusApply()},teasp.Tsf.InfoBase.prototype.getExpStartDate=function(){return this.common.getExpStartDate()},teasp.Tsf.InfoBase.prototype.isUseExpApproverSet=function(){return this.common.isUseExpApproverSet()},teasp.Tsf.InfoBase.prototype.getSocialExpenseItemId=function(){return this.common.getSocialExpenseItemId()},teasp.Tsf.InfoBase.prototype.isRequireNote=function(e){
return this.common.isRequireNote(e)},teasp.Tsf.InfoBase.prototype.isDisabledTimeReport=function(){return this.common.isDisabledTimeReport()},teasp.Tsf.InfoBase.prototype.getExtraItemOutputDataName1=function(){return this.common.getExtraItemOutputDataName1()},teasp.Tsf.InfoBase.prototype.getExtraItemOutputDataName2=function(){return this.common.getExtraItemOutputDataName2()},
teasp.Tsf.InfoBase.prototype.isUseExpCancelApply=function(){return this.common.isUseExpCancelApply()},teasp.Tsf.InfoBase.prototype.getJtbExpItems=function(){return this.common.getJtbExpItems()},teasp.Tsf.InfoBase.prototype.isUseJsNaviDummy=function(){return this.common.isUseJsNaviDummy()},teasp.Tsf.InfoBase.prototype.getAtkApplyTypeList=function(){return this.atkApplyTypeList},
teasp.Tsf.InfoBase.prototype.setEmpExpConfig=function(e){return this.targetEmp.setExpConfig(e)},teasp.Tsf.InfoBase.prototype.isUsingReceiptSystem=function(){return this.common.isUsingReceiptSystem()&&this.targetEmp.isUsingReceiptSystem()},teasp.Tsf.InfoBase.prototype.isUsingJsNaviSystem=function(){return this.usingJsNaviFlag&&this.targetEmp.isUsingJsNaviSystem()},
teasp.Tsf.InfoBase.prototype.isUseConnectICExpense=function(){return this.usingConnectICforPitTouchExpense&&this.targetEmp.isUsingConnectIC()&&this.common.isUseConnectICExpense()},teasp.Tsf.InfoBase.prototype.isUseScannerStorage=function(){return this.common.isUseScannerStorage()},teasp.Tsf.InfoBase.prototype.isSysAdmin=function(){return this.sessionUser.isSysAdmin()},teasp.Tsf.InfoBase.prototype.isManager=function(
){return this.sessionUser.getId()==this.getTargetEmp().getManagerId()},teasp.Tsf.InfoBase.prototype.isExpAdmin=function(){return this.sessionEmp.isExpAdmin()||this.sessionEmp.isAdmin()||this.isSysAdmin()},teasp.Tsf.InfoBase.prototype.getExpItems=function(e,t){for(var s=[],a=0;a<this.expItems.length;a++){var o=this.expItems[a];!o.isSelectable(e.empExpItemClass)&&!o.isSelectable(e.deptExpItemClass
)||!o.checkExpenseType(e.expenseType)||!t&&o.isRemoved()||s.push(o)}return s},teasp.Tsf.InfoBase.prototype.getPayItems=function(t){var s=[];return dojo.forEach(this.payItems,function(e){t&&(!e.isSelectable(t.empExpItemClass)&&!e.isSelectable(t.deptExpItemClass)||!e.checkExpenseType(t.expenseType))||e.isRemoved()||s.push(e)}),s},teasp.Tsf.InfoBase.prototype.getTaxRoundFlag=function(){
return this.common.getTaxRoundFlag()},teasp.Tsf.InfoBase.prototype.getTicketPeriod=function(){return this.common.getTicketPeriod()},teasp.Tsf.InfoBase.prototype.isExpWorkflow=function(){return this.common.isExpWorkflow()},teasp.Tsf.InfoBase.prototype.isCommuterPassWorkflow=function(){return this.common.isCommuterPassWorkflow()},teasp.Tsf.InfoBase.prototype.getUseEkitan=function(){return this.common.getUseEkitan()},
teasp.Tsf.InfoBase.prototype.isOutputJournal=function(){return this.common.isOutputJournal()},teasp.Tsf.InfoBase.prototype.getSessionEmp=function(){return this.sessionEmp},teasp.Tsf.InfoBase.prototype.getExpPreApplyConfigByName=function(e){return this.common.getExpPreApplyConfigByName(e)},teasp.Tsf.InfoBase.prototype.getExpPreApplyConfigByView=function(e){return this.common.getExpPreApplyConfigByView(e)},
teasp.Tsf.InfoBase.prototype.setExpHistory=function(e,t){this.targetEmp.setExpHistory(e,t)},teasp.Tsf.InfoBase.prototype.isOldRevi=function(){return!!this.borderRevNo&&this.common.getRevision()<this.borderRevNo},teasp.Tsf.InfoBase.margeExpRelation=function(e,t){e&&0<e.length&&(e[0].EmpExp__r=t||[])},teasp.Tsf.InfoBase.mergeExpJsNaviRelation=function(e,t){e&&0<e.length&&(e[0].ExpJsNavi__r=t||[])},
teasp.Tsf.InfoBase.prototype.getDefaultChargeDept=function(){var e=this.targetEmp;return{ChargeDeptId__c:e?e.getDeptId():null,ChargeDeptId__r:e?e.getDept():null}},teasp.Tsf.InfoBase.prototype.getStartView=function(e,t){return null},teasp.Tsf.InfoBase.prototype.isHiddenApplyBtn=function(){return!1},teasp.Tsf.InfoBase.prototype.isApplyByDetails=function(){return!1},teasp.Tsf.InfoBase.prototype.getExpenseTypes=function(
e,t){e=e||[];return e.length||(e=this.common.getExpPreApplyConfigs().expenseTypes||[]),t&&!e.contains("")?[""].concat(e):e},teasp.Tsf.InfoBase.prototype.isPossibleAtFormByApiKey=function(e,t){return e==teasp.constant.EXP_PRE_FORM1||e==teasp.constant.EXP_PRE_FORM2||e==teasp.constant.EXP_PRE_FORM3?!["ChargeJobId__c","ExpectedPayDate__c"].contains(t):e!=teasp.constant.EXP_PRE_FORM4||!["ChargeJobId__c","ApplyDate__c",
"ExpectedPayDate__c"].contains(t)},teasp.Tsf.InfoBase.prototype.getUseTitle=function(e,t){if(e!=teasp.constant.EXP_FORM0)return 0;e=this.common.getExpPreApplyConfigByName(e).useTitle||0;return!e&&t&&t.Title__c?1:e},teasp.Tsf.InfoBase.prototype.isUseExpenseType=function(e,t){var s="ExpenseType__c";return!!(t&&t[s]&&this.isPossibleAtFormByApiKey(e,s))||(this.common.getExpPreApplyConfigByName(e).useExpenseType||!1)},
teasp.Tsf.InfoBase.prototype.isUsePayMethod=function(e,t){var s="PayExpItemId__c";return!!(t&&t[s]&&this.isPossibleAtFormByApiKey(e,s))||(this.common.getExpPreApplyConfigByName(e).usePayMethod||!1)},teasp.Tsf.InfoBase.prototype.isUseApplyDate=function(e,t){var s="ApplyDate__c";return!!(t&&t[s]&&this.isPossibleAtFormByApiKey(e,s))||(this.common.getExpPreApplyConfigByName(e).useApplyDate||!1)},
teasp.Tsf.InfoBase.prototype.isUsePayDate=function(e,t){var s="ExpectedPayDate__c";return!!(t&&t[s]&&this.isPossibleAtFormByApiKey(e,s))||(this.common.getExpPreApplyConfigByName(e).usePayDate||!1)},teasp.Tsf.InfoBase.prototype.isUseProvisional=function(e,t){var s="ProvisionalPaymentId__c";return!!(t&&t[s]&&this.isPossibleAtFormByApiKey(e,s))||(!(t&&t.ExpPreApplyId__r&&t.ExpPreApplyId__r.ProvisionalPaymentAmount__c
)&&this.common.getExpPreApplyConfigByName(e).useProvisional||!1)},teasp.Tsf.InfoBase.prototype.isUseChargeJob=function(e,t){var s="ChargeJobId__c";return!!(t&&t[s]&&this.isPossibleAtFormByApiKey(e,s))||(this.common.getExpPreApplyConfigByName(e).useChargeJob||!1)},teasp.Tsf.InfoBase.prototype.isUseChargeDept=function(e,t){var s="ChargeDeptId__c";return!!(t&&t[s]&&this.isPossibleAtFormByApiKey(e,s))||(
this.common.getExpPreApplyConfigByName(e).useChargeDept||!1)},teasp.Tsf.InfoBase.prototype.isUseExtraItem1=function(e,t){var s="ExtraItem1__c";return!!(t&&t[s]&&this.isPossibleAtFormByApiKey(e,s))||(this.common.getExpPreApplyConfigByName(e).useExtraItem1||!1)},teasp.Tsf.InfoBase.prototype.isUseExtraItem2=function(e,t){var s="ExtraItem2__c";return!!(t&&t[s]&&this.isPossibleAtFormByApiKey(e,s))||(
this.common.getExpPreApplyConfigByName(e).useExtraItem2||!1)},teasp.Tsf.InfoBase.prototype.isDptArvFlagsOptional=function(e){return this.common.getExpPreApplyConfigByName(e).dptArvFlagsOptional||!1},teasp.Tsf.InfoBase.prototype.isUseOverseaTravel=function(e){return this.common.getExpPreApplyConfigByName(e).useOverseaTravel||!1},teasp.Tsf.InfoBase.prototype.isUseOneDayTrip=function(e){
return this.common.getExpPreApplyConfigByName(e).useOneDayTrip||!1},teasp.Tsf.InfoBase.prototype.isUseJtbSect=function(e){return this.common.getExpPreApplyConfigByName(e).useJtbSect||!1},teasp.Tsf.InfoBase.prototype.isUseAllowanceSect=function(e){return this.common.getExpPreApplyConfigByName(e).useAllowanceSect||!1},teasp.Tsf.InfoBase.prototype.isUseCouponTicketSect=function(e){
return this.common.getExpPreApplyConfigByName(e).useCouponTicketSect||!1},teasp.Tsf.InfoBase.prototype.isUseTicketArrangeSect=function(e){return this.common.getExpPreApplyConfigByName(e).useTicketArrangeSect||!1},teasp.Tsf.InfoBase.prototype.isUseProvisionalSect=function(e){return this.common.getExpPreApplyConfigByName(e).useProvisionalSect||!1},teasp.Tsf.InfoBase.prototype.isUseFreeInputSect=function(e){
return this.common.getExpPreApplyConfigByName(e).useFreeInputSect||!1},teasp.Tsf.InfoBase.prototype.isUseAttachment=function(e){return this.common.getExpPreApplyConfigByName(e).useAttachment||!1},teasp.Tsf.InfoBase.prototype.isUseCsvImport=function(e){var t=this.common.getExpPreApplyConfigByName(e).useCsvImport;return null==t&&"expApply"==e?"1"==this.common.getLocalKey().substring(20,21):t},
teasp.Tsf.InfoBase.prototype.isExpItemRevise=function(){var e=this.common.getExpPreApplyConfigs().expItemRevise;return"boolean"==typeof e?e:"1"==this.common.getLocalKey().substring(20,21)},teasp.Tsf.InfoBase.prototype.setCacheDept=function(e,t){this.cacheDept||(this.cacheDept={}),e&&("string"==typeof e?this.cacheDept[e]=t||null:"object"==typeof e&&e.ChargeDeptId__c&&e.ChargeDeptId__r&&(
this.cacheDept[e.ChargeDeptId__c]=e.ChargeDeptId__r,this.cacheDept[e.ChargeDeptId__c].Id=e.ChargeDeptId__c))},teasp.Tsf.InfoBase.prototype.setCacheDeptByRecords=function(e){dojo.forEach(e||[],function(e){e.CacheDeptId__c&&e.CacheDeptId__r&&this.setCacheDept(e.CacheDeptId__c,e.CacheDeptId__r)},this)},teasp.Tsf.InfoBase.prototype.createCacheDept=function(){this.cacheDept||(this.cacheDept={}),dojo.forEach(this.depts,
function(e){this.cacheDept[e.getId()]=e.getObj(),this.cacheDept[e.getId()].Id=e.getId()},this)},teasp.Tsf.InfoBase.prototype.getCacheDept=function(e){return e&&this.cacheDept&&this.cacheDept[e]||null},teasp.Tsf.InfoBase.prototype.setCacheJob=function(e,t){this.cacheJob||(this.cacheJob={}),e&&("string"==typeof e?this.cacheJob[e]=t||null:"object"==typeof e&&(
e.ChargeJobId__c&&e.ChargeJobId__r?this.cacheJob[e.ChargeJobId__c]=e.ChargeJobId__r:e.JobId__c&&e.JobId__r&&(this.cacheJob[e.JobId__c]=e.JobId__r)))},teasp.Tsf.InfoBase.prototype.getCacheJob=function(e){return e&&this.cacheJob&&this.cacheJob[e]||null},teasp.Tsf.InfoBase.prototype.setCacheProvis=function(e,t){this.cacheProvis||(this.cacheProvis={}),e&&(
"string"==typeof e?this.cacheProvis[e]=t||null:"object"==typeof e&&e.ProvisionalPaymentId__c&&e.ProvisionalPaymentId__r&&(this.cacheProvis[e.ProvisionalPaymentId__c]=e.ProvisionalPaymentId__r,this.cacheProvis[e.ProvisionalPaymentId__c].Id=e.ProvisionalPaymentId__c))},teasp.Tsf.InfoBase.prototype.setCacheProvisByRecords=function(e){dojo.forEach(e||[],function(e){
e.ProvisionalPaymentId__c&&e.ProvisionalPaymentId__r&&this.setCacheProvis(e.ProvisionalPaymentId__c,e.ProvisionalPaymentId__r)},this)},teasp.Tsf.InfoBase.prototype.getCacheProvis=function(e){return e&&this.cacheProvis&&this.cacheProvis[e]||null},teasp.Tsf.InfoBase.prototype.getStartEndByYearMonth=function(e){if(this.sessionEmp)return this.sessionEmp.getStartEndByYearMonth(e);var t=Math.floor(e/100),t=new Date(t,
e%100-1,1),s=teasp.util.date.addDays(teasp.util.date.addMonths(t,1),-1);return{yearMonth:e,startDate:teasp.util.date.formatDate(t),endDate:teasp.util.date.formatDate(s)}},teasp.Tsf.InfoBase.prototype.replaceDeptList=function(e){this.depts=teasp.Tsf.Dept.createList(e||[])},teasp.Tsf.InfoBase.prototype.isExtendedExpenseFunction=function(){return this.privateOption.EnableExtendedExpenseFunction__c||!1},
teasp.Tsf.InfoBase.prototype.isReceiptReaderConnect=function(){return!!this.privateOption.ReceiptReaderAuthUserName__c},teasp.Tsf.InfoBase.prototype.getStatusPickList=function(){var e=[];return e.push({v:"",n:""}),this.isExtendedExpenseFunction()?(e.push({v:"仕訳済み以外",msgId:"tf10001951"}),e.push({v:"仕訳済み",msgId:"tf10006220"})):(e.push({v:"精算済み以外",msgId:"tf10001950"}),e.push({v:"精算済み",msgId:"reimbursement_label"})),
this.isExpWorkflow()?(e.push({v:"承認済み",msgId:"tm10003480"}),e.push({v:"承認待ち",msgId:"waitApproval_label"}),e.push({v:"申請取消",msgId:"tm10003500"}),e.push({v:"却下",msgId:"tm10003490"})):(e.push({v:"確定済み",msgId:"fixed_label"}),e.push({v:"確定取消",msgId:"cancelFix_btn_title"})),this.isUseExpCancelApply()&&(e.push({v:"取消伝票承認済み",msgId:"tf10006210"}),e.push({v:"取消伝票承認待ち",msgId:"tf10006200"})),e.push({v:"未申請",msgId:"tm10003560"}),
e},teasp.Tsf.InfoBase.prototype.getRights=function(){return this.rights},teasp.Tsf.InfoBase.prototype.patchDef=function(){var e;this.isExpItemRevise()&&((e=teasp.Tsf.formParams.expItems||{}).fields=[{check:!0,domId:"ExpItem{0}_Check",domType:"checkbox",width:24},{label:"Id",apiKey:"Id",domId:"ExpItem{0}Id",domType:"text",hidden:!0},{label:"費目種別",apiKey:"TransportType__c",domId:"ExpItem{0}TransportType",
domType:"text",notUse:!0},{label:"手当種別",apiKey:"AllowanceFlag__c",domId:"ExpItem{0}AllowanceFlag",domType:"text",notUse:!0},{label:"精算区分",apiKey:"ExpenseType__c",domId:"ExpItem{0}ExpenseType",domType:"text",notUse:!0},{label:"使用制限あり",apiKey:"RestrictTargetEmployee__c",domId:"ExpItem{0}RestrictTargetEmployee",domType:"text",notUse:!0},{label:"使用可能社員",apiKey:"TargetEmployee__c",domId:"ExpItem{0}TargetEmployee",
domType:"text",notUse:!0},{label:"費目コード",msgId:"tf10007840",apiKey:"ItemCode__c",domId:"ExpItem{0}ItemCode",domType:"text",width:110,sortable:!0},{label:"費目名",msgId:"tf10007850",apiKey:"Name",domId:"ExpItem{0}Name",domType:"text",width:150,sortable:!0},{label:"科目コード",msgId:"tf10007860",apiKey:"Code__c",domId:"ExpItem{0}Code",domType:"text",width:110,sortable:!0},{label:"科目名",msgId:"tf10007870",apiKey:"ItemName__c",
domId:"ExpItem{0}ItemName",domType:"text",width:150,sortable:!0},{label:"補助科目コード",msgId:"tk10000707",apiKey:"AuxCode__c",domId:"ExpItem{0}AuxCode",domType:"text",width:110,sortable:!0},{label:"補助科目名",msgId:"tm20004575",apiKey:"AuxTitle__c",domId:"ExpItem{0}AuxTitle",domType:"text",width:150,sortable:!0}],e.sortKeys=[{apiKey:"ItemCode__c"}],e.searchFields=[{label:"費目コード",msgId:"tf10007840",apiKey:"ItemCode__c",
domId:"ExpItemSearchItemCode",domType:"text",width:100,lw:"auto",wr:!0,matchType:3,noNL:!0},{label:"費目名",msgId:"tf10007850",apiKey:"Name",domId:"ExpItemSearchName",domType:"text",width:110,lw:"auto",wr:!0,matchType:3,noNL:!0},{label:"科目コード",msgId:"tf10007860",apiKey:"Code__c",domId:"ExpItemSearchCode",domType:"text",width:100,lw:"auto",wr:!0,matchType:3,noNL:!0},{label:"科目名",msgId:"tf10007870",apiKey:"ItemName__c",
domId:"ExpItemSearchItemName",domType:"text",width:110,lw:"auto",wr:!0,matchType:3,noNL:!0},{label:"費目ID",apiKey:"Id",domId:"ExpItemSearchId",domType:"array",hidden:!0}])},teasp.Tsf.InfoBase.prototype.setExpFilter=function(e){this.expFilter=e},teasp.Tsf.InfoBase.prototype.getExpFilter=function(){return this.expFilter||{}},teasp.Tsf.InfoBase.prototype.getUnderDeptIds=function(e){return teasp.Tsf.Dept.getUnderDeptIds(
this.depts,e)},teasp.Tsf.InfoBase.prototype.isDoNotCopyExtraItem=function(){return this.common.getExpPreApplyConfigs().expApply.doNotCopyExtraItem||!1},teasp.Tsf.InfoExpApply=function(){},teasp.Tsf.InfoExpApply.prototype=new teasp.Tsf.InfoBase,teasp.Tsf.InfoExpApply.prototype.init=function(e){teasp.Tsf.InfoBase.prototype.init.call(this,e),this.expApplys=teasp.Tsf.ExpApply.createList(e.expApplys)},
teasp.Tsf.InfoExpApply.prototype.isValid=function(e){return!0},teasp.Tsf.InfoExpApply.prototype.getStartView=function(e,t){return!e&&!t&&this.common.getExpPreApplyConfigs().expApply.startFromList?teasp.Tsf.Manager.EXP_LIST_VIEW:null},teasp.Tsf.InfoExpApply.prototype.isHiddenApplyBtn=function(){return this.common.getExpPreApplyConfigs().expApply.hiddenApplyBtn},
teasp.Tsf.InfoExpApply.prototype.isApplyByDetails=function(){return this.isHiddenApplyBtn()},teasp.Tsf.InfoExpApply.prototype.newObject=function(e){return{Id:null,EmpId__c:this.getEmpId(),EmpId__r:{EmpCode__c:this.getEmpCode(),Name:this.getEmpName(),ExpItemClass__c:this.getEmpExpItemClass(),UserId__r:{SmallPhotoUrl:this.getSmallPhotoUrl()}},DeptId__c:this.getDeptId(),DeptId__r:this.getDept(),Status__c:null,
createFlag:e||!1}},teasp.Tsf.InfoExpApply.prototype.createObject=function(e,t){t=this.newObject(t),this.isUsePayMethod(teasp.constant.EXP_FORM0)&&(t.PayExpItemId__c=this.getPayExpItemId()),this.isUseApplyDate(teasp.constant.EXP_FORM0)&&(t.ApplyDate__c=teasp.util.date.formatDate(teasp.util.date.getToday())),this.isUseChargeDept(teasp.constant.EXP_FORM0)&&(t.ChargeDeptId__c=this.getDeptId()),
t=new teasp.Tsf[tsfManager.getTarget()](t);return t.setRights(teasp.constant.P_E|teasp.constant.P_ME),this.objects.push(t),t},teasp.Tsf.InfoExpApply.prototype.getExpApplyNoList=function(){var t=[];return dojo.forEach(this.expApplys,function(e){t.push({id:e.getId(),applyNo:e.getApplyNo()})}),t},teasp.Tsf.InfoExpApply.prototype.setRecords=function(e,t){var s;return teasp.Tsf.EmpExp.convertExps(e.exps),e.records?(
teasp.Tsf.InfoBase.margeExpRelation(e.records,e.exps),e.records[0].JsNaviData={},e.records[0].JsNaviData.ReserveData=e.jsnaviReserveList||[],e.records[0].JsNaviData.ActualData=e.jsnaviActualList||[],e.records[0].JsNaviData.message=e.message||[],e.records[0].JsNaviData.isPossibilityNewActualDataDelivered=e.isPossibilityNewActualDataDelivered||!1):((s=this.newObject()).EmpExp__r=e.exps||[],e.records=[s]),
e.expPreApplys&&(console.log("======================="),console.log(e.expPreApplys),teasp.Tsf.InfoBase.margeExpRelation(e.expPreApplys,e.expPreApplyExps)),e.expApplys&&(this.expApplys=teasp.Tsf.ExpApply.createList(e.expApplys,t)),this.objects=teasp.Tsf.ObjBase.merge(this.objects||[],teasp.Tsf.ObjBase.createList(e.target,e.records,e.rights,e.piwks,e.steps)),this.setTargetEmp(e.targEmp),this.setCacheDeptByRecords(
e.records),this.setCacheProvisByRecords(e.records),this.setExpPreApplys(e),this.isValid(t)?this.getObjById(this.objects,t):null},teasp.Tsf.InfoExpApply.prototype.setExpPreApplys=function(e){var a=e.expPreApplys||[],a=teasp.Tsf.ObjBase.createList("AtkExpPreApply__c",a);dojo.forEach(this.objects,function(e){for(var t=0;t<a.length;t++){var s=a[t];if(e.getExpPreApplyId()==s.getId()){e.setExpPreApply(s);break}}},this)},
teasp.Tsf.InfoExpApply.prototype.submitApply=function(e,t,s,a){var o=[],t=(dojo.forEach(s.ids,function(e){o.push({id:e})}),{method:"submitExpApply",empId:tsfManager.getEmpId(),expApplyId:t,details:o,comment:s.comment||null,ringiId:s.ringiId||null,expApply:s.expApply||null});console.log("[InfoExpApply.submitApply] submitExpApply"),console.log(t),tsfManager.loading.show(),Visualforce.remoting.Manager.invokeAction(
teasp.Tsf.Manager.API_POTAL_ACTION,teasp.Tsf.util.toJson(t),teasp.Tsf.Dom.hitch(this,function(e,t){var s;console.log(t),t.status&&"OK"==e.result?(teasp.util.excludeNameSpace(e),s=(s=e.expApplyId)||(e.expLogs&&0<e.expLogs.length?e.expLogs[0].ExpApplyId__r.Id:null),e.expApplys&&(this.expApplys=teasp.Tsf.ExpApply.createList(e.expApplys,s)),a(!0,{id:s})):(tsfManager.loading.hide(),a(!1,t.status?e:t))}),{escape:!1})},
teasp.Tsf.InfoExpApply.prototype.cancelApply=function(e,t,s){var a={method:"cancelExpApply",empId:tsfManager.getEmpId(),expApplyId:e.id,cancelApplyId:e.cancelApplyId,isCancelApplyWait:e.isCancelApplyWait,comment:t.comment||null},o=t.solve?null:e.id;console.log("[InfoExpApply.cancelApply] cancelExpApply"),console.log(a),tsfManager.loading.show(),Visualforce.remoting.Manager.invokeAction(
teasp.Tsf.Manager.API_POTAL_ACTION,teasp.Tsf.util.toJson(a),teasp.Tsf.Dom.hitch(this,function(e,t){console.log(t),t.status&&"OK"==e.result?(teasp.util.excludeNameSpace(e),e.expApplys&&(this.expApplys=teasp.Tsf.ExpApply.createList(e.expApplys,o)),s(!0,o)):(tsfManager.loading.hide(),s(!1,t.status?e:t))}),{escape:!1})},teasp.Tsf.InfoExpApply.prototype.approveApply=function(e,s,t,a){t={
method:t?"approveExpApply":"rejectExpApply",approve:!!t,comment:s.comment||null,apply:[{id:s.id,cancelApplyId:s.cancelApplyId,isCancelApplyWait:s.isCancelApplyWait}]};console.log("[InfoExpApply.approveApply] "+t.method),console.log(t),tsfManager.loading.show(),Visualforce.remoting.Manager.invokeAction(teasp.Tsf.Manager.API_POTAL_ACTION,teasp.Tsf.util.toJson(t),teasp.Tsf.Dom.hitch(this,function(e,t){console.log(t),
t.status&&"OK"==e.result?(teasp.util.excludeNameSpace(e),e.expApplys&&(this.expApplys=teasp.Tsf.ExpApply.createList(e.expApplys,s.id)),a(!0,s.id)):(tsfManager.loading.hide(),a(!1,t.status?e:t))}),{escape:!1})},teasp.Tsf.InfoExpPreApply=function(){},teasp.Tsf.InfoExpPreApply.prototype=new teasp.Tsf.InfoBase,teasp.Tsf.InfoExpPreApply.prototype.createObject=function(e){tsfManager.isEmpTargetMode(
)||this.setTargetSessionEmp();var t={Id:null,EmpId__c:this.getEmpId(),EmpId__r:{EmpCode__c:this.getEmpCode(),Name:this.getEmpName(),ExpItemClass__c:this.getEmpExpItemClass(),UserId__r:{SmallPhotoUrl:this.getSmallPhotoUrl()}},DeptId__c:this.getDeptId(),DeptId__r:this.getDept(),Status__c:"未確定"},e=this.getExpPreApplyConfigByView(e),e=(t.Type__c=e.key,t.instantFlag=e.instant||!1,this.isUsePayMethod(t.Type__c)&&(
t.PayExpItemId__c=this.getPayExpItemId()),!this.isUseApplyDate(t.Type__c)&&t.Type__c!=teasp.constant.EXP_PRE_FORM4||(t.ApplyDate__c=teasp.util.date.formatDate(teasp.util.date.getToday())),this.isUseChargeDept(t.Type__c)&&(t.ChargeDeptId__c=this.getDeptId()),new teasp.Tsf[tsfManager.getTarget()](t));return e.setRights(teasp.constant.P_E|teasp.constant.P_ME),this.objects.push(e),e},
teasp.Tsf.InfoExpPreApply.prototype.getExpCouponList=function(){return this.common.getExpCouponList()},teasp.Tsf.InfoExpPreApply.prototype.getExpPreApplyConfigs=function(){return this.common.getExpPreApplyConfigs()},teasp.Tsf.InfoExpPreApply.prototype.getExpPreApplyConfigByName=function(e){return this.common.getExpPreApplyConfigByName(e)},teasp.Tsf.InfoExpPreApply.prototype.getExpPreApplyConfigByView=function(e){
return this.common.getExpPreApplyConfigByView(e)},teasp.Tsf.InfoExpPreApply.prototype.submitApply=function(e,t,s,a){var o=null,e=(tsfManager.checkDiff()&&((o=(e=e.getDomValues()).values[0]).days=e.ExpPreApplyDay__r&&e.ExpPreApplyDay__r.values||[],o.exps=e.EmpExp__r&&e.EmpExp__r.values||[]),{method:"submitExpPreApply",id:t,comment:s.comment||null,expPreApply:o});console.log(
"[InfoExpPreApply.submitApply] submitExpPreApply"),console.log(e),tsfManager.loading.show(),Visualforce.remoting.Manager.invokeAction(teasp.Tsf.Manager.API_POTAL_ACTION,teasp.Tsf.util.toJson(e),teasp.Tsf.Dom.hitch(this,function(e,t){console.log(t),t.status&&"OK"==e.result?(teasp.util.excludeNameSpace(e),this.removeObject([{Id:null}]),a(!0,e)):(tsfManager.loading.hide(),a(!1,t.status?e:t))}),{escape:!1})},
teasp.Tsf.InfoExpPreApply.prototype.cancelApply=function(e,t,s){e={method:"cancelExpPreApply",id:e.id,cancelApplyId:e.cancelApplyId,isCancelApplyWait:e.isCancelApplyWait,comment:t.comment||null};console.log("[InfoExpPreApply.cancelApply] cancelExpPreApply"),console.log(e),tsfManager.loading.show(),Visualforce.remoting.Manager.invokeAction(teasp.Tsf.Manager.API_POTAL_ACTION,teasp.Tsf.util.toJson(e),
teasp.Tsf.Dom.hitch(this,function(e,t){console.log(t),t.status&&"OK"==e.result?(teasp.util.excludeNameSpace(e),s(!0,e.id)):(tsfManager.loading.hide(),s(!1,t.status?e:t))}),{escape:!1})},teasp.Tsf.InfoExpPreApply.prototype.approveApply=function(e,t,s,a){s={method:s?"approveExpPreApply":"rejectExpPreApply",id:t.id,cancelApplyId:t.cancelApplyId,isCancelApplyWait:t.isCancelApplyWait,comment:t.comment||null};console.log(
"[InfoExpPreApply.approveApply] "+s.method),console.log(s),tsfManager.loading.show(),Visualforce.remoting.Manager.invokeAction(teasp.Tsf.Manager.API_POTAL_ACTION,teasp.Tsf.util.toJson(s),teasp.Tsf.Dom.hitch(this,function(e,t){console.log(t),t.status&&"OK"==e.result?(teasp.util.excludeNameSpace(e),a(!0,e.id)):(tsfManager.loading.hide(),a(!1,t.status?e:t))}),{escape:!1})},teasp.Tsf.InfoExpJsNavi=function(){},
teasp.Tsf.InfoExpJsNavi.prototype=new teasp.Tsf.InfoBase,teasp.Tsf.InfoExpJsNaviDetail=function(){},teasp.Tsf.InfoExpJsNaviDetail.prototype=new teasp.Tsf.InfoBase,teasp.Tsf.InfoExpPay=function(){},teasp.Tsf.InfoExpPay.prototype=new teasp.Tsf.InfoBase,teasp.Tsf.InfoAttach=function(){},teasp.Tsf.InfoAttach.prototype=new teasp.Tsf.InfoBase,teasp.Tsf.InfoAttach.prototype.init=function(e){
teasp.Tsf.InfoBase.prototype.init.call(this,e),this.attachments=teasp.Tsf.Attachment.createList(e.attachments)},teasp.Tsf.InfoAttach.prototype.getAttachments=function(){return this.attachments},teasp.Tsf.InfoCsvUpload=function(){},teasp.Tsf.InfoCsvUpload.prototype=new teasp.Tsf.InfoExpApply,teasp.Tsf.InfoCsvUpload.prototype.init=function(e){teasp.Tsf.InfoBase.prototype.init.call(this,e),
this.attachments=teasp.Tsf.Attachment.createList(e.attachments)},teasp.Tsf.InfoCsvUpload.prototype.getAttachments=function(){return this.attachments},teasp.Tsf.InfoCsvUpload.prototype.getStartView=function(){return teasp.Tsf.Manager.CSV_UPLOAD},teasp.Tsf.InfoEmpTable=function(){},teasp.Tsf.InfoEmpTable.prototype=new teasp.Tsf.InfoBase,teasp.Tsf.InfoEmpTable.prototype.init=function(e){
teasp.Tsf.InfoBase.prototype.init.call(this,e),this.selectDeptId=e.deptId,this.month=e.month+(e.subNo?"."+e.subNo:""),this.months=e.months,this.todayYm=e.todayYm;var t=e.targetMonth;if(t){for(var s=0;s<this.months.length;s++){var a=this.months[s];if(a.yearMonth==t.yearMonth&&a.subNo==t.subNo)break}s>=this.months.length&&this.months.push(t)}},teasp.Tsf.InfoEmpTable.prototype.getSelectDeptId=function(){
return this.selectDeptId},teasp.Tsf.InfoEmpTable.prototype.setSelectDeptId=function(e){this.selectDeptId=e},teasp.Tsf.InfoEmpTable.prototype.getMonth=function(){return""+this.month},teasp.Tsf.InfoEmpTable.addYm=function(e,t){var s,a=Math.floor(e/100),e=e%100;return e+=t,t<0&&e<=0?(s=-1*e,a-=Math.floor((12+s)/12),e=12-s%12):0<t&&12<e&&(a+=Math.floor((e-1)/12),e=(e-1)%12+1),100*a+e},
teasp.Tsf.InfoEmpTable.prototype.getMonthList=function(){var t=[],s=[];return dojo.forEach(this.months,function(e){t.push({ym:e.yearMonth,sn:e.subNo,key:e.yearMonth+(e.subNo?"."+e.subNo:"")})}),t=t.sort(function(e,t){return e.ym==t.ym?(t.sn||0)-(e.sn||0):t.ym-e.ym}),dojo.forEach(t,function(e){s.push({value:e.key,label:teasp.util.date.formatMonth("zv00000021",Math.floor(e.ym/100),e.ym%100,e.sn)})}),s},
teasp.Tsf.InfoEmpTable.prototype.getStartEndByYearMonth=function(e){for(var e=(""+e).split("."),t=e[0],s=1<e.length&&e[1]||null,a=null,o=0;o<this.months.length;o++){var i=this.months[o];if(i.yearMonth==t&&i.subNo==s){a=i;break}}return{yearMonth:a.yearMonth,subNo:a.subNo,startDate:a.startDate,endDate:a.endDate}},teasp.Tsf.InfoPrintExpPay=function(){},teasp.Tsf.InfoPrintExpPay.prototype=new teasp.Tsf.InfoBase,
teasp.Tsf.InfoExpPrint=function(){},teasp.Tsf.InfoExpPrint.prototype=new teasp.Tsf.InfoExpApply,teasp.Tsf.InfoExpPrint.prototype.approveApply=function(e,t,s,a){console.log(t);(new(tsfManager.getCurrentFormType()?teasp.Tsf.InfoExpPreApply:teasp.Tsf.InfoExpApply)).approveApply(e,t,s,a)},teasp.Tsf.InfoExpPrint.prototype.setRecords=function(e,t){return t||e.target||(e.target="AtkExpApply__c"),
teasp.Tsf.InfoBase.mergeExpJsNaviRelation(e.records,e.jsnaviReserveList),teasp.Tsf.InfoExpApply.prototype.setRecords.call(this,e,t)},teasp.Tsf.receiptExifLogic={isSatisfyScannerStorageRequirement:function(e,t,s,a){var o,i=null,p=null,r=null,n=null;return e&&t&&(o=Math.max(e,t),i=Math.min(e,t)>=teasp.constant.SHORTSIDE_LOWERLIMIT,p=o>=teasp.constant.LONGSIDE_LOWERLIMIT),{isShortSideValid:i,isLongSideValid:p,
IsGradationValid:r=s?s>=teasp.constant.BITSPERSAMPLE_LOWERLIMIT:r,isColorTypeValid:n=a?a==teasp.constant.COLORTYPE_LIMIT:n}},getExifFromBase64:function(e){try{var t=ExifReader.load(_base64ToArrayBuffer(e));return{bitsPerSample:t["Bits Per Sample"].value,imageHeight:t["Image Height"].value,imageWidth:t["Image Width"].value,colorType:1<t["Color Components"].value?"Color":"GrayScale"}}catch(e){return{}}}},
teasp.Tsf.CsvImportLogic=function(){this.importData="",this.details="",this.message="",this.COL=null},teasp.Tsf.CsvImportLogic.prototype.getImportData=function(){return this.importData},teasp.Tsf.CsvImportLogic.prototype.setImportData=function(e){this.importData=e},teasp.Tsf.CsvImportLogic.prototype.getDetails=function(){return this.details},teasp.Tsf.CsvImportLogic.prototype.initDetails=function(){this.details=""},
teasp.Tsf.CsvImportLogic.prototype.addDetails=function(e){this.details+=e+"\n"},teasp.Tsf.CsvImportLogic.prototype.getMessage=function(){return this.message},teasp.Tsf.CsvImportLogic.prototype.setMessage=function(e){this.message=e},teasp.Tsf.CsvImportLogic.prototype.getCOL=function(){return this.COL},teasp.Tsf.CsvImportLogic.prototype.convertCsvData=function(e){this.payees=e.payees,this.depts=e.depts,this.jobs=e.jobs
,this.expenseType=e.expenseType,this.targetEmp=e.targetEmp;var t=e.datas,s={},a=(dojo.forEach(e.headers,function(e){s[e.name]=e.label}),{DATE:{key:"Date",name:s.Date||teasp.message.getLabel("tf10000940")},ITEM_CODE:{key:"ItemCode",name:s.ItemCode||teasp.message.getLabel("tk10000074")},COST:{key:"Cost",name:s.COST||teasp.message.getLabel("tf10000950")},DETAIL:{key:"Detail",name:s.Detail||teasp.message.getLabel(
"note_caption")},UNIT_PRICE:{key:"UnitPrice",name:s.UnitPrice||teasp.message.getLabel("tm20004720")},QUANTITY:{key:"Quantity",name:s.Quantity||teasp.message.getLabel("tm20004730")},START_NAME:{key:"StartName",name:s.StartName||teasp.message.getLabel("stationFrom_label")},END_NAME:{key:"EndName",name:s.EndName||teasp.message.getLabel("stationTo_label")},ROUND_TRIP:{key:"RoundTrip",
name:s.RoundTrip||teasp.message.getLabel("tk10000075")},CURRENCY_NAME:{key:"CurrencyName",name:s.CurrencyName||teasp.message.getLabel("tk10000699")},CURRENCY_RATE:{key:"CurrencyRate",name:s.CurrencyRate||teasp.message.getLabel("tm20004190")},FOREIGN_AMOUNT:{key:"ForeignAmount",name:s.ForeignAmount||teasp.message.getLabel("tm20004200")},WITHOUT_TAX:{key:"WithoutTax",name:s.WithoutTax||teasp.message.getLabel(
"tm20004110")},TAX:{key:"Tax",name:s.Tax||teasp.message.getLabel("tm20004120")},TAX_RATE:{key:"TaxRate",name:s.TaxRate||teasp.message.getLabel("tm20004100")},JOB_CODE:{key:"JobCode",name:s.JobCode||teasp.message.getLabel("tm20001020")},PAYEE_CODE:{key:"PayeeCode",name:s.PayeeCode||teasp.message.getLabel("ci00000150")},PAYMENT_DATE:{key:"PaymentDate",name:s.PaymentDate||teasp.message.getLabel("tf10000590")},
DEPT_CODE:{key:"ChargeDeptCode",name:s.ChargeDeptCode||teasp.message.getLabel("tf10006001")},EXTRA_ITEM_1:{key:"ExtraItem1",name:s.ExtraItem1||teasp.message.getLabel("tm20004576")},EXTRA_ITEM_2:{key:"ExtraItem2",name:s.ExtraItem2||teasp.message.getLabel("tm20004577")},PAYEE_INFO:{key:"PayeeInfo"},DEPT_INFO:{key:"ChargeDeptInfo"},JOB_INFO:{key:"JobInfo"},TAX_AUTO:{key:"TaxAuto"},TAX_TYPE:{key:"TaxType"},
TRANSPORT_TYPE:{key:"TransportType"},DUMMY:null}),e=(this.COL=a,this.initDetails(),e.fname&&this.addDetails(teasp.message.getLabel("ci00000050",e.fname)),this.parseCsvData(a,t));t.length?(e.errors.length&&(this.addDetails(teasp.message.getLabel("ci00000070")),this.addDetails(e.errors.join("\n"))),this.setImportData(e),e.valids.length||this.setMessage(teasp.message.getLabel("ci00000080"))):this.addDetails(
teasp.message.getLabel("ci00000060"))},teasp.Tsf.CsvImportLogic.prototype.parseCsvData=function(e,t){for(var s=[],a=[],o=0,i=0,p=0;p<t.length;p++){var r,n=t[p],l=(n[e.TAX_AUTO.key]=!0,n[e.TAX_TYPE.key]=null,n[e.TRANSPORT_TYPE.key]="0",o++,{er:[],addError:function(e){this.er.push(e)},getErrors:function(){return this.er},hasError:function(){return this.er.length}});this.checkRequire1(e,o,n,l),this.checkLength(e,o,n,l),
this.checkDate(e,o,n,l),this.checkNumeric(e,o,n,l),l.hasError()||(r=this.getExpItemByItemCode(e,o,n,l),this.checkByExpItem(r,e,o,n,l),this.checkPayeeInfo(e,o,n,l),this.checkDeptInfo(e,o,n,l),this.checkJobInfo(e,o,n,l),this.checkExpItemClass(r,e,o,n,l),this.checkRequire2(r,e,o,n,l)),l.hasError()?(i++,s=s.concat(l.getErrors())):a.push(n)}return{valids:a,errors:s,errorCnt:i,recordCnt:t.length}},
teasp.Tsf.CsvImportLogic.prototype.createMessageA=function(e,t,s){return teasp.message.getLabel("ci00001010",e)+teasp.message.getLabel(t,s)},teasp.Tsf.CsvImportLogic.prototype.createMessageB=function(e,t,s,a){return teasp.message.getLabel("ci00001010",e)+teasp.message.getLabel(t,s,a)},teasp.Tsf.CsvImportLogic.prototype.createMessageC=function(e,t,s,a,o){return teasp.message.getLabel("ci00001010",e
)+teasp.message.getLabel(t,s,a,o)},teasp.Tsf.CsvImportLogic.prototype.checkRequire1=function(e,t,s,a){var o=[];s[e.DATE.key]||o.push(e.DATE.name),s[e.ITEM_CODE.key]||o.push(e.ITEM_CODE.name),o.length&&a.addError(this.createMessageA(t,"ci00001020",o.join(",")))},teasp.Tsf.CsvImportLogic.prototype.checkRequire2=function(e,t,s,a,o){var i,p=[],r=[];2!=tsfManager.isRequireChargeDept()||a[t.DEPT_CODE.key]||p.push(
t.DEPT_CODE.name),0==tsfManager.isRequireChargeDept()&&a[t.DEPT_CODE.key]&&r.push(t.DEPT_CODE.name),e&&(2!=e.isRequireChargeJob()||a[t.JOB_CODE.key]||p.push(t.JOB_CODE.name),0==e.isRequireChargeJob()&&a[t.JOB_CODE.key]&&r.push(t.JOB_CODE.name),i=e.getExtraItem(1),e=e.getExtraItem(2),i&&i.require&&!a[t.EXTRA_ITEM_1.key]&&p.push(t.EXTRA_ITEM_1.name),e&&e.require&&!a[t.EXTRA_ITEM_2.key]&&p.push(t.EXTRA_ITEM_2.name),
!i&&a[t.EXTRA_ITEM_1.key]&&r.push(t.EXTRA_ITEM_1.name),!e&&a[t.EXTRA_ITEM_2.key]&&r.push(t.EXTRA_ITEM_2.name)),p.length&&o.addError(this.createMessageA(s,"ci00001020",p.join(","))),r.length&&o.addError(this.createMessageB(s,"ci00001140",r.join(",")))},teasp.Tsf.CsvImportLogic.prototype.checkLength=function(e,t,s,a){this.checkLengthInner1(e.DETAIL,t,s,a,255),this.checkLengthInner1(e.EXTRA_ITEM_1,t,s,a,255),
this.checkLengthInner1(e.EXTRA_ITEM_2,t,s,a,255),this.checkLengthInner1(e.START_NAME,t,s,a,80),this.checkLengthInner1(e.END_NAME,t,s,a,80),this.checkLengthInner1(e.CURRENCY_NAME,t,s,a,20),this.checkLengthInner1(e.ITEM_CODE,t,s,a,20),this.checkLengthInner1(e.JOB_CODE,t,s,a,20),this.checkLengthInner1(e.PAYEE_CODE,t,s,a,20),this.checkLengthInner1(e.DEPT_CODE,t,s,a,20),this.checkLengthInner1(e.DATE,t,s,a,10),
this.checkLengthInner1(e.PAYMENT_DATE,t,s,a,10),this.checkLengthInner1(e.ROUND_TRIP,t,s,a,5)},teasp.Tsf.CsvImportLogic.prototype.checkLengthInner1=function(e,t,s,a,o){s[e.key]&&"string"==typeof s[e.key]&&(s[e.key]=s[e.key].trim(),s[e.key]=s[e.key].replace(/\r?\n/g," "),s[e.key].length>o&&a.addError(this.createMessageA(t,"ci00001050",e.name)))},teasp.Tsf.CsvImportLogic.prototype.checkDate=function(e,t,s,a){
this.checkDateInner1(e.DATE,t,s,a),this.checkDateInner1(e.PAYMENT_DATE,t,s,a)},teasp.Tsf.CsvImportLogic.prototype.checkDateInner1=function(e,t,s,a){var o;s[e.key]&&((o=teasp.Tsf.CsvImportLogic.parseDate(s[e.key])).isValid()?s[e.key]=o.format("YYYY-MM-DD"):a.addError(this.createMessageA(t,"ci00001030",e.name)))},teasp.Tsf.CsvImportLogic.parseDate=function(e){var t=moment(e,"YYYY/M/D",!0);return t.isValid()||(t=moment(
e,"YYYY-M-D",!0)).isValid()?t:moment(e,"YYYY.M.D",!0)},teasp.Tsf.CsvImportLogic.prototype.checkNumeric=function(e,t,s,a){this.checkNumericInner1(e.COST,t,s,a,0,12),this.checkNumericInner1(e.UNIT_PRICE,t,s,a,0,12),this.checkNumericInner1(e.QUANTITY,t,s,a,0,12),this.checkNumericInner1(e.CURRENCY_RATE,t,s,a,6,12),this.checkNumericInner1(e.FOREIGN_AMOUNT,t,s,a,6,12),this.checkNumericInner1(e.WITHOUT_TAX,t,s,a,0,12),
this.checkNumericInner1(e.TAX,t,s,a,0,12),this.checkNumericInner1(e.TAX_RATE,t,s,a,0,3),this.checkNumericInner2(e.QUANTITY,t,s,a),this.checkNumericInner2(e.CURRENCY_RATE,t,s,a),this.checkNumericInner2(e.TAX_RATE,t,s,a)},teasp.Tsf.CsvImportLogic.prototype.checkNumericInner1=function(e,t,s,a,o,i){var p=s[e.key];if(p&&"string"==typeof p){if(p=p.trim(),!/^\-?[\d,\.]+$/.test(p))return void a.addError(this.createMessageA(t
,"ci00001030",e.name));var r=p.replace(/[\-,]+/g,"").split(".");if(2<r.length||!o&&1<r.length)return void a.addError(this.createMessageA(t,"ci00001030",e.name));if(r[0].length>i||1<r.length&&r[1].length>o)return void a.addError(this.createMessageA(t,"ci00001050",e.name))}!p&&"number"!=typeof p||(i=teasp.util.currency.formatDecimal(p,o,6,!0),s[e.key]=i.n)},
teasp.Tsf.CsvImportLogic.prototype.checkNumericInner2=function(e,t,s,a){s[e.key]&&s[e.key]<0&&a.addError(this.createMessageA(t,"ci00001060",e.name))},teasp.Tsf.CsvImportLogic.prototype.getExpItemByItemCode=function(e,t,s,a){var s=s[e.ITEM_CODE.key],o=tsfManager.getExpItemByItemCode(s);return o?o.isRemoved()&&a.addError(this.createMessageB(t,"ci00001130",e.ITEM_CODE.name,s)):a.addError(this.createMessageB(t,
"ci00001040",e.ITEM_CODE.name,s)),o},teasp.Tsf.CsvImportLogic.prototype.checkByExpItem=function(e,t,s,a,o){var i;e&&(e.checkExpenseType(this.expenseType)?(e.isAllowMinus()||(this.checkNumericInner2(t.COST,s,a,o),this.checkNumericInner2(t.UNIT_PRICE,s,a,o),this.checkNumericInner2(t.FOREIGN_AMOUNT,s,a,o),this.checkNumericInner2(t.WITHOUT_TAX,s,a,o),this.checkNumericInner2(t.TAX,s,a,o)),e.isTaxFlag()&&"0"!=e.getTaxType(
)?"number"!=typeof a[t.COST.key]&&"number"!=typeof a[t.WITHOUT_TAX.key]&&((i=[]).push(t.COST.name),i.push(t.WITHOUT_TAX.name),o.addError(this.createMessageA(s,"ci00001020",i.join(",")))):"number"!=typeof a[t.COST.key]&&o.addError(this.createMessageA(s,"ci00001020",t.COST.name)),this.checkByExpItemTax(e,t,s,a,o),this.checkByExpItemQuantity(e,t,s,a,o),this.checkByExpItemTransport(e,t,s,a,o),
this.checkByExpItemFixAmount(e,t,s,a,o),this.checkByExpItemForeign(e,t,s,a,o)):o.addError(this.createMessageB(s,"ci00001110",t.ITEM_CODE.name,e.getItemCode())))},teasp.Tsf.CsvImportLogic.prototype.checkByExpItemQuantity=function(e,t,s,a,o){e.isEnableQuantity()?(e=[],a[t.UNIT_PRICE.key]||e.push(t.UNIT_PRICE.name),a[t.QUANTITY.key]||e.push(t.QUANTITY.name),e.length?o.addError(this.createMessageA(s,"ci00001020",e.join(
","))):a[t.COST.key]&&(e=a[t.UNIT_PRICE.key]*a[t.QUANTITY.key],a[t.COST.key]!=e&&o.addError(this.createMessageC(s,"ci00001070",t.UNIT_PRICE.name,t.QUANTITY.name,t.COST.name)))):(e=[],a[t.UNIT_PRICE.key]&&e.push(t.UNIT_PRICE.name),a[t.QUANTITY.key]&&e.push(t.QUANTITY.name),e.length&&o.addError(this.createMessageA(s,"ci00001140",e.join(","))),a[t.UNIT_PRICE.key]=null,a[t.QUANTITY.key]=null)},
teasp.Tsf.CsvImportLogic.prototype.checkByExpItemTransport=function(e,t,s,a,o){var i;"0"!=e.getTransportType()?(a[t.TRANSPORT_TYPE.key]="2",e=[],a[t.START_NAME.key]||e.push(t.START_NAME.name),a[t.END_NAME.key]||e.push(t.END_NAME.name),a[t.ROUND_TRIP.key]?"true"==(i=a[t.ROUND_TRIP.key].toLowerCase())||"yes"==i||"on"==i?a[t.ROUND_TRIP.key]=!0:"false"==i||"no"==i||"off"==i?a[t.ROUND_TRIP.key]=!1:o.addError(
this.createMessageA(s,"ci00001030",t.ROUND_TRIP.name)):a[t.ROUND_TRIP.key]=!1,e.length&&o.addError(this.createMessageA(s,"ci00001020",e.join(",")))):(i=[],a[t.START_NAME.key]&&i.push(t.START_NAME.name),a[t.END_NAME.key]&&i.push(t.END_NAME.name),a[t.ROUND_TRIP.key]&&i.push(t.ROUND_TRIP.name),i.length&&o.addError(this.createMessageA(s,"ci00001140",i.join(","))),a[t.START_NAME.key]=null,a[t.END_NAME.key]=null,
a[t.ROUND_TRIP.key]=!1)},teasp.Tsf.CsvImportLogic.prototype.checkByExpItemFixAmount=function(e,t,s,a,o){!a[t.COST.key]||!e.isFixAmount()||e.isForeignFlag()&&e.getCurrencyName()||e.getCost()!=a[t.COST.key]&&o.addError(this.createMessageA(s,"ci00001080",e.getName()))},teasp.Tsf.CsvImportLogic.prototype.checkByExpItemForeign=function(e,t,s,a,o){var i;e.isForeignFlag()?(i=[],a[t.CURRENCY_NAME.key]||i.push(
t.CURRENCY_NAME.name),a[t.CURRENCY_RATE.key]||i.push(t.CURRENCY_RATE.name),a[t.FOREIGN_AMOUNT.key]||i.push(t.FOREIGN_AMOUNT.name),i.length?o.addError(this.createMessageA(s,"ci00001020",i.join(","))):e.isFixAmount()&&e.getCurrencyName()?e.getCost()!=a[t.FOREIGN_AMOUNT.key]&&o.addError(this.createMessageA(s,"ci00001080",e.getName())):a[t.COST.key]&&(i=a[t.COST.key],e=a[t.FOREIGN_AMOUNT.key]*a[t.CURRENCY_RATE.key],
1<Math.abs(i-e)&&o.addError(this.createMessageC(s,"ci00001070",t.COST.name,t.CURRENCY_RATE.name,t.FOREIGN_AMOUNT.name)))):(i=[],a[t.CURRENCY_NAME.key]&&i.push(t.CURRENCY_NAME.name),a[t.CURRENCY_RATE.key]&&i.push(t.CURRENCY_RATE.name),a[t.FOREIGN_AMOUNT.key]&&i.push(t.FOREIGN_AMOUNT.name),i.length&&o.addError(this.createMessageA(s,"ci00001140",i.join(","))),a[t.CURRENCY_NAME.key]=null,a[t.CURRENCY_RATE.key]=null,
a[t.FOREIGN_AMOUNT.key]=null)},teasp.Tsf.CsvImportLogic.prototype.checkByExpItemTax=function(e,t,s,a,o){a[t.TAX_TYPE.key]=e.getTaxType();var i=a[t.COST.key],p=a[t.WITHOUT_TAX.key];if("number"==typeof i||"number"==typeof p){var r,n=a[t.TAX.key];if("0"!=e.getTaxType()){if("number"!=typeof(r=a[t.TAX_RATE.key]))r=a[t.TAX_RATE.key]=e.getTaxRate(a[t.DATE.key]);else{for(var l=e.getSelectableTaxRateEx(),c=!1,
m=0;m<l.length;m++)if(r==l[m]){c=!0;break}if(!c)return void o.addError(this.createMessageC(s,"ci00001160",t.TAX_RATE.name,r))}var d=tsfManager.getTaxRoundFlag(),d=teasp.Tsf.ExpDetail.calcTax(i,p,n,"number"==typeof i?0:1,e.getTaxType(),r,!0,d,e.isAllowMinus());"number"==typeof i&&"number"==typeof p&&"number"==typeof n?i==d.cost&&p==d.withoutTax&&n==d.tax||(i!=p+n?o.addError(this.createMessageC(s,"ci00001070",
t.COST.name,t.WITHOUT_TAX.name,t.TAX.name)):a[t.TAX_AUTO.key]=d.cost==i&&d.withoutTax==p):"number"!=typeof i&&"number"==typeof p&&"number"!=typeof n?(i=a[t.COST.key]=d.cost,n=a[t.TAX.key]=d.tax,a[t.TAX_AUTO.key]=!0):"number"==typeof i&&"number"!=typeof p&&"number"!=typeof n?(p=a[t.WITHOUT_TAX.key]=d.withoutTax,n=a[t.TAX.key]=d.tax,a[t.TAX_AUTO.key]=!0):(
"number"==typeof i&&"number"==typeof n?p=a[t.WITHOUT_TAX.key]=Math.max(i-n,0):"number"==typeof i&&"number"==typeof p?n=a[t.TAX.key]=Math.max(i-p,0):"number"==typeof n&&"number"==typeof p&&(i=a[t.COST.key]=n+p),i!=p+n?o.addError(this.createMessageC(s,"ci00001070",t.COST.name,t.WITHOUT_TAX.name,t.TAX.name)):d.withoutTax==p&&d.tax==n||(a[t.TAX_AUTO.key]=!1))}else"number"==typeof(r=a[t.TAX_RATE.key])&&0!=r?o.addError(
this.createMessageC(s,"ci00001160",t.TAX_RATE.name,r)):("number"!=typeof n&&(n=a[t.TAX.key]=0),(i="number"!=typeof i?a[t.COST.key]=p:i)==(p="number"!=typeof p?a[t.WITHOUT_TAX.key]=i:p)&&0==n||o.addError(this.createMessageC(s,"ci00001070",t.COST.name,t.WITHOUT_TAX.name,t.TAX.name)))}},teasp.Tsf.CsvImportLogic.prototype.checkPayeeInfo=function(e,t,s,a){s[e.PAYEE_INFO.key]=null;var o,i,p,r=s[e.PAYEE_CODE.key];r?(o=[],
i=[],dojo.forEach(this.payees,function(e){r==e.PayeeCode&&o.push(e),r==e.PayeeCode&&(!e.PayeeExpenseType||this.expenseType&&e.PayeeExpenseType.split(/,/).contains(this.expenseType))&&i.push(e)},this),o.length?i.length?1<i.length?a.addError(this.createMessageB(t,"ci00001090",e.PAYEE_CODE.name,r)):s[e.PAYEE_INFO.key]=i[0]:a.addError(this.createMessageB(t,"ci00001110",e.PAYEE_CODE.name,r)):a.addError(
this.createMessageB(t,"ci00001040",e.PAYEE_CODE.name,r))):(p=[],s[e.PAYMENT_DATE.key]&&p.push(e.PAYMENT_DATE.name),p.length&&a.addError(this.createMessageA(t,"ci00001140",p.join(","))),s[e.PAYMENT_DATE.key]=null)},teasp.Tsf.CsvImportLogic.prototype.checkDeptInfo=function(e,t,s,a){s[e.DEPT_INFO.key]=null;var o,i,p,r=s[e.DEPT_CODE.key];r&&(o=s[e.DATE.key],i=[],p=[],dojo.forEach(this.depts,function(e){
r==e.ChargeDeptCode&&(i.push(e),(!e.ChargeDeptStartDate||e.ChargeDeptStartDate<=o)&&(!e.ChargeDeptEndDate||e.ChargeDeptEndDate>=o)&&p.push(e))}),i.length?1<p.length?a.addError(this.createMessageB(t,"ci00001090",e.DEPT_CODE.name,r)):p.length?s[e.DEPT_INFO.key]=p[0]:a.addError(this.createMessageB(t,"ci00001100",e.DEPT_CODE.name,r)):a.addError(this.createMessageB(t,"ci00001040",e.DEPT_CODE.name,r)))},
teasp.Tsf.CsvImportLogic.prototype.checkJobInfo=function(e,t,s,a){s[e.JOB_INFO.key]=null;var o,i,p,r,n=s[e.JOB_CODE.key];n&&(o=s[e.DATE.key],i=[],p=[],dojo.forEach(this.jobs,function(e){n==e.JobCode&&e.JobActive&&(i.push(e),(!e.JobStartDate||e.JobStartDate<=o)&&(!e.JobEndDate||e.JobEndDate>=o)&&p.push(e))}),r=p.length?p[0]:null,i.length?1<p.length?a.addError(this.createMessageB(t,"ci00001090",e.JOB_CODE.name,n)
):r?-1==r.JobMember||0==r.JobMember&&!this.targetEmp.isMatchEmpJobAssignClass(r.JobAssignClass)?a.addError(this.createMessageB(t,"ci00001150",e.JOB_CODE.name,n)):s[e.JOB_INFO.key]=r:a.addError(this.createMessageB(t,"ci00001100",e.JOB_CODE.name,n)):a.addError(this.createMessageB(t,"ci00001040",e.JOB_CODE.name,n)))},teasp.Tsf.CsvImportLogic.prototype.checkExpItemClass=function(e,t,s,a,o){var i,p;e&&(
i=this.targetEmp.getExpItemClass(),p=null,p=(p=!(p=(a=a[t.DEPT_INFO.key])?a.ExpItemClass||null:p)&&this.assist&&this.assist.ChargeDeptId__r?this.assist.ChargeDeptId__r.ExpItemClass__c||null:p)||this.targetEmp.getDeptExpItemClass(),console.log("empExpItemClass="+i),console.log("deptExpItemClass="+p),e.isSelectable(i)||e.isSelectable(p)||o.addError(this.createMessageB(s,"ci00001120",t.ITEM_CODE.name,e.getItemCode())))}
,teasp.Tsf.Currency=function(){},teasp.Tsf.Currency.V_YEN="\\",teasp.Tsf.Currency.S_YEN="&#165;",teasp.Tsf.Currency.J_YEN="円",teasp.Tsf.Currency.eventInput=function(e,t,s,a){e.connect(t,"blur",null,function(e){e.target.value=teasp.Tsf.Currency.formatMoneyN(e.target),s&&s(e)},a),e.connect(t,"onkeypress",null,function(e){""===e.keyChar&&13===e.keyCode&&(e.target.value=teasp.Tsf.Currency.formatMoneyN(e.target),
e.preventDefault(),e.stopPropagation(),s&&s(e))},a)},teasp.Tsf.Currency.formatMoneyN=function(e){var t=teasp.Tsf.Dom.hasClass(e,"ts-minus-ok");return teasp.Tsf.Currency.formatMoney(e.value,teasp.Tsf.Currency.V_YEN,!1,t)},teasp.Tsf.Currency.formatMoney=function(e,t,s,a){if(null===e)return"";if(!(a="string"==typeof e?""+(e?teasp.util.currency.money2number(e,a):""):""+(e||0)))return"";for(var o=a.replace(/,/g,"");o!=(
o=o.replace(/^(-?\d+)(\d{3})/,"$1,$2")););return s&&"0"==o?"":t==teasp.Tsf.Currency.V_YEN?teasp.message.getLabel("cunit_text")+o:t==teasp.Tsf.Currency.S_YEN?teasp.message.getLabel("cunit_html")+o:t==teasp.Tsf.Currency.J_YEN?o+teasp.message.getLabel("cunit_jps"):o},teasp.Tsf.Currency.roundSameAsSalesforce=function(e){return 0<=e?Math.floor(e+.5):-1*Math.floor(Math.abs(e)+.5)},teasp.Tsf.Time=function(){},
teasp.Tsf.Time.eventInput=function(e,t,s){e.connect(t,"blur",null,function(e){teasp.util.time.onblurTime(e)},s),e.connect(t,"onkeypress",null,function(e){teasp.util.time.onkeypressTime(e)},s)},teasp.Tsf.Error=function(){},teasp.Tsf.Error.parse=function(e){return{message:teasp.Tsf.Error.getMessage(e)}},teasp.Tsf.Error.getMessage=function(e){var t=e;return t&&"object"==typeof t?(
t=t.error&&"object"==typeof t.error?t.error:t).messageId?teasp.message.getLabel2(t.messageId,t.args||[]):t.message||e.message||t.name||"Error":t||"Error"},teasp.Tsf.Error.showError=function(e,t){var s,t=t?"string"==typeof t?teasp.Tsf.Dom.byId(t):t:teasp.Tsf.Dom.byId("tsfErrorArea");e?(t=t||teasp.Tsf.Dom.node(".ts-error-el"),e="Error："+teasp.Tsf.Error.getMessage(e),(s=t?teasp.Tsf.Dom.node("div",t):null)?(s.innerHTML=e
,teasp.Tsf.Dom.show(t,null,!0)):teasp.tsAlert(e)):t&&teasp.Tsf.Dom.show(t,null,!1)},teasp.Tsf.Error.showMessage=function(e,t){var s,t=t?"string"==typeof t?teasp.Tsf.Dom.byId(t):t:teasp.Tsf.Dom.byId("tsfErrorArea");e?(t=t||teasp.Tsf.Dom.node(".ts-error-el"),e=teasp.Tsf.Error.getMessage(e),(s=t?teasp.Tsf.Dom.node("div",t):null)?(s.innerHTML=e,teasp.Tsf.Dom.show(t,null,!0)):teasp.tsAlert(e)):t&&teasp.Tsf.Dom.show(t,null
,!1)},teasp.Tsf.Error.messageFromNgList=function(e){var s=[],a=[],o=[],i=null,p=null,r="";return dojo.forEach(e,function(e){var t;e.fc&&(t=e.fc.getLabel(),1==e.ngType?s.contains(t)||s.push(t):2==e.ngType?(a.contains(t)||a.push(t),i=e.tmpl):3==e.ngType?(o.contains(t)||o.push(t),p=e.tmpl):4==e.ngType&&(r+=e.message))}),0<s.length&&(r+=teasp.message.getLabel("tf10001840",s.join(","))),0<a.length&&(r+=dojo.replace(i,[
a.join(",")])),0<o.length&&(r+=dojo.replace(p,[o.join(",")])),r},teasp.Tsf.Fc=function(e,t,s){this.fc=e,this.parent=t,this.last=s,this.notUse=this.fc.notUse||!1,this.label=null,this.fc.dispField&&(this.dispFc=new teasp.Tsf.Fc(this.fc.dispField,t)),this.fc.suffix&&(this.suffixFc=new teasp.Tsf.Fc(this.fc.suffix,t)),this.fc.premix&&(this.premixFc=new teasp.Tsf.Fc(this.fc.premix,t))},teasp.Tsf.Fc.createList=function(e,s
){var a=[],o=e.length;return dojo.forEach(e,function(e,t){a.push(new teasp.Tsf.Fc(e,s,t==o-1))}),a},teasp.Tsf.Fc.setObjValue=function(e,t,s,a){for(var o=s.split("."),i=a?a.split("."):o,p=t,r=e,n=0;n<i.length&&!(n>=o.length);n++){var l=i[n],c=o[n];if(!p||void 0===p[l])break;"object"==typeof p[l]?(p=p[l],r[c]||(r[c]={}),r=r[c]):r[c]=p[l]}return e},teasp.Tsf.Fc.setObjSimpleValue=function(e,t,s){for(var a=t.split("."),
o=e,i=0;i<a.length;i++){var p=a[i];if(i==a.length-1){o[p]=s;break}o[p]||(o[p]={}),o=o[p]}return e},teasp.Tsf.Fc.prototype.getDomId=function(e){return teasp.Tsf.util.formatString(this.fc.domId,e)},teasp.Tsf.Fc.prototype.getName=function(e){return teasp.Tsf.util.formatString(this.fc.name,e)},teasp.Tsf.Fc.prototype.getElement=function(e,t,s){e=this.getDomId(e);return e?(s&&this.isHiddenPlus()&&(e+="Hidden"),
t?teasp.Tsf.Dom.node('[id="'+e+'"]',t):teasp.Tsf.Dom.byId(e)):null},teasp.Tsf.Fc.prototype.getSuffixElement=function(e,t){if(!this.getSuffix())return null;e=this.getDomId(e);return e?(e+="Suffix",t?teasp.Tsf.Dom.node('[id="'+e+'"]',t):teasp.Tsf.Dom.byId(e)):null},teasp.Tsf.Fc.prototype.getWidth=function(e){return"number"==typeof this.fc.width?this.fc.width+(e||0)+"px":this.fc.width},
teasp.Tsf.Fc.prototype.getLw=function(){return"number"==typeof this.fc.lw?this.fc.lw+"px":this.fc.lw},teasp.Tsf.Fc.prototype.getWplus=function(){return this.isLast()?16:0},teasp.Tsf.Fc.prototype.getWidthNum=function(e){return"number"==typeof this.fc.width?this.fc.width+this.getWplus():0},teasp.Tsf.Fc.prototype.getHeadSpan=function(){return"number"==typeof this.fc.headSpan?this.fc.headSpan:1},
teasp.Tsf.Fc.prototype.getApiKey=function(e,t){return!t||"children"!=this.fc.domType&&this.fc.apiKey&&"_"!=this.fc.apiKey.substring(0,1)?null!=e&&this.fc.apiName?teasp.Tsf.util.formatString(this.fc.apiName,e):this.fc.apiKey:null},teasp.Tsf.Fc.prototype.isApiField=function(e){return"children"!=this.fc.domType&&(this.fc.apiKey&&"_"!=this.fc.apiKey.substring(0,1)&&(e||!this.fc.ro))},teasp.Tsf.Fc.setBackground=function(e
,t){tsfManager.isDiffView()&&(teasp.Tsf.Dom.toggleClass(e,"ts-diff-yes",t.difference&&!t._removed),teasp.Tsf.Dom.toggleClass(e,"ts-diff-del",!t.difference&&t._removed),t._diffJsNavi&&teasp.Tsf.Dom.toggleClass(e,"ts-diff-jsnavi",!t.difference&&t._diffJsNavi),teasp.Tsf.Dom.toggleClass(e,"ts-diff-no",!t.difference&&!t._removed))},teasp.Tsf.Fc.prototype.drawText=function(e,t,s,a,o){var i=this.getElement(s,a);if(i){var p,
r,n=this.getDomType(),l=this.parseValue(t);if(l.premix&&(l.dispValue=l.premix+" "+l.dispValue),t._removed?(l._removed=!0,t._diffJsNavi&&(l._diffJsNavi=!0)):t.preObj?this.getApiKey()&&(r=this.parseValue(t.preObj),l.value!=r.value&&(l.difference=!0)):t._addJsNavi?l.difference=!1:t.ExpApplyId__r&&t.ExpApplyId__r.ExpPreApplyId__c&&(l.difference=!0),"photo"==n)l.value&&e.create("img",{src:l.value},i);else if("route"==n
)t._route&&(teasp.Tsf.Dom.empty(i),"table"!=this.parent.getType()&&teasp.Tsf.Fc.setBackground(i,l),teasp.Tsf.Dom.append(i,t._route.getExpContent(e,s,t.preObj)));else if("status"==n)i.title=teasp.constant.getDisplayStatus(l.value||""),/^(承認|確定)済み$/.test(l.value
)?i.className="ts-status-img ts-s-approve":"精算済み"==l.value?i.className="ts-status-img ts-s-paid":"承認待ち"==l.value?i.className="ts-status-img ts-s-wait":"却下"==l.value?i.className="ts-status-img ts-s-reject":/^(申請|確定)取消$/.test(l.value
)?i.className="ts-status-img ts-s-remove":"取消伝票承認待ち"==l.value?i.className="ts-status-img ts-s-cancel-wait":"取消伝票承認済み"==l.value?i.className="ts-status-img ts-s-cancel-approve":"仕訳済み"==l.value?i.className="ts-status-img ts-s-journal":l.spec&&(i.className="ts-status-img ts-s-none");else if("radio"==n)teasp.Tsf.Dom.query('input[type="radio"]',i).forEach(function(e){e.value==l.value&&(e.checked=!0),
e.disabled=this.isReadOnly()},this);else if("children"==n)l.value&&("INPUT"==i.tagName?i.value=l.value:(e.create("div",{className:"pp_ico_receipt_r"},i),(p=teasp.Tsf.Dom.nextSibling(i))&&(p.value=l.value)));else if(this.isReadOnly()&&"INPUT"!=i.tagName&&"SELECT"!=i.tagName)this.isCheck()&&this.isTable()&&t.Id?(i.firstChild&&teasp.Tsf.Dom.destroy(i.firstChild),t._removed||(this.isRadio()?t.noChoose||e.create("input",{
type:"radio",name:this.getRadioName(),className:"ts-check"},i):l.checky&&e.create("input",{type:"checkbox",className:"ts-check"},i),t.noChoosePlus&&e.create("div",{className:t.noChoosePlus.className||"",title:t.noChoosePlus.title||""},i))):(teasp.Tsf.Dom.empty(i),"_stepStatus"==this.getApiKey()&&(l.dispValue=teasp.message.getLabel("approvalHistory_label")),t.uncertain&&t.uncertain[this.getApiKey(
)]?i.innerHTML="":this.isLink()&&l.dispValue&&!t._removed?e.create("a",{href:"javascript:void(0);",innerHTML:teasp.Tsf.util.entitizg(l.dispValue)},i):"boolean"==typeof l.dispValue?i.innerHTML=l.dispValue?"○":"":"PaymentDay__c"==this.getApiKey()&&"number"==typeof l.dispValue?i.innerHTML="31"==l.dispValue?teasp.message.getLabel("tf10001550"):l.dispValue+teasp.message.getLabel("day_label"
):i.innerHTML=teasp.Tsf.util.entitizg(l.dispValue,"textarea"==n),"table"!=this.parent.getType()&&teasp.Tsf.Fc.setBackground(i,l),"select"==n&&(p=teasp.Tsf.Dom.nextSibling(i))&&(p.value=l.value||"",(r=teasp.Tsf.Dom.nextSibling(p))&&(r.value=l.nameValue||"")));else if("dateRange"==n||"dateFrom"==n||"currencyRange"==n){var c=0;teasp.Tsf.Dom.query("input",i).forEach(function(e){e.value=l.dispValue[c++]||""})}else switch(
n){case"select":if(l.value){for(var m=0;m<i.options.length&&i.options[m].value!=l.value;m++);m>=i.options.length&&!this.isWeak()&&e.create("option",{value:l.value||"",innerHTML:teasp.Tsf.util.entitizf(l.dispValue)},i),(m<i.options.length||this.isWeak())&&(i.value=l.value)}else i.value="";(p=teasp.Tsf.Dom.nextSibling(i))&&(p.value=l.nameValue||"");break;case"children":i.value=l.value||"";break;default:
var d=o?l.value:l.dispValue;i.value="number"==typeof d?""+d:d||""}this.isHiddenPlus()&&(i=this.getElement(s,a,!0))&&(i.value=l.value),l.suffix&&(i=this.getSuffixElement(s,a))&&(i.innerHTML=teasp.Tsf.util.entitizf(l.suffix)),"depta"==n?teasp.Tsf.Dom.node('input[type="checkbox"]',i.parentNode).checked=l.checked:"deptb"==n&&(t=teasp.Tsf.Dom.node('input[type="checkbox"].dept-apply',i.parentNode),r=teasp.Tsf.Dom.node(
'input[type="checkbox"].dept-layer',i.parentNode),t&&(t.checked=l.checkDeptApply),r&&(r.checked=l.checkDeptLayer))}},teasp.Tsf.Fc.prototype.textOut=function(e,t,s){t=this.getElement(t);t&&("INPUT"==t.tagName||"SELECT"==t.tagName||"TEXTAREA"==t.tagName?"checkbox"==t.type?t.checked=s:t.value=s:t.innerHTML=teasp.Tsf.util.entitizf(s))},teasp.Tsf.Fc.prototype.parseSimple=function(e,t,s){var a,o=null,i=!1,
p=s||t||this.getApiKey();if(p)for(var r=p.split("."),o=e,n=0;n<r.length;n++){var l=r[n];if(!o||void 0===o[l]){o=null;break}n==r.length-1&&(i=!0),o=o[l]}return o||t||!this.getOptKey()?"deptb"==this.getDomType()?(p=e.composite&&e.composite[this.getApiKey()]||{},dojo.isArray(p)&&(p=p[0]),{value:o,spec:i,checkDeptApply:this.getCompositeCheck("checkDeptApply",p.checkDeptApply),checkDeptLayer:this.getCompositeCheck(
"checkDeptLayer",p.checkDeptLayer)}):!s&&this.getCodeKey()?{value:((a=this.parseSimple(e,null,this.getCodeKey())).value||"")+(a.value?this.getDivStr():"")+(o||""),nameValue:o||"",spec:i}:{value:o,spec:i}:((a=this.parseSimple(e,this.getOptKey())).checked=!0,a)},teasp.Tsf.Fc.prototype.parseValue=function(e){var t,s=this.parseSimple(e),a=s.value,o={},i=this.getDomType();if(this.getSuffixFc()&&(t=this.getSuffixFc(
).parseValue(e),o.suffix=t.dispValue),this.getPremixFc()&&(t=this.getPremixFc().parseValue(e),o.premix=t.dispValue),"depta"==i?o.checked=s.checked:"deptb"==i&&(o.checkDeptApply=s.checkDeptApply,o.checkDeptLayer=s.checkDeptLayer),"select"==i)return this.getDispFc()?(t=this.getDispFc().parseValue(e),o.value=a||this.getDefaultValue()||"",o.pickList=this.getPickList(),o.dispValue=t.dispValue,t.nameValue&&(
o.nameValue=t.nameValue)):(o.value=a||this.getDefaultValue()||"",o.pickList=this.getPickList(),o.dispValue=o.value,dojo.forEach(o.pickList,function(e){"string"==typeof e&&o.value==e?o.dispValue=e||"":o.value==e.v&&(o.dispValue=e.n||"")})),o;if("date"==i||"dateRange"==i||"dateFrom"==i){if(teasp.Tsf.util.isArray(a)){o.value=a,o.dispValue=[];for(var p=0;p<a.length;p++)"number"==typeof(n=a[p])&&(
n=teasp.util.date.formatDate(n)),o.dispValue.push(teasp.util.date.formatDate(n,this.getFormat()||"SLA"))}else"number"==typeof a&&(a=teasp.util.date.formatDate(a)),o.value=a,o.dispValue=teasp.util.date.formatDate(a,this.getFormat()||"SLA");return o}if("datetime"==i)return"number"==typeof a&&(a=teasp.util.date.formatDateTime(a)),o.value=a,"date"==this.getDspType()?o.dispValue=teasp.util.date.formatDate(a,
this.getFormat()||"SLA"):o.dispValue=a?teasp.util.date.formatDateTime(a,this.getFormat()||"SLA-HM"):"",o;if("time"==i)return o.value=a,o.dispValue=("number"==typeof a?teasp.util.time.timeValue(a):a)||"",o;if("currency"!=i&&"currencyRange"!=i)return"checkbox"==i?(o.value=a,o.dispValue=a||this.getDefaultValue()||"",(!this.isPiw()&&!this.isPaychk()&&!e.noChoose||this.isPiw()&&e.piwk||this.isPaychk()&&e.approved)&&(
o.checky=!0),o):"status"==i?(o.value=a,o.dispValue=a||this.getDefaultValue()||"",o.spec=s.spec,o):"children"==i?(o.value=a?teasp.Tsf.util.toJson(a):null,o.dispValue="JSON",o):"StepStatus"==this.getApiKey()?(o.value=a,o.dispValue=teasp.constant.getStepStatus(a)||a,e.isCancelApply&&(o.dispValue=teasp.message.getLabel("tf10006190",o.dispValue)),o):(o.value=a,s.nameValue&&(o.nameValue=s.nameValue),
o.dispValue="number"==i?teasp.util.currency.formatDecimal(a,0,0,!1).str:"number"==typeof a?a:a||this.getDefaultValue()||"",o);if(teasp.Tsf.util.isArray(a)){o.value=a,o.dispValue=[];for(var r=this.getDecimal(),p=0;p<a.length;p++){var n=a[p];r?o.dispValue.push((n||0===n)&&s.spec?teasp.util.currency.formatDecimal(n,r[1],r[0],!0).str:""):o.dispValue.push(s.spec?teasp.Tsf.Currency.formatMoney(n,teasp.Tsf.Currency.V_YEN,!1
,!0):"")}}else{o.value=a;r=this.getDecimal();o.dispValue=r?(a||0===a)&&s.spec?teasp.util.currency.formatDecimal(a,r[1],r[0],!0).str:"":s.spec?teasp.Tsf.Currency.formatMoney(a,teasp.Tsf.Currency.V_YEN,!1,!0):""}return o},teasp.Tsf.Fc.prototype.fillValue=function(e,t,s){var a=this.getApiKey();if(!a)return this.isCheck()&&(e.checked=teasp.Tsf.Fc.combiVal(t,"value")),e.checked||!1;for(var o=(a="depta"==this.getDomType(
)&&t[0].checked?this.getOptKey():a).split("."),i=e,p=null,r=teasp.Tsf.Fc.combiVal(t,"value"),n=0;n<o.length;n++){var l=o[n];if(!r&&s&&n==o.length-2){p=i[l]=null;break}if(n==o.length-1){(p=i[l]=r)&&"children"==this.getDomType()&&(p=i[l]=teasp.Tsf.util.fromJson(p));break}i[l]||(i[l]={}),i=i[l]}return this.getDispFc()&&this.getDispFc().fillValue(e,{value:teasp.Tsf.Fc.combiVal(t,this.getDispFc().getCodeKey(
)?"nameValue":"dispValue")},!0),p},teasp.Tsf.Fc.combiVal=function(e,t){if(teasp.Tsf.util.isArray(e)){for(var s=[],a=0;a<e.length;a++)s.push(e[a][t]);return 1<s.length?s:s.length?s[0]:null}return e[t]},teasp.Tsf.Fc.prototype.fetchValue=function(e,t){return this.fetchValues(e,t)[0]},teasp.Tsf.Fc.prototype.fetchValues=function(e,t){var s,a,o=this.getElement(e,null,!0),i=this.getDomType(),p=[{dispValue:null,value:null}];
if(o)if("INPUT"==o.tagName)p[0].value="checkbox"==o.type?o.checked:o.value;else if("TEXTAREA"==o.tagName)p[0].value=o.value;else if("SELECT"==o.tagName){if(0<=o.selectedIndex)if(p[0].dispValue=o.options[o.selectedIndex].text,p[0].value=o.options[o.selectedIndex].value,(a=teasp.Tsf.Dom.nextSibling(o))&&"INPUT"==a.tagName&&(p[0].nameValue=a.value||""),this.isOptall()&&!p[0].value){p[0].array=[];for(
var r=0;r<o.options.length;r++)o.options[r].value&&p[0].array.push("'"+o.options[r].value+"'")}}else"dateRange"==i||"dateFrom"==i||"currencyRange"==i?(s=0,teasp.Tsf.Dom.query("input",o).forEach(function(e){p[s]={dispValue:null,value:null},p[s].value=e.value,p[s].name=e.name,s++}),i="dateRange"==i||"dateFrom"==i?"date":"currency"):"radio"==i?(p[0]={dispValue:null,value:null},teasp.Tsf.Dom.query("input",o).forEach(
function(e){e.checked&&(p[0].dispValue=p[0].value=e.value)})):"DIV"==o.tagName&&(e=teasp.Tsf.Dom.node("a",o),p[0].value=teasp.Tsf.util.revetize((e||o).innerHTML,""),p[0].value=p[0].value.replace(/&nbsp;/g,""),(a=teasp.Tsf.Dom.nextSibling(o))&&"INPUT"==a.tagName&&(p[0].dispValue=p[0].value,p[0].value=a.value||"",(e=teasp.Tsf.Dom.nextSibling(a))&&"INPUT"==e.tagName&&(p[0].nameValue=e.value||"")));"depta"==i?(
a=teasp.Tsf.Dom.node('input[type="checkbox"]',o.parentNode))&&(p[0].checked=a.checked):"deptb"==i&&((e=teasp.Tsf.Dom.node('input[type="checkbox"].dept-apply',o.parentNode))&&(p[0].checkDeptApply=e.checked),(a=teasp.Tsf.Dom.node('input[type="checkbox"].dept-layer',o.parentNode))&&(p[0].checkDeptLayer=a.checked));for(r=0;r<p.length;r++){var n,l,c=p[r];c.value&&("date"==i||"dateFrom"==i?(c.dispValue=c.value,
c.value=teasp.util.date.formatDate(c.value)||null):"datetime"==i?(c.dispValue=c.value,c.value=teasp.util.date.formatDateTime(c.value)||null):"time"==i?(n=teasp.util.time.clock2minutes(c.value),c.dispValue=c.value,c.value="number"==typeof n?n:null):"number"==i?(c.dispValue=c.value,l=teasp.util.currency.string2number(c.value),c.value=l.str?l.num:null):"checkbox"==i?"string"==typeof c.value&&(
c.value="true"==c.value.toLowerCase()||"1"==c.value):"currency"==i&&(c.dispValue=c.value,l=teasp.util.currency.string2number(c.value,!this.isPlusOnly()),c.value=l.str?""+l.num:null)),"checkbox"==i?(c.dispValue=c.dispValue||!1,c.value=c.value||!1):t&&"currency"==i?(c.dispValue=c.dispValue||0===c.dispValue?c.dispValue:null,c.value=c.value||0===c.value?c.value:"0"):t&&"number"==i?(
c.dispValue=c.dispValue||0===c.dispValue?c.dispValue:null,c.value=c.value||0===c.value?c.value:0):(c.dispValue=c.dispValue||0===c.dispValue?c.dispValue:null,c.value=c.value||0===c.value?c.value:null)}return p},teasp.Tsf.Fc.prototype.createFieldDiv=function(s,a,e){var t,o,i,p,r=[];if("route"!=this.getDomType()&&"tax"!=this.getDomType()){if("photo"==this.getDomType())return t=s.create("div",{className:"ts-form-photo"})
,(n=this.getDomId(a))&&(t.id=n),{areaTags:[t]};if("dateRange"==this.getDomType())return t=s.create("div",{className:"ts-form-date-range",id:this.getDomId(a)}),o=s.create("div",{className:"ts-form-date",style:{width:this.getWidth()}},t),i=s.create("div",{className:"ts-form-icon"},t),p=s.create("div",{className:"ts-form-wave"},t),h=s.create("div",{className:"ts-form-date",style:{width:this.getWidth()}},t),c=s.create(
"div",{className:"ts-form-icon"},t),m=this.getName()+"1",l=this.getName()+"2",s.create("input",{type:"text",name:m,maxLength:10},o),s.create("button",{className:"ts-form-cal",name:m},i),p.innerHTML=teasp.message.getLabel("wave_label"),s.create("input",{type:"text",name:l,maxLength:10},h),s.create("button",{className:"ts-form-cal",name:l},c),{areaTags:[t]};if("dateFrom"==this.getDomType())return t=s.create("div",{
className:"ts-form-date-range",id:this.getDomId(a)}),o=s.create("div",{className:"ts-form-date",style:{width:this.getWidth()}},t),i=s.create("div",{className:"ts-form-icon"},t),p=s.create("div",{style:{marginTop:"2px",marginLeft:"4px"}},t),m=this.getName()+"1",s.create("input",{type:"text",name:m,maxLength:10},o),s.create("button",{className:"ts-form-cal",name:m},i),p.innerHTML=teasp.message.getLabel("tk10000350"),{
areaTags:[t]};if("currencyRange"==this.getDomType())return t=s.create("div",{className:"ts-form-currency-range",id:this.getDomId(a)}),o=s.create("div",{className:"ts-form-currency",style:{width:this.getWidth()}},t),i=s.create("div",{className:"ts-form-wave"},t),p=s.create("div",{className:"ts-form-currency",style:{width:this.getWidth()}},t),s.create("input",{type:"text",maxLength:17},o),
i.innerHTML=teasp.message.getLabel("wave_label"),s.create("input",{type:"text",maxLength:17},p),this.isMinus()&&teasp.Tsf.Dom.query("input",t).forEach(function(e){teasp.Tsf.Dom.addClass(e,"ts-minus-ok")}),{areaTags:[t]}}var n,l,c,m,d,h=null,f=(e&&"TD"==e.tagName?h="100%":this.fc.width&&(h=this.getWidth()),s.create("div",{className:"ts-form-value ts-form-"+this.getDomType(),style:{width:h}})),g=(r.push(f),null);if(
"radio"==this.getDomType())g=f,this.getPickList()&&dojo.forEach(this.getPickList(),function(e){var t=s.create("label",null,f);s.create("input",{type:"radio",name:this.getName(a),value:e.v},t),t.appendChild(document.createTextNode(" "+e.n))},this);else if(this.isReadOnly())g=s.create("div",null,f),"select"==this.getDomType()?(s.create("input",{type:"hidden"},f),this.getDispFc()&&this.getDispFc().getCodeKey(
)&&s.create("input",{type:"hidden"},f)):"children"==this.getDomType()&&s.create("input",{type:"hidden"},f);else switch(this.getDomType()){case"select":g=s.create("select",null,f),this.loadPickList(s,g),this.getDispFc()&&this.getDispFc().getCodeKey()&&s.create("input",{type:"hidden"},f);break;case"checkbox":g=s.create("input",{type:"checkbox",style:{marginTop:"4px"}},f);break;case"textarea":g=s.create("textarea",{
style:{height:this.getHeight()||"40px"}},f),this.getMaxLength()&&(g.maxLength=this.getMaxLength());break;default:g=s.create("input",{type:"text"},f),this.getMaxLength()&&(g.maxLength=this.getMaxLength()),this.isMinus()&&teasp.Tsf.Dom.addClass(g,"ts-minus-ok")}return g&&(g.className="ts-form-"+this.getDomType(),(n=this.getDomId(a))&&(g.id=n),(l=this.getName(a))&&(g.name=l),this.isHiddenPlus()&&(c=s.create("input",{
type:"hidden"}),g.id&&(c.id=g.id+"Hidden"),r.push(c)),this.getSuffix()&&(m=s.create("div",{className:"ts-suffix"}),g.id&&(m.id=g.id+"Suffix"),r.push(m)),this.getPlaceholder()&&teasp.Tsf.Dom.setAttr(g,"placeholder",this.getPlaceholder()),this.getSelectIn()&&teasp.Tsf.Dom.setAttr(g,"readOnly",!0),this.getAlign()&&teasp.Tsf.Dom.style(g,"text-align",this.getAlign()),"depta"==this.getDomType()?(d=s.create("label",null,f),
s.create("input",{type:"checkbox"},d).checked=this.isDefaultChk(),s.create("span",{innerHTML:" "+teasp.message.getLabel("tk10005090")},d)):"deptb"==this.getDomType()&&(d=s.create("label",null,f),s.create("input",{type:"checkbox",className:"dept-apply"},d).checked=this.getCompositeCheck("checkDeptApply"),s.create("span",{innerHTML:" "+teasp.message.getLabel("tk10005090")},d),s.create("br",null,f),d=s.create("label",
null,f),s.create("input",{type:"checkbox",className:"dept-layer"},d).checked=this.getCompositeCheck("checkDeptLayer"),s.create("span",{innerHTML:" "+teasp.message.getLabel("tf10010800")},d))),{areaTags:r}},teasp.Tsf.Fc.prototype.appendFieldDiv=function(e,t,s){this.isSkip()||(teasp.Tsf.Dom.append(t,this.createFieldDiv(e,s,t).areaTags),this.getBrowse()&&!this.isReadOnly()&&(s=e.create("button",{
className:"ts-form-"+this.getBrowse()},e.create("div",{className:"ts-form-icon"},t)),this.isNoNL()&&teasp.Tsf.Dom.style(s,"margin-right","4px")))},teasp.Tsf.Fc.prototype.appendFieldHead=function(e,t){var s,a;if(!this.isSkip())return s=this.getHeadSpan(),a=this.getBrowse()&&!this.isReadOnly(),s&&a&&s++,s&&(a=(a?24:0)+this.getWplus(),a=e.create("th",{className:"ts-form-"+this.getDomType(),colSpan:s,style:{
width:this.getWidth(a)}},t),t=e.create("div",{innerHTML:this.getLabel()},a),this.isRequired()&&e.create("div",{className:"ts-require"},t),this.isCheck()&&!this.isRadio()&&e.create("input",{type:"checkbox"},t)),s},teasp.Tsf.Fc.prototype.appendFieldEmptyCell=function(e,t){var s;this.isSkip()||(s=this.getWidth()?{width:this.getWidth()}:null,s=e.create("td",{className:"ts-form-"+this.getDomType(),style:s},t),
teasp.Tsf.Dom.append(s,this.getFieldEmptyDiv(e,s).areaTags),this.getBrowse()&&!this.isReadOnly()&&e.create("div",{className:"ts-form-icon"},e.create("td",{className:"ts-form-"+this.getBrowse()},t)))},teasp.Tsf.Fc.prototype.getFieldEmptyDiv=function(e,t){if(!this.isSkip()){if("route"==this.getDomType())return{areaTags:e.create("div",null)};var s=this.getWidth(),t="TD"==t.tagName?{width:"100%"}:s?{width:s}:null;return{
areaTags:e.create("div",{className:"ts-form-value ts-form-"+this.getDomType(),style:t})}}},teasp.Tsf.Fc.prototype.appendFieldCell=function(e,t,s){var a;this.isSkip()||(a=this.getWidth()?{width:this.getWidth()}:null,a=e.create("td",{className:"ts-form-"+this.getDomType()+(this.isLast()?" last":""),style:a},t),teasp.Tsf.Dom.append(a,this.createFieldDiv(e,s,a).areaTags),this.getBrowse()&&!this.isReadOnly()&&e.create(
"button",{className:"ts-form-"+this.getBrowse()},e.create("div",{className:"ts-form-icon"},e.create("td",{className:"ts-form-"+this.getBrowse()},t))))},teasp.Tsf.Fc.SOBJTYP={select:"PICKLIST",date:"DATE",datetime:"DATETIME",time:"DOUBLE",text:"STRING",textarea:"STRING",currency:"CURRENCY",number:"DOUBLE",checkbox:"BOOLEAN"},teasp.Tsf.Fc.prototype.getSObjType=function(){return teasp.Tsf.Fc.SOBJTYP[this.getDomType()]},
teasp.Tsf.Fc.prototype.isSkip=function(){return!(!this.isCheck()||!this.parent.isReadOnly())},teasp.Tsf.Fc.prototype.isReadOnly=function(){return!(this.fc.wr||!this.isTable())||this.fc.ro},teasp.Tsf.Fc.prototype.setReadOnly=function(e){this.fc.ro=e},teasp.Tsf.Fc.prototype.isTable=function(){return this.parent&&("table"==this.parent.getType()||this.parent.isReadOnly())},
teasp.Tsf.Fc.prototype.isSearchCondition=function(){return this.parent&&this.parent.isSearchCondition()},teasp.Tsf.Fc.prototype.getDispFc=function(){return this.dispFc},teasp.Tsf.Fc.prototype.getSuffixFc=function(){return this.suffixFc},teasp.Tsf.Fc.prototype.getPremixFc=function(){return this.premixFc},teasp.Tsf.Fc.prototype.isLast=function(){return this.last},teasp.Tsf.Fc.prototype.isCheck=function(){
return this.fc.check},teasp.Tsf.Fc.prototype.isRadio=function(){return!!this.fc.check&&(this.parent&&"radio"==this.parent.getSelType())},teasp.Tsf.Fc.prototype.getRadioName=function(){return this.parent&&this.parent.getDiscernment()||"radio"},teasp.Tsf.Fc.prototype.getMatchType=function(){return this.fc.matchType||0},teasp.Tsf.Fc.prototype.getDataType=function(){return this.fc.dataType||null},
teasp.Tsf.Fc.prototype.getLabel=function(){if(null!==this.label)return this.label;if(this.fc.msgId){var e=teasp.message.getLabel(this.fc.msgId);if(e)return e}return this.fc.label||""},teasp.Tsf.Fc.prototype.setLabel=function(e){null!==e&&(this.label=e||"")},teasp.Tsf.Fc.prototype.getApiName=function(){return this.fc.apiName},teasp.Tsf.Fc.prototype.getDomType=function(){return this.fc.domType},
teasp.Tsf.Fc.prototype.getDspType=function(){return this.fc.dspType},teasp.Tsf.Fc.prototype.getSubType=function(){return this.fc.subType},teasp.Tsf.Fc.prototype.isHidden=function(){return this.fc.hidden},teasp.Tsf.Fc.prototype.isHiddenPlus=function(){return this.fc.hiddenPlus},teasp.Tsf.Fc.prototype.getFix=function(){return this.fc.fix},teasp.Tsf.Fc.prototype.getBrowse=function(){return this.fc.browse},
teasp.Tsf.Fc.prototype.isNoNL=function(){return this.fc.noNL},teasp.Tsf.Fc.prototype.getFormat=function(){return this.fc.format},teasp.Tsf.Fc.prototype.getAreaKey=function(){return this.fc.areaKey},teasp.Tsf.Fc.prototype.getDefaultValue=function(){return this.fc.defaultValue},teasp.Tsf.Fc.prototype.getHeight=function(){return this.fc.height},teasp.Tsf.Fc.prototype.isLink=function(){return this.fc.link},
teasp.Tsf.Fc.prototype.isSortable=function(){return this.fc.sortable},teasp.Tsf.Fc.prototype.isPiw=function(){return this.fc.piw||!1},teasp.Tsf.Fc.prototype.isPaychk=function(){return this.fc.paychk||!1},teasp.Tsf.Fc.prototype.getSelectIn=function(){return this.fc.selectIn||0},teasp.Tsf.Fc.prototype.getMaxLength=function(){return this.fc.maxLen},teasp.Tsf.Fc.prototype.getColNames=function(){return this.fc.colNames||[
]},teasp.Tsf.Fc.prototype.getAlign=function(){return this.fc.align||null},teasp.Tsf.Fc.prototype.getSuffix=function(){return this.fc.suffix||null};teasp.Tsf.Fc.prototype.isNoLf=function(){return this.fc.noLf},teasp.Tsf.Fc.prototype.isPlusOnly=function(){return this.fc.plusOnly||!1},teasp.Tsf.Fc.prototype.getOptKey=function(){return this.fc.optKey||null},teasp.Tsf.Fc.prototype.getOptKeys=function(){
return this.fc.optKeys||null},teasp.Tsf.Fc.prototype.getCodeKey=function(){return this.fc.codeKey||null},teasp.Tsf.Fc.prototype.getDivStr=function(){return this.fc.divStr||teasp.Tsf.JOB_CODE_NAME_DIV},teasp.Tsf.Fc.prototype.isDefaultChk=function(){return this.fc.defaultChk||!1},teasp.Tsf.Fc.prototype.isMinus=function(){return this.fc.minus||!1},teasp.Tsf.Fc.prototype.getHeadCss=function(){return this.fc.headCss||null
},teasp.Tsf.Fc.prototype.isNotUse=function(){return this.notUse||!1},teasp.Tsf.Fc.prototype.setNotUse=function(e){this.notUse=e},teasp.Tsf.Fc.prototype.isMinusIsNull=function(){return this.fc.minusIsNull||!1},teasp.Tsf.Fc.prototype.isNullSpec=function(){return this.fc.nullspec||!1},teasp.Tsf.Fc.prototype.isNullPlus=function(){return this.fc.nullplus||!1},teasp.Tsf.Fc.prototype.isDefaultIsTop=function(){
return this.fc.defaultIsTop||!1},teasp.Tsf.Fc.prototype.isFindMid=function(){return this.fc.findmid||null},teasp.Tsf.Fc.prototype.isTargetMask=function(e){return!this.fc.mask||this.fc.mask==e},teasp.Tsf.Fc.prototype.isComposite=function(){return"deptb"==this.getDomType()},teasp.Tsf.Fc.prototype.getCompositeCheck=function(e,t){return"boolean"==typeof t?t:e&&this.fc.defaultChks&&this.fc.defaultChks[e]||!1},
teasp.Tsf.Fc.prototype.isWeak=function(){return void 0===this.weak?this.fc.weak||!1:this.weak},teasp.Tsf.Fc.prototype.setWeak=function(e){this.weak=e},teasp.Tsf.Fc.prototype.isOptall=function(){return this.fc.optall||!1},teasp.Tsf.Fc.prototype.getPickList=function(e){if(this._pickList&&!e)return this._pickList;this._pickList=[];for(var t=this.fc.pickList||[],s=0;s<t.length;s++){var a=t[s];a.msgId&&(
a.n=teasp.message.getLabel(a.msgId)),this._pickList.push(a)}return this._pickList},teasp.Tsf.Fc.prototype.getPlaceholder=function(){return this.fc.placeholder&&"object"==typeof this.fc.placeholder&&this.fc.placeholder.msgId&&(this.fc.placeholder=teasp.message.getLabel(this.fc.placeholder.msgId)),this.fc.placeholder},teasp.Tsf.Fc.prototype.setPlusOnly=function(e){this.fc.plusOnly=e},
teasp.Tsf.Fc.prototype.setFilts=function(e,t,s){var a=[],o=this.getDomType(),i=s||this.getApiKey();if("text"==o||"select"==o||"depta"==o||"deptb"==o||"status"==o){var p,r=t[0].value;if("status"==this.getSubType()){var s=/^(.+)以外$/.exec(r),n=!1;s&&(r=s[1],n=!0),a.push({filtVal:i+(n?" != '":" = '")+r+"'"})}else if("noope"==this.getSubType())a.push({filtVal:i+r});else if("_station"==i)a.push({
filtVal:"(startName__c like '%"+r+"%' or endName__c like '%"+r+"%')"});else if("deptb"==o&&(t[0].checkDeptApply||t[0].checkDeptLayer)){s=this.getOptKeys();t[0].checkDeptApply&&!t[0].checkDeptLayer?a.push({filtVal:teasp.message.format(s[0],r)}):!t[0].checkDeptApply&&t[0].checkDeptLayer?a.push({filtVal:teasp.message.format(s[1],r)}):a.push({filtVal:teasp.message.format(s[2],r)})}else switch("depta"==o&&t[0].checked&&(
i=this.getOptKey()),this.getMatchType()){case 1:a.push({filtVal:i+" like '"+r+"%'"});break;case 2:a.push({filtVal:i+" like '%"+r+"'"});break;case 3:a.push({filtVal:i+" like '%"+r+"%'"});break;default:t[0].array?a.push({filtVal:i+" in ("+t[0].array.join(",")+")"}):"-1"==r&&this.isMinusIsNull()?a.push({filtVal:i+" = null"}):r&&this.isNullPlus()?a.push({filtVal:"("+i+" = '"+r+"' or "+i+" = null)"}):r&&this.isFindMid()?(
p=this.isFindMid(),a.push({filtVal:"("+i+" = '"+r+"' or "+i+" = null or "+i+" like '%"+p+r+p+"%')"})):r?a.push({filtVal:i+" = '"+r+"'"}):a.push({filtVal:i+" = null"})}}else if("dateRange"==o)if("dateTime"==this.getDataType())t[0].value&&a.push({filtVal:i+" >= "+teasp.util.date.formatDateTimeTz(t[0].value,0)}),t[1].value&&a.push({filtVal:i+" < "+teasp.util.date.formatDateTimeTz(teasp.util.date.addDays(t[1].value,1),0)
});else{var l=[i,i];if("_startEnd"==i)if(l=this.getColNames(),t[1].value)if(t[0].value){for(var c=[],m=0;m<2;m++){var d=[];t[0].value&&d.push(l[m]+" >= "+t[0].value),t[1].value&&d.push(l[m]+" <= "+t[1].value),c.push("("+d.join(" and ")+")")}a.push({filtVal:"("+c.join(" or ")+")"})}else a.push({filtVal:l[0]+" <= "+t[1].value});else a.push({filtVal:l[1]+" >= "+t[0].value});else t[0].value&&a.push({
filtVal:i+" >= "+t[0].value}),t[1].value&&a.push({filtVal:i+" <= "+t[1].value})}else"dateFrom"==o?t[0].value&&("dateTime"==this.getDataType()?a.push({filtVal:i+" >= "+teasp.util.date.formatDateTimeTz(t[0].value,0)}):a.push({filtVal:i+" >= "+t[0].value})):"date"==o?t[0].value&&(n=t[0].value,"_date"==i&&(l=this.getColNames(),a.push({
filtVal:"("+l[0]+" = null or "+l[0]+" <= "+n+") and ("+l[1]+" = null or "+l[1]+" >= "+n+")"}))):"filt"==o?a.push({filtVal:t[0].value}):"currencyRange"==o?(t[0].value&&a.push({filtVal:i+" >= "+t[0].value}),t[1].value&&a.push({filtVal:i+" <= "+t[1].value})):"array"==o&&t[0].value&&a.push({filtVal:i+" in ("+t[0].value+")"});for(m=0;m<a.length;m++)e.push(a[m])},teasp.Tsf.Fc.prototype.isRequired=function(e){
return!this.isReadOnly()&&(!e||1&e?this.fc.required:this.fc.required&e)},teasp.Tsf.Fc.prototype.setRequired=function(e){this.fc.required=e},teasp.Tsf.Fc.prototype.setPickList=function(e){this.fc.pickList=e},teasp.Tsf.Fc.prototype.checkValid=function(e,t,s){t&&(e?"date"==this.getDomType()&&1<(e=teasp.util.strToDate(e)).failed&&s.push({failed:e.failed,ngType:2==e.failed?2:3,fc:this,tmpl:e.tmpl}):this.isRequired(t
)&&s.push({ngType:1,fc:this}))},teasp.Tsf.Fc.prototype.getDecimal=function(){return this.fc.decimal?[6,2]:null},teasp.Tsf.Fc.prototype.isLinkAttachments=function(){return"children"==this.getDomType()&&!this.isHidden()},teasp.Tsf.Fc.prototype.loadPickList=function(t,s,e){teasp.Tsf.Dom.empty(s);var a,o=this.getPickList(!0);o&&(a=null,dojo.forEach(o,function(e){"string"==typeof e?(t.create("option",{value:e,
innerHTML:teasp.Tsf.util.entitizf(e||this.isSearchCondition()&&teasp.message.getLabel("tk10004480"))},s),null===a&&(a=e)):(t.create("option",{value:e.v,innerHTML:teasp.Tsf.util.entitizf(e.n)},s),null===a&&(a=e.v))},this),s.value=void 0!==e?e:this.isDefaultIsTop()&&a||"")},teasp.Tsf.Fc.prototype.getTooltipMsgId=function(){return this.fc.tooltipMsgId},teasp.Tsf.Fp=function(e,t){this.fp=e,
this.fp.fcs=teasp.Tsf.Fc.createList(e.fields||[],this),this.fp.searchFcs=teasp.Tsf.Fc.createList(e.searchFields||[],this),this.subkey=t},teasp.Tsf.Fp.UNIQ_SEQ=1,teasp.Tsf.Fp.createFp=function(e,t){return new teasp.Tsf.Fp(teasp.Tsf.util.clone(e),t)},teasp.Tsf.Fp.prototype.fcLoop=function(e,t,s){var a=this.fp.fcs,o=0,i=a&&a.length||0;if(t)for(;o<i;++o)a[o].isNotUse()&&!s||a[o].isTargetMask(t.mask)&&e.call(t,a[o],o,a
);else for(;o<i;++o)a[o].isNotUse()&&!s||e(a[o],o,a)},teasp.Tsf.Fp.prototype.searchFcLoop=function(e,t){dojo.forEach(this.fp.searchFcs,e,t)},teasp.Tsf.Fp.prototype.getFcByApiKey=function(e){for(var t=0;t<this.fp.fcs.length;t++){var s=this.fp.fcs[t];if(s.getApiKey()==e)return s}return null},teasp.Tsf.Fp.prototype.getFcById=function(e,t){for(var s=0;s<this.fp.fcs.length;s++){var a=this.fp.fcs[s];if(a.getDomId(t)==e
)return a}return null},teasp.Tsf.Fp.prototype.getElementByApiKey=function(e,t,s){e=this.getFcByApiKey(e);return e?e.getElement(t,s):null},teasp.Tsf.Fp.getTitle=function(e){var t=e;return e&&teasp.Tsf.util.isArray(e)?t=teasp.message.mixLabel(e):e&&(t=teasp.message.getLabel(e)),t||e},teasp.Tsf.Fp.prototype.getTitle=function(){return teasp.Tsf.Fp.getTitle(this.fp.title)},teasp.Tsf.Fp.prototype.getSectionTitle=function(e
){return e&&this.fp.sectionTitles?teasp.Tsf.Fp.getTitle(this.fp.sectionTitles[e]):this.fp.sectionTitle?teasp.Tsf.Fp.getTitle(this.fp.sectionTitle):""},teasp.Tsf.Fp.prototype.getWidth=function(){var t=0;return this.fcLoop(function(e){t+=e.getWidthNum()},this),t},teasp.Tsf.Fp.prototype.createSoql=function(e,t,s){var a=[],t=(this.fcLoop(function(e){e.isApiField(!0)&&a.push(e.getApiKey())},this,!0),"select "+(a=a.concat(
this.createChildSoqls(t))).join(",")+" from "+this.getObjectName()+(e||""));return s||(t+=this.createOrderBy()||""),t},teasp.Tsf.Fp.prototype.createOrderBy=function(){var t=[];return dojo.forEach(this.getSortKeys(),function(e){t.push(e.apiKey+(e.desc?" desc nulls last":""))},this),0<t.length?(t.push("Id")," order by "+t.join(",")):null},teasp.Tsf.Fp.prototype.createSoqlForCnt=function(e,t){
e="select Count() from "+this.getObjectName()+(e||"");return t||(e+=" limit "+teasp.constant.COUNT_LIMIT),e},teasp.Tsf.Fp.prototype.setChildren=function(e){this.fp.children=e},teasp.Tsf.Fp.prototype.getChildren=function(){return this.fp.children},teasp.Tsf.Fp.prototype.createChildSoqls=function(e){var t,s=this.fp.children||{},a=[];for(t in s)if(s.hasOwnProperty(t)){for(var o=s[t].fields||[],i=[],p=0;p<o.length;p++){
var r=o[p];r.apiKey&&i.push(r.apiKey)}0<i.length&&a.push("(select "+i.join(",")+" from "+t+(e||"")+")")}return a},teasp.Tsf.Fp.prototype.getFilts=function(){return this.fp.filts||[]},teasp.Tsf.Fp.prototype.getChildFilts=function(){return this.fp.childFilts||[]},teasp.Tsf.Fp.prototype.getSortKeys=function(){return this.fp.sortKeys||[]},teasp.Tsf.Fp.prototype.setSortKeys=function(e){var t=this.fp.sortKeys||[];if(
0<t.length&&t[0].apiKey==e.apiKey)t[0].desc=!t[0].desc;else{t.unshift(e);for(var s=t.length-1;0<s;s--)if(t[s].apiKey==e.apiKey){t.splice(s,1);break}}3<t.length&&t.splice(3),this.fp.sortKeys=t},teasp.Tsf.Fp.prototype.parseValueByDomType=function(t,s){var a=[];return this.fcLoop(function(e){e.getDomType()==s&&a.push(e.parseValue(t))},this),a},teasp.Tsf.Fp.prototype.getDispValueByApiKey=function(e,t){
t=this.getFcByApiKey(t);return t?t.parseValue(e).dispValue:null},teasp.Tsf.Fp.prototype.getDefaultFilts=function(){var s={},a=0,e=this.getFilts();return dojo.forEach(e,function(e){var t;e.apiKey&&e.value&&((t=this.getFcByApiKey(e.apiKey))&&t.fillValue(s,{value:e.value}),a++)},this),0<a?s:null},teasp.Tsf.Fp.prototype.getAreaId=function(){return this.fp.areaId},teasp.Tsf.Fp.prototype.getSectionTitles=function(){
return this.fp.sectionTitles},teasp.Tsf.Fp.prototype.getObjectName=function(){return this.fp.objectName},teasp.Tsf.Fp.prototype.getFields=function(){return this.fp.fields},teasp.Tsf.Fp.prototype.getDiscernment=function(){return this.fp.discernment},teasp.Tsf.Fp.prototype.getRelationshipName=function(){return this.fp.relationshipName},teasp.Tsf.Fp.prototype.isChild=function(){return this.fp.child},
teasp.Tsf.Fp.prototype.isVirChild=function(){return this.fp.virChild},teasp.Tsf.Fp.prototype.isPiw=function(){return this.fp.piw||!1},teasp.Tsf.Fp.prototype.getVirMax=function(){return this.fp.virMax},teasp.Tsf.Fp.prototype.getRowLimit=function(){return this.fp.rowLimit},teasp.Tsf.Fp.prototype.getPageLimit=function(){return this.fp.pageLimit},teasp.Tsf.Fp.prototype.getType=function(){return this.fp.type},
teasp.Tsf.Fp.prototype.getSelType=function(){return this.fp.selType},teasp.Tsf.Fp.prototype.isReadOnly=function(){return this.fp.readOnly},teasp.Tsf.Fp.prototype.getFoots=function(){return this.fp.foots||[]},teasp.Tsf.Fp.prototype.getButtons=function(){return this.fp.buttons||[]},teasp.Tsf.Fp.prototype.isStereoType=function(){return this.fp.stereoType||!1},teasp.Tsf.Fp.prototype.isJobList=function(){
return this.fp.jobList||!1},teasp.Tsf.Fp.prototype.isEmpList=function(){return this.fp.empList||!1},teasp.Tsf.Fp.prototype.getSearchFields=function(){return this.fp.searchFields||[]},teasp.Tsf.Fp.prototype.isSearchCondition=function(){return"searchCondition"==this.fp.type},teasp.Tsf.Fp.prototype.getSubkey=function(){return this.subkey||null},teasp.Tsf.Fp.prototype.getPayManage=function(){
return this.fp.payManage||null},teasp.Tsf.Fp.prototype.getDock=function(){return this.fp.dock||null},teasp.Tsf.Fp.prototype.getFormCss=function(){return this.fp.formCss+(this.subkey||"")},teasp.Tsf.Fp.prototype.getRowDisp=function(){return this.fp.rowDisp||10},teasp.Tsf.Fp.prototype.setReadOnly=function(e){this.fp.readOnly=e},teasp.Tsf.Fp.prototype.getIrregularType=function(){return this.fp.irregularType||null},
teasp.Tsf.Fp.createHkey=function(){return"R"+teasp.Tsf.Fp.UNIQ_SEQ++},teasp.Tsf.Fp.setHkey=function(e,t,s){s=s||teasp.Tsf.Fp.createHkey();return e.create("input",{type:"hidden",value:s,className:teasp.Tsf.HKEY_HOLD_CSS},t),s},teasp.Tsf.Fp.getHkey=function(e){e=teasp.Tsf.Dom.node("."+teasp.Tsf.HKEY_HOLD_CSS,e);return e&&e.value||null},teasp.Tsf.Fp.getHkeys=function(e){var t=[];if(e)for(var s=0;s<e.rows.length;s++){
var a=e.rows[s];t.push(this.getHkey(a))}return t},teasp.Tsf.Fp.getRowByHkey=function(e,t){if(e)for(var s=0;s<e.rows.length;s++){var a=e.rows[s];if(teasp.Tsf.Fp.getHkey(a)==t)return a}return null},teasp.Tsf.Fp.createPickList=function(e,t){var s=[];return t&&s.push({n:teasp.message.getLabel("tk10004480"),v:""}),dojo.forEach(e,function(e){this.push({n:e[0],v:e[1]})},s),s},teasp.Tsf.ListBase=function(e){this.reskey="L",
this.pageNo=1,this.checkMap={},this.selectedCount=0,this.selectedCountMax=0,this.cntOverMessage=null},teasp.Tsf.ListBase.prototype.setOption=function(e){this.option=e,this.freeFilts=e?e.filts:null,this.dataProcessingExt=e?e.dataProcessingExt:null},teasp.Tsf.ListBase.prototype.setSelectedCountMax=function(e){this.selectedCountMax=e},teasp.Tsf.ListBase.prototype.setFreeFilts=function(e){this.freeFilts=e},
teasp.Tsf.ListBase.prototype.getFilt=function(e){var o=this.freeFilts||[],p=[],t=(0<o.length&&dojo.forEach(o,function(e){if(e.filtVal)p.push(e.filtVal);else if(e.ors){for(var t=[],s=0;s<e.ors.length;s++){for(var a=e.ors[s]||[],o=[],i=0;i<a.length;i++)o.push(a[i].filtVal);t.push("("+o.join(" and ")+")")}p.push("("+t.join(" or ")+")")}}),this.fp.getFilts());return dojo.forEach(t,function(e){if(e.fix||o.length<=0)if(
e.filtVal)"empId"==e.filtKey?p.push(teasp.Tsf.util.formatString(e.filtVal,tsfManager.getEmpId())):"userId"==e.filtKey?p.push(teasp.Tsf.util.formatString(e.filtVal,tsfManager.getEmpUserId())):"today"==e.filtKey?p.push(teasp.Tsf.util.formatString(e.filtVal,teasp.util.date.formatDate(teasp.util.date.getToday()))):e.mask&&e.mask!=this.mask||p.push(e.filtVal);else if(e.apiKey&&e.value&&!/^_/.test(e.apiKey)){
var t=this.fp.getFcByApiKey(e.apiKey);if(t){var s=[];t.setFilts(s,[{value:e.value}]);for(var a=0;a<s.length;a++)p.push(s[a].filtVal)}}},this),p.length<=0?"":(e?" where ":"")+p.join(" and ")},teasp.Tsf.ListBase.prototype.setChildFilts=function(e){this.childFilts=e},teasp.Tsf.ListBase.prototype.getChildFilt=function(){var e=this.childFilts||this.fp.getChildFilts();return e&&0<e.length?e[0].filtVal:null},
teasp.Tsf.ListBase.prototype.getChildNega=function(){var e=this.childFilts||this.fp.getChildFilts();return!!(e&&0<e.length)&&e[0].nega},teasp.Tsf.ListBase.prototype.init=function(){this.domHelper=new teasp.Tsf.Dom,this.show(!1),teasp.Tsf.Dom.append(this.getArea(),this.createBase())},teasp.Tsf.ListBase.prototype.refresh=function(){this.checkMap={},this.setCheckedIds(),this.showCheckedCount(!0),
this.checkSelectableLimit(0),this.resetCheck(),this.getDomHelper().freeBy(this.reskey),teasp.Tsf.Dom.show(this.getArea(),null,!0),this.showData()},teasp.Tsf.ListBase.prototype.show=function(e){teasp.Tsf.Dom.show(this.getArea(),null,e)},teasp.Tsf.ListBase.prototype.getArea=function(){return teasp.Tsf.Dom.byId("expListView")},teasp.Tsf.ListBase.prototype.getListArea=function(){return teasp.Tsf.Dom.node(
"table.ts-list-body",this.getArea())},teasp.Tsf.ListBase.prototype.getDomHelper=function(){return this.domHelper},teasp.Tsf.ListBase.prototype.getListMode=function(){return 1},teasp.Tsf.ListBase.prototype.getTargetEmpId=function(){return null},teasp.Tsf.ListBase.prototype.getDeptId=function(){return tsfManager.getTargetEmp().getDeptId()},teasp.Tsf.ListBase.prototype.getDept=function(){return tsfManager.getTargetEmp(
).getDept()},teasp.Tsf.ListBase.prototype.isShowInit=function(){return!0},teasp.Tsf.ListBase.prototype.destroy=function(){this.domHelper&&(this.domHelper.free(),teasp.Tsf.Dom.empty(this.getArea()),delete this.domHelper),this.domHelper=null},teasp.Tsf.ListBase.prototype.createBase=function(){var e=this.getDomHelper().create("table",{className:"ts-list-body ts-list-head"}),s=this.getDomHelper().create("tr",null,
this.getDomHelper().create("thead",null,e)),a=teasp.Tsf.Fp.setHkey(this.getDomHelper(),s),o=0,t=(this.fp.fcLoop(function(e){var t;e.isHidden()||(t=this.getDomHelper().create("th",{id:e.getDomId(a),style:{width:e.getWidth()}},s),o++,e.isSortable()&&(teasp.Tsf.Dom.style(t,"cursor","pointer"),this.getDomHelper().connect(t,"onclick",this,this.sortBy)),e.isCheck()?this.getDomHelper().create("input",{type:"checkbox"},t):(
t=this.getDomHelper().create("div",null,t),this.getDomHelper().create("div",{innerHTML:e.getLabel()},t)))},this),teasp.Tsf.Dom.node('input[type="checkbox"]',s)),t=(t&&this.getDomHelper().connect(t,"onclick",this,this.checkAll),this.getDomHelper().create("tbody",null,e));return this.records=[],this.recordCount=0,this.drawData(t),(s=this.getDomHelper().create("tr",null,this.getDomHelper().create("tfoot",null,e))
).style.height="0px",this.getDomHelper().create("td",{colSpan:o},s),e},teasp.Tsf.ListBase.prototype.createScrollTable=function(e){var t=this.getDomHelper().create("div",{className:"ts-error-area",style:"display:none;"},e),s=(this.getDomHelper().create("div",null,t),this.setSearchContent(e),this.getDomHelper().create("div",{className:"ts-section-form"},e)),a=(this.getDomHelper().create("div",{
className:"ts-list-paging"},s),this.getDomHelper().create("table",{className:"ts-list-head"},s)),o=this.getDomHelper().create("thead",null,a),i=this.getDomHelper().create("tr",null,o),p=teasp.Tsf.Fp.setHkey(this.getDomHelper(),i),o=(this.fp.fcLoop(function(e){var t;e.isHidden()||(t=e.getWplus(),t=this.getDomHelper().create("th",{id:e.getDomId(p),style:{width:e.getWidth(t)}},i),e.getHeadCss()&&teasp.Tsf.Dom.addClass(t
,e.getHeadCss()),e.isSortable()&&(teasp.Tsf.Dom.style(t,"cursor","pointer"),this.getDomHelper().connect(t,"onclick",this,this.sortBy)),e.isCheck()&&!e.isRadio()?this.getDomHelper().create("input",{type:"checkbox"},t):(t=this.getDomHelper().create("div",null,t),this.getDomHelper().create("div",{innerHTML:e.getLabel()},t)))},this),teasp.Tsf.Dom.node('input[type="checkbox"]',o)),o=(o&&this.getDomHelper().connect(o,
"onclick",this,this.checkAll),this.getDomHelper().create("div",{className:"ts-search-list-box"},s)),s=this.getDomHelper().create("table",{className:"ts-list-body"},o),r=this.getDomHelper().create("tbody",null,s),n=this.fp.getRowLimit();n>this.fp.getRowDisp()&&(n=this.fp.getRowDisp()),teasp.Tsf.Dom.style(o,"height",20*n+2+"px");for(var l=0;l<n;l++){i=this.getDomHelper().create("tr",null,r),p=(
teasp.Tsf.Dom.toggleClass(i,"ts-row-even",!(l%2)),teasp.Tsf.Dom.toggleClass(i,"ts-row-odd",l%2),teasp.Tsf.Fp.setHkey(this.getDomHelper(),i));this.fp.fcLoop(function(e){e.isHidden()?this.getDomHelper().create("input",{type:"hidden",id:e.getDomId(p)},i):e.appendFieldCell(this.getDomHelper(),i,p)},this),this.getDomHelper().create("td",{className:"last",style:"width:16px;display:none;"},i)}
a.style.width=o.style.width=this.fp.getWidth()+2+"px",t.style.width=a.style.width,this.createButtons(e)},teasp.Tsf.ListBase.prototype.setSearchContent=function(e){},teasp.Tsf.ListBase.prototype.createButtons=function(e){},teasp.Tsf.ListBase.prototype.showData=function(e){this.showError(),this.checkSelectableLimit(0),this.pageNo=1,this.setSortMarker(),this.searchData(1,this.fp.getRowLimit(),!0,this.fp.isPiw(),
teasp.Tsf.Dom.hitch(this,function(e,t){e?(this.recordCount=t.recordsCount,this.records=t.records||[],this.mergePiwks(this.records,t.piwks||[]),this.dataProcessing(),this.dataProcessingExt&&this.dataProcessingExt(this.records),this.drawData(),this.showDataEnd()):this.showError(t)}))},teasp.Tsf.ListBase.prototype.tryChangePage=function(s){this.showError(),this.getCheckedIds(),this.resetCheck(),this.searchData(s,
this.fp.getRowLimit(),!1,this.fp.isPiw(),teasp.Tsf.Dom.hitch(this,function(e,t){e?(this.pageNo=s,this.records=t.records||[],this.mergePiwks(this.records,t.piwks||[]),this.dataProcessing(),this.dataProcessingExt&&this.dataProcessingExt(this.records),this.drawData()):this.showError(t)}))},teasp.Tsf.ListBase.prototype.searchData=function(e,t,s,a,o){t={limit:t,offset:t*(e-1),countUp:s,piw:a},e=this.fp.isStereoType()?(
t.target=this.fp.getObjectName(),t.countUp=!0,t.mode=this.getListMode(),tsfManager.isEmpTargetMode()?t.targetEmpId=tsfManager.getEmpId():t.targetEmpId=null,t.orderBy=this.fp.createOrderBy(),t.filt=this.getFilt(),t.childFilt=this.getChildFilt(),t.childNega=this.getChildNega(),t.payManage=this.fp.getPayManage(),t.irregularType=this.fp.getIrregularType(),"getList"):this.fp.isJobList()?(t.countUp=!0,
t.orderBy=this.fp.createOrderBy(),t.filt=this.getFilt(),t.targetEmpId=tsfManager.getEmpId(),"getJobList"):this.fp.isEmpList()?(t.soql=this.fp.createSoql(null,this.getChildFilt(),!0),t.soqlForCnt=this.fp.createSoqlForCnt(null,!0),t.countUp=!0,t.orderBy=this.fp.createOrderBy(),t.filt=this.getFilt(),t.orgTarget=this.getOrgTarget(),"getEmpList"):(t.soql=this.fp.createSoql(this.getFilt(!0)),
t.soqlForCnt=s?this.fp.createSoqlForCnt(this.getFilt(!0)):null,t.irregularType=this.fp.getIrregularType(),t.countUp=!0,"searchData");tsfManager[e](t,teasp.Tsf.Dom.hitch(this,function(e,t){o(!!e,t)}))},teasp.Tsf.ListBase.prototype.dataProcessing=function(){},teasp.Tsf.ListBase.prototype.showDataEnd=function(){var e=teasp.Tsf.Dom.node("div.ts-search-list-box",this.getArea());
e&&e.offsetWidth-e.clientWidth-2<=0&&teasp.Tsf.Dom.query("td:last-child",e).forEach(function(e){teasp.Tsf.Dom.style(e,"display","")})},teasp.Tsf.ListBase.prototype.showError=function(e){var t;this.isShowInit()?(t=teasp.Tsf.Dom.node(".ts-error-area",this.getArea()),teasp.Tsf.Error.showError(e,t)):teasp.Tsf.Error.showError(e)},teasp.Tsf.ListBase.prototype.mergePiwks=function(e,s){dojo.forEach(e,function(e){for(
var t=0;t<s.length;t++)e.Id==s[t].ProcessInstance.TargetObjectId&&(e.piwk=!0)},this)},teasp.Tsf.ListBase.prototype.sortBy=function(e){var e=teasp.Tsf.Dom.getAncestorByTagName(e.target,"TH"),t=teasp.Tsf.Fp.getHkey(teasp.Tsf.Dom.getAncestorByTagName(e,"TR")),e=this.fp.getFcById(e.id,t);e&&(this.fp.setSortKeys({apiKey:e.getApiKey()}),this.showData())},teasp.Tsf.ListBase.prototype.changePage=function(e){var t=e,s=this;
return function(){s.tryChangePage(t)}},teasp.Tsf.ListBase.prototype.drawData=function(e){for(var t=e||this.getCheckboxBody(),s=(this.getDomHelper().freeBy(this.reskey),teasp.Tsf.Dom.empty(t),this.firstEmptyRowKey=null,this.fp.getRowLimit()+1),a=0;a<s;a++){var o=this.getDomHelper().create("tr",null,t),i=teasp.Tsf.Fp.setHkey(this.getDomHelper(),o),p=(this.fp.fcLoop(function(e){e.isHidden()?this.getDomHelper().create(
"input",{type:"hidden",id:e.getDomId(i)},o):e.appendFieldCell(this.getDomHelper(),o,i)},this),this.getDomHelper().create("td",{className:"last",style:"width:16px;display:none;"},o),a<this.records.length?this.records[a]:{});a==this.records.length&&(this.firstEmptyRowKey=i),this.fp.fcLoop(function(e){e.drawText(this.getDomHelper(),p,i,o)},this),a<this.records.length?(o.style.cursor="pointer",this.getDomHelper(
).connect(o,"onclick",this,this.clickTr,this.reskey)):o.style.cursor="default",this.setAnchor(o)}this.setCheckedIds(),teasp.Tsf.ListBase.setPaging({pageNo:this.pageNo,cntAll:this.recordCount,rowLimit:this.fp.getRowLimit(),pageLimit:this.fp.getPageLimit(),cntOverMessage:this.cntOverMessage},teasp.Tsf.Dom.node(".ts-list-paging",this.getArea()),this.getDomHelper(),"paging",this)},
teasp.Tsf.ListBase.prototype.setAnchor=function(e){this.getDomHelper().connect(teasp.Tsf.Dom.query("a",e),"onclick",this,function(e){try{var t=teasp.Tsf.Fp.getHkey(teasp.Tsf.Dom.getAncestorByTagName(e.target,"TR")),s=this.fp.getFcByApiKey("Id").fetchValue(t).value;s&&tsfManager.changeView(null,s,null,teasp.Tsf.Dom.hitch(this,function(e,t){e||this.showError(t)}))}catch(e){this.showError(e)}},this.reskey)},
teasp.Tsf.ListBase.prototype.setSortMarker=function(){var a=teasp.Tsf.Fp.getHkey(teasp.Tsf.Dom.node(".ts-list-head thead tr",this.getArea())),e=this.fp.getSortKeys(),o=0<e.length?e[0]:null;this.fp.fcLoop(function(e){var t,s;e.isHidden()||(t=teasp.Tsf.Dom.node("div",teasp.Tsf.Dom.byId(e.getDomId(a))))&&(s=teasp.Tsf.Dom.node(".pp_base",t),o&&e.getApiKey()==o.apiKey?s?(teasp.Tsf.Dom.toggleClass(s,"pp_ico_sort_asc",
!o.desc),teasp.Tsf.Dom.toggleClass(s,"pp_ico_sort_desc",!!o.desc)):this.getDomHelper().create("div",{className:"pp_base pp_ico_sort_"+(o.desc?"desc":"asc")},t):s&&teasp.Tsf.Dom.destroy(s))},this)},teasp.Tsf.ListBase.setPaging=function(s,a,o,i,p){var e,t,r,n;a&&(o.freeBy(i),teasp.Tsf.Dom.empty(a),e=0<s.cntAll?Math.ceil(s.cntAll/s.rowLimit):1,s.pageLimit&&e>s.pageLimit&&(e=s.pageLimit),n=o.create("div",{
className:"ts-page-no ts-page-"+(1<s.pageNo?"on":"off"),innerHTML:"&lt;"},a),1<s.pageNo&&o.connect(n,"onclick",p,p.changePage(s.pageNo-1),i),n=teasp.util.getPageBox(e,s.pageNo,4,5,4),dojo.forEach(n,function(e){var t;null===e?o.create("div",{className:"ts-page-no ts-page-off",innerHTML:"･･"},a):(t=o.create("div",{className:"ts-page-no ts-page-"+(s.pageNo!=e?"on":"off"),innerHTML:e},a),s.pageNo!=e&&o.connect(t,
"onclick",p,p.changePage(e),i))}),n=o.create("div",{className:"ts-page-no ts-page-"+(s.pageNo<e?"on":"off"),innerHTML:"&gt;"},a),s.pageNo<e&&o.connect(n,"onclick",p,p.changePage(s.pageNo+1),i),(t=(n=(s.pageNo-1)*s.rowLimit+1)+s.rowLimit-1)>s.cntAll&&(t=s.cntAll),r="",0<s.cntAll&&(r=s.cntAll<=s.rowLimit?teasp.message.getLabel("tk10003230",s.cntAll):teasp.message.getLabel(
s.cntAll==teasp.constant.COUNT_LIMIT?"tk10003241":"tk10003240",s.cntAll,n||1,t||1)),o.create("div",{innerHTML:r,className:"ts-page-message"},a),s.rowLimit&&s.pageLimit&&s.cntOverMessage&&s.cntAll>s.rowLimit*s.pageLimit&&(n=o.create("div",null,a),o.create("div",{className:"pp_base pp_icon_caut",style:"margin-left:4px;margin-top:4px;"},n),o.createTooltip({connectId:n,label:s.cntOverMessage,position:["below"],
showDelay:200})),e<=1&&teasp.Tsf.Dom.show(".ts-page-no",a,!1))},teasp.Tsf.ListBase.prototype.clickTr=function(e){if("INPUT"==e.target.tagName&&"checkbox"==e.target.type)return this.checkSelectableLimit(this.selectedCount+(e.target.checked?1:0))?void(e.target.checked=!1):void this.showCheckedCount();e=teasp.Tsf.Dom.node("input.ts-check:not(:disabled)",teasp.Tsf.Dom.getAncestorByTagName(e.target,"TR"));
!e||"checkbox"!=e.type&&e.checked||this.checkSelectableLimit(this.selectedCount+(e.checked?0:1))||(e.checked=!e.checked,this.showCheckedCount())},teasp.Tsf.ListBase.prototype.getCheckboxHead=function(e){return teasp.Tsf.Dom.node("thead",this.getListArea())},teasp.Tsf.ListBase.prototype.getCheckboxBody=function(e){return teasp.Tsf.Dom.node("tbody",this.getListArea())},teasp.Tsf.ListBase.prototype.checkAll=function(e){
var t,s,a=teasp.Tsf.Dom.node('input[type="checkbox"]',this.getCheckboxHead());a&&(t=this.getCheckboxBody())&&(s=this.selectedCount,teasp.Tsf.Dom.query('input[type="checkbox"]',t).forEach(function(e){!e.checked&&a.checked&&s++,a.checked&&this.selectedCountMax&&!(this.selectedCount<this.selectedCountMax)||(!e.checked&&a.checked&&this.selectedCount++,e.checked=a.checked)},this),this.showCheckedCount(),
this.checkSelectableLimit(s))},teasp.Tsf.ListBase.prototype.resetCheck=function(){var e=this.getCheckboxHead();!e||(e=teasp.Tsf.Dom.node('input[type="checkbox"]',e))&&(e.checked=!1,this.showCheckedCount(),this.checkSelectableLimit(0))},teasp.Tsf.ListBase.prototype.showCheckedCount=function(e){var e=e?0:this.getCheckedIds().length,t=(this.selectedCount=e,teasp.Tsf.Dom.node("div.ts-list-countMsg",this.getArea()));t&&(
t.innerHTML=teasp.message.getLabel("tf10001830",e))},teasp.Tsf.ListBase.prototype.getCheckedIds=function(){for(var e=this.getCheckboxBody(),t={},s=0;s<e.rows.length;s++){var a=e.rows[s],o=teasp.Tsf.Fp.getHkey(a),o=this.fp.getFcByApiKey("Id").fetchValue(o).value;!o||(a=teasp.Tsf.Dom.node("input.ts-check",a))&&"checkbox"==a.type&&(t[o]=a.checked)}teasp.Tsf.util.mixin(this.checkMap,t);var i,p=[];for(i in this.checkMap
)this.checkMap.hasOwnProperty(i)&&this.checkMap[i]&&p.push(i);return p},teasp.Tsf.ListBase.prototype.setCheckedIds=function(){for(var e=this.getCheckboxBody(),t=0;t<e.rows.length;t++){var s=e.rows[t],a=teasp.Tsf.Fp.getHkey(s),a=this.fp.getFcByApiKey("Id").fetchValue(a).value;!a||(s=teasp.Tsf.Dom.node("input.ts-check",s))&&"checkbox"==s.type&&(s.checked=this.checkMap[a])}},
teasp.Tsf.ListBase.prototype.resizedArea=function(e){},teasp.Tsf.ListBase.prototype.getOrgTarget=function(){return null},teasp.Tsf.ListBase.prototype.checkSelectableLimit=function(e){var t=this.selectedCountMax;return!!t&&(e<=t?(teasp.Tsf.Dom.html("div.ts-list-caution",this.getArea(),""),!1):(teasp.Tsf.Dom.html("div.ts-list-caution",this.getArea(),teasp.message.getLabel("tf10010820",t)),!0))},
teasp.Tsf.Dialog=function(){},teasp.Tsf.Dialog.createButton=function(e,t,s,a){s=e.create("button",{className:s},a);return teasp.Tsf.Dom.append(s,e.create("div",{innerHTML:t})),s},teasp.Tsf.Loading=function(){this.off=!1},teasp.Tsf.Loading.prototype.show=function(){teasp.Tsf.Error.showError(),this.off||(this.dialog||(this.dialog=new dijit.Dialog({title:teasp.message.getLabel("tm00000040"),
content:'<div class="busywait"></div>',className:"ts-dialog-loading"}),dojo.query(".dijitDialogCloseIcon",this.dialog.titleBar).forEach(function(e){e.style.display="none"}),this.dialog.startup()),this.dialog.show())},teasp.Tsf.Loading.prototype.hide=function(){this.dialog&&this.dialog.hide()},teasp.Tsf.Loading.prototype.setOff=function(e){this.off=e},teasp.Tsf.ApplyComment=function(){this.params=null,
this.applyKey=null},teasp.Tsf.ApplyComment.prototype.getArea=function(){return teasp.Tsf.Dom.byId(this.dialog.id)},teasp.Tsf.ApplyComment.prototype.show=function(e,t){teasp.Tsf.Error.showError(),this.params=e||{},this.domHelper=new teasp.Tsf.Dom,this.dialog=new dijit.Dialog({title:this.params.title||"",className:this.params.formCss||""}),this.dialog.attr("content",this.getContent()),this.dialog.startup(),
this.domHelper.connect(this.dialog,"onCancel",this,function(){this.hide()}),this.callback=t,this.orgData=e,this.dialog.show()},teasp.Tsf.ApplyComment.prototype.hide=function(){this.dialog&&(this.dialog.hide(),this.domHelper.free(),this.dialog.destroy(),tsfManager.removeDialog("ApplyComment"))},teasp.Tsf.ApplyComment.prototype.getDomHelper=function(){return this.domHelper},
teasp.Tsf.ApplyComment.prototype.getContent=function(){var e=this.getDomHelper().create("div",{className:"ts-dialog"}),t=(this.getDomHelper().create("div",null,this.getDomHelper().create("div",{className:"ts-error-area",style:"width:360px;display:none;"},e)),this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("comment_head"),className:"ts-dialog-title"},e),this.getDomHelper().create("textarea",{
maxLength:4e3},this.getDomHelper().create("div",{className:"ts-dialog-comment"},e)));return teasp.Tsf.Dom.setlimitChars(this.getDomHelper(),[t],null,4e3),this.createButtons(e),e},teasp.Tsf.ApplyComment.prototype.createButtons=function(e){var t,e=this.getDomHelper().create("div",{className:"ts-dialog-buttons"},e),s=this.getDomHelper().create("div",null,e),e=this.params.buttons||[];e.length<=0&&(
t=teasp.Tsf.Dialog.createButton(this.getDomHelper(),teasp.message.getLabel("close_btn_title"),"ts-dialog-cancel",s),this.getDomHelper().connect(t,"onclick",this,this.hide)),dojo.forEach(e,function(t){var e;"cancel"==t.key?(e=teasp.Tsf.Dialog.createButton(this.getDomHelper(),t.label,t.css||"ts-dialog-cancel",s),this.getDomHelper().connect(e,"onclick",this,this.hide)):"function"==typeof this[t.key]?(
e=teasp.Tsf.Dialog.createButton(this.getDomHelper(),t.label,t.css||"ts-dialog-ok",s),this.getDomHelper().connect(e,"onclick",this,function(e){this.submit(t.key)})):(e=teasp.Tsf.Dialog.createButton(this.getDomHelper(),t.label,t.css||"ts-dialog-ok",s),this.getDomHelper().connect(e,"onclick",this,function(e){this.showError(),this.callback(t.key,this.fetchComment(),teasp.Tsf.Dom.hitch(this,this.hide),teasp.Tsf.Dom.hitch(
this,this.showError))}))},this)},teasp.Tsf.ApplyComment.prototype.showError=function(e){var t=teasp.Tsf.Dom.node(".ts-error-area",this.getArea());teasp.Tsf.Error.showError(e,t)},teasp.Tsf.ApplyComment.prototype.fetchComment=function(){return teasp.Tsf.Dom.node(".ts-dialog-comment textarea",this.getArea()).value||null},teasp.Tsf.ApplyComment.prototype.submit=function(e){this.showError();var t=this.fetchComment();
!t&&tsfManager.isRequireNote(this.applyKey)?this.showError(teasp.message.getLabel("tm10003820")):this[e](t)},teasp.Tsf.ApplyComment.prototype.submitApply=function(e){},teasp.Tsf.ApplyComment.prototype.cancelApply=function(e){},teasp.Tsf.ApplyComment.prototype.approveApply=function(e){},teasp.Tsf.ApplyComment.prototype.rejectApply=function(e){},teasp.Tsf.ApplyComment.prototype.openApproverSet=function(e){
var t=tsfManager.getTargetEmp().getApproverId(teasp.constant.APPROVER_TYPE_EXP);if(t)return window.open("/"+t+"/e","_blank"),!1;tsfManager.getApproverSet({empId:tsfManager.getEmpId(),type:teasp.constant.APPROVER_TYPE_EXP},teasp.Tsf.Dom.hitch(this,function(e,t){if(e){tsfManager.getTargetEmp().setApproverSet(t.approverSet);e=tsfManager.getTargetEmp().getApproverId(teasp.constant.APPROVER_TYPE_EXP);if(e
)return window.open("/"+e+"/e","_blank"),!1}else this.showError(t)}))},teasp.Tsf.ApplyComment.prototype.reloadApproverSet=function(e){tsfManager.getApproverSet({empId:tsfManager.getEmpId(),type:teasp.constant.APPROVER_TYPE_EXP},teasp.Tsf.Dom.hitch(this,function(e,t){e?(tsfManager.getTargetEmp().setApproverSet(t.approverSet),(e=teasp.Tsf.Dom.node("div.ts-apply-approver-area div.ts-apply-approver-b",this.getArea()))&&(
e.innerHTML=tsfManager.getTargetEmp().getApproverNames(teasp.constant.APPROVER_TYPE_EXP))):this.showError(t)}))},teasp.Tsf.ApplyCommentExp=function(){this.params=null},teasp.Tsf.ApplyCommentExp.prototype=new teasp.Tsf.ApplyComment,teasp.Tsf.ApplyCommentExp.prototype.show=function(e,t){this.orgData=e,this.applyKey=teasp.constant.APPLY_KEY_EXPAPPLY,teasp.Tsf.ApplyComment.prototype.show.call(this,e,t),
teasp.Tsf.Dom.show("div.ts-apply-target-choice",this.getArea(),this.orgData.targetChoice);e=this.orgData.objBase.getRingiApplyObj();tsfManager.isExpLinkDocument()||e.Id?this.showRingiInfo(e):(teasp.Tsf.Dom.show("div.ts-apply-link-ringi",this.getArea(),!1),teasp.Tsf.Dom.show("div.ts-section-ringi",this.getArea(),!1))},teasp.Tsf.ApplyCommentExp.prototype.getContent=function(){var s,e=this.getDomHelper().create("div",{
className:"ts-dialog"}),t=(this.getDomHelper().create("div",null,this.getDomHelper().create("div",{className:"ts-error-area",style:"width:390px;display:none;"},e)),this.getDomHelper().create("div",{className:"ts-apply-target-choice"},e)),a=(this.getDomHelper().create("div",{className:"ts-apply-target",innerHTML:teasp.message.getLabel("tf10001300")},t),this.getDomHelper().create("label",null,this.getDomHelper(
).create("div",null,t))),o=this.getDomHelper().create("input",{type:"radio",name:"ApplyCommentTarget"},a),a=(o.disabled=this.orgData.checkedOnly,o.checked=!this.orgData.checkedOnly,a.appendChild(document.createTextNode(" "+teasp.message.getLabel("all_label"))),this.getDomHelper().create("label",null,this.getDomHelper().create("div",null,t))),o=((o=this.getDomHelper().create("input",{type:"radio",
name:"ApplyCommentTarget"},a)).disabled=this.orgData.checkedList.length<=0,o.checked=this.orgData.checkedOnly,a.appendChild(document.createTextNode(" "+teasp.message.getLabel("tf10001630"))),dojo.query('input[type="radio"]',t).forEach(function(e){this.getDomHelper().connect(e,"onclick",this,teasp.Tsf.Dom.hitch(this,function(){this.showClosingWarn()}))},this),this.getDomHelper().create("div",null,this.getDomHelper(
).create("div",{className:"ts-apply-warn-closing",style:"display:none;"},e)),this.getDomHelper().create("div",null,this.getDomHelper().create("div",{className:"ts-apply-warn-over",style:"display:none;"},e)),this.getDomHelper().create("div",{className:"ts-apply-approver-area",style:"width:390px;"},e)),a=(this.getDomHelper().create("div",{className:"ts-apply-approver-a",innerHTML:teasp.message.getLabel("tk10000071")},o
),this.getDomHelper().create("div",{className:"ts-apply-approver-b"},o)),t=this.getDomHelper().create("div",{className:"ts-apply-approver-c"},o),i=this.getDomHelper().create("a",{className:"ts-apply-approver-a1"},t),t=this.getDomHelper().create("a",{className:"ts-apply-approver-a2"},t),a=(this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tk10004000")},i),this.getDomHelper().create("div",{
innerHTML:teasp.message.getLabel("tk10004010")},t),a.innerHTML=tsfManager.getTargetEmp().getApproverNames(teasp.constant.APPROVER_TYPE_EXP),teasp.Tsf.Dom.show(o,null,tsfManager.isUseExpApproverSet()),this.getDomHelper().connect(i,"onclick",this,this.reloadApproverSet),this.getDomHelper().connect(t,"onclick",this,this.openApproverSet),this.getDomHelper().create("div",{className:"ts-apply-link-ringi"},e)),
o=this.getDomHelper().create("button",{className:"std-button1",innerHTML:teasp.message.getLabel("tf10001640")},a),i=(this.getDomHelper().connect(o,"onclick",this,this.openRingiList),this.getDomHelper().create("button",{className:"std-button2",innerHTML:teasp.message.getLabel("clearLabel")},a)),p=(this.getDomHelper().connect(i,"onclick",this,this.clearRingi),this.getDomHelper().create("div",{
className:"ts-section-form ts-section-ringi"},e)),t=(this.fp=teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.ringiInfo),this.fp.fcLoop(function(e){var t;e.isHidden()?this.getDomHelper().create("input",{type:"hidden",id:e.getDomId()},p):(s=this.getDomHelper().create("div",{className:"ts-form-row"},p),t=this.getDomHelper().create("div",{className:"ts-form-label"},s),e.getLw()&&teasp.Tsf.Dom.style(t,"width",e.getLw()),
this.getDomHelper().create("div",{innerHTML:e.getLabel()},t),e.appendFieldDiv(this.getDomHelper(),s))},this),this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("comment_head"),className:"ts-dialog-title"},e),this.getDomHelper().create("textarea",{maxLength:4e3,style:"width:390px;"},this.getDomHelper().create("div",{className:"ts-dialog-comment"},e)));return teasp.Tsf.Dom.setlimitChars(
this.getDomHelper(),[t],null,4e3),this.createButtons(e),this.orgData.targetChoice&&this.showClosingWarn(e),e},teasp.Tsf.ApplyCommentExp.prototype.showClosingWarn=function(e){var t=e||this.getArea(),t=dojo.query("div.ts-apply-warn-closing",t)[0],s=dojo.query("div",t)[0],a=(dojo.empty(s),this.getDivideDateList(e));1<a.length&&(this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10007690")},s),
teasp.Tsf.Dom.append(s,this.createRangeList(a))),dojo.style(t,"display",1<a.length?"":"none"),this.showOverWarn(e)},teasp.Tsf.ApplyCommentExp.prototype.showOverWarn=function(e){var t=0,s=tsfManager.getExpCountLimit(),a=e||this.getArea(),o=dojo.query("div.ts-apply-warn-over",a)[0],i=dojo.query("div",o)[0],p=(dojo.empty(i),this.getTargetRange(e)),a=teasp.Tsf.Dom.node('div.ts-apply-target-choice input[type="radio"]',a);
s<(t=p.active?p.count||0:(a.checked?this.orgData.allList:this.orgData.checkedList).length)&&(this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10007700",s)},i),p=this.getDomHelper().create("label",null,this.getDomHelper().create("div",{className:"top-only"},i)),a=this.getDomHelper().create("input",{type:"checkbox"},p),this.getDomHelper().create("span",{innerHTML:" "+teasp.message.getLabel(
"tf10007710",s)},p),this.getDomHelper().connect(a,"onclick",this,teasp.Tsf.Dom.hitch(this,function(){this.enableSubmit(e)}))),dojo.style(o,"display",s<t?"":"none"),this.enableSubmit(e)},teasp.Tsf.ApplyCommentExp.prototype.getTargetRange=function(e){var e=e||this.getArea(),t={active:!1};return dojo.query('.ts-range-list input[type="radio"]',e).forEach(function(e){t.active=!0,e.checked&&(
e=teasp.Tsf.Dom.getAncestorByTagName(e,"DIV"),t.sd=dojo.query('input[type="hidden"].range-sd',e)[0].value,t.ed=dojo.query('input[type="hidden"].range-ed',e)[0].value,t.count=parseInt(dojo.query('input[type="hidden"].range-count',e)[0].value,10))}),t},teasp.Tsf.ApplyCommentExp.prototype.enableSubmit=function(e){var t=e||this.getArea(),s=!0,a=teasp.Tsf.Dom.node('div.ts-apply-warn-over input[type="checkbox"]',t),e=((
a&&!a.checked||(a=this.getTargetRange(e)).active&&!a.count)&&(s=!1),teasp.Tsf.Dom.node("div.ts-dialog-buttons",t)),a=teasp.Tsf.Dom.node("button.ts-dialog-ok",e)||teasp.Tsf.Dom.node("button.ts-dialog-ok-disabled",e);dojo.toggleClass(a,"ts-dialog-ok",s),dojo.toggleClass(a,"ts-dialog-ok-disabled",!s),a.disabled=!s},teasp.Tsf.ApplyCommentExp.prototype.getDivideDateList=function(e){var e=e||this.getArea(),
t=tsfManager.getExpStartDate();return this.orgData.targetChoice&&0<t?(e=teasp.Tsf.Dom.node('div.ts-apply-target-choice input[type="radio"]',e).checked?this.orgData.allDates:this.orgData.checkedDates,teasp.util.date.divideDateList(e,t)):[]},teasp.Tsf.ApplyCommentExp.prototype.createRangeList=function(e,t){this.getDomHelper().freeBy("rangeList");for(var s=this.getDomHelper().create("div",{className:"ts-range-list"}),
a=0;a<e.length;a++){var o=e[a],i=this.getDomHelper().create("div",null,s),p=this.getDomHelper().create("label",null,i),r=this.getDomHelper().create("input",{type:"radio",name:"rangeSel"},p),r=("number"==typeof t&&a==t&&(r.checked=!0),this.getDomHelper().connect(r,"onclick",this,teasp.Tsf.Dom.hitch(this,function(){this.showOverWarn()}),"rangeList"),teasp.message.getLabel(o.sd!=o.ed?"tf10007720":"tf10007730",
teasp.util.date.formatDate(o.sd,"SLA"),teasp.util.date.formatDate(o.ed,"SLA"),o.lst.length));this.getDomHelper().create("span",{innerHTML:" "+r},p),this.getDomHelper().create("input",{type:"hidden",value:o.sd,className:"range-sd"},i),this.getDomHelper().create("input",{type:"hidden",value:o.ed,className:"range-ed"},i),this.getDomHelper().create("input",{type:"hidden",value:""+o.lst.length,className:"range-count"},i)}
return 3<e.length&&(dojo.style(s,"overflow-y","scroll"),dojo.style(s,"height","60px")),s},teasp.Tsf.ApplyCommentExp.prototype.getExpList=function(e){for(var t=this.getArea(),s=tsfManager.getExpCountLimit(),a=teasp.Tsf.Dom.node('div.ts-apply-target-choice input[type="radio"]',t),o=a.checked?this.orgData.allList:this.orgData.checkedList,i=this.getTargetRange(t),p={cost:0,ids:[],uks:[],
allApply:a.checked&&!i.active&&o.length<=s},r=1,n=0;n<e.length&&p.ids.length<s;n++){var l=e[n];l._tempId="_temp"+r++,o.contains(l.Id||l._uniqKey)&&(!i.active||i.sd<=l.Date__c&&l.Date__c<=i.ed)&&(p.ids.push(l.Id||l._uniqKey),p.uks.push(l._tempId),p.cost+=teasp.Tsf.util.parseInt(l.Cost__c)||0)}return p},teasp.Tsf.ApplyCommentExp.prototype.openRingiList=function(e){for(
var t=teasp.Tsf.formParams.ringiList.searchFields||[],s=0;s<t.length;s++)"Type__c"==t[s].apiKey&&(t[s].pickList=tsfManager.getAtkApplyTypeList());tsfManager.showSearchListDialog({discernment:"ringiList"},null,teasp.Tsf.Dom.hitch(this,this.selectedRingi))},teasp.Tsf.ApplyCommentExp.prototype.selectedRingi=function(e){this.showRingiInfo(e[0])},teasp.Tsf.ApplyCommentExp.prototype.clearRingi=function(e){
this.showRingiInfo({})},teasp.Tsf.ApplyCommentExp.prototype.showRingiInfo=function(t){this.fp.fcLoop(function(e){e.isApiField(!0)&&e.drawText(this.getDomHelper(),t)},this);var e=teasp.Tsf.Dom.node("div.ts-section-ringi",this.getArea());teasp.Tsf.Dom.show(e,null,t.Id),teasp.Tsf.Dom.show("div.ts-apply-link-ringi button.std-button2",this.getArea(),t.Id),t.Id&&this.getDomHelper().connect(teasp.Tsf.Dom.query("a",e),
"onclick",this,function(e){teasp.isSforce1()?sforce.one.navigateToURL("/"+t.Id):window.open("/"+t.Id)})},teasp.Tsf.ApplyCommentExp.prototype.submitApply=function(e){var t={comment:e},e=this.orgData.totalCost,s=!0,a=[],o=this.orgData.expApply;if(this.orgData.targetChoice){var i=this.getExpList(o&&o.exps||this.orgData.objBase.obj.EmpExp__r||[]);if(i.ids.length<=0)return void teasp.tsAlert(teasp.message.getLabel(
"tf10001650"));t.ids=i.ids,e=i.cost,a=i.uks,s=i.allApply}else{var i=this.orgData.allDates,p=tsfManager.getExpStartDate();if(0<p)if(1<teasp.util.date.divideDateList(i,p).length)return p=100<=p?teasp.message.getLabel("tm10010490",teasp.util.date.getWeekJp(p-100)):teasp.message.getLabel("tm10010480",p),void teasp.tsAlert(teasp.message.getLabel("tf10000460",p));p=tsfManager.getExpCountLimit();if(i.length>p
)return void teasp.tsAlert(teasp.message.getLabel("tm30001140",i.length,p))}if(this.orgData.objBase.obj.EmpExp__r)for(var r=0;r<this.orgData.objBase.obj.EmpExp__r.length;r++)if(!(n=this.orgData.objBase.obj.EmpExp__r[r]).ExpItemId__c||0==n.ExpItemId__c.length)return void teasp.tsAlert(teasp.message.getLabel("jt13000060"));if(!tsfManager.isAllowMinusApply()&&e<0)teasp.tsAlert(teasp.message.getLabel("tm30001145",
teasp.util.currency.addFigure(e),teasp.message.getLabel("cunit_jps"),teasp.util.currency.addFigure(teasp.constant.CU_TOTAL_LOWER_LIMIT),teasp.message.getLabel("cunit_jps")));else{if(t.ringiId=this.fp.getFcByApiKey("Id").fetchValue().value,o){for(r=0;r<o.exps.length;r++){var n=o.exps[r];(s||n.Id&&t.ids.contains(n.Id)||a.contains(n._tempId))&&(n.isApply=!0)}t.expApply=o}tsfManager.submitApply(t,teasp.Tsf.Dom.hitch(this
,function(e,t){e?(this.hide(),this.callback(t)):this.showError(t)}))}},teasp.Tsf.ApplyCommentExp.prototype.cancelApply=function(e){e={solve:this.orgData.solve,comment:e};tsfManager.cancelApply(e,teasp.Tsf.Dom.hitch(this,function(e,t){e?(this.hide(),this.params.parentHide&&this.params.parentHide(),this.callback(t)):this.showError(t)}))},teasp.Tsf.ApplyCommentExpPre=function(){this.params=null},
teasp.Tsf.ApplyCommentExpPre.prototype=new teasp.Tsf.ApplyComment,teasp.Tsf.ApplyCommentExpPre.prototype.getContent=function(){this.applyKey=teasp.constant.APPLY_KEY_EXPPREAPPLY;var e=this.getDomHelper().create("div",{className:"ts-dialog"}),t=(this.getDomHelper().create("div",null,this.getDomHelper().create("div",{className:"ts-error-area",style:"width:390px;display:none;"},e)),this.getDomHelper().create("div",{
className:"ts-apply-approver-area",style:"width:390px;"},e)),s=(this.getDomHelper().create("div",{className:"ts-apply-approver-a",innerHTML:teasp.message.getLabel("tk10000071")},t),this.getDomHelper().create("div",{className:"ts-apply-approver-b"},t)),a=this.getDomHelper().create("div",{className:"ts-apply-approver-c"},t),o=this.getDomHelper().create("a",{className:"ts-apply-approver-a1"},a),a=this.getDomHelper(
).create("a",{className:"ts-apply-approver-a2"},a),s=(this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tk10004000")},o),this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tk10004010")},a),s.innerHTML=tsfManager.getTargetEmp().getApproverNames(teasp.constant.APPROVER_TYPE_EXP),teasp.Tsf.Dom.show(t,null,tsfManager.isUseExpApproverSet()),this.getDomHelper().connect(o,"onclick",this,
this.reloadApproverSet),this.getDomHelper().connect(a,"onclick",this,this.openApproverSet),this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("comment_head"),className:"ts-dialog-title"},e),this.getDomHelper().create("textarea",{maxLength:4e3,style:"width:390px;"},this.getDomHelper().create("div",{className:"ts-dialog-comment"},e)));return teasp.Tsf.Dom.setlimitChars(this.getDomHelper(),[s],null,4e3),
this.createButtons(e),e},teasp.Tsf.ApplyCommentExpPre.prototype.submitApply=function(e){tsfManager.submitApply({comment:e},teasp.Tsf.Dom.hitch(this,function(e,t){e?(this.hide(),this.callback(t)):this.showError(t)}))},teasp.Tsf.ApplyCommentExpPre.prototype.cancelApply=function(e){e={solve:this.orgData.solve,comment:e};tsfManager.cancelApply(e,teasp.Tsf.Dom.hitch(this,function(e,t){e?(this.hide(),
this.params.parentHide&&this.params.parentHide(),this.callback(t)):this.showError(t)}))},teasp.Tsf.ApplyCommentApprove=function(){this.params=null},teasp.Tsf.ApplyCommentApprove.prototype=new teasp.Tsf.ApplyComment,teasp.Tsf.ApplyCommentApprove.prototype.approveApply=function(e){tsfManager.approveApply({comment:e},!0,teasp.Tsf.Dom.hitch(this,function(e,t){e?(this.hide(),this.callback(t)):this.showError(t)}))},
teasp.Tsf.ApplyCommentApprove.prototype.rejectApply=function(e){tsfManager.approveApply({comment:e},!1,teasp.Tsf.Dom.hitch(this,function(e,t){e?(this.hide(),this.callback(t)):this.showError(t)}))},teasp.Tsf.ApplyCommentCancel=function(){this.params=null},teasp.Tsf.ApplyCommentCancel.prototype=new teasp.Tsf.ApplyComment,teasp.Tsf.ApplyCommentCancel.prototype.show=function(e,t){
teasp.Tsf.ApplyComment.prototype.show.call(this,e,t),e.noComment&&(teasp.Tsf.Dom.show("div.ts-dialog-comment",this.getArea(),!1),(t=teasp.Tsf.Dom.node("div.ts-dialog-title",this.getArea())).innerHTML=e.warning||"",t.style.width="350px",t.style.height="60px",t.style.padding="5px 20px")},teasp.Tsf.ApplyCommentCancel.prototype.cancelApply=function(e){e={solve:this.orgData.solve,comment:e};tsfManager.cancelApply(e,
teasp.Tsf.Dom.hitch(this,function(e,t){e?(this.hide(),this.params.parentHide&&this.params.parentHide(),this.callback(t)):this.showError(t)}))},teasp.Tsf.ApplyCommentCommuterPass=function(){this.params=null},teasp.Tsf.ApplyCommentCommuterPass.prototype=new teasp.Tsf.ApplyComment,teasp.Tsf.ApplyCommentCommuterPass.prototype.show=function(e,t){teasp.Tsf.ApplyComment.prototype.show.call(this,e,t),e.noComment&&(
teasp.Tsf.Dom.show("div.ts-dialog-comment",this.getArea(),!1),(t=teasp.Tsf.Dom.node("div.ts-dialog-title",this.getArea())).innerHTML=teasp.message.getLabel("tf10001620"),t.style.width="300px",t.style.height="50px",t.style.padding="5px 20px")},teasp.Tsf.ApplyCommentCommuterPass.prototype.cancelApply=function(e){e={method:"cancelCommuterPass",id:this.orgData.id,empId:this.orgData.empId,comment:e};
tsfManager.submitCommuterPass(e,teasp.Tsf.Dom.hitch(this,function(e,t){e?(this.hide(),this.params.parentHide&&this.params.parentHide(),this.callback(t)):this.showError(t)}))},teasp.Tsf.ApplyCreateExp=function(){this.params=null,this.applyKey=null},teasp.Tsf.ApplyCreateExp.prototype.getArea=function(){return teasp.Tsf.Dom.byId(this.dialog.id)},teasp.Tsf.ApplyCreateExp.prototype.getDomHelper=function(){
return this.domHelper},teasp.Tsf.ApplyCreateExp.prototype.hide=function(){this.dialog&&(this.dialog.hide(),this.domHelper.free(),this.dialog.destroy(),tsfManager.removeDialog("ApplyCreateExp"))},teasp.Tsf.ApplyCreateExp.prototype.createButtons=function(e){var t,e=this.getDomHelper().create("div",{className:"ts-dialog-buttons"},e),s=this.getDomHelper().create("div",null,e),e=this.params.buttons||[];e.length<=0&&(
t=teasp.Tsf.Dialog.createButton(this.getDomHelper(),teasp.message.getLabel("close_btn_title"),"ts-dialog-cancel",s),this.getDomHelper().connect(t,"onclick",this,this.hide)),dojo.forEach(e,function(t){var e;"cancel"==t.key?(e=teasp.Tsf.Dialog.createButton(this.getDomHelper(),t.label,t.css||"ts-dialog-cancel",s),this.getDomHelper().connect(e,"onclick",this,this.hide)):"function"==typeof this[t.key]?(
e=teasp.Tsf.Dialog.createButton(this.getDomHelper(),t.label,t.css||"ts-dialog-ok",s),this.getDomHelper().connect(e,"onclick",this,function(e){this.submit(t.key)})):(e=teasp.Tsf.Dialog.createButton(this.getDomHelper(),t.label,t.css||"ts-dialog-ok",s),this.getDomHelper().connect(e,"onclick",this,function(e){this.showError(),this.callback(t.key,this.fetchComment(),teasp.Tsf.Dom.hitch(this,this.hide),teasp.Tsf.Dom.hitch(
this,this.showError))}))},this)},teasp.Tsf.ApplyCreateExp.prototype.showError=function(e){var t=teasp.Tsf.Dom.node(".ts-error-area",this.getArea());teasp.Tsf.Error.showError(e,t)},teasp.Tsf.ApplyCreateExp.prototype.submit=function(e){this.showError(),this[e]()},teasp.Tsf.ApplyCreateExp.prototype.show=function(e,t){this.orgData=e,this.applyKey=teasp.constant.APPLY_KEY_EXPAPPLY,teasp.Tsf.Error.showError(),
this.params=e||{},this.domHelper=new teasp.Tsf.Dom,this.dialog=new dijit.Dialog({title:this.params.title||"",className:this.params.formCss||""}),this.dialog.attr("content",this.getContent()),this.dialog.startup(),this.domHelper.connect(this.dialog,"onCancel",this,function(){this.hide()}),this.callback=t,this.dialog.show()},teasp.Tsf.ApplyCreateExp.prototype.getContent=function(){var e=this.getDomHelper().create("div"
,{className:"ts-dialog"}),t=(this.getDomHelper().create("div",null,this.getDomHelper().create("div",{className:"ts-error-area",style:"width:390px;display:none;"},e)),this.getDomHelper().create("div",{className:"ts-apply-target-choice"},e)),s=(this.getDomHelper().create("div",{className:"ts-apply-target",innerHTML:teasp.message.getLabel("tf10001300")},t),this.getDomHelper().create("label",null,this.getDomHelper(
).create("div",null,t))),a=this.getDomHelper().create("input",{type:"radio",name:"ApplyCommentTarget"},s),s=(a.checked=!this.orgData.checkedList.length,s.appendChild(document.createTextNode(" "+teasp.message.getLabel("all_label"))),this.getDomHelper().create("label",null,this.getDomHelper().create("div",null,t)));return(a=this.getDomHelper().create("input",{type:"radio",name:"ApplyCommentTarget"},s)
).disabled=!this.orgData.checkedList.length,a.checked=0<this.orgData.checkedList.length,s.appendChild(document.createTextNode(" "+teasp.message.getLabel("tf10001630"))),dojo.query('input[type="radio"]',t).forEach(function(e){this.getDomHelper().connect(e,"onclick",this,teasp.Tsf.Dom.hitch(this,function(){this.showClosingWarn()}))},this),this.params&&!this.params.allList.length?(this.getDomHelper().create("div",{
innerHTML:teasp.message.getLabel("tf10008890"),style:"text-align:center;"},e),teasp.Tsf.Dom.show(t,this.getArea(),!1)):teasp.Tsf.Dom.show(t,this.getArea(),!0),this.getDomHelper().create("div",null,this.getDomHelper().create("div",{className:"ts-apply-warn-closing",style:"display:none;"},e)),this.getDomHelper().create("div",null,this.getDomHelper().create("div",{className:"ts-apply-warn-over",style:"display:none;"},e)
),this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10008870")},this.getDomHelper().create("div",{className:"ts-apply-start-message"},e)),this.createButtons(e),this.showClosingWarn(e),e},teasp.Tsf.ApplyCreateExp.prototype.showClosingWarn=function(e){var t=e||this.getArea(),t=dojo.query("div.ts-apply-warn-closing",t)[0],s=dojo.query("div",t)[0],a=(dojo.empty(s),this.getDivideDateList(e));
1<a.length&&(this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10007690")},s),teasp.Tsf.Dom.append(s,this.createRangeList(a))),dojo.style(t,"display",1<a.length?"":"none"),this.showOverWarn(e)},teasp.Tsf.ApplyCreateExp.prototype.showOverWarn=function(e){var t=0,s=tsfManager.getExpCountLimit(),a=e||this.getArea(),o=dojo.query("div.ts-apply-warn-over",a)[0],i=dojo.query("div",o)[0],p=(dojo.empty(i),
this.getTargetRange(e)),a=teasp.Tsf.Dom.node('div.ts-apply-target-choice input[type="radio"]',a);s<(t=p.active?p.count||0:(a.checked?this.orgData.allList:this.orgData.checkedList).length)&&(this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10007700",s)},i),p=this.getDomHelper().create("label",null,this.getDomHelper().create("div",{className:"top-only"},i)),a=this.getDomHelper().create("input",{
type:"checkbox"},p),this.getDomHelper().create("span",{innerHTML:" "+teasp.message.getLabel("tf10007710",s)},p),this.getDomHelper().connect(a,"onclick",this,teasp.Tsf.Dom.hitch(this,function(){this.enableSubmit(e)}))),dojo.style(o,"display",s<t?"":"none"),this.enableSubmit(e)},teasp.Tsf.ApplyCreateExp.prototype.getTargetRange=function(e){var e=e||this.getArea(),t={active:!1};return dojo.query(
'.ts-range-list input[type="radio"]',e).forEach(function(e){t.active=!0,e.checked&&(e=teasp.Tsf.Dom.getAncestorByTagName(e,"DIV"),t.sd=dojo.query('input[type="hidden"].range-sd',e)[0].value,t.ed=dojo.query('input[type="hidden"].range-ed',e)[0].value,t.count=parseInt(dojo.query('input[type="hidden"].range-count',e)[0].value,10))}),t},teasp.Tsf.ApplyCreateExp.prototype.enableSubmit=function(e){var t=e||this.getArea(),
s=!0,a=teasp.Tsf.Dom.node('div.ts-apply-warn-over input[type="checkbox"]',t),e=((a&&!a.checked||(a=this.getTargetRange(e)).active&&!a.count)&&(s=!1),teasp.Tsf.Dom.node("div.ts-dialog-buttons",t)),a=teasp.Tsf.Dom.node("button.ts-dialog-ok",e)||teasp.Tsf.Dom.node("button.ts-dialog-ok-disabled",e);dojo.toggleClass(a,"ts-dialog-ok",s),dojo.toggleClass(a,"ts-dialog-ok-disabled",!s),a.disabled=!s},
teasp.Tsf.ApplyCreateExp.prototype.getDivideDateList=function(e){var e=e||this.getArea(),t=tsfManager.getExpStartDate();return 0<t?(e=teasp.Tsf.Dom.node('div.ts-apply-target-choice input[type="radio"]',e).checked?this.orgData.allDates:this.orgData.checkedDates,teasp.util.date.divideDateList(e,t)):[]},teasp.Tsf.ApplyCreateExp.prototype.createRangeList=function(e,t){this.getDomHelper().freeBy("rangeList");for(
var s=this.getDomHelper().create("div",{className:"ts-range-list"}),a=0;a<e.length;a++){var o=e[a],i=this.getDomHelper().create("div",null,s),p=this.getDomHelper().create("label",null,i),r=this.getDomHelper().create("input",{type:"radio",name:"rangeSel"},p),r=("number"==typeof t&&a==t&&(r.checked=!0),this.getDomHelper().connect(r,"onclick",this,teasp.Tsf.Dom.hitch(this,function(){this.showOverWarn()}),"rangeList"),
teasp.message.getLabel(o.sd!=o.ed?"tf10007720":"tf10007730",teasp.util.date.formatDate(o.sd,"SLA"),teasp.util.date.formatDate(o.ed,"SLA"),o.lst.length));this.getDomHelper().create("span",{innerHTML:" "+r},p),this.getDomHelper().create("input",{type:"hidden",value:o.sd,className:"range-sd"},i),this.getDomHelper().create("input",{type:"hidden",value:o.ed,className:"range-ed"},i),this.getDomHelper().create("input",{
type:"hidden",value:""+o.lst.length,className:"range-count"},i)}return 3<e.length&&(dojo.style(s,"overflow-y","scroll"),dojo.style(s,"height","60px")),s},teasp.Tsf.ApplyCreateExp.prototype.getExpList=function(e){for(var t=this.getArea(),s=tsfManager.getExpCountLimit(),a=teasp.Tsf.Dom.node('div.ts-apply-target-choice input[type="radio"]',t),o=a.checked?this.orgData.allList:this.orgData.checkedList,
i=this.getTargetRange(t),p={cost:0,ids:[],uks:[],allApply:a.checked&&!i.active&&o.length<=s},r=1,n=0;n<e.length&&p.ids.length<s;n++){var l=e[n];l._tempId="_temp"+r++,o.contains(l.Id||l._uniqKey)&&(!i.active||i.sd<=l.Date__c&&l.Date__c<=i.ed)&&(p.ids.push(l.Id||l._uniqKey),p.uks.push(l._tempId),p.cost+=teasp.Tsf.util.parseInt(l.Cost__c)||0)}return p},teasp.Tsf.ApplyCreateExp.prototype.createExpApply=function(){for(
var e=this.orgData.expApply,t=this.getExpList(e.exps),s=t.ids,a=t.uks,o=t.allApply,i=[],p=0;p<e.exps.length;p++){var r=e.exps[p];(o||s.contains(r.Id||r._uniqKey)||a.contains(r._tempId))&&i.push(r)}e.exps=i.sort(function(e,t){return e.Date__c==t.Date__c?0:e.Date__c<t.Date__c?-1:1}),e.applyStart=!0,e.ExpenseType__c=this.orgData.expenseType,tsfManager.createExpApply(e,teasp.Tsf.Dom.hitch(this,function(e,t){e?(this.hide(
),this.callback(t)):this.showError(t)}))},teasp.Tsf.dialog={},teasp.Tsf.dialog.Base=function(){this.inited=!1,this.dialog=null,this.id=null,this.args={},this.callback=null,this.thisObject=null,this.bodyId="bodyCell",this.pouch=null,this.title="",this.duration=1,this.content=null,this.widthHint=null,this.heightHint=null,this.okLink=null,this.cancelLink=null,this.closeLink=null},teasp.Tsf.dialog.Hack=function(e){
this.title=e&&e.title||null,this.id=e&&e.id||null,this.duration=e&&e.duration||null,this.content=null,this.id||(this.id="Dialog"+teasp.sequence.dialog++),dojo.byId(this.id)||(dojo.create("div",{id:this.id,className:"ver-dialog",style:"padding-bottom:80px;"},dojo.byId("big_area").parentNode),this.content&&(dojo.byId(this.id).innerHTML=this.content))},teasp.Tsf.dialog.Hack.prototype.attr=function(e,t){this[e]=t,
"content"!=e||dojo.byId(this.id).innerHTML||(dojo.byId(this.id).innerHTML=this.content)},teasp.Tsf.dialog.Hack.prototype.startup=function(){},teasp.Tsf.dialog.Hack.prototype.show=function(){teasp.Tsf.dialogStack.length<=0&&teasp.Tsf.dialogStack.push("big_area"),teasp.Tsf.dialogStack.unshift(this.id),dojo.style(teasp.Tsf.dialogStack[1],"display","none"),dojo.style(teasp.Tsf.dialogStack[0],"display","")},
teasp.Tsf.dialog.Hack.prototype.hide=function(){var e=teasp.Tsf.dialogStack.shift();dojo.style(e,"display","none"),0<teasp.Tsf.dialogStack.length&&(e=teasp.Tsf.dialogStack[0],dojo.style(e,"display",""),"big_area"==e&&((e=dojo.byId("graphDiv"))&&(e.scrollLeft=140),(e=dojo.byId("timeGridView"))&&(e.scrollTop=280)))},teasp.Tsf.dialog.Base.prototype._init=function(){var e,t;this.inited||(require(["dijit/Dialog"]),
this.domHelper=new teasp.Tsf.Dom,this.preInit(),this.inited=!0,t={title:this.title,id:this.id,duration:this.duration},this.dialog=new(this.noDialog()?teasp.Tsf.dialog.Hack:dijit.Dialog)(t),this.dialog.attr("content",this.content),this.okLink&&dojo.byId(this.okLink.id)&&this.domHelper.connect(teasp.Tsf.Dom.byId(this.okLink.id),"onclick",this,this.okLink.callback),this.cancelLink&&dojo.byId(this.cancelLink.id
)&&this.domHelper.connect(teasp.Tsf.Dom.byId(this.cancelLink.id),"onclick",this,this.cancelLink.callback),this.closeLink&&dojo.byId(this.closeLink.id)&&this.domHelper.connect(teasp.Tsf.Dom.byId(this.closeLink.id),"onclick",this,this.closeLink.callback),dojo.byId(this.id+"_title")||(t=dojo.byId(this.id))&&t.firstChild&&(e=t.firstChild.clientWidth,(t=dojo.create("div",{id:this.id+"_title",style:{marginTop:"2px",
marginBottom:"4px"},className:"dijitDialogTitleBar"},t.firstChild,"before")).style.width=e+"px",this.title&&(t.innerHTML=this.title)),this.preStart(),this.dialog.startup(),this.postStart())},teasp.Tsf.dialog.Base.prototype.getDomHelper=function(){return this.domHelper},teasp.Tsf.dialog.Base.prototype.noDialog=function(){return this.pouch&&this.pouch.isNonDialogMode&&this.pouch.isNonDialogMode()&&!this.nohack},
teasp.Tsf.dialog.Base.prototype.show=function(){this.dialog.show()},teasp.Tsf.dialog.Base.prototype.hide=function(){this.dialog.hide()},teasp.Tsf.dialog.Base.prototype.open=function(e,t,s,a){this.pouch=e,this.args=t||{},this.callback=s,this.thisObject=a,this.nohack=this.args.nohack||this.nohack,this.ready(),this._init(),this.preShow()&&(this.show(),this.postShow())},teasp.Tsf.dialog.Base.prototype.close=function(){
this.hide()},teasp.Tsf.dialog.Base.prototype.ready=function(){},teasp.Tsf.dialog.Base.prototype.preInit=function(){},teasp.Tsf.dialog.Base.prototype.preStart=function(){},teasp.Tsf.dialog.Base.prototype.postStart=function(){},teasp.Tsf.dialog.Base.prototype.preShow=function(){return!0},teasp.Tsf.dialog.Base.prototype.postShow=function(){},teasp.Tsf.dialog.Base.prototype.ok=function(){return!0},
teasp.Tsf.dialog.Base.prototype.cancel=function(){return!0},teasp.Tsf.dialog.Base.prototype.onfinishfunc=function(e){this.callback&&this.callback.apply(this.thisObject||this,arguments)},teasp.Tsf.dialog.ExpSearch=function(){this.widthHint=770,this.heightHint=428,this.id="dialogExpSearch",this.title=teasp.message.getLabel("ekitanResult_caption"),this.duration=1,
this.content='<table class="ekitan_search_frame" style="width:752px;"><tr><td><table class="cond" style="margin-left:auto;margin-right:auto;"><tr><td class="ekitan-search-date" style="width:128px;" id="ekSerch_date_label"></td><td class="from" style="width:160px;" id="ekSerch_stationFrom_label"></td><td class="arrow" style="width:24px;" ></td><td class="to" style="width:160px;" id="ekSerch_stationTo_label"></td><td class="route" style="width:190px;"><div class="horizon" style="display:table;margin:0px auto;"><div id="ekSerch_stationVia_label"></div><div id="expSearchViaHelp" class="pp_base pp_icon_help" style="margin:3px 0px 0px 3px;"></div></div></td><td class="search" style="width:90px;" ></td></tr><tr><td class="ekitan-search-date"><input type="text" value="" class="inputran" style="width:90px;text-align:center;" maxlength="10" id="expSearchDate" name="expSearchDate" /><input type="button" id="expSearchDateCal" class="ts-legacy-cal" /></td><td class="from"><input type="text" id="expSearchComboSt0" /></td><td class="arrow"><input type="button" id="expSearchResultArrow" class="pp_base pp_btn_oneway" style="margin-left:2px;" /></td><td class="to"><input type="text" id="expSearchComboSt1" /></td><td class="route"><input type="text" value="" class="inputran" style="width:180px;padding:1px 4px;" maxlength="20" id="expSearchResultRoute" /></td><td class="search"><button id="expSearchResultSearch"><div></div></button></td></tr><tr><td colspan="3"></td><td colspan="2" class="transfer" style="text-align:left;padding-left:20px;"><div class="horizon"><div><label><input type="checkbox" id="expSearchTransfer" /> <span id="expSearchTransferLabel"></span></label></div><div id="expSearchTransferHelp" class="pp_base pp_icon_help" style="margin:3px 0px 0px 3px;"></div></div></td></tr></table></td></tr><tr id="expSearchResultErrorRow" style="display:none;"><td style="padding-top:4px;text-align:center;"><span id="expSearchResultError" style="color: red;"></span></td></tr><tr><td style="padding-top:4px;"><table class="head" style="width:752px;"><thead><tr><th class="chk" ></th><th class="cost" id="expSearchColumn2"></th><th class="route" id="ekSerch_route_head"></th></tr></thead></table></td></tr><tr style="height:1px;"><td></td></tr><tr><td><div class="scroll_area" style="width:750px;" id="expSearchResultArea"><table class="data"><tbody id="expSearchResultTableBody"></tbody></table></div></td></tr><tr id="expSearchCtrl1Row" style="display:none;"><td style="padding-top:4px;"><table class="horiz" style="width:752px;"><tr><td style="width:234px;text-align:left"><div id="expSearchPeriodArea" style="display:none;"><span id="expSearchPeriodLabel"></span>&nbsp;<select id="expSearchPeriod"></select></div></td><td style="width:124px;text-align:center;"><button id="expSearchOk"><div></div></button></td><td style="width:124px;text-align:center;"><button id="expSearchCancel"><div></div></button></td><td style="width:154px;"></td><td style="width:116px;"><div class="pp_base pp_logo_ekitan" style="text-align:right;" ></div></td></tr></table></td></tr><tr id="expSearchCtrl2Row"><td style="padding-top:4px;"><table class="horiz" style="width:752px;"><tr><td style="width:234px;"></td><td style="width:248px;text-align:center;"><button id="expSearchClose"><div></div></button></td><td style="width:154px;"></td><td style="width:116px;"><div class="pp_base pp_logo_ekitan" style="text-align:right;" ></div></td></tr></table></td></tr><tr id="expSearchCtrlWarnRow" style="display:none;"><td style="text-align:left;"><div id="expSearchCtrlWarn" style="color:blue;font-size:0.9em;padding-top:4px;"></div></td></tr></table>'
,this.okLink={id:"expSearchOk",callback:this.ok},this.cancelLink={id:"expSearchCancel",callback:this.hide},this.closeLink={id:"expSearchClose",callback:this.close},this.searchRoute=dojo.hitch(tsfManager,tsfManager.searchRoute),this.rowMin=6,this.comboSt=[],this.expRoutes=null,this.searchKey={},this.hkey="exp-search"},teasp.Tsf.dialog.ExpSearch.prototype=new teasp.Tsf.dialog.Base,
teasp.Tsf.dialog.ExpSearch.prototype.getStoreFrom=function(){return this.storeFrom||(this.storeFrom=teasp.Tsf.Dom.createStoreMemory([])),this.storeFrom},teasp.Tsf.dialog.ExpSearch.prototype.getStoreTo=function(){return this.storeTo||(this.storeTo=teasp.Tsf.Dom.createStoreMemory([])),this.storeTo},teasp.Tsf.dialog.ExpSearch.prototype.setStoreFrom=function(e){teasp.Tsf.Dom.setStoreMemory(this.getStoreFrom(),e)},
teasp.Tsf.dialog.ExpSearch.prototype.setStoreTo=function(e){teasp.Tsf.Dom.setStoreMemory(this.getStoreTo(),e)},teasp.Tsf.dialog.ExpSearch.prototype.preStart=function(){teasp.message.setLabelHtml("ekSerch_date_label","tf10000180"),teasp.message.setLabelHtml("ekSerch_stationFrom_label","stationFrom_label"),teasp.message.setLabelHtml("ekSerch_stationTo_label","stationTo_label"),teasp.message.setLabelHtml(
"ekSerch_stationVia_label","stationVia_label"),teasp.message.setLabelHtml("expSearchColumn2","expCost_head"),teasp.message.setLabelHtml("ekSerch_route_head","route_head"),teasp.message.setLabelHtml("expSearchTransferLabel","tf10008820"),teasp.message.setLabelEx("expSearchCtrlWarn","tk10005060"),dojo.byId("expSearchResultSearch").firstChild.innerHTML=teasp.message.getLabel("tf10000190"),dojo.byId("expSearchOk"
).firstChild.innerHTML=teasp.message.getLabel("select_btn_title"),dojo.byId("expSearchCancel").firstChild.innerHTML=teasp.message.getLabel("cancel_btn_title"),dojo.byId("expSearchClose").firstChild.innerHTML=teasp.message.getLabel("close_btn_title"),this.getDomHelper().connect("expSearchResultSearch","onclick",this,this.search),this.comboSt[0]=this.getDomHelper().createComboBox({id:"expSearchComboStList0",
name:"comboSt0",value:"",store:this.getStoreFrom(),fetchProperties:{sort:[{attribute:"score",descending:!1},{attribute:"name",descending:!1}]},searchAttr:"name",style:{width:"150px",border:"1px solid #539AC7"}},teasp.Tsf.Dom.byId("expSearchComboSt0")),this.comboSt[1]=this.getDomHelper().createComboBox({id:"expSearchComboStList1",name:"comboSt1",value:"",store:this.getStoreTo(),fetchProperties:{sort:[{
attribute:"score",descending:!1},{attribute:"name",descending:!1}]},searchAttr:"name",style:{width:"150px",border:"1px solid #539AC7"}},teasp.Tsf.Dom.byId("expSearchComboSt1"));var e=teasp.Tsf.Dom.byId("expSearchDateCal"),t=teasp.Tsf.Dom.byId("expSearchDate");e&&t&&tsfManager.eventOpenCalendar(this.getDomHelper(),e,t,{tagName:t.name,isDisabledDate:function(e){return!1}}),9==dojo.isIE&&this.getDomHelper().connect(
this.dialog,"onKeyDown",this,function(e){return 13===e.keyCode&&dojo.stopEvent(e),!1}),this.getDomHelper().createTooltip({connectId:"expSearchViaHelp",label:teasp.message.getLabel("tf10008840"),position:["below"],showDelay:100}),this.getDomHelper().createTooltip({connectId:"expSearchTransferHelp",label:teasp.message.getLabel("tf10008830"),position:["below"],showDelay:100})},
teasp.Tsf.dialog.ExpSearch.prototype.preShow=function(){this.getDomHelper().freeBy(this.hkey),this.showError(null),this.resobj={routes:[]},dojo.style("expSearchPeriodArea","display",this.args.commuter?"":"none"),dojo.query(".ekitan-search-date").forEach(function(e){dojo.style(e,"display","none")},this),this.args.commuter?(e=teasp.util.date.formatDate(teasp.util.date.getToday(),"SLA"),dojo.byId("expSearchDate"
).value=e,teasp.Tsf.Dom.byId("expSearchPeriodLabel").innerHTML=teasp.message.getLabel("tk10005030"),e=teasp.Tsf.Dom.byId("expSearchPeriod"),teasp.Tsf.Dom.empty(e),dojo.create("option",{value:"0",innerHTML:teasp.message.getLabel("tk10005010")},e),dojo.create("option",{value:"1",innerHTML:teasp.message.getLabel("tk10005040",1)},e),dojo.create("option",{value:"3",innerHTML:teasp.message.getLabel("tk10005040",3)},e),
dojo.create("option",{value:"6",innerHTML:teasp.message.getLabel("tk10005040",6)},e),e.value=tsfManager.getTicketPeriod(),this.getDomHelper().connect(e,"onchange",this,this.changeTicketPeriod,this.hkey)):this.getDomHelper().connect("expSearchResultArrow","onclick",this,this.checkRoundTrip,this.hkey),this.displayFareName(),teasp.Tsf.Dom.byId("expSearchResultArrow").className="pp_base "+(
this.args.roundTrip?"pp_btn_round":"pp_btn_oneway"),dojo.style("expSearchResultArrow","cursor",this.args.commuter?"default":"pointer"),dojo.style("expSearchCtrl1Row","display",this.args.readonly||this.args.fixed?"none":""),dojo.style("expSearchCtrl2Row","display",this.args.readonly||this.args.fixed?"":"none"),dojo.style("expSearchCtrlWarnRow","display",
!this.args.commuter||this.args.readonly||this.args.fixed?"none":""),this.setStoreFrom(this.args.stationFromHist),this.setStoreTo(this.args.stationToHist),this.comboSt[0].setValue(this.args.startName||""),this.comboSt[1].setValue(this.args.endName||"");var e,t=[];return this.args.stationVia&&dojo.forEach(this.args.stationVia,function(e){t.push(e.name)}),teasp.Tsf.Dom.byId("expSearchResultRoute").value=t.join(","),
teasp.Tsf.Dom.byId("expSearchTransfer").checked=this.args.transfer||!1,this.createBody(),this.show(),this.args.startName&&this.args.endName&&!this.args.searchStop&&setTimeout(dojo.hitch(this,this.search),100),!1},teasp.Tsf.dialog.ExpSearch.prototype.ok=function(){var e,t,s=this.getSelectRowIndex();s<0||(e=dojo.byId("expSearchPeriod").value,this.args.commuter&&"0"==e?this.showError(teasp.message.getLabel("tk10005020")
):(t=0<=s&&s<this.expRoutes.getRouteCount()?this.expRoutes.getRoute(s):null)&&(this.args.commuter&&!t.getCommuterCode()?teasp.tsAlert(teasp.message.getLabel("tk10005050"),this,function(){this.onfinishfunc({roundTrip:dojo.hasClass("expSearchResultArrow","pp_btn_round"),searchKey:this.searchKey,date:this.searchedDate,period:this.searchedPeriod,ICCardMode:this.ICCardMode,route:t.getRouteObj()}),this.close()}):(
this.onfinishfunc({roundTrip:dojo.hasClass("expSearchResultArrow","pp_btn_round"),searchKey:this.searchKey,date:this.searchedDate,period:this.searchedPeriod,ICCardMode:this.ICCardMode,route:t.getRouteObj()}),this.close())))},teasp.Tsf.dialog.ExpSearch.prototype.displayFareName=function(){dojo.byId("expSearchColumn2").innerHTML=this.args.commuter&&"0"!=dojo.byId("expSearchPeriod").value?teasp.message.getLabel(
"tm20005010",dojo.byId("expSearchPeriod").value):teasp.message.getLabel("expCost_head")},teasp.Tsf.dialog.ExpSearch.prototype.createBody=function(){var e,t,s,a,o,i,p=[[],[]],r=[],n=[null,null],l=[this.resobj.stationFromList,this.resobj.stationToList],c=[this.resobj.stationVia1List,this.resobj.stationVia2List,this.resobj.stationVia3List],m=(this.expRoutes&&(this.expRoutes.destroy(),this.expRoutes=null),
this.expRoutes=new teasp.helper.EkitanRoutes(this.resobj.routes),i=dojo.hasClass("expSearchResultArrow","pp_btn_round"),e=dojo.byId("expSearchResultTableBody"),teasp.Tsf.Dom.empty(e),this.displayFareName(),this.args.commuter&&"0"!=dojo.byId("expSearchPeriod").value);if(0<this.resobj.routes.length){for(o=0;o<2;o++)if(l[o])for(a=0;a<l[o].length;a++)i=l[o][a],0<this.expRoutes.getRouteCount()&&0==a&&(
this.comboSt[o].setValue(i.name),n[o]=i),p[o].push({name:i.name,code:i.code});for(this.searchKey.stationFrom=n[0],this.searchKey.stationTo=n[1],this.searchKey.stationVia=[],this.searchKey.transfer=this.resobj.transfer||!1,o=0;o<3;o++)if(c[o])for(a=0;a<c[o].length;a++)i=c[o][a],0==a&&(r.push(i.name),this.searchKey.stationVia.push(i)),p[0].push({name:i.name,code:i.code}),p[1].push({name:i.name,code:i.code});
var d=teasp.Tsf.util.clone(p[0]),h=teasp.Tsf.util.clone(p[1]);p[0]=p[0].concat(p[1]),p[1]=h.concat(d),this.setStoreFrom(p[0]),this.setStoreTo(p[1]),dojo.byId("expSearchResultRoute").value=0<r.length?r.join(","):"",dojo.byId("expSearchTransfer").checked=this.searchKey.transfer||!1}for(s=this.rowMin<this.expRoutes.getRouteCount()?this.expRoutes.getRouteCount():this.rowMin,t=0;t<s;t++)this.createRow(e,t,
this.expRoutes.getRoute(t),m);h=dojo.create("tr",null,e),dojo.create("div",{className:"clear26x1",width:"26px",height:"1px"},dojo.create("td",null,h)),dojo.create("div",{className:"clear110x1",width:"110px",height:"1px"},dojo.create("td",null,h)),dojo.create("td",null,h)},teasp.Tsf.dialog.ExpSearch.prototype.createRow=function(e,t,s,a){var o,e=dojo.create("tr",{className:"row "+(t%2==0?"even":"odd")},e),
i=dojo.create("td",{className:"cell chk"},e);null!=s&&(o=dojo.create("input",{type:"radio",id:"expResultSel"+t,name:"expResultSel",style:{width:"26px"}},i),this.args.commuterCode?o.checked=s.getCommuterCode()==this.args.commuterCode:o.checked=0==t),i=dojo.create("td",{className:"cell cost",style:{fontSize:"95%"}},e),null!=s&&(i.onclick=this.clickSearchResultRow(t),dojo.create("div",{id:"expResultCost"+t,
style:"width:110px"},i)),i=dojo.create("td",{className:"cell route"},e),null!=s&&(i.onclick=this.clickSearchResultRow(t),i.appendChild(s.createTable({tableId:"expResultTbl"+t,changedFare:dojo.hitch(this,function(){this.changedFare(t,a)})})))},teasp.Tsf.dialog.ExpSearch.prototype.changedFare=function(e,t){var s=dojo.hasClass("expSearchResultArrow","pp_btn_oneway"),a=this.expRoutes.getRoute(e);dojo.byId(
"expResultCost"+e).innerHTML=t?a.getCommuterFare("#,##0円"):a.getFareEx(!s)},teasp.Tsf.dialog.ExpSearch.prototype.search=function(){var e,t,s,a=this.comboSt[0].getValue().trim(),o=this.comboSt[1].getValue().trim(),i=dojo.byId("expSearchResultRoute").value.trim(),p=this.args.date;if(""==a)this.showError(teasp.message.getLabel("tm20005030"));else if(""==o)this.showError(teasp.message.getLabel("tm20005040"));else if(a==o
)this.showError(teasp.message.getLabel("tm20005050"));else if(this.showError(null),this.searchKey={stationFrom:{name:a,code:null},stationTo:{name:o,code:null},stationVia:[],transfer:!1},0<(s=""!=i?i.split(/[,、， 　]+/):[]).length&&(dojo.byId("expSearchResultRoute").value=s.join(","),3<s.length))this.showError(teasp.message.getLabel("tm20005060"));else{for(e=0;e<s.length;e++)t=s[e],this.searchKey.stationVia.push({
name:t,code:null});this.searchKey.transfer=this.searchKey.stationVia.length&&dojo.byId("expSearchTransfer").checked||!1,this.setStationCode(this.searchKey);var r=this.args.commuter?parseInt(dojo.byId("expSearchPeriod").value,10):0;this.searchRoute(r,this.searchKey,p,this.args.config,dojo.hitch(this,function(e,t){e?(this.searchedDate=p,this.searchedPeriod=r,this.ICCardMode=t.ICCardMode||null,this.resobj=t):(
this.resobj.routes=[],this.showError(teasp.Tsf.Error.getMessage(t))),this.createBody()}))}},teasp.Tsf.dialog.ExpSearch.prototype.setStationCode=function(t){var e=this.getStoreFrom().query({name:t.stationFrom.name});dojo.forEach(e,function(e){e.code&&e.name==t.stationFrom.name&&(t.stationFrom.code=e.code)},this),e=this.getStoreTo().query({name:t.stationTo.name}),dojo.forEach(e,function(e){
e.code&&e.name==t.stationTo.name&&(t.stationTo.code=e.code)},this);for(var s=0;s<t.stationVia.length;s++)e=this.getStoreFrom().query({name:t.stationVia[s].name}),dojo.forEach(e,function(e){e.code&&e.name==t.stationVia[s].name&&(t.stationVia[s].code=e.code)},this);for(var a=!t.stationFrom.code||!t.stationTo.code,s=0;!a&&s<t.stationVia.length;s++)a=!t.stationVia[s].code;if(a){t.stationFrom.code=null,
t.stationTo.code=null;for(s=0;s<t.stationVia.length;s++)t.stationVia[s].code=null}},teasp.Tsf.dialog.ExpSearch.prototype.checkRoundTrip=function(){for(var e=dojo.hasClass("expSearchResultArrow","pp_btn_oneway"),t=(dojo.byId("expSearchResultArrow").className="pp_base "+(e?"pp_btn_round":"pp_btn_oneway"),this.args.commuter&&"0"!=dojo.byId("expSearchPeriod").value),s=0;s<this.expRoutes.getRouteCount();s++
)this.changedFare(s,t)},teasp.Tsf.dialog.ExpSearch.prototype.changeTicketPeriod=function(){var e=this.comboSt[0].getValue().trim(),t=this.comboSt[1].getValue().trim();this.showError(null),""!=e&&""!=t&&e!=t&&this.search()},teasp.Tsf.dialog.ExpSearch.prototype.clickSearchResultRow=function(e){var t=e;return function(){var e=dojo.byId("expSearchResultTableBody").rows[t].cells[0].firstChild;e&&(e.checked=!0)}},
teasp.Tsf.dialog.ExpSearch.prototype.getSelectRowIndex=function(){for(var e=dojo.byId("expSearchResultTableBody"),t=0;t<e.rows.length;t++){var s=e.rows[t].cells[0].firstChild;if(s&&s.tagName&&"input"==s.tagName.toLowerCase()&&"radio"==s.type&&s.checked)return t}return-1},teasp.Tsf.dialog.ExpSearch.prototype.showError=function(e){e?(dojo.style("expSearchResultErrorRow","display",""),dojo.byId("expSearchResultError"
).innerHTML=e.entitize()):dojo.style("expSearchResultErrorRow","display","none")},teasp.Tsf.OutputZengin=function(e){this._dialog=null,this._expPayHistoryRows=e.expPayHistories.map(function(e,t){return new teasp.Tsf.OutputZengin.ExpPayHistoryTableRow({expPayHistory:e,isEven:t%2==0})})||[],this._searchParams=new teasp.Tsf.OutputZengin.SearchParamsWrap(e.searchParams),this._selectedExpPayHistory=null,
this._selectedSourceAccount=null},teasp.Tsf.OutputZengin.prototype={show:function(){teasp.Tsf.Error.showError(),this._dialog||(this._dialog=new dijit.Dialog({title:teasp.message.getLabel("tk10000779")||"",className:"ts-dialog-exp-item"}),this._dialog.attr("content",this._getContent()),this._dialog.startup(),this._setEventHandler()),this._showData(),this._validate(),this._dialog.show()},output:function(){
var e=this._searchParams.getTargetObjectName();const t=this._selectedExpPayHistory.getExpIds();var s=this._selectedExpPayHistory.getPayDate("YYYY-MM-DD"),a=this._selectedSourceAccount;dojo.byId("payFormTarget").value=e,dojo.byId("payFormExpApplyId").value=t.join(","),dojo.byId("payFormPayDate").value=s||"",dojo.byId("payFormSourceAccountId").value=a||"",dojo.attr("expPayForm","target","_top"),dojo.attr("expPayForm",
"action",teasp.getPageUrl("ebDataView")),dojo.byId("expPayForm").submit()},hide:function(){this._dialog&&(this._dialog.hide(),this._dialog.destroy(),tsfManager.removeDialog("OutputZengin"))},_setEventHandler:function(){const t=this;dojo.connect(this._dialog,"onCancel",function(){t.hide()});var e=dojo.query("button.ts-dialog-ok")[0],e=(dojo.connect(e,"onclick",function(){t.output()}),dojo.query(
"button.ts-dialog-cancel")[0]);dojo.connect(e,"onclick",function(){t.hide()}),t._expPayHistoryRows.forEach(function(e){e.setOnSelected(function(e){t._selectedExpPayHistory=e,t._validate()})}),document.getElementById("zg-accounts").onchange=function(e){t._selectedSourceAccount=e.target.value,t._validate()}},_showData:function(){const e=document.getElementById("search-conditions"),t=(e.innerHTML=teasp.message.getLabel(
"tk10007430",this._searchParams.getFormattedBaseDate(),this._searchParams.getPayeeTypeName()),document.getElementById("exp-histories")),s=(this._expPayHistoryRows.forEach(function(e){t.appendChild(e.getDom())}),0<this._expPayHistoryRows.length&&this._expPayHistoryRows[0].select(),document.getElementById("zg-accounts")),a=tsfManager.getZgAccounts();a.forEach(function(e){const t=document.createElement("option");
t.value=e.account.Id,t.text=e.account.Name,s.appendChild(t)})},_getContent:function(){const e={thPayDate:teasp.message.getLabel("payDate_label"),thSetPaidTime:teasp.message.getLabel("tf10011080"),setPaidActorName:teasp.message.getLabel("tf10011070"),totalNumber:teasp.message.getLabel("tk10007440"),totalAmount:teasp.message.getLabel("tf10001110")},t=teasp.message.getLabel("tk10000786"),s={
output:teasp.message.getLabel("output_btn_title"),cancel:teasp.message.getLabel("cancel_btn_title")},a=document.createElement("div");return a.className="ts-dialog ts-message",
a.innerHTML='<div id="output-zengin-dialog-content" class="ts-section-form">\x3c!-- 精算実行履歴の表示条件 --\x3e<label id="search-conditions"></label>\x3c!-- 精算実行履歴の一覧 --\x3e<table class="scrollable-table"><thead><tr><th style="width: 24px;"></th><th style="width: 180px; cursor: pointer;"><div>'+e.thPayDate+'</div></th><th style="width: 180px; cursor: pointer;"><div>'+e.thSetPaidTime+'</div></th><th style="width: 180px; cursor: pointer;"><div>'+e.setPaidActorName+'</div></th><th style="width: 70px; cursor: pointer;"><div>'+e.totalNumber+'</div></th><th style="width: 180px; cursor: pointer;"><div>'+e.totalAmount+'</div></th></tr></thead><tbody id="exp-histories" style="height: 200px;">\x3c!-- データ表示部 --\x3e</tbody></table>\x3c!-- 振込元 --\x3e<div class="ts-form-row"><div class="ts-form-label"><div>'+t+'</div><div class="ts-require"></div></div><div class="ts-form-value ts-form-select" style="width: 300px;"><select class="ts-form-select" id="zg-accounts"><option value=""></option></select></div></div></div><div class="ts-dialog-buttons"><div><button id="output-button" class="ts-dialog-ok"><div>'+s.output+'</div></button><button class="ts-dialog-cancel"><div>'+s.cancel+"</div></button></div></div>"
,a},_validate:function(){var e=!this._selectedExpPayHistory||!this._selectedSourceAccount;const t=document.getElementById("output-button");e?(t.setAttribute("disabled",!0),t.classList.add("ts-dialog-ok-disabled"),t.classList.remove("ts-dialog-ok")):(t.removeAttribute("disabled"),t.classList.add("ts-dialog-ok"),t.classList.remove("ts-dialog-ok-disabled"))}},teasp.Tsf.OutputZengin.SearchParamsWrap=function(e){
this.baseDate=e.baseDate,this.payeeType=e.payeeType},teasp.Tsf.OutputZengin.SearchParamsWrap.prototype={getPayeeTypeName:function(){switch(this.payeeType){case"1":return teasp.message.getLabel("tf10001360");case"2":return teasp.message.getLabel("tf10001370");case"3":return teasp.message.getLabel("tf10001380");case"4":return teasp.message.getLabel("tf10001450")}},getFormattedBaseDate:function(){return moment(
this.baseDate).format("YYYY/MM/DD")},getTargetObjectName:function(){switch(this.payeeType){case"1":return"ExpApply";case"2":case"3":return"EmpExp";case"4":return"ExpPreApply"}}},teasp.Tsf.OutputZengin.ExpPayHistoryTableRow=function(e){this._obj=e.expPayHistory,this._isEven=e.isEven,this._onSelected=null,this._dom=this._createContent()},teasp.Tsf.OutputZengin.ExpPayHistoryTableRow.prototype={getSetPaidTime:function(e
){e=e||"YYYY/MM/DD HH:mm:ss";return moment(this._obj.setPaidTime).format(e)},getPayDate:function(e){e=e||"YYYY/MM/DD";return moment(this._obj.payDate).format(e)},getExpIds:function(){return this._obj.expIds},getDom:function(){return this._dom},setOnSelected:function(e){this._onSelected=e},select:function(){this._dom.getElementsByClassName("radio-exp-pay-hist")[0].checked=!0,this._onSelected(this)},
_createContent:function(){const e=this,t=document.createElement("tr");return t.className=this._isEven?"ts-row-even":"ts-row-odd",t.style="cursor: pointer",
t.innerHTML='<td class="ts-form-checkbox" style="width: 24px"><div class="ts-form-value ts-form-checkbox"><input type="radio" name="radioExpPayHistory" class="radio-exp-pay-hist ts-check" /></div></td>\x3c!-- 精算日 --\x3e<td class="ts-form-text" style="width: 180px"><div class="pay-date ts-form-value ts-form-date" style="width: 100%"></div></td>\x3c!-- 精算実行日時 --\x3e<td class="ts-form-text" style="width: 180px"><div class="set-paid-time ts-form-value ts-form-time" style="width: 100%"></div></td>\x3c!-- 精算実行者 --\x3e<td class="ts-form-text" style="width: 180px"><div class="set-paid-actor ts-form-value ts-form-text" style="width: 100%"></div></td>\x3c!-- 合計件数 --\x3e<td class="ts-form-text" style="width: 70px"><div class="total-number ts-form-value ts-form-number" style="width: 100%"></div></td>\x3c!-- 合計金額 --\x3e<td class="ts-form-text" style="width: 180px"><div class="total-amount ts-form-value ts-form-currency" style="width: 100%"></div></td><td class="last" style="width: 16px; display: none"></td>'
,t.getElementsByClassName("radio-exp-pay-hist")[0].value=e._obj.setPaidTime,t.getElementsByClassName("set-paid-time")[0].innerHTML=e.getSetPaidTime(),t.getElementsByClassName("set-paid-actor")[0].innerHTML=e._obj.setPaidActorName,t.getElementsByClassName("pay-date")[0].innerHTML=e.getPayDate(),t.getElementsByClassName("total-number")[0].innerHTML=e._obj.totalNumber,t.getElementsByClassName("total-amount"
)[0].innerHTML=teasp.Tsf.Currency.formatMoney(e._obj.totalAmount,teasp.Tsf.Currency.V_YEN,!1,!0),t.onclick=function(){e.select()},t}},teasp.Tsf.SearchCondition=function(e,t){this.fp=teasp.Tsf.Fp.createFp(e),this.mask=t},teasp.Tsf.SearchCondition.prototype.show=function(e,t){teasp.Tsf.Error.showError(),this.dialog||(this.domHelper=new teasp.Tsf.Dom,this.dialog=new dijit.Dialog({title:this.fp.getTitle(),
className:this.fp.getFormCss()}),this.dialog.attr("content",this.getContent()),this.dialog.startup(),this.domHelper.connect(this.dialog,"onCancel",this,function(){this.hide()}),9==dojo.isIE&&this.domHelper.connect(this.dialog,"onKeyDown",this,function(e){return 13===e.keyCode&&dojo.stopEvent(e),!1})),this.callback=t,this.showData(e)},teasp.Tsf.SearchCondition.prototype.showData=function(e){this.orgData=e||{};
var t=this.orgData.values||{};this.fp.fcLoop(function(e){e.getApiKey()&&e.drawText(this.getDomHelper(),t)},this),this.dialog.show()},teasp.Tsf.SearchCondition.prototype.getDomHelper=function(){return this.domHelper},teasp.Tsf.SearchCondition.prototype.getFormEl=function(){return teasp.Tsf.Dom.node(".ts-section-form",teasp.Tsf.Dom.byId(this.dialog.id))},teasp.Tsf.SearchCondition.prototype.hide=function(){
this.dialog&&(this.dialog.hide(),this.domHelper.free(),this.dialog.destroy())},teasp.Tsf.SearchCondition.prototype.getContent=function(){var e=this.getDomHelper().create("div",{className:"ts-dialog ts-search-expPreApply",style:"min-width:448px;"}),s=this.getDomHelper().create("div",{className:"ts-section-form"},e),a=null,o=null;return this.fp.fcLoop(function(e){var t;e.isHidden()?this.getDomHelper().create("input",{
type:"hidden",id:e.getDomId()},s):(a&&a.isNoNL()||(o=this.getDomHelper().create("div",{className:"ts-form-row"},s)),t=this.getDomHelper().create("div",{className:"ts-form-label"},o),e.getLw()&&teasp.Tsf.Dom.style(t,"width",e.getLw()),this.getDomHelper().create("div",{innerHTML:e.getLabel()},t),e.appendFieldDiv(this.getDomHelper(),o),a=e)},this),this.setEventHandler(s),this.createButtons(e),e},
teasp.Tsf.SearchCondition.prototype.createButtons=function(e){var e=this.getDomHelper().create("div",{className:"ts-dialog-buttons"},e),e=this.getDomHelper().create("div",null,e),t=teasp.Tsf.Dialog.createButton(this.getDomHelper(),teasp.message.getLabel("ok_btn_title"),"ts-dialog-ok",e),e=teasp.Tsf.Dialog.createButton(this.getDomHelper(),teasp.message.getLabel("cancel_btn_title"),"ts-dialog-cancel",e);
this.getDomHelper().connect(t,"onclick",this,this.ok),this.getDomHelper().connect(e,"onclick",this,this.hide)},teasp.Tsf.SearchCondition.prototype.setEventHandler=function(e){teasp.Tsf.Dom.query(".ts-form-cal",e).forEach(function(t){teasp.Tsf.Dom.query('input[type="text"]',t.parentNode.parentNode).forEach(function(e){e.name==t.name&&tsfManager.eventOpenCalendar(this.getDomHelper(),t,e,{tagName:e.name,
isDisabledDate:function(e){return!1}})},this)},this),teasp.Tsf.Dom.query(".ts-form-currency input",e).forEach(function(e){teasp.Tsf.Currency.eventInput(this.getDomHelper(),e,teasp.Tsf.Dom.hitch(this,this.changedCurrency))},this)},teasp.Tsf.SearchCondition.prototype.changedCurrency=function(e){},teasp.Tsf.SearchCondition.prototype.ok=function(e){var i,p,r;this.callback&&(i={composite:{}},r=[],(p=[]).push({}),
this.fp.fcLoop(function(e){var t,s,a,o;e.getApiKey()&&(t=e.fetchValues(),e.fillValue(i,t),"_childStatus"==e.getApiKey()?(a={filtVal:null,nega:!1,orgVal:null},(s=t[0].value)&&(a.orgVal=s,(o=/^(.+)以外$/.exec(s))&&(s=o[1],a.nega=!0),a.filtVal="StatusD__c = '"+s+"'"),r.push(a)):(t[0].value||1<t.length&&t[1].value)&&e.setFilts(p,t),e.isComposite()&&(i.composite[e.getApiKey()]=t))},this),this.callback({
hkey:this.orgData.hkey,filts:p,childFilts:r,values:i})),this.hide()},teasp.Tsf.ExpDetail=function(){this.fp=teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.dialogDetail),this.EXPITEM_TOOLTIP_HKEY="expItem_toolTip",this.EXPITEM_TOOLTIP_HKEY_EX="expItem_toolTip_ex",this.EXPITEM_INTERNALPARTICIPANT_TOOLTIP_HKEY="expItem_internalParticipanttoolTip",this.EXPITEM_RECEIPT_TOOLTIP_HKEY="expItem_receipt_toolTip",this.jobPool={}},
teasp.Tsf.ExpDetail.prototype.show=function(e,t){this.orgData=teasp.Tsf.Dom.clone(e),teasp.Tsf.Error.showError(),this.fp.setReadOnly(e.ro),this.receiptIn=this.orgData.values.CardStatementLineId__r&&this.orgData.values.CardStatementLineId__r.RecordType&&"領収書"==this.orgData.values.CardStatementLineId__r.RecordType.Name,this.cardConst=this.orgData.values.CardStatementLineId__c&&!this.receiptIn,
this.fromHist=this.orgData.fromHist,this.fp.fcLoop(function(e){("ChargeDeptId__c"==e.getApiKey()&&!tsfManager.isRequireChargeDept()||this.orgData.pre&&"Publisher__c"==e.getApiKey())&&e.setNotUse(!0)},this),this.domHelper=new teasp.Tsf.Dom,this.dialog=new dijit.Dialog({title:teasp.message.getLabel("tf10001340"),className:"ts-dialog-exp-detail"}),this.dialog.attr("content",this.getContent()),this.dialog.startup(),
this.domHelper.connect(this.dialog,"onCancel",this,function(){this.hide()}),this.entryDetail=t,this.showData(e)},teasp.Tsf.ExpDetail.prototype.showData=function(e){var o=this.getFormEl(),i=this.orgData.values,t=(this.expItemFilter={empExpItemClass:this.orgData.expItemClass,
deptExpItemClass:i.ChargeDeptId__r&&i.ChargeDeptId__r.ExpItemClass__c||this.orgData.assist&&this.orgData.assist.ChargeDeptId__r&&this.orgData.assist.ChargeDeptId__r.ExpItemClass__c||null,expenseType:this.orgData.assist&&this.orgData.assist.ExpenseType__c||null},this.fp.getElementByApiKey("ExpItemId__c",null,o)),t=(t&&this.loadExpItems(t),i.Date__c),s=i.Id,a=(!s&&this.orgData.nextOrder&&(
i.Order__c=this.orgData.nextOrder),i.Cost__c),a=(i._date=t,i._cost=a,this.memoryDate=t,this.memoryCost=a,tsfManager.getInfo().setCacheDept(i),tsfManager.getInfo().setCacheJob(i),t||(
this.orgData.targetDate?i.Date__c=this.orgData.targetDate:this.orgData.assist&&this.orgData.assist.ApplyDate__c?i.Date__c=this.orgData.assist.ApplyDate__c:this.orgData.defaultDate?i.Date__c=this.orgData.defaultDate:i.Date__c=teasp.util.date.formatDate(teasp.util.date.getToday())),this.loadJobs(i.Date__c),this.checkImportJobs(i),this.loadChargeDepts(),this.fp.fcLoop(function(e){var t,s,a;"_route"==e.getApiKey()?(
a=i.startName__c||"",t=i.endName__c||"",s=i.roundTrip__c||!1,this.isReadOnly()||e.isReadOnly()?teasp.Tsf.Dom.node("div.ts-form-route > div",o).innerHTML=teasp.Tsf.util.entitizf(teasp.message.getLabel(s?"tm20009040":"tm20009060",a,t)):(dijit.byId("DlgExpDetailStFrom").setValue(a),dijit.byId("DlgExpDetailStTo").setValue(t),"JTB"==i.Item__c&&(dijit.byId("DlgExpDetailStFrom").setDisabled(!0),dijit.byId("DlgExpDetailStTo"
).setDisabled(!0)),this.setRoundTripIcon(s))):"_tax"==e.getApiKey()?this.isReadOnly()||e.isReadOnly()?this.setStaticTax(i):(this.setTaxAuto("boolean"!=typeof i.TaxAuto__c||i.TaxAuto__c),a=this.getCurrentExpItem(),this.setTaxRate(a,"number"==typeof i.TaxRate__c?i.TaxRate__c:null),this.setTaxValue(i.Tax__c||0),this.setWithoutTaxValue(i.WithoutTax__c||0),this.setTaxType(i.TaxType__c||0)):"_foreign"==e.getApiKey(
)?this.isReadOnly()||e.isReadOnly()?this.setStaticForeign(i):(this.setForeignNameValue(i.CurrencyName__c||""),this.setForeignRateValue(i.CurrencyRate__c||""),this.setForeignAmountValue(i.ForeignAmount__c||"")):!e.isApiField(!0)&&"_date"!=e.getApiKey()&&"_cost"!=e.getApiKey()&&"_temp_attach"!=e.getApiKey()||e.drawText(this.getDomHelper(),i)},this),this.changedExpItem(),i.Item__c||null),p=(teasp.Tsf.EmpExp.isSpice(a
)?teasp.Tsf.Dom.show(".ts-spice",o,!0):(t=i.TransportType__c||"0",teasp.Tsf.Dom.show(".pp_ico_ekitan",o,"1"==t)),teasp.Tsf.Dom.show(".ts-external",o,teasp.Tsf.EmpExp.isExternalExpense(a)),this.isReadOnly()||(t=this.getCurrentExpItem())&&t.isTaxFlag()&&(this.setTaxType(this.getTaxType(!0)),this.setTaxArea(this.getTaxType())),this.expItemFilter.expenseType),r=tsfManager.getPayeeTypeNums(p),t=this.fp.getFcByApiKey(
"_payment"),n=i.PayeeId__r&&i.PayeeId__r.PayeeType__c||null,l=((n||i.Id)&&(r[n||"1"]=1),null),t=(this.isReadOnly()||t.isReadOnly()?(t=teasp.Tsf.Dom.node("div.ts-row-payment div.ts-payment-div",o),payMap={1:teasp.message.getLabel("tf10001350"),2:teasp.message.getLabel("tf10001370"),3:teasp.message.getLabel("tf10001380")},t.innerHTML=payMap[n]||teasp.message.getLabel("tf10001350")):l=teasp.Tsf.Dom.node(
"select.ts-payment-select",o),!1);if(l){for(var c=[],m=0;m<l.options.length;m++)!p&&"1"==l.options[m].value||r[l.options[m].value]||c.push(m);for(m=c.length-1;0<=m;m--)l.remove(c[m]);1==l.options.length&&"1"==(n=n||l.options[0].value)&&(t=!0),n=n||(0<l.options.length?l.options[0].value:"1"),0<l.options.length&&(l.value=n)}else p||r[2]||r[3]||(t=!0);t?teasp.Tsf.Dom.show(
".ts-row-payment, .ts-row-payee, .ts-row-invoiceURL",o,!1):"1"!=(n||"1")?(teasp.Tsf.Dom.show(".ts-row-payee",o,!0),teasp.Tsf.Dom.show(".ts-row-invoiceURL",o,!0)):(teasp.Tsf.Dom.show(".ts-row-payee-name",o,!!i.PayeeId__r),teasp.Tsf.Dom.show(".ts-row-payee-date",o,!!i.PaymentDate__c),teasp.Tsf.Dom.show(".ts-row-invoiceURL",o,!!i.invoiceURL__c));t=teasp.Tsf.Dom.node(".ts-payment-icon",o),t&&(teasp.Tsf.Dom.toggleClass(t,
"pp_ico_card2",!!this.cardConst),teasp.Tsf.Dom.toggleClass(t,"pp_ico_card1",!this.cardConst&&"3"==n),teasp.Tsf.Dom.toggleClass(t,"pp_ico_bill",!this.cardConst&&"2"==n)),t=teasp.Tsf.Dom.node("div.ts-dialog-tips",teasp.Tsf.Dom.byId(this.dialog.id)),s?(teasp.Tsf.Dom.show(t,null,!0),teasp.Tsf.Dom.node("a",t).href="/"+s):teasp.Tsf.Dom.show(t,null,!1),n=teasp.Tsf.Dom.node('input[type="button"].ts-receipt',o);if(n){
var t=0<(i.Attachments||[]).length||!s&&i._temp_attach,d=0<(i.ContentDocumentLinks||[]).length,t=t||d,d=i.Receipt__c&&teasp.Tsf.EmpExp.isUber(a)||!1;if(teasp.Tsf.Dom.toggleClass(n,"pp_ico_receipt",!t&&!d),teasp.Tsf.Dom.toggleClass(n,"pp_ico_receipt_a",t&&!this.receiptIn&&!d),teasp.Tsf.Dom.toggleClass(n,"pp_ico_receipt_r",t&&this.receiptIn&&!d||!1),teasp.Tsf.Dom.toggleClass(n,"pp_ico_receipt_u",d),this.orgData.pre
)teasp.Tsf.Dom.style(n,"cursor","default"),n.title=teasp.message.getLabel("tf10004690");else if(s)n.title=teasp.message.getLabel(t?"attachedReceipt":"nonReceipt"),this.getDomHelper().connect(n,"onclick",this,function(e){tsfManager.openExpImageView(s,this.isReadOnly())},this.EXPITEM_RECEIPT_TOOLTIP_HKEY);else if(i._temp_attach){n.title=teasp.message.getLabel("attachedReceipt");try{var h=teasp.Tsf.util.fromJson(
i._temp_attach);this.getDomHelper().connect(n,"onclick",this,function(e){tsfManager.openReceiptImageView(h.Id,h.ParentId)},this.EXPITEM_RECEIPT_TOOLTIP_HKEY)}catch(e){}}else this.getDomHelper().createTooltip({connectId:n,label:teasp.message.getLabel("tf10001660"),position:["below"],showDelay:200},this.EXPITEM_RECEIPT_TOOLTIP_HKEY)}this.checkExpMatching(i),this.dialog.show(),this.orgData.defaultDate&&setTimeout(
teasp.Tsf.Dom.hitch(this,function(){var e=this.fp.getElementByApiKey("ExpItemId__c",this.getFormEl());e&&e.focus()}),200)},teasp.Tsf.ExpDetail.prototype.getDomHelper=function(){return this.domHelper},teasp.Tsf.ExpDetail.prototype.getFormEl=function(){return teasp.Tsf.Dom.node(".ts-section-form",teasp.Tsf.Dom.byId(this.dialog.id))},teasp.Tsf.ExpDetail.prototype.fetchValueByApiKey=function(e){
return this.fp.getFcByApiKey(e).fetchValue().value},teasp.Tsf.ExpDetail.prototype.setValueByApiKey=function(e,t){this.fp.getFcByApiKey(e).textOut(this.getDomHelper(),null,t)},teasp.Tsf.ExpDetail.prototype.isReadOnly=function(){return this.fp.isReadOnly()},teasp.Tsf.ExpDetail.prototype.isNew=function(){return!this.orgData.values.Id},teasp.Tsf.ExpDetail.prototype.hide=function(){this.dialog&&(this.dialog.hide(),
this.domHelper.free(),this.dialog.destroy(),tsfManager.removeDialog("ExpDetail"))},teasp.Tsf.ExpDetail.prototype.getContent=function(){var e,t=this.getDomHelper().create("div",{className:"ts-dialog ts-exp-detail",style:"width:750px;"}),s=(this.getDomHelper().create("div",null,this.getDomHelper().create("div",{className:"ts-error-area",style:"width:750px;display:none;"},t)),this.getDomHelper().create("div",{
className:"ts-section-form"},t)),a=null,o=null;return this.fp.getFcByApiKey("ChargeDeptId__c").setRequired(2==tsfManager.isRequireChargeDept()?1:0),this.orgData.targetDate&&this.fp.getFcByApiKey("Date__c").setReadOnly(!0),this.cardConst&&dojo.forEach(["Date__c","Cost__c","_foreign","Publisher__c","_payment","PayeeId__r.Name","PaymentDate__c"],function(e){this.fp.getFcByApiKey(e).setReadOnly(!0)},this),
"JTB"==this.orgData.values.Item__c&&dojo.forEach(["Date__c","Cost__c","_foreign","_payment","PayeeId__r.Name","PaymentDate__c"],function(e){this.fp.getFcByApiKey(e).setReadOnly(!0)},this),this.fp.fcLoop(function(e){var t;e.isHidden()?this.getDomHelper().create("input",{type:"hidden",id:e.getDomId()},s):"route"==e.getDomType()?o=this.createRouteRow(e,s):"tax"==e.getDomType()?o=this.createTaxRow(e,s
):"foreign"==e.getDomType()?o=this.createForeignRow(e,s):"payment"==e.getDomType()?o=this.createPaymentRow(e,s):(a&&a.isNoNL()||(t="ts-form-row","ExtraItem1__c"==e.getApiKey()?t+=" ts-row-extra1":"ExtraItem2__c"==e.getApiKey()?t+=" ts-row-extra2":"UnitPrice__c"==e.getApiKey()||"Quantity__c"==e.getApiKey()?t+=" ts-row-quantity":"PaymentDate__c"==e.getApiKey()||"PayeeId__r.Name"==e.getApiKey()?(t+=" ts-row-payee",
"PaymentDate__c"==e.getApiKey()?t+=" ts-row-payee-date":"PayeeId__r.Name"==e.getApiKey()&&(t+=" ts-row-payee-name")):"InvoiceURL__c"==e.getApiKey()?t+=" ts-row-invoiceURL":"JobId__c"==e.getApiKey()?t+=" ts-row-job":"ChargeDeptId__c"==e.getApiKey()?t+=" ts-row-dept":"InternalParticipantsNumber__c"==e.getApiKey()||"InternalParticipants__c"==e.getApiKey()?(t+=" ts-row-intpart",
"InternalParticipantsNumber__c"==e.getApiKey()?t+=" ts-row-intpart-number":"InternalParticipants__c"==e.getApiKey()&&(t+=" ts-row-intpart-name",e.fc.height="90px")):"ExternalParticipantsNumber__c"==e.getApiKey()||"ExternalParticipants__c"==e.getApiKey()?(t+=" ts-row-extpart","ExternalParticipantsNumber__c"==e.getApiKey()?t+=" ts-row-extpart-number":"ExternalParticipants__c"==e.getApiKey()&&(t+=" ts-row-extpart-name",
e.fc.height="90px")):"PlaceName__c"==e.getApiKey()||"PlaceAddress__c"==e.getApiKey()?(t+=" ts-row-place","PlaceName__c"==e.getApiKey()?t+=" ts-row-place-name":"PlaceAddress__c"==e.getApiKey()&&(t+=" ts-row-place-address")):"Publisher__c"==e.getApiKey()&&(t+=" ts-row-publisher"),o=this.getDomHelper().create("div",{className:t},s)),t=this.getDomHelper().create("div",{className:"ts-form-label"},o),e.getLw(
)&&teasp.Tsf.Dom.style(t,"width",e.getLw()),this.getDomHelper().create("div",{innerHTML:e.getLabel()},t),(e.isRequired()||/ExtraItem.__c/.test(e.getApiKey()))&&this.getDomHelper().create("div",{className:"ts-require"},t),e.appendFieldDiv(this.getDomHelper(),o),"Cost__c"==e.getApiKey()&&(this.getDomHelper().create("div",{className:"ts-form-value ts-PerParticipant",style:"padding-left: 20px;"},o),this.getDomHelper(
).create("input",{type:"button",className:"ts-external"},o),this.getDomHelper().create("input",{type:"button",className:"ts-receipt pp_ico_receipt"},o)),a=e)},this),teasp.Tsf.Dom.show(".ts-row-payee",s,!1),teasp.Tsf.Dom.show(".ts-row-invoiceURL",s,!1),this.setEventHandler(s),this.createButtons(t),tsfManager.getDebug()&&(e=this.getDomHelper().create("div",{className:"ts-dialog-tips"},s),this.getDomHelper().create("a",
{href:"",innerHTML:teasp.message.getLabel("tf10001560"),target:"_blank"},e)),t},teasp.Tsf.ExpDetail.prototype.createRouteRow=function(e,t){var t=this.getDomHelper().create("div",{className:"ts-form-row ts-row-route"},t),s=this.getDomHelper().create("div",{className:"ts-form-label"},t);return this.getDomHelper().create("div",{innerHTML:e.getLabel()},s),e.isRequired()&&this.getDomHelper().create("div",{
className:"ts-require"},s),e.isReadOnly()||e.isReadOnly()?(this.getDomHelper().create("div",{className:"ts-form-text",style:"width:100%;"},this.getDomHelper().create("div",{className:"ts-form-value ts-form-route",style:{width:e.getWidth()}},t)),this.getDomHelper().create("input",{type:"button",className:"pp_base pp_btn_ektsrch"},t),this.getDomHelper().create("input",{type:"button",className:"pp_base pp_ico_ekitan"},t
),this.getDomHelper().create("div",{className:"ts-spice"},t)):(s=this.getDomHelper().create("div",{className:"ts-dialog-route"},t),e=this.getDomHelper().create("div",{className:"ts-station-area"},s),this.getDomHelper().create("input",{className:"ts-form-st-from"},this.getDomHelper().create("div",{className:"ts-station-text"},e)),this.getDomHelper().create("input",{type:"button",
className:"pp_base pp_btn_oneway ts-form-roundtrip"},e),this.getDomHelper().create("input",{className:"ts-form-st-to"},this.getDomHelper().create("div",{className:"ts-station-text"},e)),this.getDomHelper().create("input",{type:"button",className:"pp_base pp_btn_ektsrch"},e),this.getDomHelper().create("input",{type:"button",className:"pp_base pp_ico_ekitan"},e),this.getDomHelper().create("div",{className:"ts-spice"},e
)),this.getDomHelper().connect(teasp.Tsf.Dom.node("input.pp_ico_ekitan",t),"onclick",this,function(e){var t=this.orgData.values.Route__c;t?tsfManager.showDialog("ExpRoute",t):teasp.tsAlert(teasp.message.getLabel("tf10001770"))}),t},teasp.Tsf.ExpDetail.prototype.createTaxRow=function(e,t){var s,a,t=this.getDomHelper().create("div",{className:"ts-form-row ts-row-tax"},t),o=this.getDomHelper().create("div",{
className:"ts-form-label"},t),o=(this.getDomHelper().create("div",{innerHTML:e.getLabel()},o),e.isRequired()&&this.getDomHelper().create("div",{className:"ts-require"},o),this.getDomHelper().create("div",{className:"ts-form-value ts-form-"+e.getDomType()},t));return this.isReadOnly()||e.isReadOnly()?this.getDomHelper().create("div",{className:"ts-tax-div"},o):(e=this.getDomHelper().create("table",{
className:"ts-tax-table"},o),o=this.getDomHelper().create("tr",null,this.getDomHelper().create("tbody",null,e)),this.getDomHelper().create("div",{className:"ts-tax-type"},this.getDomHelper().create("td",null,o)),this.getDomHelper().create("div",{className:"ts-tax-label",innerHTML:teasp.message.getLabel("tm20004110")},this.getDomHelper().create("td",null,o)),this.getDomHelper().create("td",{
className:"ts-tax-without-tax ts-form-currency"},o),this.getDomHelper().create("div",{className:"ts-tax-label",innerHTML:teasp.message.getLabel("tf10001390")},this.getDomHelper().create("td",null,o)),this.getDomHelper().create("td",{className:"ts-tax-auto"},o),this.getDomHelper().create("td",{className:"ts-tax-tax ts-form-currency"},o),this.getDomHelper().create("div",{className:"ts-tax-label",
innerHTML:teasp.message.getLabel("tm20004100")},this.getDomHelper().create("td",null,o)),this.getDomHelper().create("td",{className:"ts-tax-rate"},o),o=teasp.Tsf.Dom.node("td.ts-tax-without-tax",e),s=teasp.Tsf.Dom.node("td.ts-tax-auto",e),a=teasp.Tsf.Dom.node("td.ts-tax-tax",e),e=teasp.Tsf.Dom.node("td.ts-tax-rate",e),this.getDomHelper().create("input",{type:"text",className:"ts-tax-without-tax"},o),
this.getDomHelper().create("button",{className:"ts-tax-auto enabled"},s),this.getDomHelper().create("input",{type:"text",className:"ts-tax-tax"},a).disabled=!0,o=this.getDomHelper().create("select",{className:"ts-tax-rate"},e),this.getDomHelper().create("option",{value:"10",innerHTML:"10%"},o),this.getDomHelper().create("option",{value:"8",innerHTML:"8%"},o),this.getDomHelper().create("option",{value:"5",
innerHTML:"5%"},o),this.getDomHelper().create("option",{value:"0",innerHTML:"0%"},o),o.value=""+teasp.Tsf.ExpDetail.getTaxRate(this.getDate())),t},teasp.Tsf.ExpDetail.prototype.createForeignRow=function(e,t){var s,t=this.getDomHelper().create("div",{className:"ts-form-row ts-row-foreign"},t),a=this.getDomHelper().create("div",{className:"ts-form-label"},t),a=(this.getDomHelper().create("div",{innerHTML:e.getLabel()},
a),e.isRequired()&&this.getDomHelper().create("div",{className:"ts-require"},a),this.getDomHelper().create("div",{className:"ts-form-value ts-form-"+e.getDomType()},t));return this.isReadOnly()||e.isReadOnly()?this.getDomHelper().create("div",{className:"ts-foreign-div"},a):(e=this.getDomHelper().create("table",{className:"ts-foreign-table"},a),a=this.getDomHelper().create("tr",null,this.getDomHelper().create("tbody"
,null,e)),this.getDomHelper().create("div",{className:"ts-foreign-label",innerHTML:teasp.message.getLabel("tm20004180")},this.getDomHelper().create("td",null,a)),this.getDomHelper().create("td",{className:"ts-foreign-name"},a),this.getDomHelper().create("div",{className:"ts-foreign-label",innerHTML:teasp.message.getLabel("tm20004190")},this.getDomHelper().create("td",null,a)),this.getDomHelper().create("td",{
className:"ts-foreign-rate"},a),this.getDomHelper().create("div",{className:"ts-foreign-label",innerHTML:teasp.message.getLabel("tm20004200")},this.getDomHelper().create("td",null,a)),this.getDomHelper().create("td",{className:"ts-foreign-cost"},a),a=teasp.Tsf.Dom.node("td.ts-foreign-name",e),s=teasp.Tsf.Dom.node("td.ts-foreign-rate",e),e=teasp.Tsf.Dom.node("td.ts-foreign-cost",e),this.getDomHelper().create("select",
{className:"ts-foreign-name"},a),a=this.getDomHelper().create("input",{type:"text",className:"ts-foreign-rate"},s),s=this.getDomHelper().create("input",{type:"text",className:"ts-foreign-cost"},e),a.value="1.00",s.value="0"),t},teasp.Tsf.ExpDetail.prototype.loadCurrency=function(e,t){var t=t||e.getCurrencyName(),s=(s=t)&&s.toLowerCase(),a=this.getForeignNameNode(),o=null,i=(a&&(dojo.empty(a),dojo.forEach(
tsfManager.getForeigns(),function(e){this.getDomHelper().create("option",{value:e.getId(),innerHTML:e.getName()},a),s&&e.getName().toLowerCase()==s&&(o=e.getId())},this),s&&null===o&&(this.getDomHelper().create("option",{value:t,innerHTML:t},a),o=t),a.value=o||""),this.getForeignCostNode());return i&&(i.disabled=e.isAmountReadOnly()),{name:t,value:o||""}},teasp.Tsf.ExpDetail.prototype.initForeignCurrency=function(e,t
,s){var a,o,i,s=this.loadCurrency(e,s);s.value?(s=tsfManager.getForeignById(s.value),a=this.fetchValueByApiKey("Date__c")||teasp.util.date.formatDate(teasp.util.date.getToday()),s=s.getRateByDate(a),a=teasp.util.currency.formatDecimal(s,teasp.constant.CU_DEC_POINT_MIN,teasp.constant.CU_DEC_POINT_MAX),(i=this.getForeignRateNode())&&(t?(s=parseFloat(i.value||"0"),this.setForeignRateTitle(i,
s!=a.n?teasp.message.getLabel("tm20004050"):null)):(i.value=a.str,this.setForeignRateTitle(i))),t||(!(s=this.getCostValue(e))||e.isFixAmount()?(a=e.getCost(),o=e.getRecalcTarget(),this.recalcForeign(o,e,a,!0)):this.recalcForeign(0,e,s,!0))):t||(i=this.getForeignRateNode())&&(i.value="1.00",this.setForeignRateTitle(i),this.recalcForeign(0,e))},teasp.Tsf.ExpDetail.prototype.createPaymentRow=function(e,t){var s,
t=this.getDomHelper().create("div",{className:"ts-form-row ts-row-payment"},t),a=this.getDomHelper().create("div",{className:"ts-form-label"},t),a=(this.getDomHelper().create("div",{innerHTML:e.getLabel()},a),e.isRequired()&&this.getDomHelper().create("div",{className:"ts-require"},a),this.getDomHelper().create("div",{className:"ts-form-value ts-form-"+e.getDomType()},t));return this.isReadOnly()||e.isReadOnly(
)?this.getDomHelper().create("div",{className:"ts-payment-div"},a):(s=this.getDomHelper().create("select",{className:"ts-payment-select"},a),e=[{v:"1",n:teasp.message.getLabel("tf10001350")},{v:"2",n:teasp.message.getLabel("tf10001370")},{v:"3",n:teasp.message.getLabel("tf10001380")}],dojo.forEach(e,function(e){this.getDomHelper().create("option",{value:e.v,innerHTML:e.n},s)},this),this.getDomHelper().connect(s,
"onchange",this,this.changedPayType)),this.getDomHelper().create("div",{className:"ts-payment-icon"},t),t},teasp.Tsf.ExpDetail.prototype.createButtons=function(e){var t,e=this.getDomHelper().create("div",{className:"ts-dialog-buttons"},e),s=this.getDomHelper().create("div",{className:"ts-edge-continue"},e),a=(this.isReadOnly()||this.fromHist||this.cardConst||"JTB"==this.orgData.values.Item__c||(
a=teasp.Tsf.Dialog.createButton(this.getDomHelper(),teasp.message.getLabel("tf10006310"),null,s),this.getDomHelper().connect(a,"onclick",this,this.inputAndContinue)),s=this.getDomHelper().create("div",null,e),t=this.isReadOnly()?teasp.Tsf.Dialog.createButton(this.getDomHelper(),teasp.message.getLabel("close_btn_title"),"ts-dialog-cancel",s):(this.orgData.targetDate?(t=teasp.Tsf.Dialog.createButton(this.getDomHelper()
,teasp.message.getLabel("save_btn_title"),"ts-dialog-ok",s),this.getDomHelper().connect(t,"onclick",this,this.regist)):(t=teasp.Tsf.Dialog.createButton(this.getDomHelper(),teasp.message.getLabel("ok_btn_title"),"ts-dialog-ok",s),this.getDomHelper().connect(t,"onclick",this,this.ok)),teasp.Tsf.Dialog.createButton(this.getDomHelper(),teasp.message.getLabel("cancel_btn_title"),"ts-dialog-cancel",s)),this.getDomHelper(
).connect(t,"onclick",this,this.hide),s=this.getDomHelper().create("div",{className:"ts-edge-right"},e),teasp.Tsf.Dialog.createButton(this.getDomHelper(),teasp.message.getLabel("ekitanSetting_btn_title"),null,s));this.getDomHelper().connect(a,"onclick",this,this.ekitanSetting)},teasp.Tsf.ExpDetail.prototype.setEventHandler=function(e){var t;this.getDomHelper().connect(teasp.Tsf.Dom.query(".pp_btn_ektsrch",e),
"onclick",this,this.searchRoute),this.isReadOnly()||(teasp.Tsf.Dom.query(".ts-form-cal",e).forEach(function(e){var t=teasp.Tsf.Dom.node('input[type="text"]',e.parentNode.parentNode);t&&tsfManager.eventOpenCalendar(this.getDomHelper(),e,t,{tagName:t.name,isDisabledDate:function(e){return!1},selectedDate:dojo.hitch(this,this.selectedDate)})},this),teasp.Tsf.Dom.query(".ts-form-currency input",e).forEach(function(e){
teasp.Tsf.Currency.eventInput(this.getDomHelper(),e,teasp.Tsf.Dom.hitch(this,this.changedCurrency))},this),this.getDomHelper().connect(teasp.Tsf.Dom.node("button.ts-tax-auto",e),"onclick",this,this.clickTaxAuto),(t=this.fp.getElementByApiKey("ExpItemId__c",null,e))&&this.getDomHelper().connect(t,"onchange",this,this.changedExpItem),(t=this.fp.getElementByApiKey("JobId__c",null,e))&&this.getDomHelper().connect(t,
"onchange",this,this.changedJob),(t=this.fp.getElementByApiKey("ChargeDeptId__c",null,e))&&this.getDomHelper().connect(t,"onchange",this,this.changedChargeDept),this.setEventExpItem(e),this.setEventTax(e),this.setEventForeign(e),this.setEventQuantity(e),this.setEventRoute(e),this.setEventJob(e),this.setEventDept(e),this.setEventPayee(e),this.setEventDate(e),this.setEventExtra(e),this.setEventParticipant(e))},
teasp.Tsf.ExpDetail.prototype.setEventDate=function(e){e=this.fp.getElementByApiKey("Date__c",null,e);e&&(this.getDomHelper().connect(e,"blur",this,this.changedDate),this.getDomHelper().connect(e,"onkeypress",this,function(e){""===e.keyChar&&13===e.keyCode&&(e.preventDefault(),e.stopPropagation(),this.changedDate(e))}))},teasp.Tsf.ExpDetail.prototype.setEventExpItem=function(a){var e=this.fp.getElementByApiKey(
"ExpItemId__c",null,a);e&&(e=teasp.Tsf.Dom.getAncestorByCssName(e,"ts-form-row"))&&(e=teasp.Tsf.Dom.node("button.ts-form-find",e))&&this.getDomHelper().connect(e,"onclick",this,function(t){var s=[],e=tsfManager.getExpItems(this.expItemFilter,!0);dojo.forEach(e,function(e){this.isSelectableExpItem(e)&&s.push("'"+e.getId()+"'")},this),s.length||s.push("''"),tsfManager.showSearchListDialog({discernment:"expItems",
delay:!0,values:{Id:s.join(",")}},null,teasp.Tsf.Dom.hitch(this,function(e){e=e[0],e={ExpItemId__c:e.Id,ExpItemId__r:e};this.fp.getFcByApiKey("ExpItemId__c").drawText(this.getDomHelper(),e,null,a),this.changedExpItem(t)}))})},teasp.Tsf.ExpDetail.prototype.setEventTax=function(e){e=teasp.Tsf.Dom.node("div.ts-row-tax select.ts-tax-rate",e);e&&this.getDomHelper().connect(e,"onchange",this,this.changedTaxRate)},
teasp.Tsf.ExpDetail.prototype.setEventForeign=function(e){var e=teasp.Tsf.Dom.node("div.ts-row-foreign",e),t=teasp.Tsf.Dom.node("select.ts-foreign-name",e),t=(t&&this.getDomHelper().connect(t,"onchange",this,this.changedForeign),teasp.Tsf.Dom.query("input",e));this.getDomHelper().connect(t,"blur",this,this.changedCurrency),this.getDomHelper().connect(t,"onkeypress",this,function(e){""===e.keyChar&&13===e.keyCode&&(
e.preventDefault(),e.stopPropagation(),this.changedCurrency(e))})},teasp.Tsf.ExpDetail.prototype.setEventQuantity=function(e){e=this.fp.getElementByApiKey("Quantity__c",null,e);e&&(this.getDomHelper().connect(e,"blur",this,this.changedCurrency),this.getDomHelper().connect(e,"onkeypress",this,function(e){""===e.keyChar&&13===e.keyCode&&(e.preventDefault(),e.stopPropagation(),this.changedCurrency(e))}))},
teasp.Tsf.ExpDetail.prototype.setEventParticipant=function(e){dojo.forEach([this.fp.getElementByApiKey("InternalParticipantsNumber__c",null,e),this.fp.getElementByApiKey("ExternalParticipantsNumber__c",null,e)],function(e){this.getDomHelper().connect(e,"blur",this,this.changedparticipants),this.getDomHelper().connect(e,"onkeypress",this,function(e){""===e.keyChar&&13===e.keyCode&&(e.preventDefault(),
e.stopPropagation(),this.changedparticipants(e))})},this)},teasp.Tsf.ExpDetail.prototype.setEventExtra=function(e){dojo.forEach([this.fp.getElementByApiKey("ExtraItem1__c",null,e),this.fp.getElementByApiKey("ExtraItem2__c",null,e)],function(e){this.getDomHelper().connect(e,"blur",this,this.checkMatching),this.getDomHelper().connect(e,"onkeypress",this,function(e){""===e.keyChar&&13===e.keyCode&&(e.preventDefault(),
e.stopPropagation(),this.checkMatching())})},this)},teasp.Tsf.ExpDetail.prototype.setEventRoute=function(e){var t=this.getDomHelper().createComboBox({id:"DlgExpDetailStFrom",name:"DlgExpDetailStFrom",value:"",store:this.getStoreFrom(),fetchProperties:{sort:[{attribute:"score",descending:!1},{attribute:"name",descending:!1}]},searchAttr:"name"},teasp.Tsf.Dom.node(".ts-form-st-from",e)),s=this.getDomHelper(
).createComboBox({id:"DlgExpDetailStTo",name:"DlgExpDetailStTo",value:"",store:this.getStoreTo(),fetchProperties:{sort:[{attribute:"score",descending:!1},{attribute:"name",descending:!1}]},searchAttr:"name"},teasp.Tsf.Dom.node(".ts-form-st-to",e));this.getDomHelper().connect(t,"onChange",this,this.changeEkitanElements),this.getDomHelper().connect(s,"onChange",this,this.changeEkitanElements),this.getDomHelper(
).connect(teasp.Tsf.Dom.node(".ts-form-roundtrip",e),"onclick",this,this.clickRoundTrip)},teasp.Tsf.ExpDetail.prototype.setEventJob=function(a){var e=this.fp.getElementByApiKey("JobId__c",null,a);e&&(e=teasp.Tsf.Dom.getAncestorByCssName(e,"ts-form-row"))&&(e=teasp.Tsf.Dom.node("button.ts-form-find",e))&&this.getDomHelper().connect(e,"onclick",this,function(e){var t=this.fetchValueByApiKey("Date__c"
)||teasp.util.date.formatDate(teasp.util.date.getToday()),s=this.getCurrentChargeDept(),s=s&&s.Id||this.orgData.assist&&this.orgData.assist.ChargeDeptId__c||this.orgData.defaultDeptId;tsfManager.showSearchListDialog({discernment:"jobs",dialog:"JobList",delay:!0,values:{_date:[t],DeptId__c:s,_jobAssignClass:tsfManager.getEmpJobSearchCondition()}},null,teasp.Tsf.Dom.hitch(this,function(e){var e=e[0],t=(
this.setImportJobs(e),{});t.JobId__r={},t.JobId__r.JobCode__c=e.JobCode__c,t.JobId__r.StartDate__c=e.StartDate__c,t.JobId__r.EndDate__c=e.EndDate__c,t.JobId__r.Active__c=e.Active__c,t.JobId__r.Name=e.Name,t.JobId__c=e.Id,this.fp.getFcByApiKey("JobId__c").drawText(this.getDomHelper(),t,null,a),teasp.Tsf.util.mixin(this.orgData.values,t),this.checkMatching()}))})},teasp.Tsf.ExpDetail.prototype.setEventDept=function(s){
var e=this.fp.getElementByApiKey("ChargeDeptId__c",null,s);e&&(e=teasp.Tsf.Dom.getAncestorByCssName(e,"ts-form-row"))&&(e=teasp.Tsf.Dom.node("button.ts-form-find",e))&&this.getDomHelper().connect(e,"onclick",this,function(e){var t=this.fetchValueByApiKey("Date__c")||teasp.util.date.formatDate(teasp.util.date.getToday());tsfManager.showSearchListDialog({discernment:"depts",delay:!0,values:{_date:[t]}},null,
teasp.Tsf.Dom.hitch(this,function(e){e=e[0],e={ChargeDeptId__c:e.Id,ChargeDeptId__r:{DeptCode__c:e.DeptCode__c,ExpItemClass__c:e.ExpItemClass__c,Name:e.Name}};tsfManager.getInfo().setCacheDept(e),this.fp.getFcByApiKey("ChargeDeptId__c").drawText(this.getDomHelper(),e,null,s),this.expItemFilter.deptExpItemClass=e.ChargeDeptId__r.ExpItemClass__c||null,this.refreshExpItems()}))})},
teasp.Tsf.ExpDetail.prototype.setEventPayee=function(p){var e=this.fp.getElementByApiKey("PayeeId__r.Name",null,p);e&&(e=teasp.Tsf.Dom.getAncestorByCssName(e,"ts-form-row"))&&(e=teasp.Tsf.Dom.node("button.ts-form-find",e))&&this.getDomHelper().connect(e,"onclick",this,function(e){var t={PayeeType__c:teasp.Tsf.Dom.node("select.ts-payment-select",this.getFormEl()).value,
ExpenseType__c:this.orgData.assist&&this.orgData.assist.ExpenseType__c||null};tsfManager.showSearchListDialog({discernment:"payeeList",delay:!0,values:t},null,teasp.Tsf.Dom.hitch(this,function(e){var t={PayeeId__r:{}},s=(t.PayeeId__r.Name=e[0].dispValue,t.PayeeId__c=e[0].value,t.PayeeId__r.PayeeType__c=e[0].PayeeType__c,t.PayeeId__r.ExpenseType__c=e[0].ExpenseType__c,this.fp.getFcByApiKey("PayeeId__r.Name")),
a=this.fp.getFcByApiKey("PayeeId__c"),o=this.fp.getFcByApiKey("PayeeId__r.PayeeType__c"),i=this.fp.getFcByApiKey("PayeeId__r.ExpenseType__c");s.drawText(this.getDomHelper(),t,null,p),a.drawText(this.getDomHelper(),t,null,p),o.drawText(this.getDomHelper(),t,null,p),i.drawText(this.getDomHelper(),t,null,p),e[0].PayeeType__c&&(teasp.Tsf.Dom.node("select.ts-payment-select",this.getFormEl()).value=e[0].PayeeType__c),
teasp.Tsf.util.mixin(this.orgData.values,t),this.checkMatching()}))})},teasp.Tsf.ExpDetail.prototype.getWithoutTaxNode=function(){return teasp.Tsf.Dom.node("div.ts-row-tax input.ts-tax-without-tax",this.getFormEl())},teasp.Tsf.ExpDetail.prototype.getTaxNode=function(){return teasp.Tsf.Dom.node("div.ts-row-tax input.ts-tax-tax",this.getFormEl())},teasp.Tsf.ExpDetail.prototype.getForeignRateNode=function(){
return teasp.Tsf.Dom.node("div.ts-row-foreign input.ts-foreign-rate",this.getFormEl())},teasp.Tsf.ExpDetail.prototype.getForeignCostNode=function(){return teasp.Tsf.Dom.node("div.ts-row-foreign input.ts-foreign-cost",this.getFormEl())},teasp.Tsf.ExpDetail.prototype.getForeignNameNode=function(){return teasp.Tsf.Dom.node("div.ts-row-foreign select.ts-foreign-name",this.getFormEl())},
teasp.Tsf.ExpDetail.prototype.getRoundTripNode=function(){return teasp.Tsf.Dom.node(".ts-form-roundtrip",this.getFormEl())},teasp.Tsf.ExpDetail.prototype.loadExpItems=function(t){var e=t.value,s={};teasp.Tsf.Dom.empty(t),this.getDomHelper().create("option",{value:"",innerHTML:""},t),dojo.forEach(tsfManager.getExpItems(this.expItemFilter),function(e){this.isSelectableExpItem(e)&&(this.getDomHelper().create("option",{
value:e.getId(),innerHTML:e.getName()},t),s[e.getId()]=1)},this),s[e]&&(t.value=e)},teasp.Tsf.ExpDetail.prototype.refreshExpItems=function(){var e=this.fp.getElementByApiKey("ExpItemId__c",null,this.getFormEl());e&&this.loadExpItems(e),this.checkMatching()},teasp.Tsf.ExpDetail.prototype.isMinusCost=function(e){e=e&&e.Cost__c||null,e=e&&"string"==typeof e?parseInt(e,10):e;return"number"==typeof e&&!isNaN(e)&&e<0},
teasp.Tsf.ExpDetail.prototype.isSelectableExpItem=function(e){var t=this.orgData.values;if(this.cardConst){if(e.isFixAmount())return!1;if(this.isMinusCost(t)&&!e.isAllowMinus())return!1;if(!t.CurrencyName__c&&e.isForeignFlag())return!1}return this.isSelectableJtbExpItem(e)},teasp.Tsf.ExpDetail.prototype.isSelectableJtbExpItem=function(e){var t=this.orgData.values;if("JTB"==t.Item__c){if(!t.JsNaviActualId__r)return!1;
var s=tsfManager.getJtbExpItems();if(!s)return!0;if(0<=["JL","NH","JE","SF","JN","HD","JW"].indexOf(t.JsNaviActualId__r.FunctionCode__c)||t.JsNaviActualId__r.Data01__c&&(0<=t.JsNaviActualId__r.Data01__c.indexOf("交通")||0<=t.JsNaviActualId__r.Data01__c.indexOf("航空")||0<=t.JsNaviActualId__r.Data01__c.indexOf("新幹線"))){if("J"==t.JsNaviActualId__r.SystemType__c){if(0<s.j1.length&&s.j1.indexOf(e.expItem.Id)<0)return!1
}else if("F"==t.JsNaviActualId__r.SystemType__c){if(0<s.f1.length&&s.f1.indexOf(e.expItem.Id)<0)return!1}else if(0<s.j1.length&&s.j1.indexOf(e.expItem.Id)<0&&0<s.f1.length&&s.f1.indexOf(e.expItem.Id)<0&&0<s.e1.length&&s.e1.indexOf(e.expItem.Id)<0)return!1}else if(
"BH"==t.JsNaviActualId__r.FunctionCode__c||"RT"==t.JsNaviActualId__r.FunctionCode__c||"GT"==t.JsNaviActualId__r.FunctionCode__c||"HR"==t.JsNaviActualId__r.FunctionCode__c||t.JsNaviActualId__r.Data01__c&&0<=t.JsNaviActualId__r.Data01__c.indexOf("宿泊")){if("J"==t.JsNaviActualId__r.SystemType__c){if(0<s.j2.length&&s.j2.indexOf(e.expItem.Id)<0)return!1}else if("F"==t.JsNaviActualId__r.SystemType__c){if(
0<s.f2.length&&s.f2.indexOf(e.expItem.Id)<0)return!1}else if(0<s.j2.length&&s.j2.indexOf(e.expItem.Id)<0&&0<s.f2.length&&s.f2.indexOf(e.expItem.Id)<0&&0<s.e2.length&&s.e2.indexOf(e.expItem.Id)<0)return!1}else if(t.JsNaviActualId__r.Data01__c&&0<=t.JsNaviActualId__r.Data01__c.indexOf("レンタカー"))if("J"==t.JsNaviActualId__r.SystemType__c){if(0<s.j3.length&&s.j3.indexOf(e.expItem.Id)<0)return!1}else if(
"F"==t.JsNaviActualId__r.SystemType__c){if(0<s.f3.length&&s.f3.indexOf(e.expItem.Id)<0)return!1}else if(0<s.j3.length&&s.j3.indexOf(e.expItem.Id)<0&&0<s.f3.length&&s.f3.indexOf(e.expItem.Id)<0&&0<s.e3.length&&s.e3.indexOf(e.expItem.Id)<0)return!1}return!0},teasp.Tsf.ExpDetail.prototype.loadJobs=function(e){var s=this.fp.getElementByApiKey("JobId__c",null,this.getFormEl());if(s){for(var a=s.value,t=this.getJobChoices(
),o=0;o<t.length;o++)this.jobPool[t[o].getId()]=t[o].getObj();var i=e||this.getDate(),p={};teasp.Tsf.Dom.empty(s),this.getDomHelper().create("option",{value:"",innerHTML:""},s),dojo.forEach(t,function(e){var t=e.getId();!e.activeOnDate(i)&&t!=a||p[t]||(this.getDomHelper().create("option",{value:t,innerHTML:e.getDisplayName()},s),p[t]=1)},this),p[a]&&(s.value=a)}},teasp.Tsf.ExpDetail.prototype.getCurrentJob=function(
){var e=this.fp.getElementByApiKey("JobId__c",null,this.getFormEl()).value||null;if(e)for(var t=this.getJobChoices(),s=0;s<t.length;s++)if(t[s].getId()==e)return t[s];return null},teasp.Tsf.ExpDetail.prototype.getJobChoices=function(){var e=tsfManager.getEmpJobAssigns();return this.impJobs?e.concat(this.impJobs):e},teasp.Tsf.ExpDetail.prototype.setImportJobs=function(e){for(var t=this.getJobChoices(),s=!1,
a=0;a<t.length;a++)if(t[a].getId()==e.Id){s=!0;break}s||(this.impJobs=[new teasp.Tsf.Job(e)])},teasp.Tsf.ExpDetail.prototype.checkImportJobs=function(e){e.JobId__c&&e.JobId__r&&this.setImportJobs({Id:e.JobId__c,JobCode__c:e.JobId__r.JobCode__c||"",Name:e.JobId__r.Name||"",IsAssigned__c:!1,JobAssignId:null,StartDate__c:e.JobId__r.StartDate__c||null,EndDate__c:e.JobId__r.EndDate__c||null,
Active__c:void 0===e.JobId__r.Active__c||e.JobId__r.Active__c})},teasp.Tsf.ExpDetail.prototype.loadChargeDepts=function(e){var t,s=this.fp.getElementByApiKey("ChargeDeptId__c",null,this.getFormEl());s&&(teasp.Tsf.Dom.empty(s),t=tsfManager.getDefaultChargeDept(),this.getDomHelper().create("option",{value:"",innerHTML:""},s),t.ChargeDeptId__c&&(this.getDomHelper().create("option",{value:t.ChargeDeptId__c,
innerHTML:t.ChargeDeptId__r.DeptCode__c+" "+t.ChargeDeptId__r.Name},s),tsfManager.getInfo().setCacheDept(t)))},teasp.Tsf.ExpDetail.prototype.getCurrentChargeDept=function(){var e=this.fp.getElementByApiKey("ChargeDeptId__c",null,this.getFormEl());return e&&tsfManager.getInfo().getCacheDept(e.value||null)||null},teasp.Tsf.ExpDetail.prototype.getCurrentExpItem=function(){return tsfManager.getExpItemById(
this.fp.getFcByApiKey("ExpItemId__c").fetchValue().value)},teasp.Tsf.ExpDetail.prototype.changedExpItem=function(e){var t=this.getFormEl(),s=this.getCurrentExpItem(),a=s?s.getTransportType():null,o="1"==a||"2"==a,a="1"==a,i=s&&s.isReceipt()||!1,p=s&&s.isTaxFlag()||!1,r=s&&s.isForeignFlag()||!1,n=s&&s.isUseExtraItem1()||!1,l=s&&s.isUseExtraItem2()||!1,c=s&&s.isEnableQuantity()||!1,m=s?s.isRequireChargeJob(
)||0:tsfManager.isRequireChargeJob(),d=s&&s.isInternalParticipants()||!1,h=s&&s.isExternalParticipants()||!1,f=s&&s.isPlace()||!1,g=s&&(s.isInternalParticipants()||s.isExternalParticipants())||!1,o=(teasp.Tsf.Dom.show(".ts-row-route",t,o),teasp.Tsf.Dom.show(".ts-row-tax",t,p),teasp.Tsf.Dom.show(".ts-row-foreign",t,r),teasp.Tsf.Dom.show(".ts-row-quantity",t,c),teasp.Tsf.Dom.show(".ts-row-extra1",t,n),
teasp.Tsf.Dom.show(".ts-row-extra2",t,l),teasp.Tsf.Dom.show(".ts-row-job",t,0<m),teasp.Tsf.Dom.show(".ts-row-intpart",t,d),teasp.Tsf.Dom.show(".ts-row-extpart",t,h),teasp.Tsf.Dom.show(".ts-row-place",t,f),teasp.Tsf.Dom.show(".ts-PerParticipant",t,g),teasp.Tsf.Dom.show(".pp_btn_ektsrch",t,!this.cardConst&&a),teasp.Tsf.Dom.show(".pp_ico_ekitan",t,!1),teasp.Tsf.Dom.show(".ts-spice",t,!1),teasp.Tsf.Dom.show(
".ts-external",t,!1),teasp.Tsf.Dom.show(".ts-receipt",t,i),teasp.Tsf.Dom.show(".ts-row-job  .ts-require",t,2==m),i&&!this.orgData.pre&&tsfManager.isUseScannerStorage());if(teasp.Tsf.Dom.show(".ts-row-publisher  .ts-require",t,o),n||l)for(var u=1;u<=2;u++){var y,_,T=s.getExtraItem(u);T&&(y=teasp.Tsf.Dom.node(".ts-row-extra"+u,t),(_=teasp.Tsf.Dom.node("div.ts-form-label > div",y))&&(_.innerHTML=T.name||"&nbsp;"),
teasp.Tsf.Dom.show(".ts-require",y,T.require),(_=teasp.Tsf.Dom.node("div.ts-form-value > input",y))&&(_.style.width=T.width,_.maxLength=T.maxLength),this.getDomHelper().freeBy(this.EXPITEM_TOOLTIP_HKEY_EX+u),T.note&&this.getDomHelper().createTooltip({connectId:teasp.Tsf.Dom.node("div.ts-form-value",y),label:T.note,position:["before"],showDelay:100},this.EXPITEM_TOOLTIP_HKEY_EX+u))}var D,I,E,f=teasp.Tsf.Dom.node(
"div.ts-row-quantity div.ts-suffix");f&&(f.innerHTML=s&&s.getUnitName()||""),s&&(D=s.isAllowMinus(),dojo.forEach(["Cost__c","ForeignAmount__c","Tax__c","WithoutTax__c","UnitPrice__c","InternalParticipantsNumber__c","ExternalParticipantsNumber__c"],function(e){var e=this.fp.getFcByApiKey(e);e&&(e.setReadOnly(!D),e=e.getElement(null,t),teasp.Tsf.Dom.toggleClass(e,"ts-minus-ok",D),teasp.Tsf.Dom.toggleClass(e,
"ts-minus-ng",!D),!D&&e.value&&(e.value=e.value.replace(/-/,"")))},this),dojo.forEach([this.getTaxNode(),this.getWithoutTaxNode(),this.getForeignCostNode()],function(e){e&&(teasp.Tsf.Dom.toggleClass(e,"ts-minus-ok",D),teasp.Tsf.Dom.toggleClass(e,"ts-minus-ng",!D),!D&&e.value&&(e.value=e.value.replace(/-/,"")))},this)),e&&s?(a=this.getDate()||teasp.util.date.formatDate(teasp.util.date.getToday()),m=this.getCostValue(s
,!0),(o="number"==typeof(i=s.getCost(a,!0)))&&(s.isEnableQuantity()&&(this.setUnitPriceValue(i),(I=this.getQuantityValue())||this.setQuantityValue(1)),this.setCostValue(i),m=i),(E=this.fp.getElementByApiKey("Cost__c",t))&&(E.disabled=s.isAmountReadOnly()),c&&(n=this.getUnitPriceValue(s),I=this.getQuantityValue(),n||I||(this.setUnitPriceValue(m||0),this.setQuantityValue(1))),s.isEnableQuantity()&&this.recalcCost(!0,s,
o),(p||g)&&(this.setTaxType(this.getTaxType(!0)),this.setTaxArea(this.getTaxType()),l=this.getExpItemTaxRate(s),this.setSelectableTaxRate(l,s),this.recalcTax(0,s,o)),r&&this.initForeignCurrency(s),d?(this.setInternalParticipants(s,s.getInternalParticipantsTemplateText()),this.setInternalParticipantsNumber(0)):(this.setInternalParticipants(s,""),this.setInternalParticipantsNumber(null)),h?(
this.setExternalParticipants(s,s.getExternalParticipantsTemplateText()),this.setExternalParticipantsNumber(0)):(this.setExternalParticipants(s,""),this.setExternalParticipantsNumber(null)),this.setPlaceName(""),this.setPlaceAddress(""),g&&this.recalcAmountPerParticipants(s),f=this.getRouteData(s),teasp.Tsf.EmpExp.isSpice(f.item)?teasp.Tsf.Dom.show(".spice",this.getFormEl(),!0):"1"==s.getTransportType(
)&&teasp.Tsf.Dom.show(".pp_ico_ekitan",this.getFormEl(),"1"==f.transportType),teasp.Tsf.Dom.show(".ts-external",this.getFormEl(),teasp.Tsf.EmpExp.isExternalExpense(f.item))):s&&((E=this.fp.getElementByApiKey("Cost__c",t))&&(E.disabled=s.isAmountReadOnly()),r&&(e=this.getForeignNameNode())&&(a=e.selectedIndex<0?"":e.options[e.selectedIndex].text,this.initForeignCurrency(s,!0,a)),g&&(this.isReadOnly()||this.recalcTax(
1==this.getTaxType()||this.cardConst?0:1),this.recalcAmountPerParticipants(s))),this.createExpItemTooltip(),this.checkMatching()},teasp.Tsf.ExpDetail.prototype.createExpItemTooltip=function(){this.getDomHelper().freeBy(this.EXPITEM_TOOLTIP_HKEY);var e,t=this.fp.getElementByApiKey("ExpItemId__c",null,this.getFormEl()),s=this.getCurrentExpItem();t&&(s=s?(e=this.getDate(),s.getToolTip(!1,e,this.getCurrentTaxRate(e))
):teasp.message.getLabel("tf10001680"),this.getDomHelper().createTooltip({connectId:t.parentNode,label:s,position:["before"],showDelay:100},this.EXPITEM_TOOLTIP_HKEY))},teasp.Tsf.ExpDetail.prototype.createInternalParticipantsNumberTooltip=function(){this.getDomHelper().freeBy(this.EXPITEM_INTERNALPARTICIPANT_TOOLTIP_HKEY);var e=this.fp.getElementByApiKey("InternalParticipantsNumber__c",null,this.getFormEl());
e&&this.getDomHelper().createTooltip({connectId:e.parentNode,label:teasp.message.getLabel("tf10001853"),position:["before"],showDelay:100},this.EXPITEM_INTERNALPARTICIPANT_TOOLTIP_HKEY)},teasp.Tsf.ExpDetail.prototype.setTaxArea=function(e){var t;0==e?this.displayTaxArea(!1):(this.displayTaxArea(!0),(t=this.getWithoutTaxNode())&&(t.disabled=1==e))},teasp.Tsf.ExpDetail.prototype.setSelectableTaxRate=function(e,t){
var s=t?t.getSelectableTaxRateEx(e):[10,8,5,0],a=teasp.Tsf.Dom.node("table.ts-tax-table",this.getFormEl()),o=teasp.Tsf.Dom.node("select.ts-tax-rate",a);dojo.empty(o);for(var i=0;i<s.length;i++){var p=s[i];this.getDomHelper().create("option",{value:""+p,innerHTML:p+"%"},o)}p=null;p=null===e?(t||teasp.Tsf.ExpDetail).getTaxRate(this.getDate()):e,this.setTaxRateIfNotContain(p),o.value=""+p,dojo.setAttr(o,"disabled",!!(
t&&t.getSelectableTaxRate().length<=1)),this.createExpItemTooltip()},teasp.Tsf.ExpDetail.prototype.getTaxType=function(e){var t=this.getCurrentExpItem();return!e&&2==t.getTaxType()&&(t.isEkitanType()||t.isEnableQuantity()||t.isFixAmount())?1:t.getTaxType()},teasp.Tsf.ExpDetail.getTaxTypeName=function(e){return 1==e?teasp.message.getLabel("tm20001210"):2==e?teasp.message.getLabel("tm20001220"):teasp.message.getLabel(
"tm20001230")},teasp.Tsf.ExpDetail.prototype.setTaxType=function(e){var t=teasp.Tsf.Dom.node("div.ts-row-tax div.ts-tax-type",this.getFormEl());t&&(t.innerHTML=teasp.Tsf.ExpDetail.getTaxTypeName(e))},teasp.Tsf.ExpDetail.getTaxRate=function(e){e=e?"string"==typeof e?teasp.util.date.parseDate(e):e:new Date;return 2019<e.getFullYear()||2019<=e.getFullYear()&&10<=e.getMonth()+1?10:2014<e.getFullYear(
)||2014<=e.getFullYear()&&4<=e.getMonth()+1?8:5},teasp.Tsf.ExpDetail.prototype.setTaxRate=function(e,t){var s;this.isReadOnly()?((s=teasp.Tsf.Dom.node("div.ts-row-tax div.ts-tax-rate"))&&(s.innerHTML=""),this.createExpItemTooltip()):this.setSelectableTaxRate(t,e)},teasp.Tsf.ExpDetail.prototype.getCurrentTaxRate=function(e){var t=this.getCurrentExpItem();if(t&&!t.isTaxFlag())return t.getTaxRate(e);
t=teasp.Tsf.Dom.node("div.ts-row-tax select.ts-tax-rate");return t?parseInt(t.value,10):void 0},teasp.Tsf.ExpDetail.prototype.setTaxRateIfNotContain=function(t){var e=teasp.Tsf.Dom.node("div.ts-row-tax select.ts-tax-rate"),s=!1;teasp.Tsf.Dom.query("option",e).forEach(function(e){e.value==t&&(s=!0)},this),s||this.getDomHelper().create("option",{value:""+t,innerHTML:t+"%"},e)},
teasp.Tsf.ExpDetail.prototype.getExpItemTaxRate=function(e){e=e.getDefaultTaxRate();return"number"==typeof e?e:teasp.Tsf.ExpDetail.getTaxRate(this.getDate())},teasp.Tsf.ExpDetail.prototype.changedTaxRate=function(e){this.recalcTax(1==this.getTaxType()||this.cardConst?0:1),this.recalcAmountPerParticipants(),this.createExpItemTooltip()},teasp.Tsf.ExpDetail.prototype.getCostValue=function(e,t){
var s=this.fp.getFcByApiKey("Cost__c").fetchValue().value;return!t||null!==s&&""!=s?teasp.util.currency.string2number(""+s,e.isAllowMinus()).num:null},teasp.Tsf.ExpDetail.prototype.setCostValue=function(e,t){var s=this.fp.getElementByApiKey("Cost__c",this.getFormEl());s&&(s.value=!e&&t?"":teasp.Tsf.Currency.formatMoney(e,teasp.Tsf.Currency.V_YEN,!1,!0))},
teasp.Tsf.ExpDetail.prototype.getInternalParticipantsNumber=function(e,t){var s=this.fp.getFcByApiKey("InternalParticipantsNumber__c").fetchValue().value;if(t&&(null===s||""==s))return null;t=teasp.util.currency.string2number(""+s);return parseInt(t.sn1)},teasp.Tsf.ExpDetail.prototype.setInternalParticipantsNumber=function(e){var t=this.fp.getElementByApiKey("InternalParticipantsNumber__c",this.getFormEl());t&&(
t.value=e)},teasp.Tsf.ExpDetail.prototype.getInternalParticipants=function(){return this.fp.getFcByApiKey("InternalParticipants__c").fetchValue().value||null},teasp.Tsf.ExpDetail.prototype.setInternalParticipants=function(e,t){var s=this.fp.getElementByApiKey("InternalParticipants__c",this.getFormEl());s&&(s.value=t)},teasp.Tsf.ExpDetail.prototype.getExternalParticipantsNumber=function(e,t){
var s=this.fp.getFcByApiKey("ExternalParticipantsNumber__c").fetchValue().value;if(t&&(null===s||""==s))return null;t=teasp.util.currency.string2number(""+s);return parseInt(t.sn1)},teasp.Tsf.ExpDetail.prototype.setExternalParticipantsNumber=function(e){var t=this.fp.getElementByApiKey("ExternalParticipantsNumber__c",this.getFormEl());t&&(t.value=e)},teasp.Tsf.ExpDetail.prototype.getExternalParticipants=function(e){
return this.fp.getFcByApiKey("ExternalParticipants__c").fetchValue().value||null},teasp.Tsf.ExpDetail.prototype.setExternalParticipants=function(e,t){var s=this.fp.getElementByApiKey("ExternalParticipants__c",this.getFormEl());s&&(s.value=t)},teasp.Tsf.ExpDetail.prototype.setAmountPerParticipantValue=function(e,t){var s=teasp.Tsf.Dom.node("div.ts-PerParticipant",this.getFormEl()),e=(s&&(
s.innerHTML=teasp.message.getLabel("tf10011000")+teasp.message.getLabel("tm10001590")),!isNaN(t)&&isFinite(t)?s.innerHTML+=teasp.Tsf.Currency.formatMoney(t,teasp.Tsf.Currency.V_YEN,!1,e.isAllowMinus()):s.innerHTML+=teasp.Tsf.Currency.V_YEN+"-",this.fp.getElementByApiKey("AmountPerParticipant__c",this.getFormEl()));e&&(e.value=t)},teasp.Tsf.ExpDetail.prototype.setPlaceName=function(e){var t=this.fp.getElementByApiKey(
"PlaceName__c",this.getFormEl());t&&(t.value=e)},teasp.Tsf.ExpDetail.prototype.setPlaceAddress=function(e){var t=this.fp.getElementByApiKey("PlaceAddress__c",this.getFormEl());t&&(t.value=e)},teasp.Tsf.ExpDetail.prototype.changedparticipants=function(e){var t=this.getCurrentExpItem();this.setInternalParticipantsNumber(this.getInternalParticipantsNumber(t)),this.setExternalParticipantsNumber(
this.getExternalParticipantsNumber(t)),this.recalcTax(0,t),this.recalcAmountPerParticipants()},teasp.Tsf.ExpDetail.prototype.recalcAmountPerParticipants=function(){var e,t,s,a=this.getCurrentExpItem();a&&(s=this.getWithoutTaxValue(a),e=this.getInternalParticipantsNumber(a),a.isInternalParticipants()||(e=0,this.setInternalParticipantsNumber(null),this.setInternalParticipants(a,"")),
t=this.getExternalParticipantsNumber(a),a.isExternalParticipants()||(t=0,this.setExternalParticipantsNumber(null),this.setExternalParticipants(a,"")),a.isPlace()||(this.setPlaceName(""),this.setPlaceAddress("")),s=teasp.Tsf.Currency.roundSameAsSalesforce(s/(e+t)),this.setAmountPerParticipantValue(a,s),this.createInternalParticipantsNumberTooltip())},teasp.Tsf.ExpDetail.prototype.getUnitPriceValue=function(e){
var t=this.fp.getElementByApiKey("UnitPrice__c",this.getFormEl());return t?teasp.util.currency.string2number(t.value,e.isAllowMinus()).num:null},teasp.Tsf.ExpDetail.prototype.setUnitPriceValue=function(e){var t=this.fp.getElementByApiKey("UnitPrice__c",this.getFormEl());t&&(t.value=teasp.Tsf.Currency.formatMoney(e,teasp.Tsf.Currency.V_YEN,!1,!0))},teasp.Tsf.ExpDetail.prototype.getQuantityValue=function(){
var e=this.fp.getElementByApiKey("Quantity__c",this.getFormEl());return e?teasp.util.currency.formatDecimal(e.value,0,0,!1).n:null},teasp.Tsf.ExpDetail.prototype.setQuantityValue=function(e){var t=this.fp.getElementByApiKey("Quantity__c",this.getFormEl());t&&(t.value=teasp.util.currency.formatDecimal(e,0,0,!1).str)},teasp.Tsf.ExpDetail.prototype.setStaticTax=function(e){var t=teasp.Tsf.Dom.node(
"div.ts-row-tax div.ts-tax-div",this.getFormEl()),s=teasp.Tsf.ExpDetail.getTaxTypeName(e.TaxType__c||0),a=e.Tax__c||0,e="boolean"!=typeof e.TaxAuto__c||e.TaxAuto__c;t.innerHTML=s+teasp.message.getLabel("tm10001590")+'<span class="ts-currency">'+teasp.Tsf.Currency.formatMoney(a,teasp.Tsf.Currency.V_YEN,!1,!0)+"</span> "+(e?"":teasp.message.getLabel("tm20001200"))},
teasp.Tsf.ExpDetail.prototype.setStaticForeign=function(e){var t,s,a=teasp.Tsf.Dom.node("div.ts-row-foreign div.ts-foreign-div",this.getFormEl());a&&(t=e.CurrencyName__c||"",s=e.CurrencyRate__c||"",e=e.ForeignAmount__c||"",a.innerHTML=teasp.message.getLabel("tm20001171",t,teasp.util.currency.formatDecimal(s,teasp.constant.CU_DEC_POINT_MIN,teasp.constant.CU_DEC_POINT_MAX).str,teasp.util.currency.formatDecimal(e,
teasp.constant.CU_DEC_POINT_MIN,teasp.constant.CU_DEC_POINT_MAX,!0).str))},teasp.Tsf.ExpDetail.prototype.getWithoutTaxValue=function(e){var t;return this.isReadOnly()?this.orgData.values.WithoutTax__c||null:(t=this.getWithoutTaxNode())?teasp.util.currency.string2number(t.value,e.isAllowMinus()).num:null},teasp.Tsf.ExpDetail.prototype.setWithoutTaxValue=function(e){this.getWithoutTaxNode(
).value=teasp.Tsf.Currency.formatMoney(e,teasp.Tsf.Currency.V_YEN,!1,!0)},teasp.Tsf.ExpDetail.prototype.getTaxValue=function(e){var t;return this.isReadOnly()?this.orgData.values.Tax__c||null:(t=this.getTaxNode(),teasp.util.currency.string2number(t.value,e.isAllowMinus()).num)},teasp.Tsf.ExpDetail.prototype.setTaxValue=function(e){this.getTaxNode().value=teasp.Tsf.Currency.formatMoney(e,teasp.Tsf.Currency.V_YEN,!1,!0
)},teasp.Tsf.ExpDetail.prototype.isTaxAuto=function(){var e=teasp.Tsf.Dom.node("div.ts-row-tax button.ts-tax-auto");return!!e&&(!!teasp.Tsf.Dom.hasClass(e,"disabled")||!teasp.Tsf.Dom.hasClass(e,"pushed"))},teasp.Tsf.ExpDetail.prototype.setTaxAuto=function(e,t,s){var a;this.isReadOnly()?(a=teasp.Tsf.Dom.node("div.ts-row-tax div.ts-tax-auto"))&&(a.innerHTML=e?"":teasp.message.getLabel("tm20001200")):(
a=teasp.Tsf.Dom.node("div.ts-row-tax button.ts-tax-auto"),teasp.Tsf.Dom.toggleClass(a,"pushed",!e),teasp.Tsf.Dom.toggleClass(a,"enabled",e),(a=teasp.Tsf.Dom.node("input.ts-tax-tax"))&&!(a.disabled=e)&&s&&a.focus(),e&&t&&this.recalcTax(1==this.getTaxType()||this.cardConst?0:1))},teasp.Tsf.ExpDetail.prototype.clickTaxAuto=function(e){this.setTaxAuto(!this.isTaxAuto(),!0,!0),this.recalcAmountPerParticipants()},
teasp.Tsf.ExpDetail.prototype.displayTaxArea=function(t){var e=teasp.Tsf.Dom.node("table.ts-tax-table",this.getFormEl());teasp.Tsf.Dom.query("div, input, button, select",e).forEach(function(e){teasp.Tsf.Dom.hasClass(e,"ts-tax-type")||teasp.Tsf.Dom.show(e,null,t)},this)},teasp.Tsf.ExpDetail.prototype.changedForeignRate=function(e){var t,s;e&&(t=this.getCurrentForeignRate(),s=parseFloat(e.value||"0"),
this.setForeignRateTitle(e,s!=t.n?teasp.message.getLabel("tm20004050"):null))},teasp.Tsf.ExpDetail.prototype.setForeignRateTitle=function(e,t){t?(dojo.setAttr(e,"title",t),dojo.style(e,"background-color","#ffffe0")):(dojo.removeAttr(e,"title"),dojo.style(e,"background-color","#ffffff"))},teasp.Tsf.ExpDetail.prototype.changedCurrency=function(e){var t=this.getCurrentExpItem();t&&this.changedCurrencyAction(e.target,t)}
,teasp.Tsf.ExpDetail.prototype.changedCurrencyAction=function(e,t,s){var a=null,o=null,i=null,p=null,r=(void 0!==s&&(e.value=s),teasp.Tsf.Dom.hasClass(e,"ts-tax-tax")?(a=this.cardConst||t.isEkitanType()?0:2,p=0):teasp.Tsf.Dom.hasClass(e,"ts-tax-without-tax")?(a=this.cardConst?0:1,p=0):teasp.Tsf.Dom.hasClass(e,"ts-foreign-rate")?(o=t.getRecalcTarget(),this.changedForeignRate(e)):teasp.Tsf.Dom.hasClass(e,
"ts-foreign-name")?o=t.getCost()?t.getRecalcTarget():0:teasp.Tsf.Dom.hasClass(e,"ts-foreign-cost")?o=2:(teasp.Tsf.Dom.hasClass(e,"ts-form-currency")||teasp.Tsf.Dom.hasClass(e,"ts-form-number"))&&(t.isEnableQuantity()&&(i=0),t.isTaxFlag()&&(a=0),t.isForeignFlag()&&(o=0),(t.isInternalParticipants()||t.isExternalParticipants())&&(p=0),"UnitPrice__c"==(r=this.fp.getFcById(e.id)).getApiKey(
)?i=1:"Quantity__c"==r.getApiKey()&&(i=2)),null!==i&&this.recalcCost(i,t),null===a&&null===p||this.recalcTax(a,t,null!==s),null!==o&&this.recalcForeign(o,t),null!==p&&this.recalcAmountPerParticipants(t),this.getRouteData(t));teasp.Tsf.EmpExp.isSpice(r.item)?(teasp.Tsf.Dom.show(".ts-spice",this.getFormEl(),!0),teasp.Tsf.Dom.show(".pp_ico_ekitan",this.getFormEl(),!1)):(teasp.Tsf.Dom.show(".ts-spice",this.getFormEl(),!1
),teasp.Tsf.Dom.show(".pp_ico_ekitan",this.getFormEl(),"1"==r.transportType)),teasp.Tsf.Dom.show(".ts-external",this.getFormEl(),teasp.Tsf.EmpExp.isExternalExpense(r.item)),""===s&&(e.value=s)},teasp.Tsf.ExpDetail.prototype.selectedDate=function(){this.changedDate()},teasp.Tsf.ExpDetail.prototype.getDate=function(){var e=this.fetchValueByApiKey("Date__c"),e=teasp.util.strToDate(e);return e.failed?null:e.datef},
teasp.Tsf.ExpDetail.prototype.changedDate=function(e){var t,s,a,o=this.getDate();this.memoryDate!=o&&(this.loadJobs(o),this.memoryDate=o,this.changeEkitanElements(),o&&(o=this.getCurrentExpItem())&&(o.isForeignFlag()&&(a=this.getForeignRateNode())&&(s=this.getCurrentForeignRate(),a.value=s.str,this.setForeignRateTitle(a),t=o.getRecalcTarget(),this.recalcForeign(t,o)),(o.isTaxFlag()||o.isInternalParticipants(
)||o.isExternalParticipants())&&(t=this.getCurrentTaxRate(),s=""+o.getTaxRate(this.getDate(),t),(a=teasp.Tsf.Dom.node("div.ts-row-tax select.ts-tax-rate"))&&a.value!=s&&(this.setTaxRateIfNotContain(s),a.value=s,this.recalcTax(2==this.getTaxType()?1:0,o))),this.recalcAmountPerParticipants()),this.createExpItemTooltip())},teasp.Tsf.ExpDetail.prototype.changedForeign=function(e){var t,s=this.getForeignRateNode();s&&(
t=this.getCurrentForeignRate(),s.value=t.str,this.setForeignRateTitle(s),this.changedCurrency(e))},teasp.Tsf.ExpDetail.prototype.getForeignNameValue=function(){var e=teasp.Tsf.Dom.node("div.ts-row-foreign",this.getFormEl()),e=teasp.Tsf.Dom.node("select.ts-foreign-name",e);return e?0<=e.selectedIndex?e.options[e.selectedIndex].text:null:this.orgData.values.CurrencyName__c||""},
teasp.Tsf.ExpDetail.prototype.setForeignNameValue=function(e){var t=teasp.Tsf.Dom.node("div.ts-row-foreign",this.getFormEl()),s=teasp.Tsf.Dom.node("select.ts-foreign-name",t);if(s)if(e){for(var a=0;a<s.options.length;a++)if(s.options[a].text==e){s.selectedIndex=a;break}a>=s.options.length&&(this.getDomHelper().create("option",{value:e,innerHTML:e},s).selected=!0)}else s.value=""},
teasp.Tsf.ExpDetail.prototype.getCurrentForeignRate=function(){var e=this.getForeignNameNode(),e=tsfManager.getForeignById(e?e.value:""),t=this.fetchValueByApiKey("Date__c")||teasp.util.date.formatDate(teasp.util.date.getToday()),e=e.getRateByDate(t);return teasp.util.currency.formatDecimal(e,teasp.constant.CU_DEC_POINT_MIN,teasp.constant.CU_DEC_POINT_MAX)},teasp.Tsf.ExpDetail.prototype.getForeignRate=function(e){
var t=this.getForeignRateNode(),t=teasp.util.currency.formatDecimal(t?t.value:this.orgData.values.CurrencyRate__c||"");return t=e||""!=t.str?t:this.getCurrentForeignRate()},teasp.Tsf.ExpDetail.prototype.setForeignRateValue=function(e){var t=this.getForeignRateNode();t&&(t.value=teasp.util.currency.formatDecimal(e,teasp.constant.CU_DEC_POINT_MIN,teasp.constant.CU_DEC_POINT_MAX).str)},
teasp.Tsf.ExpDetail.prototype.getForeignAmountValue=function(e){var t=this.getForeignCostNode();return teasp.util.currency.formatDecimal(t?t.value:this.orgData.values.ForeignAmount__c||"",0,teasp.constant.CU_DEC_POINT_MAX,e.isAllowMinus()).n},teasp.Tsf.ExpDetail.prototype.setForeignAmountValue=function(e){var t=this.getForeignCostNode();t&&(t.value=teasp.util.currency.formatDecimal(e,teasp.constant.CU_DEC_POINT_MIN,
teasp.constant.CU_DEC_POINT_MAX,!0).str)},teasp.Tsf.ExpDetail.prototype.recalcTax=function(e,t,s){var a,o,i,p,r,n,l,t=t||this.getCurrentExpItem();t&&(a=this.getTaxType(),o=t.isAllowMinus(),i=tsfManager.getTaxRoundFlag(),p=this.isTaxAuto(),r=this.getCurrentTaxRate(this.getDate()),l=this.getCostValue(t),n=this.getWithoutTaxValue(t),t=this.getTaxValue(t),l=teasp.Tsf.ExpDetail.calcTax(l,n,t,e,a,r,p,i,o),
this.setCostValue(l.cost,!s),this.setWithoutTaxValue(l.withoutTax),this.setTaxValue(l.tax))},teasp.Tsf.ExpDetail.calcTax=function(e,t,s,a,o,i,p,r,n){return o?(a?1==a?(m=t<0?-1:1,c=Math.abs(t),p&&(s=c==(l=Math.abs(e))-(l=teasp.Tsf.ExpDetail.getTax(1,i,r,l))?l:teasp.Tsf.ExpDetail.getTax(2,i,r,c)),e=(c+Math.abs(s))*m,s=Math.abs(s)*m):2==a&&(m=s<0?-1:1,c=Math.abs(s),l=Math.abs(e),1==o?t=l-(c=l<c?l:c):l=Math.abs(t)+c,
s=c*m,e=l*m,t=Math.abs(t)*m):(m=(c=e)<0?-1:1,c=Math.abs(c),p?"0"==o?(s=0,t=e):(t=c-(s=teasp.Tsf.ExpDetail.getTax(1,i,r,c)),s*=m,t*=m):(t=c-(s=c<(s=Math.abs(s))?c:s),s*=m,t*=m)),{cost:e,tax:s,withoutTax:t}):{cost:e,tax:0,withoutTax:e};var l,c,m},teasp.Tsf.ExpDetail.getTax=function(e,t,s,a){var o=0;switch(e){case 1:switch(s){case 2:o=Math.ceil(a*t/(100+t));break;case 1:o=Math.floor(a*t/(100+t));break;case 0:
o=Math.round(a*t/(100+t))}break;case 2:switch(s){case 2:o=Math.ceil(a*t/100);break;case 1:o=Math.floor(a*t/100);break;case 0:o=Math.round(a*t/100)}break;case 0:o=0}return o},teasp.Tsf.ExpDetail.prototype.recalcForeign=function(e,t,s,a){var o=t.isAllowMinus(),i=this.getForeignRate(),s=s||this.getForeignAmountValue(t),p=this.getCostValue(t),p=(2!=e&&t.getCurrencyName()&&t.isFixAmount()&&!t.isEkitanType()&&(e=2),
teasp.Tsf.ExpDetail.calcForeign(p,i.n,s,e,"0"!=i.sn1&&1!=i.n?1:0,o));(e||a)&&(this.setCostValue(p.cost,!0),t.isEnableQuantity()&&(s=this.getQuantityValue()||1,i=teasp.util.currency.formatDecimal(p.cost/s,0,0,o).n,this.setUnitPriceValue(i))),2==e&&!a||this.setForeignAmountValue(p.amount),1==e&&!a||this.setForeignRateValue(p.rate)},teasp.Tsf.ExpDetail.calcForeign=function(e,t,s,a,o,i){var p=e,r=s,a=(2!=a&&(
p=new Decimal(t).times(s).toNumber(),r=t?new Decimal(e).div(t).toNumber():0),new Decimal(t).times(r).toNumber());return Math.abs(a)<teasp.constant.CU_DEC_MIN_VALUE&&(a=0),Math.abs(a)>teasp.constant.CU_TOTAL_UPPER_LIMIT&&(a=0),(Math.abs(a-p)>o||a==Math.floor(a))&&(e=teasp.util.currency.formatDecimal(a,0,0,i).n,s=r),{cost:e,rate:t,amount:s}},teasp.Tsf.ExpDetail.prototype.recalcCost=function(e,t,s){var a=t.isAllowMinus(
),t=this.getUnitPriceValue(t)||0,o=this.getQuantityValue()||0;e&&(e=teasp.util.currency.formatDecimal(t*o,0,0,a).n,this.setCostValue(e,!s),this.setUnitPriceValue(t),this.setQuantityValue(o))},teasp.Tsf.ExpDetail.prototype.changeEkitanElements=function(e){var t=this.getRouteData(this.getCurrentExpItem());teasp.Tsf.EmpExp.isSpice(t.item)?(teasp.Tsf.Dom.show(".ts-spice",this.getFormEl(),!0),teasp.Tsf.Dom.show(
".pp_ico_ekitan",this.getFormEl(),!1)):(teasp.Tsf.Dom.show(".ts-spice",this.getFormEl(),!1),teasp.Tsf.Dom.show(".pp_ico_ekitan",this.getFormEl(),"1"==t.transportType)),teasp.Tsf.Dom.show(".ts-external",this.getFormEl(),teasp.Tsf.EmpExp.isExternalExpense(t.item))},teasp.Tsf.ExpDetail.prototype.getStoreFrom=function(){return this.storeFrom||(this.storeFrom=teasp.Tsf.Dom.createStoreMemory(tsfManager.getStationFromHist()
)),this.storeFrom},teasp.Tsf.ExpDetail.prototype.getStoreTo=function(){return this.storeTo||(this.storeTo=teasp.Tsf.Dom.createStoreMemory(tsfManager.getStationToHist())),this.storeTo},teasp.Tsf.ExpDetail.prototype.isRoundTrip=function(){return teasp.Tsf.Dom.hasClass(this.getRoundTripNode(),"pp_btn_round")},teasp.Tsf.ExpDetail.prototype.clickRoundTrip=function(e){var t,s,a=!this.isRoundTrip(),o=(this.setRoundTripIcon(
a),this.getCurrentExpItem());o.isEnableQuantity()?(s=this.getUnitPriceValue(o),s=Math.round(a?2*s:s/2),this.setUnitPriceValue(s),t=this.getQuantityValue()||0,this.setCostValue(s*t)):(s=this.getCostValue(o),this.setCostValue(Math.round(a?2*s:s/2))),this.changeEkitanElements(),o.isTaxFlag()?this.recalcTax(0,o):o.isForeignFlag()&&this.recalcForeign(0,o)},teasp.Tsf.ExpDetail.prototype.setRoundTripIcon=function(e){
var t=this.getRoundTripNode();teasp.Tsf.Dom.toggleClass(t,"pp_btn_oneway",!e),teasp.Tsf.Dom.toggleClass(t,"pp_btn_round",e)},teasp.Tsf.ExpDetail.prototype.showCalendar=function(){var e=this.fp.getElementByApiKey("Date__c",null,this.getFormEl()),e=teasp.Tsf.Dom.getAncestorByCssName(e,"ts-form-row"),e=teasp.Tsf.Dom.node("button.ts-form-cal",e);e&&teasp.Tsf.Dom.pushEvent(e,"onclick")},
teasp.Tsf.ExpDetail.prototype.searchRoute=function(e){var t=this.getCurrentExpItem(),s=this.fetchValueByApiKey("Date__c");s?(s=teasp.Tsf.util.mixin({date:s,readonly:this.isReadOnly(),fixed:!1,stationFromHist:tsfManager.getStationFromHist(),stationToHist:tsfManager.getStationToHist(),config:tsfManager.getEmpExpConfig(s)},this.getRouteData(t)),tsfManager.dialogOpen("ExpSearch",s,null,this,function(e){
var t=this.orgData.values,e={startName:e.searchKey.stationFrom.name,startCode:e.searchKey.stationFrom.code,endName:e.searchKey.stationTo.name,endCode:e.searchKey.stationTo.code,cost:e.route.fare*(e.roundTrip?2:1),roundTrip:e.roundTrip,route:dojo.toJson(e)},t=(dijit.byId("DlgExpDetailStFrom").setValue(e.startName),dijit.byId("DlgExpDetailStTo").setValue(e.endName),this.setRoundTripIcon(e.roundTrip),
this.setValueByApiKey("Cost__c",teasp.Tsf.Currency.formatMoney(e.cost,teasp.Tsf.Currency.V_YEN,!1,!0)),t.startCode__c=e.startCode,t.startName__c=e.startName,t.endCode__c=e.endCode,t.endName__c=e.endName,t.Route__c=e.route,t._date=this.fetchValueByApiKey("Date__c"),t.Item__c=t.ExternalICExpenseId__r&&t.ExternalICExpenseId__r.UsageDate__c==t._date&&t.ExternalICExpenseId__r.Amount__c==e.cost?teasp.Tsf.ITEM_EXTERNAL:null
,t.TransportType__c="1",teasp.Tsf.Dom.show(".ts-spice",this.getFormEl(),!1),teasp.Tsf.Dom.show(".ts-external",this.getFormEl(),teasp.Tsf.EmpExp.isExternalExpense(t.Item__c)),teasp.Tsf.Dom.show(".pp_ico_ekitan",this.getFormEl(),!0),this.getCurrentExpItem()),t=(t.isTaxFlag()?this.recalcTax(0,t):t.isForeignFlag()&&this.recalcForeign(0,t),[]);t.unshift({name:e.startName,code:e.startCode}),t.unshift({name:e.endName,
code:e.endCode}),tsfManager.setExpHistory(t,e.route)})):this.showCalendar()},teasp.Tsf.ExpDetail.prototype.ekitanSetting=function(){this.escapeSf1(),tsfManager.showDialog("EkitanSetting",{ro:this.isReadOnly()})},teasp.Tsf.ExpDetail.prototype.getRouteData=function(e){var t,s,a,o,i,p={startCode:null,startName:null,endCode:null,endName:null,roundTrip:!1,transportType:e?e.getTransportType():"0",route:null,item:null},
r=this.orgData.values,n=("0"!=p.transportType?(p.startName=r.startName__c,p.endName=r.endName__c,p.roundTrip=r.roundTrip__c,p.item=r.Item__c,"1"==p.transportType?(p.startCode=r.startCode__c,p.endCode=r.endCode__c,p.route=r.Route__c):teasp.Tsf.EmpExp.isUber(p.item)&&(p.route=this.fetchValueByApiKey("Route__c"))):"JTB"!=r.Item__c&&r.Item__c!=teasp.Tsf.ITEM_EXTERNAL||(p.item=r.Item__c),p.route?teasp.Tsf.util.fromJson(
p.route):null);return p.stationVia=n&&n.searchKey&&n.searchKey.stationVia||[],p.transfer=n&&n.searchKey&&n.searchKey.transfer||!1,p.cost=n&&n.route&&n.route.fare||0,"2"==r.TransportType__c&&(p.route=null),this.isReadOnly()||(n=this.fetchValueByApiKey("Date__c"),t=this.fetchValueByApiKey("Cost__c"),s=r._date,a=r._cost,r.ExternalICExpenseId__r?(i=o=null,"string"==typeof r.ExternalICExpenseId__r.UsageDate__c&&(
o=r.ExternalICExpenseId__r.UsageDate__c),"number"==typeof r.ExternalICExpenseId__r.Amount__c&&(i=""+r.ExternalICExpenseId__r.Amount__c),p.item=n==o&&t==i?teasp.Tsf.ITEM_EXTERNAL:null):!teasp.Tsf.EmpExp.isSpice(p.item)||n==s&&t==a||(p.item=null),"0"!=p.transportType&&(r=dijit.byId("DlgExpDetailStFrom").getValue(),o=dijit.byId("DlgExpDetailStTo").getValue(),!teasp.Tsf.EmpExp.isSpice(p.item
)||p.startName==r&&p.endName==o||(p.item=null),i=!1,p.startName!=r&&(p.startCode=null,p.startName=r,i=!0),p.endName!=o&&(p.endCode=null,p.endName=o,i=!0),p.roundTrip=this.isRoundTrip(),"1"==p.transportType&&(p.cost&&p.roundTrip&&(p.cost*=2),!i&&p.route&&p.cost==this.getCostValue(e)&&n==s||(p.transportType="2")))),p},teasp.Tsf.ExpDetail.prototype.changedPayType=function(e){var e=e.target.value,t="1"!=e,
s=this.getFormEl(),t=(teasp.Tsf.Dom.show(".ts-row-payee",s,t),teasp.Tsf.Dom.show(".ts-row-invoiceURL",s,"2"==e),this.fp.getElementByApiKey("PayeeId__c",s)),a=this.fp.getElementByApiKey("PayeeId__r.PayeeType__c",s),o=this.fp.getElementByApiKey("PayeeId__r.Name",s),s=this.fp.getElementByApiKey("PayeeId__r.ExpenseType__c",s),t=(t&&(t.value=""),a&&(a.value=""),o&&(o.value=""),s&&(s.value=""),teasp.Tsf.Dom.node(
".ts-payment-icon",teasp.Tsf.Dom.byId(this.dialog.id)));t&&(teasp.Tsf.Dom.toggleClass(t,"pp_ico_bill","2"==e),teasp.Tsf.Dom.toggleClass(t,"pp_ico_card1","3"==e)),this.checkMatching()},teasp.Tsf.ExpDetail.prototype.changedJob=function(e){var t=this.getCurrentJob(),s=this.fp.getElementByApiKey("JobId__c",null,this.getFormEl()),a=teasp.Tsf.Dom.nextSibling(s);a&&"INPUT"==a.tagName&&(a.value=t&&t.getName()||""),(
s=this.fp.getElementByApiKey("JobId__r.JobCode__c",null,this.getFormEl()))&&(s.value=t&&t.getCode()||""),(s=this.fp.getElementByApiKey("JobId__r.StartDate__c",null,this.getFormEl()))&&(s.value=t&&t.getStartDate()||""),(s=this.fp.getElementByApiKey("JobId__r.EndDate__c",null,this.getFormEl()))&&(s.value=t&&t.getEndDate()||""),this.checkMatching()},teasp.Tsf.ExpDetail.prototype.changedChargeDept=function(e){
var t=this.getCurrentChargeDept(),s=this.fp.getElementByApiKey("ChargeDeptId__c",null,this.getFormEl()),s=teasp.Tsf.Dom.nextSibling(s);s&&"INPUT"==s.tagName&&(s.value=t&&t.Name||""),this.expItemFilter.deptExpItemClass=t&&t.ExpItemClass__c||null,this.refreshExpItems()},teasp.Tsf.ExpDetail.prototype.setAttachmentExist=function(e,t){this.fp.getFcByApiKey("Id").fetchValue().value==e&&teasp.Tsf.EmpExp.setAttachmentExist2(
this.getDomHelper(),this.getFormEl(),this.orgData.values,t)},teasp.Tsf.ExpDetail.prototype.showError=function(e){var t=teasp.Tsf.Dom.node(".ts-error-area",teasp.Tsf.Dom.byId(this.dialog.id));teasp.Tsf.Error.showError(e,t)},teasp.Tsf.ExpDetail.prototype.getCurrentValue=function(){this.showError();var t=this.getCurrentExpItem();if(!t)return this.showError(teasp.message.getLabel("tf10001680")),null;
var s=this.orgData.values||{},e=(this.fp.fcLoop(function(e){e.isApiField(!0)||"_temp_attach"==e.getApiKey()?e.fillValue(s,e.fetchValue()):"_tax"==e.getApiKey()?(s.TaxAuto__c=this.isTaxAuto(),s.TaxRate__c=this.getCurrentTaxRate(),s.TaxType__c=""+(t.getTaxType()||"0"),s.Tax__c=""+this.getTaxValue(t),s.WithoutTax__c=""+this.getWithoutTaxValue(t)):"_foreign"==e.getApiKey()&&t.isForeignFlag()&&(
s.CurrencyName__c=this.getForeignNameValue(),s.CurrencyRate__c=""+this.getForeignRate().n,s.ForeignAmount__c=""+this.getForeignAmountValue(t))},this),s.JobId__c&&this.jobPool[s.JobId__c]&&(s.JobId__r=this.jobPool[s.JobId__c]),this.fp.getFcByApiKey("_payment")),a="1";if(a=e.isReadOnly()?s.PayeeId__r&&s.PayeeId__r.PayeeType__c||"1":(o=teasp.Tsf.Dom.node("select.ts-payment-select",this.getFormEl())
).options.length?o.value:null,null===s.Cost__c||""==s.Cost__c)return this.showError(teasp.message.getLabel("tm20004270")),null;if(null===a)return this.showError(teasp.message.getLabel("tf10001840",e.getLabel())),null;var o=this.getRouteData(t),e=(s.startCode__c=o.startCode,s.startName__c=o.startName,s.endCode__c=o.endCode,s.endName__c=o.endName,s.roundTrip__c=o.roundTrip,s.Route__c=o.route,
s.TransportType__c=o.transportType,s.Item__c=o.item,s.Receipt__c=t.isReceipt(),s.PayeeId__r=s.PayeeId__r||{},s.PayeeId__r.PayeeType__c=a,teasp.util.strToDate(s.Date__c));if(e.failed)return this.showError(dojo.replace(e.tmpl,[teasp.message.getLabel("tf10000940")])),null;if(!("0"==s.TransportType__c||s.startName__c&&s.endName__c))return this.showError(teasp.message.getLabel("tm20004260")),null;if(t.isEnableQuantity()){
var o=this.getUnitPriceValue(t),e=this.getQuantityValue()||0,i=this.getCostValue(t),p=o*e;if(Math.abs(p)>teasp.constant.CU_TOTAL_UPPER_LIMIT)return this.showError(teasp.message.getLabel("tf10001780")),null;if(i!=o*e)return this.showError(teasp.message.getLabel("tf10001790")),null}else s.UnitPrice__c=null,s.Quantity__c=null;if(t.isTaxFlag()){if("0"==t.getTaxType())s.TaxAuto__c=!0,s.TaxRate__c=null,s.TaxType__c="0",
s.Tax__c=0,s.WithoutTax__c=s.Cost__c;else if((i=this.getCostValue(t))!=this.getWithoutTaxValue(t)+this.getTaxValue(t))return this.showError(teasp.message.getLabel("tf10008270")),null}else s.TaxAuto__c=!0,s.TaxRate__c=null,s.TaxType__c=null,s.Tax__c=null,s.WithoutTax__c=this.getWithoutTaxValue(t);if(t.isForeignFlag()){if(!s.CurrencyName__c||s.CurrencyName__c==teasp.Tsf.ForeignCurrency.NONE)return this.showError(
teasp.message.getLabel(this.cardConst?"tf10002060":"tm20004280")),null;o=this.getForeignRate(),p=this.getForeignAmountValue(t)*o.n;if(Math.abs(p)>teasp.constant.CU_TOTAL_UPPER_LIMIT)return this.showError(teasp.message.getLabel("tf10001800")),null;if(p-=i=this.getCostValue(t),1<Math.abs(p))return this.showError(teasp.message.getLabel("tf10008280")),null}else this.cardConst||(s.CurrencyName__c=null,
s.CurrencyRate__c=null,s.ForeignAmount__c=null);if(t.isReceipt()&&!s.Publisher__c&&!this.orgData.pre&&tsfManager.isUseScannerStorage())return this.showError(teasp.message.getLabel("ex00000130")),null;e=t.isRequireChargeJob();if(2==e&&!s.JobId__c)return this.showError(teasp.message.getLabel("tf10001710")),null;if(0<e){o=this.getCurrentJob();if(o&&!o.activeOnDate(s.Date__c))return this.showError(teasp.message.getLabel(
"tf10001810")),null}else s.JobId__c=null,s.JobId__r=null;i=tsfManager.isRequireChargeDept();if(2==i&&!s.ChargeDeptId__c)return this.showError(teasp.message.getLabel("tf10006030")),null;if(0<i?s.ChargeDeptId__r=tsfManager.getInfo().getCacheDept(s.ChargeDeptId__c):(s.ChargeDeptId__c=null,s.ChargeDeptId__r=null),"2"==a||"3"==a){if(!s.PayeeId__r||!s.PayeeId__r.Name)return this.showError(teasp.message.getLabel(
"tf10001720")),null}else this.cardConst||(s.PayeeId__c=null,s.PayeeId__r=null,s.PaymentDate__c=null);if(s.PaymentDate__c){p=teasp.util.strToDate(s.PaymentDate__c);if(p.failed)return this.showError(dojo.replace(p.tmpl,[teasp.message.getLabel("tf10000590")])),null}if(s.InvoiceURL__c){e="http://",o="https://",i=s.InvoiceURL__c.toLowerCase();if("2"!=a)s.InvoiceURL__c=null;else if(i.substr(0,e.length)!=e&&i.substr(0,
o.length)!=o)return this.showError(teasp.message.getLabel("ex00001240")),null}if(t.isInternalParticipants()&&t.isExternalParticipants()){if(0==+s.InternalParticipantsNumber__c&&0==+s.ExternalParticipantsNumber__c)return this.showError(teasp.message.getLabel("tf10001851")),null;if(+s.InternalParticipantsNumber__c<0||+s.ExternalParticipantsNumber__c<0)return this.showError(teasp.message.getLabel("tf10001852")),null
}else if(t.isInternalParticipants()&&!t.isExternalParticipants()){if(+s.InternalParticipantsNumber__c<=0)return this.showError(teasp.message.getLabel("tf10001854")),null}else if(!t.isInternalParticipants()&&t.isExternalParticipants()&&+s.ExternalParticipantsNumber__c<=0)return this.showError(teasp.message.getLabel("tf10001855")),null;p=t.getExtraItem(1);if(p){if(p.require&&!s.ExtraItem1__c)return this.showError(
teasp.message.getLabel("tf10001840",p.name)),null}else s.ExtraItem1__c=null;a=t.getExtraItem(2);if(a){if(a.require&&!s.ExtraItem2__c)return this.showError(teasp.message.getLabel("tf10001840",a.name)),null}else s.ExtraItem2__c=null;return s.ExpenseType__c=this.orgData.expenseType||null,delete s._date,s},teasp.Tsf.ExpDetail.prototype.inputMemory=function(e){var t=this.getCurrentValue();return!!t&&(this.entryDetail&&(
this.entryDetail({hkey:this.orgData.hkey,values:t}),this.orgData.parentHide&&this.orgData.parentHide()),this.orgData.values=t,!0)},teasp.Tsf.ExpDetail.prototype.escapeSf1=function(){try{var e;!teasp.isSforce1()||(e=this.fp.getElementByApiKey("ExpItemId__c",null,this.getFormEl()))&&e.focus()}catch(e){}},teasp.Tsf.ExpDetail.prototype.ok=function(e){this.escapeSf1(),this.inputMemory()&&this.hide()},
teasp.Tsf.ExpDetail.prototype.inputAndContinue=function(e){this.escapeSf1(),this.orgData.targetDate?this.doRegist(teasp.Tsf.Dom.hitch(this,function(){this.resetContent()})):this.inputMemory()&&this.resetContent()},teasp.Tsf.ExpDetail.prototype.doRegist=function(s){var e=this.getCurrentValue();e&&(e={EmpId__c:tsfManager.getEmpId(),ExpApplyId__c:null,ExpPreApplyId__c:null,date:this.orgData.targetDate||null,exps:[e]},
tsfManager.saveEmpExp(e,teasp.Tsf.Dom.hitch(this,function(e,t){e?(this.entryDetail&&this.entryDetail(t),s()):this.showError(teasp.Tsf.Error.getMessage(t))})))},teasp.Tsf.ExpDetail.prototype.regist=function(e){this.doRegist(teasp.Tsf.Dom.hitch(this,function(){this.hide()}))},teasp.Tsf.ExpDetail.prototype.resetContent=function(){var e=this.getFormEl(),t=(this.orgData.hkey=teasp.Tsf.Fp.createHkey(),
this.orgData.values=teasp.Tsf.Dom.clone(this.orgData.values),this.orgData.values.Id=null,this.orgData.values._uniqKey=teasp.Tsf.ExpApply.createUniqKey(),this.orgData.values.Attachments=[],this.orgData.values.Item__c=null,this.orgData.values.PreEmpExpId__c=null,this.orgData.values.PreExpItemId__c=null,this.orgData.values.CardStatementLineId__c=null,this.orgData.values.CardStatementLineId__r=null,
this.orgData.values.ExternalICExpenseId__c=null,this.orgData.values.ExternalICExpenseId__r=null,this.orgData.values.Route__c=null,this.orgData.values.PlaceName__c=null,this.orgData.values.PlaceAddress__c=null,delete this.orgData.values._temp_attach,delete this.orgData.values.preObj,tsfManager.getExpItemById(this.orgData.values.ExpItemId__c)),s=this.getDate()||teasp.util.date.formatDate(teasp.util.date.getToday()),
s=t.getCost(s,!0),s=(this.orgData.values._cost=this.orgData.values.Cost__c=s||null,this.setCostValue(this.orgData.values.Cost__c),this.changedCurrencyAction(this.fp.getElementByApiKey("Cost__c",e),t,this.getCostValue(t,!0)),t.isEnableQuantity()&&(s?this.setUnitPriceValue(s):this.setUnitPriceValue(""),this.setQuantityValue(1)),t.getTransportType());"1"!=s&&"2"!=s||(dijit.byId("DlgExpDetailStFrom").setValue(""),
dijit.byId("DlgExpDetailStTo").setValue("")),t.isTaxFlag()&&(this.setTaxAuto(!0),this.setTaxRate(t,null)),t.isForeignFlag()&&this.initForeignCurrency(t),t.isUseExtraItem1()&&(dojo.byId("DlgDetailExtraItem1").value=!tsfManager.isDoNotCopyExtraItem()&&this.orgData.assist&&this.orgData.assist.ExtraItem1__c||""),t.isUseExtraItem2()&&(dojo.byId("DlgDetailExtraItem2").value=!tsfManager.isDoNotCopyExtraItem(
)&&this.orgData.assist&&this.orgData.assist.ExtraItem2__c||""),t.isInternalParticipants()?(this.setInternalParticipants(t,t.getInternalParticipantsTemplateText()),this.setInternalParticipantsNumber(0)):(this.setInternalParticipants(t,""),this.setInternalParticipantsNumber(null)),t.isExternalParticipants()?(this.setExternalParticipants(t,t.getExternalParticipantsTemplateText()),this.setExternalParticipantsNumber(0)):(
this.setExternalParticipants(t,""),this.setExternalParticipantsNumber(null)),this.setPlaceName(""),this.setPlaceAddress(""),(t.isInternalParticipants()||t.isExternalParticipants())&&this.setAmountPerParticipantValue(t,NaN),dojo.byId("DlgDetailInvoiceURL").value="",dojo.byId("DlgDetailDetail").value="",this.setValueByApiKey("Id",""),teasp.Tsf.Dom.show(".ts-spice",e,!1),teasp.Tsf.Dom.show(".ts-external",e,!1),
this.orgData.pre||(s=teasp.Tsf.Dom.node('input[type="button"].ts-receipt',e),teasp.Tsf.Dom.toggleClass(s,"pp_ico_receipt",!0),teasp.Tsf.Dom.toggleClass(s,"pp_ico_receipt_a",!1),teasp.Tsf.Dom.toggleClass(s,"pp_ico_receipt_r",!1),teasp.Tsf.Dom.toggleClass(s,"pp_ico_receipt_u",!1),s.title=null,this.getDomHelper().freeBy(this.EXPITEM_RECEIPT_TOOLTIP_HKEY),this.getDomHelper().createTooltip({connectId:s,
label:teasp.message.getLabel("tf10001660"),position:["below"],showDelay:200},this.EXPITEM_RECEIPT_TOOLTIP_HKEY)),teasp.Tsf.Dom.show("div.ts-dialog-tips",teasp.Tsf.Dom.byId(this.dialog.id),!1)},teasp.Tsf.ExpDetail.prototype.getExpMatching=function(e){var t,s,a,o=0,i=tsfManager.getExpItemById(e.ExpItemId__c);return i&&(i.checkExpenseType(this.expItemFilter.expenseType)||(o=teasp.Tsf.EmpExp.MISMATCH_EXPENSE_TYPE),
i.isSelectable(this.expItemFilter.empExpItemClass)||i.isSelectable(this.expItemFilter.deptExpItemClass)||(o|=teasp.Tsf.EmpExp.MISMATCH_EXPITEM_CLASS),s=tsfManager.getPayeeTypeNums(this.expItemFilter.expenseType),a=e.PayeeId__r&&(e.PayeeId__r.PayeeType__c||e.payeeType)||null,t=e.PayeeId__r&&e.PayeeId__r.ExpenseType__c||null,s[a||1]||!this.expItemFilter.expenseType&&1==(a||1)||(o|=teasp.Tsf.EmpExp.MISMATCH_PAY_TYPE),
!t||this.expItemFilter.expenseType&&t.split(/,/).contains(this.expItemFilter.expenseType)||(o|=teasp.Tsf.EmpExp.MISMATCH_PAY_EXPENSE_TYPE),2!=i.isRequireChargeJob()||e.JobId__c||(o|=teasp.Tsf.EmpExp.EMPTY_JOB),(s=i.getExtraItem(1))&&s.require&&!e.ExtraItem1__c&&(o|=teasp.Tsf.EmpExp.EMPTY_EXTRA1),(a=i.getExtraItem(2))&&a.require&&!e.ExtraItem2__c&&(o|=teasp.Tsf.EmpExp.EMPTY_EXTRA2)),2!=tsfManager.isRequireChargeDept(
)||e.ChargeDeptId__c||(o|=teasp.Tsf.EmpExp.EMPTY_CHARGE_DEPT),o},teasp.Tsf.ExpDetail.prototype.showMisMatch=function(e,t){var s,a,o;e&&this.orgData.isShowMisMatch&&((e=teasp.Tsf.Dom.node("div.ts-form-label",teasp.Tsf.Dom.getAncestorByCssName(e,"ts-form-row")))&&((s=teasp.Tsf.Dom.node("div.ts-mismatch",e))&&teasp.Tsf.Dom.destroy(s),s=[],t&(
teasp.Tsf.EmpExp.MISMATCH_EXPENSE_TYPE|teasp.Tsf.EmpExp.MISMATCH_PAY_TYPE|teasp.Tsf.EmpExp.MISMATCH_PAY_EXPENSE_TYPE)&&s.push(teasp.message.getLabel("tf10006860")),t&teasp.Tsf.EmpExp.MISMATCH_EXPITEM_CLASS&&s.push(teasp.message.getLabel("tf10006870")),t&teasp.Tsf.EmpExp.EMPTY_CHARGE_DEPT&&s.push(teasp.message.getLabel("tf10007910")),t&teasp.Tsf.EmpExp.EMPTY_JOB&&s.push(teasp.message.getLabel("tf10007920")),t&(
teasp.Tsf.EmpExp.EMPTY_EXTRA1|teasp.Tsf.EmpExp.EMPTY_EXTRA2)&&(a=(o=this.getCurrentExpItem()).getExtraItem(1),o=o.getExtraItem(2),a&&t&teasp.Tsf.EmpExp.EMPTY_EXTRA1&&s.push(teasp.message.getLabel("tf10008260",a.name)),o&&t&teasp.Tsf.EmpExp.EMPTY_EXTRA2&&s.push(teasp.message.getLabel("tf10008260",o.name))),s.length&&this.getDomHelper().create("div",{className:"pp_ico_ng"},this.getDomHelper().create("div",{
className:"ts-mismatch"},e)),e.title=s.length?s.join("\r\n"):""))},teasp.Tsf.ExpDetail.prototype.checkExpMatching=function(e){var e=this.getExpMatching(e),t=this.fp.getElementByApiKey("ExpItemId__c",null,this.getFormEl()),s=teasp.Tsf.Dom.node(this.isReadOnly()?"div.ts-payment-div":"select.ts-payment-select",this.getFormEl()),a=this.fp.getElementByApiKey("PayeeId__r.Name",null,this.getFormEl()),
o=this.fp.getElementByApiKey("ChargeDeptId__c",null,this.getFormEl()),i=this.fp.getElementByApiKey("JobId__c",null,this.getFormEl()),p=this.fp.getElementByApiKey("ExtraItem1__c",null,this.getFormEl()),r=this.fp.getElementByApiKey("ExtraItem2__c",null,this.getFormEl());this.showMisMatch(t,e&(teasp.Tsf.EmpExp.MISMATCH_EXPENSE_TYPE|teasp.Tsf.EmpExp.MISMATCH_EXPITEM_CLASS)),this.showMisMatch(s,
e&teasp.Tsf.EmpExp.MISMATCH_PAY_TYPE),this.showMisMatch(a,e&teasp.Tsf.EmpExp.MISMATCH_PAY_EXPENSE_TYPE),this.showMisMatch(o,e&teasp.Tsf.EmpExp.EMPTY_CHARGE_DEPT),this.showMisMatch(i,e&teasp.Tsf.EmpExp.EMPTY_JOB),this.showMisMatch(p,e&teasp.Tsf.EmpExp.EMPTY_EXTRA1),this.showMisMatch(r,e&teasp.Tsf.EmpExp.EMPTY_EXTRA2)},teasp.Tsf.ExpDetail.prototype.checkMatching=function(){var t,e;this.isReadOnly()||(
e=teasp.Tsf.Dom.node("select.ts-payment-select",this.getFormEl()),t={payeeType:e?e.value:null},(e=[]).push(this.fp.getFcByApiKey("ExpItemId__c")),e.push(this.fp.getFcByApiKey("PayeeId__c")),e.push(this.fp.getFcByApiKey("PayeeId__r.Name")),e.push(this.fp.getFcByApiKey("PayeeId__r.PayeeType__c")),e.push(this.fp.getFcByApiKey("PayeeId__r.ExpenseType__c")),e.push(this.fp.getFcByApiKey("ChargeDeptId__c")),e.push(
this.fp.getFcByApiKey("JobId__c")),e.push(this.fp.getFcByApiKey("ExtraItem1__c")),e.push(this.fp.getFcByApiKey("ExtraItem2__c")),dojo.forEach(e,function(e){e&&e.fillValue(t,e.fetchValue())}),this.checkExpMatching(t))},teasp.Tsf.ExpRoute=function(){this.expRoute=null},teasp.Tsf.ExpRoute.prototype.show=function(e){teasp.Tsf.Error.showError(),this.dialog||(this.domHelper=new teasp.Tsf.Dom,this.dialog=new dijit.Dialog({
title:teasp.message.getLabel("routeInfo_caption")}),this.dialog.attr("content",this.getContent()),this.dialog.startup(),this.domHelper.connect(this.dialog,"onCancel",this,function(){this.hide()})),this.showData(e)},teasp.Tsf.ExpRoute.prototype.showData=function(e){var t=e,s=("string"==typeof e&&(t=dojo.fromJson(e)),this.expRoute&&this.expRoute.destroy(),this.expRoute=new teasp.helper.EkitanRoute(t.route),
teasp.message.getLabel("tm20009060",t.searchKey.stationFrom.name,t.searchKey.stationTo.name));if(t.searchKey.stationVia&&t.searchKey.stationVia.length){s+=teasp.message.getLabel("tm20009019");for(var a=0;a<t.searchKey.stationVia.length;a++)0<a&&(s+=teasp.message.getLabel("tm10001540")),s+=t.searchKey.stationVia[a].name;s+=teasp.message.getLabel("tm20009020")}teasp.Tsf.Dom.node(".ts-title > div").innerHTML=s,
teasp.Tsf.Dom.node(".ts-cost  > div").innerHTML=teasp.util.currency.formatMoney(t.route.fare)+teasp.message.getLabel("tm20009090")+teasp.message.getLabel("tm20009030"),teasp.Tsf.Dom.node(".ts-route-head > div").innerHTML=teasp.message.getLabel("route_head");e=teasp.Tsf.Dom.node(".ts-route-body > div");teasp.Tsf.Dom.empty(e),e.appendChild(this.expRoute.createTable({tableId:"expRouteTable",readOnly:!0})),
this.dialog.show()},teasp.Tsf.ExpRoute.prototype.getDomHelper=function(){return this.domHelper},teasp.Tsf.ExpRoute.prototype.getArea=function(){return teasp.Tsf.Dom.byId(this.dialog.id)},teasp.Tsf.ExpRoute.prototype.hide=function(){this.dialog&&(this.dialog.hide(),this.domHelper.free(),this.dialog.destroy(),tsfManager.removeDialog("ExpRoute"))},teasp.Tsf.ExpRoute.prototype.getContent=function(){
var e=this.getDomHelper().create("div",{className:"ts-dialog ts-exp-route"}),t=this.getDomHelper().create("table",null,e),t=this.getDomHelper().create("tbody",null,t);return this.getDomHelper().create("div",null,this.getDomHelper().create("td",{className:"ts-title"},this.getDomHelper().create("tr",null,t))),this.getDomHelper().create("div",null,this.getDomHelper().create("td",{className:"ts-cost"},this.getDomHelper(
).create("tr",null,t))),this.getDomHelper().create("div",null,this.getDomHelper().create("td",{className:"ts-route-head"},this.getDomHelper().create("tr",null,t))),this.getDomHelper().create("div",null,this.getDomHelper().create("td",{className:"ts-route-body"},this.getDomHelper().create("tr",null,t))),this.createButtons(e),e},teasp.Tsf.ExpRoute.prototype.createButtons=function(e){e=this.getDomHelper().create("div",{
className:"ts-dialog-buttons"},e),e=this.getDomHelper().create("div",null,e),e=teasp.Tsf.Dialog.createButton(this.getDomHelper(),teasp.message.getLabel("close_btn_title"),"ts-dialog-cancel",e);this.getDomHelper().connect(e,"onclick",this,this.hide)},teasp.Tsf.ExpImport=function(){this.fp=teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.dialogExpImport),this.expImportRemarks=tsfManager.getInfo().getExpPreApplyConfigs(
).expImportRemarks||!1,this.EXPITEM_INTERNALPARTICIPANT_TOOLTIP_HKEY="expItem_internalParticipanttoolTip"},teasp.Tsf.ExpImport.prototype.show=function(e,t){teasp.Tsf.Error.showError(),this.fp.setReadOnly(e.ro),this.dialog||(this.fp.fcLoop(function(e){"ChargeDeptId__c"!=e.getApiKey()||tsfManager.isRequireChargeDept()||e.setNotUse(!0)},this),this.domHelper=new teasp.Tsf.Dom,this.dialog=new dijit.Dialog({
title:e.dialogTitle||"",className:"ts-dialog-exp-item"}),this.dialog.attr("content",this.getContent()),this.dialog.startup(),this.domHelper.connect(this.dialog,"onCancel",this,function(){this.hide()}),9==dojo.isIE&&this.domHelper.connect(this.dialog,"onKeyDown",this,function(e){return 13===e.keyCode&&dojo.stopEvent(e),!1})),this.entryExpItem=t,this.createInternalParticipantsNumberTooltip(),this.showData(e)},
teasp.Tsf.ExpImport.prototype.showData=function(e){var t=this.getFormEl(),s=(this.orgData=e,this.orgData.values),e=(this.expItemFilter={empExpItemClass:this.orgData.expItemClass,deptExpItemClass:s.ChargeDeptId__r&&s.ChargeDeptId__r.ExpItemClass__c||this.orgData.assist&&this.orgData.assist.ChargeDeptId__r&&this.orgData.assist.ChargeDeptId__r.ExpItemClass__c||null,
expenseType:this.orgData.assist&&this.orgData.assist.ExpenseType__c||null},this.fp.getElementByApiKey("ExpItemId__c",null,t)),e=(s.ExpItemId__c=this.loadExpItems(e),this.getDomHelper().connect(e,"onchange",this,this.changedExpItem),this.fp.getElementByApiKey("JobId__c",null,t)),a=(e&&(a=this.getValueByApiKey("EmpId__c",s,null),this.loadJobs(e,a),this.getDomHelper().connect(e,"onchange",this,this.changedJob)),
this.fp.getElementByApiKey("ChargeDeptId__c",null,t));if(a&&(this.loadChargeDepts(a),this.getDomHelper().connect(a,"onchange",this,this.changedChargeDept)),this.remarksAddMax=0,this.expImportRemarks&&1<this.orgData.data.records.length&&!this.orgData.isExternalExpense){for(var e=teasp.Tsf.Dom.node(".ts-row-detail div.ts-form-value",t),a=this.getDomHelper().create("label",null,e),e=this.getDomHelper().create("input",{
type:"checkbox"},a),o=(this.getDomHelper().create("span",{innerHTML:" "+teasp.message.getLabel("ci00000230")},a),e.checked=!0,this.getDomHelper().connect(e,"onclick",this,function(){this.checkedAddToRemarks()}),0),i=this.orgData.data.records,p=0;p<i.length;p++){var r=(i[p].Note__c||"")+" ";o<r.length&&(o=r.length)}this.remarksAddMax=Math.max(255-o,0),this.checkedAddToRemarks(t)}this.fp.fcLoop(function(e){
e.isApiField(!0)&&e.drawText(this.getDomHelper(),s)},this),this.showExtraItem(t),this.dialog.show()},teasp.Tsf.ExpImport.prototype.getDomHelper=function(){return this.domHelper},teasp.Tsf.ExpImport.prototype.getFormEl=function(){return teasp.Tsf.Dom.node(".ts-section-form",teasp.Tsf.Dom.byId(this.dialog.id))},teasp.Tsf.ExpImport.prototype.getValueByApiKey=function(e,t,s){e=this.fp.getFcByApiKey(e);if(!e)return s;
e=e.parseValue(t);return void 0===e.value||null===e.value?s:e.value},teasp.Tsf.ExpImport.prototype.hide=function(){this.dialog&&(this.dialog.hide(),this.domHelper.free(),this.dialog.destroy(),tsfManager.removeDialog("ExpImport"))},teasp.Tsf.ExpImport.prototype.getContent=function(){var e=this.getDomHelper().create("div",{className:"ts-dialog ts-exp-detail",style:"width:530px;"}),s=(this.getDomHelper().create("div",
null,this.getDomHelper().create("div",{className:"ts-error-area",style:"width:530px;display:none;"},e)),this.getDomHelper().create("div",{className:"ts-section-form"},e)),a=null,o=null;return this.fp.getFcByApiKey("ChargeDeptId__c").setRequired(2==tsfManager.isRequireChargeDept()?1:0),this.fp.fcLoop(function(e){var t;e.isHidden()?this.getDomHelper().create("input",{type:"hidden",id:e.getDomId()},s):(a&&a.isNoNL()||(
t="ts-form-row","ExtraItem1__c"==e.getApiKey()?t+=" ts-row-extra1":"ExtraItem2__c"==e.getApiKey()?t+=" ts-row-extra2":"JobId__c"==e.getApiKey()?t+=" ts-row-job":"Detail__c"==e.getApiKey()?t+=" ts-row-detail":"InternalParticipantsNumber__c"==e.getApiKey()||"InternalParticipants__c"==e.getApiKey()?(t+=" ts-row-intpart","InternalParticipantsNumber__c"==e.getApiKey(
)?t+=" ts-row-intpart-number":"InternalParticipants__c"==e.getApiKey()&&(t+=" ts-row-intpart-name",e.fc.height="90px")):"ExternalParticipantsNumber__c"==e.getApiKey()||"ExternalParticipants__c"==e.getApiKey()?(t+=" ts-row-extpart","ExternalParticipantsNumber__c"==e.getApiKey()?t+=" ts-row-extpart-number":"ExternalParticipants__c"==e.getApiKey()&&(t+=" ts-row-extpart-name",e.fc.height="90px")
):"PlaceName__c"!=e.getApiKey()&&"PlaceAddress__c"!=e.getApiKey()||(t+=" ts-row-place","PlaceName__c"==e.getApiKey()?t+=" ts-row-place-name":"PlaceAddress__c"==e.getApiKey()&&(t+=" ts-row-place-address")),o=this.getDomHelper().create("div",{className:t},s)),t=this.getDomHelper().create("div",{className:"ts-form-label"},o),e.getLw()&&teasp.Tsf.Dom.style(t,"width",e.getLw()),this.getDomHelper().create("div",{
innerHTML:e.getLabel()},t),(e.isRequired()||/ExtraItem.__c/.test(e.getApiKey()))&&this.getDomHelper().create("div",{className:"ts-require"},t),e.appendFieldDiv(this.getDomHelper(),o),a=e)},this),this.setEventExpItem(s),this.setEventJob(s),this.setEventDept(s),this.showExtraItem(s),this.setEventParticipant(s),teasp.Tsf.Dom.show(".ts-row-detail",s,this.expImportRemarks),this.createButtons(e),e},
teasp.Tsf.ExpImport.prototype.createButtons=function(e){var e=this.getDomHelper().create("div",{className:"ts-dialog-buttons"},e),e=this.getDomHelper().create("div",null,e),t=teasp.Tsf.Dialog.createButton(this.getDomHelper(),teasp.message.getLabel("tf10001510"),"ts-dialog-ok",e),e=teasp.Tsf.Dialog.createButton(this.getDomHelper(),teasp.message.getLabel("cancel_btn_title"),"ts-dialog-cancel",e);this.getDomHelper(
).connect(t,"onclick",this,this.ok),this.getDomHelper().connect(e,"onclick",this,this.hide)},teasp.Tsf.ExpImport.prototype.setEventExpItem=function(i){var e=this.fp.getElementByApiKey("ExpItemId__c",null,i);e&&(e=teasp.Tsf.Dom.getAncestorByCssName(e,"ts-form-row"))&&(e=teasp.Tsf.Dom.node("button.ts-form-find",e))&&this.getDomHelper().connect(e,"onclick",this,function(e){var t=[],s=tsfManager.getExpItems(
this.expItemFilter,!0),a="領収書"==this.orgData.recordType,o=tsfManager.getForeignByName(teasp.Tsf.JPY);dojo.forEach(s,function(e){e.isFixAmount()||a&&!e.isReceipt()||a&&e.isForeignFlag()||this.orgData.isExternalExpense&&e.isForeignFlag()&&!o||this.orgData.isExternalExpense&&e.isHideWhenReadingICExpenses()||t.push("'"+e.getId()+"'")},this),t.length||t.push("''"),tsfManager.showSearchListDialog({discernment:"expItems",
delay:!0,values:{Id:t.join(",")}},null,teasp.Tsf.Dom.hitch(this,function(e){e=e[0],e={ExpItemId__c:e.Id,ExpItemId__r:e};this.fp.getFcByApiKey("ExpItemId__c").drawText(this.getDomHelper(),e,null,i),this.showExtraItem()}))})},teasp.Tsf.ExpImport.prototype.setEventJob=function(o){var e=this.fp.getElementByApiKey("JobId__c",null,o);e&&(e=teasp.Tsf.Dom.getAncestorByCssName(e,"ts-form-row"))&&(e=teasp.Tsf.Dom.node(
"button.ts-form-find",e))&&this.getDomHelper().connect(e,"onclick",this,function(e){var t=teasp.util.date.formatDate(teasp.util.date.getToday()),s=this.getCurrentChargeDept(),s=s&&s.Id||this.orgData.assist&&this.orgData.assist.ChargeDeptId__c||this.orgData.defaultDeptId;tsfManager.showSearchListDialog({discernment:"jobs",dialog:"JobList",delay:!0,values:{_date:[t],DeptId__c:s,
_jobAssignClass:tsfManager.getEmpJobSearchCondition()}},null,teasp.Tsf.Dom.hitch(this,function(e){var s={},a=e[0];this.setImportJobs(a),dojo.forEach([{n:"JobId__r.JobCode__c",v:"JobCode__c"},{n:"JobId__r.StartDate__c",v:"StartDate__c"},{n:"JobId__r.EndDate__c",v:"EndDate__c"},{n:"JobId__r.Active__c",v:"Active__c"},{n:"JobId__c",v:"Id",d:"Name"}],function(e){var t=this.fp.getFcByApiKey(e.n);t.fillValue(s,{
value:a[e.v],nameValue:e.d?a[e.d]:null}),t.drawText(this.getDomHelper(),s,null,o)},this)}))})},teasp.Tsf.ExpImport.prototype.setEventDept=function(s){var e=this.fp.getElementByApiKey("ChargeDeptId__c",null,s);e&&(e=teasp.Tsf.Dom.getAncestorByCssName(e,"ts-form-row"))&&(e=teasp.Tsf.Dom.node("button.ts-form-find",e))&&this.getDomHelper().connect(e,"onclick",this,function(e){var t=teasp.util.date.formatDate(
teasp.util.date.getToday());tsfManager.showSearchListDialog({discernment:"depts",delay:!0,values:{_date:[t]}},null,teasp.Tsf.Dom.hitch(this,function(e){e=e[0],e={ChargeDeptId__c:e.Id,ChargeDeptId__r:{DeptCode__c:e.DeptCode__c,ExpItemClass__c:e.ExpItemClass__c,Name:e.Name}};tsfManager.getInfo().setCacheDept(e),this.fp.getFcByApiKey("ChargeDeptId__c").drawText(this.getDomHelper(),e,null,s),
this.expItemFilter.deptExpItemClass=e.ChargeDeptId__r.ExpItemClass__c||null,this.refreshExpItems()}))})},teasp.Tsf.ExpImport.prototype.setEventParticipant=function(e){dojo.forEach([this.fp.getElementByApiKey("InternalParticipantsNumber__c",null,e),this.fp.getElementByApiKey("ExternalParticipantsNumber__c",null,e)],function(e){this.getDomHelper().connect(e,"blur",this,this.changedparticipants),this.getDomHelper(
).connect(e,"onkeypress",this,function(e){""===e.keyChar&&13===e.keyCode&&(e.preventDefault(),e.stopPropagation(),this.changedparticipants(e))})},this)},teasp.Tsf.ExpImport.prototype.loadExpItems=function(t){var e=t.value||"",s={},a=(teasp.Tsf.Dom.empty(t),"領収書"==this.orgData.recordType),o=(this.getDomHelper().create("option",{value:"",innerHTML:""},t),tsfManager.getForeignByName(teasp.Tsf.JPY)),
i=tsfManager.getExpItems(this.expItemFilter),p=null;return dojo.forEach(i,function(e){e.isFixAmount()||a&&!e.isReceipt()||a&&e.isForeignFlag()||this.orgData.isExternalExpense&&e.isForeignFlag()&&!o||this.orgData.isExternalExpense&&e.isHideWhenReadingICExpenses()||(this.getDomHelper().create("option",{value:e.getId(),innerHTML:e.getName()},t),s[e.getId()]=1,p=p||e.getId())},this),t.value=e&&s[e]?e:"",t.value||p},
teasp.Tsf.ExpImport.prototype.refreshExpItems=function(){var e=this.fp.getElementByApiKey("ExpItemId__c",null,this.getFormEl());e&&this.loadExpItems(e)},teasp.Tsf.ExpImport.prototype.loadJobs=function(t,e){var s=tsfManager.getEmpJobAssigns();teasp.Tsf.Dom.empty(t),this.getDomHelper().create("option",{value:"",innerHTML:""},t),dojo.forEach(s,function(e){this.getDomHelper().create("option",{value:e.getId(),
innerHTML:e.getDisplayName()},t)},this)},teasp.Tsf.ExpImport.prototype.loadChargeDepts=function(e){var t;e&&(teasp.Tsf.Dom.empty(e),t=tsfManager.getDefaultChargeDept(),this.getDomHelper().create("option",{value:"",innerHTML:""},e),t.ChargeDeptId__c&&(this.getDomHelper().create("option",{value:t.ChargeDeptId__c,innerHTML:t.ChargeDeptId__r.DeptCode__c+" "+t.ChargeDeptId__r.Name},e),tsfManager.getInfo().setCacheDept(t))
)},teasp.Tsf.ExpImport.prototype.getCurrentExpItem=function(){return tsfManager.getExpItemById(this.fp.getFcByApiKey("ExpItemId__c").fetchValue().value)},teasp.Tsf.ExpImport.prototype.changedExpItem=function(e){this.showExtraItem()},teasp.Tsf.ExpImport.prototype.showExtraItem=function(e){var t=this.getCurrentExpItem(),s=e||this.getFormEl(),e=t&&t.isRequireChargeJob()||0,a=t&&t.isInternalParticipants()||!1,
o=t&&t.isExternalParticipants()||!1,i=t&&t.isPlace()||!1;teasp.Tsf.Dom.show(".ts-row-job",s,0<e),teasp.Tsf.Dom.show(".ts-row-job .ts-require",s,2==e),teasp.Tsf.Dom.show(".ts-row-intpart",s,a),teasp.Tsf.Dom.show(".ts-row-extpart",s,o),teasp.Tsf.Dom.show(".ts-row-place",s,i),a?(this.setInternalParticipants(t,t.getInternalParticipantsTemplateText()),this.setInternalParticipantsNumber(0)):(this.setInternalParticipants(t,
""),this.setInternalParticipantsNumber(null)),o?(this.setExternalParticipants(t,t.getExternalParticipantsTemplateText()),this.setExternalParticipantsNumber(0)):(this.setExternalParticipants(t,""),this.setExternalParticipantsNumber(null)),this.setPlaceName(""),this.setPlaceAddress("");for(var p=1;p<=2;p++){var r,n,l=t?t.getExtraItem(p):null;teasp.Tsf.Dom.show(".ts-row-extra"+p,s,!!l),l&&(r=teasp.Tsf.Dom.node(
".ts-row-extra"+p,s),(n=teasp.Tsf.Dom.node("div.ts-form-label > div",r))&&(n.innerHTML=l.name||"&nbsp;"),teasp.Tsf.Dom.show(".ts-require",r,l.require),(n=teasp.Tsf.Dom.node("div.ts-form-value > input",r))&&(n.style.width=Math.min(l.widthN,346)+"px",n.maxLength=l.maxLength))}},teasp.Tsf.ExpImport.prototype.changedJob=function(e){var t=this.getCurrentJob(),s=this.fp.getElementByApiKey("JobId__c",null,this.getFormEl()),
a=teasp.Tsf.Dom.nextSibling(s);a&&"INPUT"==a.tagName&&(a.value=t&&t.getName()||""),(s=this.fp.getElementByApiKey("JobId__r.JobCode__c",null,this.getFormEl()))&&(s.value=t&&t.getCode()||"")},teasp.Tsf.ExpImport.prototype.getCurrentJob=function(){var e=this.fp.getElementByApiKey("JobId__c",null,this.getFormEl()).value||null;if(e)for(var t=this.getJobChoices(),s=0;s<t.length;s++)if(t[s].getId()==e)return t[s];
return null},teasp.Tsf.ExpImport.prototype.getJobChoices=function(){var e=tsfManager.getEmpJobAssigns();return this.impJobs?e.concat(this.impJobs):e},teasp.Tsf.ExpImport.prototype.setImportJobs=function(e){for(var t=this.getJobChoices(),s=!1,a=0;a<t.length;a++)if(t[a].getId()==e.Id){s=!0;break}s||(this.impJobs=[new teasp.Tsf.Job(e)])},teasp.Tsf.ExpImport.prototype.changedChargeDept=function(e){
var t=this.getCurrentChargeDept(),s=this.fp.getElementByApiKey("ChargeDeptId__c",null,this.getFormEl()),a=teasp.Tsf.Dom.nextSibling(s);a&&"INPUT"==a.tagName&&(a.value=t&&t.Name||""),(s=this.fp.getElementByApiKey("ChargeDeptId__r.DeptCode__c",null,this.getFormEl()))&&(s.value=t&&t.DeptCode__c||""),this.expItemFilter.deptExpItemClass=t&&t.ExpItemClass__c||null,this.refreshExpItems()},
teasp.Tsf.ExpImport.prototype.getCurrentChargeDept=function(){var e=this.fp.getElementByApiKey("ChargeDeptId__c",null,this.getFormEl());return e&&tsfManager.getInfo().getCacheDept(e.value||null)||null},teasp.Tsf.ExpImport.prototype.showError=function(e){var t=teasp.Tsf.Dom.node(".ts-error-area",teasp.Tsf.Dom.byId(this.dialog.id));teasp.Tsf.Error.showError(e,t)},teasp.Tsf.ExpImport.prototype.ok=function(e){if(
this.entryExpItem){var t=this.getCurrentExpItem();if(!t)return void this.showError(teasp.message.getLabel("tf10001680"));var s={};if(this.fp.fcLoop(function(e){e.isApiField(!0)&&e.fillValue(s,e.fetchValue())},this),t.isInternalParticipants()&&t.isExternalParticipants()){if(0==+s.InternalParticipantsNumber__c&&0==+s.ExternalParticipantsNumber__c)return this.showError(teasp.message.getLabel("tf10001851")),null;if(
+s.InternalParticipantsNumber__c<0||+s.ExternalParticipantsNumber__c<0)return this.showError(teasp.message.getLabel("tf10001852")),null}else if(t.isInternalParticipants()&&!t.isExternalParticipants()){if(+s.InternalParticipantsNumber__c<=0)return this.showError(teasp.message.getLabel("tf10001854")),null}else if(!t.isInternalParticipants()&&t.isExternalParticipants()&&+s.ExternalParticipantsNumber__c<=0
)return this.showError(teasp.message.getLabel("tf10001855")),null;t.isInternalParticipants()||(s.InternalParticipantsNumber__c=null,s.InternalParticipants__c=null),t.isExternalParticipants()||(s.ExternalParticipantsNumber__c=null,s.ExternalParticipants__c=null),t.isPlace()||(s.PlaceName__c=null,s.PlaceAddress__c=null);var a=t.isRequireChargeJob();if(2==a&&!s.JobId__c)return void this.showError(teasp.message.getLabel(
"tf10001710"));var o=tsfManager.isRequireChargeDept();if(2==o&&!s.ChargeDeptId__c)return void this.showError(teasp.message.getLabel("tf10006030"));var i={},o=(0<o&&(i.Id=s.ChargeDeptId__c||null,s.ChargeDeptId__r&&(i.DeptCode__c=s.ChargeDeptId__r.DeptCode__c||null,i.Name=s.ChargeDeptId__r.Name||null)),t.getExtraItem(1));if(o){if(o.require&&!s.ExtraItem1__c)return this.showError(teasp.message.getLabel("tf10001840",
o.name)),null}else s.ExtraItem1__c=null;if(o&&s.ExtraItem1__c&&o.maxLength<s.ExtraItem1__c.length)return void this.showError(teasp.message.getLabel("tm00000020",o.name,o.maxLength));o=t.getExtraItem(2);if(o){if(o.require&&!s.ExtraItem2__c)return this.showError(teasp.message.getLabel("tf10001840",o.name)),null}else s.ExtraItem2__c=null;if(o&&s.ExtraItem2__c&&o.maxLength<s.ExtraItem2__c.length
)return void this.showError(teasp.message.getLabel("tm00000020",o.name,o.maxLength));var p=!1,o=teasp.Tsf.Dom.node('.ts-row-detail div.ts-form-value input[type="checkbox"]',this.getFormEl()),r=(o&&(p=o.checked),null);if(this.expImportRemarks&&(r=(s.Detail__c||"").replace(/\r?\n/g," "),p&&r.length>this.remarksAddMax||255<r.length))return this.showError(teasp.message.getLabel("ci00000240",teasp.message.getLabel(
"note_caption"),p?this.remarksAddMax:255)),null;var n=0<a?this.getCurrentJob():null,l=this.orgData.data,c=this.orgData.expApply,m=[],d={};this.orgData.isExternalExpense&&(l.records=l.records.sort(function(e,t){return e.UsageDate__c==t.UsageDate__c?e.RegistrationDate__c<t.RegistrationDate__c?-1:1:e.UsageDate__c<t.UsageDate__c?-1:1}));for(var h=0;h<l.records.length;h++){var f=l.records[h];this.expImportRemarks&&(
f.Note__c=p?(f.Note__c||"")+(r.length?" "+r:""):r),f.InternalParticipantsNumber__c=s.InternalParticipantsNumber__c,f.InternalParticipants__c=s.InternalParticipants__c,f.ExternalParticipantsNumber__c=s.ExternalParticipantsNumber__c,f.ExternalParticipants__c=s.ExternalParticipants__c,f.PlaceName__c=s.PlaceName__c,f.PlaceAddress__c=s.PlaceAddress__c,this.orgData.isExternalExpense?m.push(
c.createEmpExpFromExternalExpense(t,n,i,s.ExtraItem1__c,s.ExtraItem2__c,f,this.orgData.expenseType||null,d)):m.push(c.createEmpExpFromCard(t,n,i,s.ExtraItem1__c,s.ExtraItem2__c,f,this.orgData.expenseType||null,d))}if(d.f)return void this.showError(d.f.message);c.addEmpExps(m),this.entryExpItem()}this.hide()},teasp.Tsf.ExpImport.prototype.checkedAddToRemarks=function(e){var e=e||this.getFormEl(),e=teasp.Tsf.Dom.node(
".ts-row-detail div.ts-form-value",e),t=teasp.Tsf.Dom.node('input[type="checkbox"]',e),e=teasp.Tsf.Dom.node("textarea",e);teasp.Tsf.Dom.setAttr(e,"maxLength",t.checked?this.remarksAddMax:255)},teasp.Tsf.ExpImport.prototype.changedparticipants=function(e){var t=this.getCurrentExpItem();this.setInternalParticipantsNumber(this.getInternalParticipantsNumber(t)),this.setExternalParticipantsNumber(
this.getExternalParticipantsNumber(t))},teasp.Tsf.ExpImport.prototype.getInternalParticipantsNumber=function(e,t){var s=this.fp.getFcByApiKey("InternalParticipantsNumber__c").fetchValue().value;if(t&&(null===s||""==s))return null;t=teasp.util.currency.string2number(""+s);return parseInt(t.sn1)},teasp.Tsf.ExpImport.prototype.setInternalParticipantsNumber=function(e){var t=this.fp.getElementByApiKey(
"InternalParticipantsNumber__c",this.getFormEl());t&&(t.value=e)},teasp.Tsf.ExpImport.prototype.getInternalParticipants=function(){return this.fp.getFcByApiKey("InternalParticipants__c").fetchValue().value||null},teasp.Tsf.ExpImport.prototype.setInternalParticipants=function(e,t){var s=this.fp.getElementByApiKey("InternalParticipants__c",this.getFormEl());s&&(s.value=t)},
teasp.Tsf.ExpImport.prototype.getExternalParticipantsNumber=function(e,t){var s=this.fp.getFcByApiKey("ExternalParticipantsNumber__c").fetchValue().value;if(t&&(null===s||""==s))return null;t=teasp.util.currency.string2number(""+s);return parseInt(t.sn1)},teasp.Tsf.ExpImport.prototype.setExternalParticipantsNumber=function(e){var t=this.fp.getElementByApiKey("ExternalParticipantsNumber__c",this.getFormEl());t&&(
t.value=e)},teasp.Tsf.ExpImport.prototype.getExternalParticipants=function(e){return this.fp.getFcByApiKey("ExternalParticipants__c").fetchValue().value||null},teasp.Tsf.ExpImport.prototype.setExternalParticipants=function(e,t){var s=this.fp.getElementByApiKey("ExternalParticipants__c",this.getFormEl());s&&(s.value=t)},teasp.Tsf.ExpImport.prototype.setPlaceName=function(e){var t=this.fp.getElementByApiKey(
"PlaceName__c",this.getFormEl());t&&(t.value=e)},teasp.Tsf.ExpImport.prototype.setPlaceAddress=function(e){var t=this.fp.getElementByApiKey("PlaceAddress__c",this.getFormEl());t&&(t.value=e)},teasp.Tsf.ExpImport.prototype.createInternalParticipantsNumberTooltip=function(){this.getDomHelper().freeBy(this.EXPITEM_INTERNALPARTICIPANT_TOOLTIP_HKEY);var e=this.fp.getElementByApiKey("InternalParticipantsNumber__c",null,
this.getFormEl());e&&this.getDomHelper().createTooltip({connectId:e.parentNode,label:teasp.message.getLabel("tf10001853"),position:["before"],showDelay:100},this.EXPITEM_INTERNALPARTICIPANT_TOOLTIP_HKEY)},teasp.Tsf.SearchList=function(){},teasp.Tsf.SearchList.prototype=new teasp.Tsf.ListBase,teasp.Tsf.SearchList.prototype.init=function(e){this.fp=teasp.Tsf.Fp.createFp(e),this.showInit=!1},
teasp.Tsf.SearchList.prototype.getArea=function(){return teasp.Tsf.Dom.byId(this.dialog.id)},teasp.Tsf.SearchList.prototype.getListArea=function(){return teasp.Tsf.Dom.node("table.ts-list-body",this.getArea())},teasp.Tsf.SearchList.prototype.getFp=function(){return this.fp},teasp.Tsf.SearchList.prototype.show=function(e,t){teasp.Tsf.Error.showError(),this.dialog||(this.discernment=e.discernment,
this.domHelper=new teasp.Tsf.Dom,this.dialog=new dijit.Dialog({title:e.title||this.fp.getTitle(),className:this.fp.getFormCss()}),this.dialog.attr("content",this.getContent()),this.dialog.startup(),this.domHelper.connect(this.dialog,"onCancel",this,function(){this.hide()}),9==dojo.isIE&&this.domHelper.connect(this.dialog,"onKeyDown",this,function(e){return 13===e.keyCode&&dojo.stopEvent(e),!1})),this.callback=t,
this.orgData=e||{},this.orgData.delay?(this.records=[],this.recordCount=0,this.drawData(),this.showDataEnd(),setTimeout(teasp.Tsf.Dom.hitch(this,this.search),100)):this.showData()},teasp.Tsf.SearchList.prototype.showDataEnd=function(){var t,e;this.showInit||(t=this.orgData.values||{},this.fp.searchFcLoop(function(e){e.getApiKey()&&e.drawText(this.getDomHelper(),t)},this),e=dojo.style(teasp.Tsf.Dom.node(
"div.ts-search-list-box",this.getArea()),"width"),dojo.style(teasp.Tsf.Dom.node("div.ts-section-form",this.getArea()),"width",e+"px"),this.dialog.show(),this.showInit=!0),teasp.Tsf.ListBase.prototype.showDataEnd.call(this)},teasp.Tsf.SearchList.prototype.isShowInit=function(){return this.showInit},teasp.Tsf.SearchList.prototype.hide=function(){this.dialog&&(this.dialog.hide(),this.domHelper.free(),
this.dialog.destroy(),tsfManager.removeSearchListDialog(this.discernment))},teasp.Tsf.SearchList.prototype.getContent=function(){var e=this.getDomHelper().create("div",{className:"ts-dialog ts-search-list"});return this.createScrollTable(e),e},teasp.Tsf.SearchList.prototype.setSearchContent=function(e){var s,a,o;0<this.fp.getSearchFields().length&&(s=this.getDomHelper().create("div",{className:"ts-section-form"},e),
o=a=null,this.fp.searchFcLoop(function(e){var t;e.isHidden()?this.getDomHelper().create("input",{type:"hidden",id:e.getDomId()},s):(a&&a.isNoNL()||(o=this.getDomHelper().create("div",{className:"ts-form-row"},s)),t=this.getDomHelper().create("div",{className:"ts-form-label"},o),e.getLw()&&teasp.Tsf.Dom.style(t,"width",e.getLw()),this.getDomHelper().create("div",{innerHTML:e.getLabel()},t),e.appendFieldDiv(
this.getDomHelper(),o),a=e)},this),e=this.getDomHelper().create("button",null,this.getDomHelper().create("div",{className:"ts-search-button"},o)),teasp.Tsf.Dom.append(e,this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("search_btn_title")})),this.getDomHelper().connect(e,"onclick",this,this.search),this.setEventHandler(s))},teasp.Tsf.SearchList.prototype.setEventHandler=function(e){
teasp.Tsf.Dom.query(".ts-form-cal",e).forEach(function(e){var t=teasp.Tsf.Dom.node('div.ts-form-date > input[type="text"]',e.parentNode.parentNode);t&&tsfManager.eventOpenCalendar(this.getDomHelper(),e,t,{tagName:t.name,isDisabledDate:function(e){return!1}})},this),teasp.Tsf.Dom.query(".ts-form-currency input",e).forEach(function(e){teasp.Tsf.Currency.eventInput(this.getDomHelper(),e,teasp.Tsf.Dom.hitch(this,
this.changedCurrency))},this)},teasp.Tsf.SearchList.prototype.createButtons=function(e){var t,s,e=this.getDomHelper().create("div",{className:"ts-dialog-buttons"},e),a=this.getDomHelper().create("div",null,e),e=this.getButtons();e.length<=0&&(t=teasp.Tsf.Dialog.createButton(this.getDomHelper(),teasp.message.getLabel("ok_btn_title"),"ts-dialog-ok",a),s=teasp.Tsf.Dialog.createButton(this.getDomHelper(),
teasp.message.getLabel("cancel_btn_title"),"ts-dialog-cancel",a),this.getDomHelper().connect(t,"onclick",this,this.ok),this.getDomHelper().connect(s,"onclick",this,this.hide)),dojo.forEach(e,function(s){var e,t;"close"==s.key?(t=teasp.Tsf.Dialog.createButton(this.getDomHelper(),s.label||teasp.message.getLabel(s.labelId),"ts-dialog-cancel",a),this.getDomHelper().connect(t,"onclick",this,this.hide)):(
e=this.option[s.key]&&"function"==typeof this.option[s.key]?"":"-disabled",t=teasp.Tsf.Dialog.createButton(this.getDomHelper(),s.label||teasp.message.getLabel(s.labelId),(s.css||"ts-dialog-ok")+e,a),e?t.disabled=!0:this.getDomHelper().connect(t,"onclick",this,function(e){var t={id:this.orgData.id,cancelLabel:this.orgData.cancelLabel,records:this.collectRecords(),dialogTitle:this.option.dialogTitle};this.showError(),
this.option[s.key](t,teasp.Tsf.Dom.hitch(this,this.hide),teasp.Tsf.Dom.hitch(this,this.showError))}))},this)},teasp.Tsf.SearchList.prototype.getButtons=function(e){return this.fp.getButtons()},teasp.Tsf.SearchList.prototype.getCheckboxHead=function(e){return teasp.Tsf.Dom.node("table.ts-list-head thead",this.getArea())},teasp.Tsf.SearchList.prototype.drawData=function(e){this.getDomHelper().freeBy(this.reskey);
var t=e||teasp.Tsf.Dom.node("tbody",this.getListArea()),s=(teasp.Tsf.Dom.empty(t),this.fp.getRowLimit());this.records.length<s&&(s=Math.max(this.fp.getRowDisp(),this.records.length));for(var a=0;a<s;a++){var o=this.getDomHelper().create("tr",null,t),i=(teasp.Tsf.Dom.toggleClass(o,"ts-row-even",!(a%2)),teasp.Tsf.Dom.toggleClass(o,"ts-row-odd",a%2),teasp.Tsf.Fp.setHkey(this.getDomHelper(),o)),p=(this.fp.fcLoop(
function(e){e.isHidden()?this.getDomHelper().create("input",{type:"hidden",id:e.getDomId(i)},o):e.appendFieldCell(this.getDomHelper(),o,i)},this),this.getDomHelper().create("td",{className:"last",style:"width:16px;display:none;"},o),a<this.records.length?this.records[a]:{});this.fp.fcLoop(function(e){var t;"route"!=e.getDomType()||p._route||(p._route=new teasp.Tsf.EmpExp(p,!1,!0)),e.drawText(this.getDomHelper(),p,i,o
),e.isLinkAttachments()&&p.Attachments&&0<p.Attachments.length?(t=teasp.Tsf.Dom.query(".ts-form-children .pp_ico_receipt_r",o),this.getDomHelper().connect(t,"onclick",this,this.openAttach)):e.isLink()&&!this.notOpenLink&&p.Id&&this.getDomHelper().connect(teasp.Tsf.Dom.query("a",o),"onclick",this,this.openLink,this.reskey)},this),a<this.records.length?(o.style.cursor="pointer",this.getDomHelper().connect(o,"onclick",
this,this.clickTr,this.reskey)):o.style.cursor="default"}e=teasp.Tsf.Dom.node("div.ts-search-list-box",this.getArea());e&&(e.scrollTop=0),teasp.Tsf.ListBase.setPaging({pageNo:this.pageNo,cntAll:this.recordCount,rowLimit:this.fp.getRowLimit()},teasp.Tsf.Dom.node(".ts-list-paging",this.getArea()),this.getDomHelper(),"paging",this)},teasp.Tsf.SearchList.prototype.search=function(e){var s={},a=[];this.fp.searchFcLoop(
function(e){var t;e.getApiKey()&&(t=e.fetchValues(),e.fillValue(s,t),(t[0].value||1<t.length&&t[1].value||t[0].array||e.isNullSpec())&&e.setFilts(a,t))},this),this.setFreeFilts(a),this.refresh()},teasp.Tsf.SearchList.prototype.collectData=function(){var o=[],e=teasp.Tsf.Dom.node("tbody",this.getListArea());return teasp.Tsf.Dom.query("input.ts-check",e).forEach(function(e){var t,s,a;e.checked&&(
e=teasp.Tsf.Dom.getAncestorByTagName(e,"TR"),t=teasp.Tsf.Fp.getHkey(e),s={},this.fp.fcLoop(function(e){e.getApiKey()&&e.fillValue(s,e.fetchValue(t))},this),e=this.fp.getFcByApiKey("Id").fetchValue(t),a=this.fp.getFcByApiKey("Name").fetchValue(t),s.value=e.value,s.dispValue=a.value,s.nameValue=a.value,o.push(s))},this),o},teasp.Tsf.SearchList.prototype.openLink=function(e){var e=teasp.Tsf.Dom.getAncestorByTagName(
e.target,"TR");e&&(e=teasp.Tsf.Fp.getHkey(e),(e=this.fp.getFcByApiKey("Id").fetchValue(e).value)&&(teasp.isSforce1()?sforce.one.navigateToURL("/"+e):window.open("/"+e)))},teasp.Tsf.SearchList.prototype.openAttach=function(e){var e=teasp.Tsf.Dom.getAncestorByTagName(e.target,"TR");e&&(e=teasp.Tsf.Fp.getHkey(e),e=this.fp.getFcByApiKey("Id").fetchValue(e).value,(e=this.getRecordById(e)
)&&e.Attachments&&0<e.Attachments.length&&(e=teasp.getPageUrl("empRefView")+"?id="+e.Attachments[0].Id+"&parentId="+e.Attachments[0].ParentId,teasp.isSforce1()?sforce.one.navigateToURL(e):(e=window.open(e,"attachment","width=700,height=600,resizable=yes,scrollbars=yes"))&&e.focus()))},teasp.Tsf.SearchList.prototype.collectRecords=function(){var e=this.collectData(),t=[];return dojo.forEach(e,function(e){
e=this.getRecordById(e.value);e&&t.push(e)},this),t},teasp.Tsf.SearchList.prototype.getRecordById=function(e){for(var t=0;t<this.records.length;t++)if(this.records[t].Id==e)return this.records[t];return null},teasp.Tsf.SearchList.prototype.ok=function(e){var t=this.collectData();t.length<=0||(this.callback&&this.callback(t),this.hide())},teasp.Tsf.ProcessInstanceSteps=function(){},
teasp.Tsf.ProcessInstanceSteps.prototype=new teasp.Tsf.SearchList,teasp.Tsf.ProcessInstanceSteps.prototype.show=function(e,t){this.cancelLabel=e.cancelLabel,teasp.Tsf.SearchList.prototype.show.call(this,e,t)},teasp.Tsf.ProcessInstanceSteps.prototype.getButtons=function(e){return[{key:"cancelCallback",label:this.cancelLabel||teasp.message.getLabel("cancelApply_btn_title"),css:"ts-cancel-apply"},{key:"close",
label:teasp.message.getLabel("close_btn_title")}]},teasp.Tsf.ProcessInstanceSteps.prototype.createButtons=function(e){var t;teasp.Tsf.SearchList.prototype.createButtons.call(this,e),e=teasp.isAndroid()&&teasp.isOnlyNarrow()?(t=teasp.Tsf.Dom.node("div.ts-dialog-buttons > div",e),teasp.Tsf.Dialog.createButton(this.getDomHelper(),teasp.message.getLabel("tf10001560"),"ts-dialog-cancel",t)):(e=teasp.Tsf.Dom.node(
"div.ts-dialog-buttons",e),t=this.getDomHelper().create("div",{className:"ts-edge-right"},e),t=this.getDomHelper().create("div",null,t),teasp.Tsf.Dialog.createButton(this.getDomHelper(),teasp.message.getLabel("tf10001560"),null,t)),this.getDomHelper().connect(e,"onclick",this,this.openStandardView)},teasp.Tsf.ProcessInstanceSteps.prototype.drawData=function(e){
this.orgData&&this.orgData.expApply&&this.orgData.expApply.mergeSteps&&(this.recordCount=this.records.length),teasp.Tsf.SearchList.prototype.drawData.call(this,e)},teasp.Tsf.ProcessInstanceSteps.prototype.showDataEnd=function(){teasp.Tsf.SearchList.prototype.showDataEnd.call(this);var e,t=teasp.Tsf.Dom.node("div.ts-dialog-buttons",this.getArea()),s=teasp.Tsf.Dom.node("button.ts-cancel-apply > div",t
)||teasp.Tsf.Dom.node("button.ts-cancel-apply-disabled > div",t);s&&(s.innerHTML=this.orgData.cancelLabel||teasp.message.getLabel("cancelApply_btn_title")),this.orgData.cancelApplyId&&(e=(e=teasp.Tsf.Dom.node("div.ts-edge-right",t))?(teasp.Tsf.Dom.style(t,"margin-bottom","28px"),s=this.getDomHelper().create("div",null,e),teasp.Tsf.Dialog.createButton(this.getDomHelper(),teasp.message.getLabel("tf10006240"),null,s)):(
s=teasp.Tsf.Dom.node("div",t),teasp.Tsf.Dialog.createButton(this.getDomHelper(),teasp.message.getLabel("tf10006240"),"ts-dialog-cancel",s)),this.getDomHelper().connect(e,"onclick",this,this.openCancelApplyStandardView))},teasp.Tsf.ProcessInstanceSteps.prototype.openStandardView=function(e){this.orgData.id&&(teasp.isSforce1()?sforce.one.navigateToURL("/"+this.orgData.id):window.open("/"+this.orgData.id))},
teasp.Tsf.ProcessInstanceSteps.prototype.openCancelApplyStandardView=function(e){this.orgData.cancelApplyId&&(teasp.isSforce1()?sforce.one.navigateToURL("/"+this.orgData.cancelApplyId):window.open("/"+this.orgData.cancelApplyId))},teasp.Tsf.PayOption=function(){this.fp=teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.payOption)},teasp.Tsf.PayOption.prototype.show=function(e,t){teasp.Tsf.Error.showError(),
this.domHelper=new teasp.Tsf.Dom,this.dialog=new dijit.Dialog({title:teasp.message.getLabel("tk10000762"),className:"ts-dialog-pay-execute"}),this.dialog.attr("content",this.getContent(e)),this.dialog.startup(),this.domHelper.connect(this.dialog,"onCancel",this,function(){this.hide()}),this.setPaid=t,this.showData(e)},teasp.Tsf.PayOption.prototype.showData=function(e){var t,s=this.getFormEl(),a=(this.orgData=e,
this.orgData.values||{}),e=(a.payDate=teasp.util.date.formatDate(teasp.util.date.getToday()),this.fp.getElementByApiKey("expItemId",null,s)),e=(this.loadPayItems(e),e&&this.getDomHelper().connect(e,"onchange",this,this.changedPayItem),e=this.fp.getElementByApiKey("sourceAccountId",null,s),this.loadZgAccounts(e),this.fp.fcLoop(function(e){e.isApiField(!0)&&e.drawText(this.getDomHelper(),a)},this),
this.fp.getFcByApiKey("payMethod")),o=e.getElement(null,s);o&&(t=teasp.Tsf.Dom.getAncestorByCssName(o,"ts-form-row"),teasp.Tsf.Dom.show(t,null,"1"==this.orgData.listType||this.isOutputJournal())),(o=(e=this.fp.getFcByApiKey("outputJournal")).getElement(null,s))&&(t=teasp.Tsf.Dom.getAncestorByCssName(o,"ts-form-row"),e=tsfManager.getInfo().getCommon().isUseExpEntryData(),s=tsfManager.getInfo().getCommon(
).getExpEntryDataUrl(),teasp.Tsf.Dom.show(t,null,e&&s)),this.showSourceAccount(),this.changedPayItem(),this.dialog.show()},teasp.Tsf.PayOption.prototype.getDomHelper=function(){return this.domHelper},teasp.Tsf.PayOption.prototype.getFormEl=function(){return teasp.Tsf.Dom.node(".ts-section-form",teasp.Tsf.Dom.byId(this.dialog.id))},teasp.Tsf.PayOption.prototype.getValueByApiKey=function(e,t,s){e=this.fp.getFcByApiKey(
e);if(!e)return s;e=e.parseValue(t);return void 0===e.value||null===e.value?s:e.value},teasp.Tsf.PayOption.prototype.fetchValueByApiKey=function(e){return this.fp.getFcByApiKey(e).fetchValue().value},teasp.Tsf.PayOption.prototype.setValueByApiKey=function(e,t){this.fp.getFcByApiKey(e).textOut(this.getDomHelper(),null,t)},teasp.Tsf.PayOption.prototype.hide=function(){this.dialog&&(this.dialog.hide(),
this.domHelper.free(),this.dialog.destroy(),tsfManager.removeDialog("PayOption"))},teasp.Tsf.PayOption.prototype.getContent=function(e){var s,t=this.getDomHelper().create("div",{className:"ts-dialog ts-exp-detail",style:"width:462px;"}),a=(this.getDomHelper().create("div",null,this.getDomHelper().create("div",{className:"ts-error-area",style:"width:462px;display:none;"},t)),this.getDomHelper().create("div",{
className:"ts-section-form"},t));return this.fp.fcLoop(function(e){var t;e.isHidden()?this.getDomHelper().create("input",{type:"hidden",id:e.getDomId()},a):(s=this.getDomHelper().create("div",{className:"ts-form-row"},a),t=this.getDomHelper().create("div",{className:"ts-form-label"},s),e.getLw()&&teasp.Tsf.Dom.style(t,"width",e.getLw()),this.getDomHelper().create("div",{innerHTML:e.getLabel()},t),e.isRequired(
)&&this.getDomHelper().create("div",{className:"ts-require"},t),e.appendFieldDiv(this.getDomHelper(),s))},this),this.showPayItemSelect(a),this.setEventHandler(a),tsfManager.getInfo().getCommon().isUseScannerStorage()&&"4"!=e.listType&&(this.getDomHelper().create("div",{className:"ts-alert-output",style:"width:462px;"},t).innerHTML=teasp.message.getLabel("ex00001180")),this.createButtons(t),t},
teasp.Tsf.PayOption.prototype.isOutputJournal=function(e){return tsfManager.isOutputJournal()&&0<tsfManager.getPayItems().length},teasp.Tsf.PayOption.prototype.showPayItemSelect=function(e){var e=this.fp.getFcByApiKey("expItemId").getElement(null,e);e&&(e=teasp.Tsf.Dom.getAncestorByCssName(e,"ts-form-row"),teasp.Tsf.Dom.show(e,null,this.isOutputJournal()))},teasp.Tsf.PayOption.prototype.showSourceAccount=function(e){
var t=this.fp.getFcByApiKey("sourceAccountId").getElement(null,this.getFormEl()),s=this.fetchValueByApiKey("zgDataCheck");t&&(t=teasp.Tsf.Dom.getAncestorByCssName(t,"ts-form-row"),teasp.Tsf.Dom.show(t,null,s))},teasp.Tsf.PayOption.prototype.createButtons=function(e){var e=this.getDomHelper().create("div",{className:"ts-dialog-buttons"},e),e=this.getDomHelper().create("div",null,e),t=teasp.Tsf.Dialog.createButton(
this.getDomHelper(),teasp.message.getLabel("ok_btn_title"),"ts-dialog-ok",e),e=teasp.Tsf.Dialog.createButton(this.getDomHelper(),teasp.message.getLabel("cancel_btn_title"),"ts-dialog-cancel",e);this.getDomHelper().connect(t,"onclick",this,this.ok),this.getDomHelper().connect(e,"onclick",this,this.hide)},teasp.Tsf.PayOption.prototype.setEventHandler=function(e){teasp.Tsf.Dom.query(".ts-form-cal",e).forEach(function(e
){var t=teasp.Tsf.Dom.node('input[type="text"]',e.parentNode.parentNode);t&&tsfManager.eventOpenCalendar(this.getDomHelper(),e,t,{tagName:t.name,isDisabledDate:function(e){return!1}})},this);var t=this.fp.getFcByApiKey("zgDataCheck").getElement(null,e);"INPUT"==t.tagName&&this.getDomHelper().connect(t,"onclick",this,this.showSourceAccount),teasp.Tsf.Dom.setlimitChars(this.getDomHelper(),teasp.Tsf.Dom.query("textarea"
,e),this.fp)},teasp.Tsf.PayOption.prototype.loadPayItems=function(t){teasp.Tsf.Dom.empty(t),this.getDomHelper().create("option",{value:"",innerHTML:""},t),dojo.forEach(tsfManager.getPayItems(),function(e){e.isRemoved()||this.getDomHelper().create("option",{value:e.getId(),innerHTML:e.getName()},t)},this)},teasp.Tsf.PayOption.prototype.changedPayItem=function(e){var t=this.fp.getElementByApiKey("expItemId",null,
this.getFormEl()),s=(this.getDomHelper().freeBy(this.EXPITEM_TOOLTIP_HKEY),this.getCurrentExpItem()),s=s?s.getToolTip(!0):teasp.message.getLabel("tf10001680");this.getDomHelper().createTooltip({connectId:t.parentNode,label:s,position:["after"],showDelay:100},this.EXPITEM_TOOLTIP_HKEY)},teasp.Tsf.PayOption.prototype.getCurrentExpItem=function(){for(var e=this.fp.getElementByApiKey("expItemId",null,this.getFormEl()),
t=0;t<tsfManager.getPayItems().length;t++){var s=tsfManager.getPayItems()[t];if(s.getId()==e.value)return s}return null},teasp.Tsf.PayOption.prototype.loadZgAccounts=function(t){teasp.Tsf.Dom.empty(t),this.getDomHelper().create("option",{value:"",innerHTML:""},t),dojo.forEach(tsfManager.getZgAccounts(),function(e){this.getDomHelper().create("option",{value:e.getId(),innerHTML:e.getName()},t)},this)},
teasp.Tsf.PayOption.prototype.showCalendar=function(){var e=this.fp.getElementByApiKey("Date__c",null,this.getFormEl()),e=teasp.Tsf.Dom.getAncestorByCssName(e,"ts-form-row"),e=teasp.Tsf.Dom.node("button.ts-form-cal",e);e&&teasp.Tsf.Dom.pushEvent(e,"onclick")},teasp.Tsf.PayOption.prototype.showError=function(e){var t=teasp.Tsf.Dom.node(".ts-error-area",teasp.Tsf.Dom.byId(this.dialog.id));teasp.Tsf.Error.showError(e,t)
},teasp.Tsf.PayOption.prototype.ok=function(e){if(this.setPaid){var t=this.isOutputJournal();if(t){var s=this.fp.getFcByApiKey("expItemId").fetchValue().value;if(tsfManager.isOutputJournal()&&!s)return void this.showError(teasp.message.getLabel("tf10001730"))}var a={};if(this.fp.fcLoop(function(e){e.isApiField(!0)&&e.fillValue(a,e.fetchValue())},this),t||(a.expItemId=null),!a.payDate)return void this.showError(
teasp.message.getLabel("tf10001740"));if(a.zgDataCheck&&!a.sourceAccountId)return void this.showError(teasp.message.getLabel("tf10001750"));this.setPaid({hkey:this.orgData.hkey,ids:this.orgData.ids,values:a})}this.hide()},teasp.Tsf.ApplyCommuterPass=function(){this.fp=teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.commuterPass),this.cache={}},teasp.Tsf.ApplyCommuterPass.prototype.show=function(e,t){
teasp.Tsf.Error.showError(),this.domHelper=new teasp.Tsf.Dom,this.dialog=new dijit.Dialog({title:teasp.message.getLabel("tf10000200"),className:"ts-dialog-commuter-pass"}),this.dialog.attr("content",this.getContent()),this.dialog.startup(),this.domHelper.connect(this.dialog,"onCancel",this,function(){this.hide()}),9==dojo.isIE&&this.domHelper.connect(this.dialog,"onKeyDown",this,function(e){
return 13===e.keyCode&&dojo.stopEvent(e),!1}),this.submitApply=t,this.showData(e)},teasp.Tsf.ApplyCommuterPass.prototype.showData=function(e){this.orgData=e;var t=this.orgData.values||{};this.fp.fcLoop(function(e){e.isApiField(!0)&&e.drawText(this.getDomHelper(),t)},this),t.startDate&&t.routeCode&&(this.cache[t.startDate]=t.routeCode||"*"),this.changePurpose(),this.dialog.show()},
teasp.Tsf.ApplyCommuterPass.prototype.getDomHelper=function(){return this.domHelper},teasp.Tsf.ApplyCommuterPass.prototype.getFormEl=function(){return teasp.Tsf.Dom.node(".ts-section-form",teasp.Tsf.Dom.byId(this.dialog.id))},teasp.Tsf.ApplyCommuterPass.prototype.fetchValueByApiKey=function(e){return this.fp.getFcByApiKey(e).fetchValue().value},teasp.Tsf.ApplyCommuterPass.prototype.hide=function(){this.dialog&&(
this.dialog.hide(),this.domHelper.free(),this.dialog.destroy(),tsfManager.removeDialog("ApplyCommuterPass"))},teasp.Tsf.ApplyCommuterPass.prototype.getContent=function(){var s,e=this.getDomHelper().create("div",{className:"ts-dialog ts-exp-detail",style:"width:500px;"}),a=(this.getDomHelper().create("div",null,this.getDomHelper().create("div",{className:"ts-error-area",style:"width:500px;display:none;"},e)),
this.getDomHelper().create("div",{className:"ts-section-form"},e));return this.fp.fcLoop(function(e){var t;e.isHidden()?this.getDomHelper().create("input",{type:"hidden",id:e.getDomId()},a):(s=this.getDomHelper().create("div",{className:"ts-form-row"},a),t=this.getDomHelper().create("div",{className:"ts-form-label"},s),e.getLw()&&teasp.Tsf.Dom.style(t,"width",e.getLw()),this.getDomHelper().create("div",{
innerHTML:e.getLabel()},t),e.appendFieldDiv(this.getDomHelper(),s),"routeDescription"==e.getApiKey()&&(t=this.getDomHelper().create("input",{type:"button",className:"pp_base pp_btn_ektsrch"},s),e=this.getDomHelper().create("input",{type:"button",className:"pp_base pp_ico_ekitan"},s),this.getDomHelper().connect(t,"onclick",this,this.commuterSearch),teasp.Tsf.Dom.show(e,null,!1)))},this),this.setEventHandler(a),
this.createButtons(e),e},teasp.Tsf.ApplyCommuterPass.prototype.createButtons=function(e){var e=this.getDomHelper().create("div",{className:"ts-dialog-buttons"},e),e=this.getDomHelper().create("div",null,e),t=teasp.message.getLabel(tsfManager.isCommuterPassWorkflow()?"applyx_btn_title":"fix_btn_title"),t=teasp.Tsf.Dialog.createButton(this.getDomHelper(),t,"ts-dialog-ok",e),e=teasp.Tsf.Dialog.createButton(
this.getDomHelper(),teasp.message.getLabel("cancel_btn_title"),"ts-dialog-cancel",e);this.getDomHelper().connect(t,"onclick",this,this.submitApply),this.getDomHelper().connect(e,"onclick",this,this.hide)},teasp.Tsf.ApplyCommuterPass.prototype.commuterSearch=function(){var e=this.fp.getFcByApiKey("startDate"),t=this.fp.getFcByApiKey("routeDescription"),s=this.fp.getFcByApiKey("routeCode"),a=this.fp.getFcByApiKey(
"transfer"),e=e.fetchValue().value,t=t.fetchValue().value,s=s.fetchValue().value,a=a.fetchValue().value,e=teasp.util.strToDate(e);if(0!=e.failed)return this.showError(dojo.replace(e.tmpl,[teasp.message.getLabel("tf10000180")])),!1;this.showError();var o={readonly:!1,fixed:!1,stationFromHist:tsfManager.getStationFromHist(),stationToHist:tsfManager.getStationToHist(),commuter:!0,startName:null,endName:null,
stationVia:null,roundTrip:!0,commuterCode:s,date:e.datef,config:this.orgData.config||null};if(/^(.+) ⇔ (.+?)(?:(?:［)(.+)(?:経由］))?$/.test(t)){o.startName=RegExp.$1,o.endName=RegExp.$2;for(var s=RegExp.$3,i=(o.stationVia=[],""!=s?s.split(/[,、， 　]+/):[]),p=0;p<i.length;p++)o.stationVia.push({name:i[p]});o.stationVia.length&&a&&(o.transfer=!0)}tsfManager.dialogOpen("ExpSearch",o,null,this,function(e){var t,s={
routeDescription:teasp.util.createCommuterSimpleRoute(e.searchKey).name,routeCode:e.route.commuterCode,startDate:e.date,passPeriod:e.period,passFare:e.route.commuterFare,route:new teasp.helper.EkitanRoute(e.route).createSimpleText2(),transfer:e.searchKey.transfer||!1};for(t in this.cache[s.startDate]=s.routeCode||"*",s)s.hasOwnProperty(t)&&this.fp.getFcByApiKey(t).drawText(this.getDomHelper(),s)})},
teasp.Tsf.ApplyCommuterPass.prototype.setEventHandler=function(e){teasp.Tsf.Dom.query(".ts-form-cal",e).forEach(function(e){var t=teasp.Tsf.Dom.node('input[type="text"]',e.parentNode.parentNode);t&&tsfManager.eventOpenCalendar(this.getDomHelper(),e,t,{tagName:t.name,isDisabledDate:function(e){return!1}})},this);var t=this.fp.getFcByApiKey("purpose").getElement(null,e);this.getDomHelper().connect(teasp.Tsf.Dom.query(
'input[type="radio"]',t),"onclick",this,this.changePurpose),teasp.Tsf.Dom.setlimitChars(this.getDomHelper(),teasp.Tsf.Dom.query("textarea",e),this.fp)},teasp.Tsf.ApplyCommuterPass.prototype.changePurpose=function(e){var t=this.fetchValueByApiKey("purpose");dojo.forEach(["route","routeDescription"],function(e){var e=this.fp.getFcByApiKey(e).getElement(null,this.getFormEl());e&&(e=teasp.Tsf.Dom.getAncestorByCssName(e,
"ts-form-row"),teasp.Tsf.Dom.show(e,null,"1"==t))},this)},teasp.Tsf.ApplyCommuterPass.prototype.showError=function(e){var t=teasp.Tsf.Dom.node(".ts-error-area",teasp.Tsf.Dom.byId(this.dialog.id));teasp.Tsf.Error.showError(e,t)},teasp.Tsf.ApplyCommuterPass.prototype.submitApply=function(e){var s={};if(this.fp.fcLoop(function(e){e.isApiField(!0)&&e.fillValue(s,e.fetchValue())},this),s.method="submitCommuterPass",
"0"==s.purpose)s.routeCode=null,s.routeDescription=null,s.route=null,s.passFare=null,s.passPeriod=null;else if(!this.cache[s.startDate]||this.cache[s.startDate]!=(s.routeCode||"*"))return void this.showError(teasp.message.getLabel("tf10000400"));var t,a=teasp.util.strToDate(s.startDate);{if(!a.failed)return(t=tsfManager.getTargetEmp().getCommuterPass())&&t.getStartDate()&&a.datef<=t.getStartDate()?(
a=teasp.util.date.formatDate(teasp.util.date.addDays(t.getStartDate(),1),"SLA"),void this.showError(teasp.message.getLabel("tf10000410",a))):void(!s.note&&tsfManager.isRequireNote(teasp.constant.APPLY_KEY_COMMUTERPASS)?this.showError(teasp.message.getLabel("tm10003820")):tsfManager.submitCommuterPass(s,teasp.Tsf.Dom.hitch(this,function(e,t){e?(tsfManager.getTargetEmp().setCommuterPasses(t.commuterPasses),
this.submitApply(s),this.hide()):this.showError(t)})));this.showError(dojo.replace(a.tmpl,[teasp.message.getLabel("tf10000180")]))}},teasp.Tsf.CommuterPassList=function(){this.notOpenLink=!0},teasp.Tsf.CommuterPassList.prototype=new teasp.Tsf.SearchList,teasp.Tsf.CommuterPassList.prototype.drawData=function(e){var t,s;teasp.Tsf.SearchList.prototype.drawData.call(this,e),this.orgData.message&&(e=teasp.Tsf.Dom.node(
".ts-error-area",this.getArea()),t=this.getDomHelper().create("div",{innerHTML:this.orgData.message,className:"ts-commuter-pass-msg"}),s=teasp.Tsf.Dom.node("div.ts-search-list-box",this.getArea()),t.style.width=s.style.width,teasp.Tsf.Dom.place(t,e,"after")),this.getDomHelper().connect(teasp.Tsf.Dom.query("table.ts-list-body a"),"onclick",this,this.clickStatus),tsfManager.getTargetEmp().mergeCommuterPassStatus(
this.records)},teasp.Tsf.CommuterPassList.prototype.getButtons=function(e){return[{key:"close",label:teasp.message.getLabel("close_btn_title")}]},teasp.Tsf.CommuterPassList.prototype.hide=function(){this.orgData.passChanged&&this.orgData.passChanged(),teasp.Tsf.SearchList.prototype.hide.call(this)},teasp.Tsf.CommuterPassList.prototype.clickStatus=function(e){var e=teasp.Tsf.Dom.getAncestorByTagName(e.target,"TR"),
e=teasp.Tsf.Fp.getHkey(e),t=this.fp.getFcByApiKey("Id").fetchValue(e).value,e=this.fp.getFcByApiKey("Status__c").fetchValue(e).value,e=teasp.Tsf.ObjBase.getCancelApplyLabel(e),s=!tsfManager.isReadMode()&&teasp.Tsf.CommuterPass.isCancelable(tsfManager.getTargetEmp().getCommuterPasses(),t);return tsfManager.showProcessInstanceSteps({id:t,cancelable:s,cancelLabel:e,cancelCallback:teasp.Tsf.Dom.hitch(this,
this.cancelApply)}),!1},teasp.Tsf.CommuterPassList.prototype.cancelApply=function(e,t){var s=e.cancelLabel||teasp.message.getLabel("tm10003500");tsfManager.showDialog("ApplyCommentCommuterPass",{key:"cancelApply",title:s,formCss:"ts-dialog-comment",buttons:[{key:"cancelApply",label:s,css:"ts-cancel-apply"},{key:"cancel",label:teasp.message.getLabel("cancel_btn_title")}],id:e.id,empId:tsfManager.getEmpId(),solve:!1,
noComment:teasp.Tsf.CommuterPass.isValid(tsfManager.getTargetEmp().getCommuterPasses(),e.id),parentHide:t},teasp.Tsf.Dom.hitch(this,function(e){tsfManager.getTargetEmp().setCommuterPasses(e.commuterPasses),this.hide()}))},teasp.Tsf.EkitanSetting=function(){this.fp=teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.dialogEkitanSetting)},teasp.Tsf.EkitanSetting.prototype.show=function(e){teasp.Tsf.Error.showError(),
e.values=tsfManager.getEmpExpConfig(),this.fp.setReadOnly(e.ro),this.domHelper=new teasp.Tsf.Dom,this.dialog=new dijit.Dialog({title:teasp.message.getLabel("ekitanSetting_caption"),className:"ts-dialog-ekitan-setting"}),this.dialog.attr("content",this.getContent()),this.dialog.startup(),this.domHelper.connect(this.dialog,"onCancel",this,function(){this.hide()}),this.showData(e)},
teasp.Tsf.EkitanSetting.prototype.showData=function(e){this.drawData(e),this.dialog.show()},teasp.Tsf.EkitanSetting.prototype.drawData=function(e){this.orgData=e;var t=this.orgData.values;t.ekitanArea=""+t.ekitanArea,t.usePaidExpress=""+(t.usePaidExpress?1:0),t.useReservedSheet=""+(t.useReservedSheet?1:0),t.preferredAirLine=""+t.preferredAirLine,t.routePreference=""+t.routePreference,t.excludeCommuterRoute=""+(
t.excludeCommuterRoute?1:0),this.showCommuterRouteWarn(t),this.fp.fcLoop(function(e){e.isApiField(!0)&&e.drawText(this.getDomHelper(),t)},this),this.enableExcludeCommuterRoute()},teasp.Tsf.EkitanSetting.prototype.drawRoute=function(e){var t=tsfManager.getEmpExpConfig(),s=this.fp.getFcByApiKey("commuterRouteCode"),a=this.fp.getFcByApiKey("commuterRouteNote"),o=this.fp.getFcByApiKey("commuterRouteRoute"),
i=this.fp.getFcByApiKey("commuterRouteTransfer"),t={commuterRouteCode:t.commuterRouteCode,commuterRouteNote:t.commuterRouteNote,commuterRouteRoute:t.commuterRouteRoute,commuterRouteTransfer:t.commuterRouteTransfer};s.drawText(this.getDomHelper(),t),a.drawText(this.getDomHelper(),t),o.drawText(this.getDomHelper(),t),i.drawText(this.getDomHelper(),t),this.showCommuterRouteWarn(t),
e&&e.excludeCommuterRoute&&this.fp.getFcByApiKey("excludeCommuterRoute").drawText(this.getDomHelper(),e)},teasp.Tsf.EkitanSetting.prototype.showCommuterRouteWarn=function(e){var t=0,e=(e.commuterRouteCode||(t=e.commuterRouteNote&&![teasp.message.getLabel("tf10000340"),teasp.message.getLabel("tm10003580")].contains(e.commuterRouteNote)?2:1),teasp.Tsf.Dom.show(".commuter-route-warn",this.getFormEl(),2==t),
this.fp.getElementByApiKey("commuterRouteRoute",null,this.getFormEl()));return e&&(e=teasp.Tsf.Dom.getAncestorByCssName(e,"ts-form-row"),teasp.Tsf.Dom.show(e,null,1!=t)),2==t},teasp.Tsf.EkitanSetting.prototype.enableExcludeCommuterRoute=function(){var t=tsfManager.getTargetEmp().isCommuterRouteLock(),e=this.fp.getElementByApiKey("excludeCommuterRoute",null,this.getFormEl());e&&(e=teasp.Tsf.Dom.getAncestorByCssName(e,
"ts-form-row"))&&teasp.Tsf.Dom.query("input",e).forEach(function(e){e.disabled=t})},teasp.Tsf.EkitanSetting.prototype.getDomHelper=function(){return this.domHelper},teasp.Tsf.EkitanSetting.prototype.getFormEl=function(){return teasp.Tsf.Dom.node(".ts-section-form",teasp.Tsf.Dom.byId(this.dialog.id))},teasp.Tsf.EkitanSetting.prototype.getValueByApiKey=function(e,t,s){e=this.fp.getFcByApiKey(e);if(!e)return s;
e=e.parseValue(t);return void 0===e.value||null===e.value?s:e.value},teasp.Tsf.EkitanSetting.prototype.hide=function(){this.dialog&&(this.dialog.hide(),this.domHelper.free(),this.dialog.destroy(),tsfManager.removeDialog("EkitanSetting"))},teasp.Tsf.EkitanSetting.prototype.getContent=function(){var s,e=this.getDomHelper().create("div",{className:"ts-dialog ts-ekitan-setting",style:"width:560px;"}),a=(
this.getDomHelper().create("div",null,this.getDomHelper().create("div",{className:"ts-error-area",style:"width:560px;display:none;"},e)),this.getDomHelper().create("div",{className:"ts-section-form"},e));return this.fp.fcLoop(function(e){var t;e.isHidden()?this.getDomHelper().create("input",{type:"hidden",id:e.getDomId()},a):(s=this.getDomHelper().create("div",{className:"ts-form-row"},a),t=this.getDomHelper(
).create("div",{className:"ts-form-label"},s),this.getDomHelper().create("div",{innerHTML:e.getLabel()},t),e.appendFieldDiv(this.getDomHelper(),s),"commuterRouteNote"==e.getApiKey()&&(tsfManager.getTargetEmp().isCommuterRouteLock()||(this.fp.isReadOnly()||(t=teasp.Tsf.Dialog.createButton(this.getDomHelper(),teasp.message.getLabel("change_btn_title"),"ts-button-thin",s),this.getDomHelper().connect(t,"onclick",this,
this.commuterSearch)),e=teasp.Tsf.Dialog.createButton(this.getDomHelper(),teasp.message.getLabel("history_head"),"ts-button-thin",s),this.getDomHelper().connect(e,"onclick",this,this.commuterHistory)),this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tk10005050"),style:{float:"right",fontSize:"0.9em",color:"red",display:"none"},className:"commuter-route-warn"},s)))},this),this.createButtons(e),e},
teasp.Tsf.EkitanSetting.prototype.createButtons=function(e){var t,s,e=this.getDomHelper().create("div",{className:"ts-dialog-buttons"},e),e=this.getDomHelper().create("div",null,e);this.fp.isReadOnly()?s=teasp.Tsf.Dialog.createButton(this.getDomHelper(),teasp.message.getLabel("close_btn_title"),"ts-dialog-cancel",e):(t=teasp.Tsf.Dialog.createButton(this.getDomHelper(),teasp.message.getLabel("save_btn_title"),
"ts-dialog-ok",e),s=teasp.Tsf.Dialog.createButton(this.getDomHelper(),teasp.message.getLabel("cancel_btn_title"),"ts-dialog-cancel",e),this.getDomHelper().connect(t,"onclick",this,this.ok)),this.getDomHelper().connect(s,"onclick",this,this.hide)},teasp.Tsf.EkitanSetting.prototype.commuterSearch=function(){var e=this.fp.getFcByApiKey("commuterRouteCode"),t=this.fp.getFcByApiKey("commuterRouteNote"),
s=this.fp.getFcByApiKey("commuterRouteRoute"),a=this.fp.getFcByApiKey("excludeCommuterRoute"),o=this.fp.getFcByApiKey("commuterRouteTransfer"),e={empId:tsfManager.getEmpId(),routeCode:e.fetchValue().value,routeDescription:t.fetchValue().value,route:s.fetchValue().value,excludeCommuterRoute:a.fetchValue().value,transfer:o.fetchValue().value,purpose:1},t=(e.routeCode||(e.routeDescription=null,e.route=null),
tsfManager.getTargetEmp().getCommuterPasses());if(0<t.length){s=teasp.Tsf.CommuterPass.getWaitApply(t);if(s)return void this.showHistory({message:teasp.message.getLabel("tf10000390",teasp.constant.getDisplayStatus(s.getStatus()))});a=teasp.Tsf.CommuterPass.getReuseApply(t);a&&(e.routeDescription=a.getRouteDescription(),e.routeCode=a.getRouteCode(),e.route=a.getRoute(),e.purpose=a.getRouteCode()?1:0,e.note=a.getNote()
,e.status=a.getStatus(),e.startDate=a.getStartDate(),e.passFare=a.getPassFare(),e.passPeriod=a.getPassPeriod(),e.id=a.getId(),e.transfer=a.getTransfer(),e.routeCode||(e.routeDescription=null))}tsfManager.showDialog("ApplyCommuterPass",{values:e,config:this.getEkitanConfig()},teasp.Tsf.Dom.hitch(this,function(e){this.drawRoute(e)}))},teasp.Tsf.EkitanSetting.prototype.showHistory=function(e){var t={
passChanged:teasp.Tsf.Dom.hitch(this,function(){this.drawRoute()})},s=new teasp.Tsf.CommuterPassList;s.init(teasp.Tsf.formParams.commuterPassList),s.show(teasp.Tsf.util.mixin(t,e))},teasp.Tsf.EkitanSetting.prototype.commuterHistory=function(){this.showHistory()},teasp.Tsf.EkitanSetting.prototype.showError=function(e){var t=teasp.Tsf.Dom.node(".ts-error-area",teasp.Tsf.Dom.byId(this.dialog.id));
teasp.Tsf.Error.showError(e,t)},teasp.Tsf.EkitanSetting.prototype.getEkitanConfig=function(){var t={};return this.fp.fcLoop(function(e){e.isApiField(!0)&&e.fillValue(t,e.fetchValue())},this),{ekitanArea:parseInt(t.ekitanArea,10),preferredAirLine:parseInt(t.preferredAirLine,10),routePreference:parseInt(t.routePreference,10),usePaidExpress:"1"==t.usePaidExpress,useReservedSheet:"1"==t.useReservedSheet,
excludeCommuterRoute:"1"==t.excludeCommuterRoute}},teasp.Tsf.EkitanSetting.prototype.ok=function(e){var t=this.getEkitanConfig(),s=tsfManager.getTargetEmp().getExpConfig();s.ekitanArea=t.ekitanArea,s.preferredAirLine=t.preferredAirLine,s.routePreference=t.routePreference,s.usePaidExpress=t.usePaidExpress,s.useReservedSheet=t.useReservedSheet,s.excludeCommuterRoute=t.excludeCommuterRoute,tsfManager.getTargetEmp(
).getCommuterPasses().length&&(delete s.commuterRouteCode,delete s.commuterRouteNote,delete s.commuterRouteRoute),console.log(s),tsfManager.setExpConfig(s,teasp.Tsf.Dom.hitch(this,function(e,t){e?this.hide():this.showError(t)}))},teasp.Tsf.ReceiptList=function(){this.notOpenLink=!0},teasp.Tsf.ReceiptList.prototype=new teasp.Tsf.SearchList,teasp.Tsf.ReceiptList.prototype.init=function(e){if(!tsfManager.getInfo(
).isReceiptReaderConnect())for(var t=0;t<e.fields.length;t++)if("Message__c"==e.fields[t].apiKey){e.fields.splice(t,1);break}teasp.Tsf.SearchList.prototype.init.call(this,e)},teasp.Tsf.ReceiptList.prototype.show=function(e,t){this.option.cancelReceipt=teasp.Tsf.Dom.hitch(this,this.cancelReceipt),teasp.Tsf.SearchList.prototype.show.call(this,e,t),this.setButtonDisplay()},
teasp.Tsf.ReceiptList.prototype.clickRecordCount=function(e){console.log(e),console.log(e.target.className);var t=teasp.Tsf.Dom.byId("ReceiptStatus");t&&(teasp.Tsf.Dom.hasClass(e.target,"proc-count")?t.value="0":teasp.Tsf.Dom.hasClass(e.target,"erro-count")?t.value="9":teasp.Tsf.Dom.hasClass(e.target,"comp-count")&&(t.value="2"),this.search())},teasp.Tsf.ReceiptList.prototype.getButtons=function(e){return[{
key:"expImport",label:teasp.message.getLabel("tf10002260"),css:"ts-dialog-ok"},{key:"cancelReceipt",label:teasp.message.getLabel("tf10005040"),css:"ts-cancel-apply"},{key:"close",label:teasp.message.getLabel("cancel_btn_title")}]},teasp.Tsf.ReceiptList.prototype.drawData=function(e){teasp.Tsf.SearchList.prototype.drawData.call(this,e)},teasp.Tsf.ReceiptList.prototype.setSearchContent=function(e){var s,a,o;
0<this.fp.getSearchFields().length&&(s=this.getDomHelper().create("div",{className:"ts-section-form"},e),tsfManager.getInfo().isReceiptReaderConnect()||teasp.Tsf.Dom.style(s,"display","none"),o=a=null,this.fp.searchFcLoop(function(e){var t;e.isHidden()?this.getDomHelper().create("input",{type:"hidden",id:e.getDomId()},s):(a&&a.isNoNL()||(o=this.getDomHelper().create("div",{className:"ts-form-row"},s)),
t=this.getDomHelper().create("div",{className:"ts-form-label"},o),e.getLw()&&teasp.Tsf.Dom.style(t,"width",e.getLw()),this.getDomHelper().create("div",{innerHTML:e.getLabel()},t),e.appendFieldDiv(this.getDomHelper(),o),a=e)},this),(o=teasp.Tsf.Dom.node("div.ts-form-row",s))&&this.getDomHelper().create("div",{className:"ts-form-value ts-receipt-sum"},o),(e=teasp.Tsf.Dom.node("select",s)
).value=e.options&&e.options[0].value,this.getDomHelper().connect(e,"onchange",this,this.search),this.setEventHandler(s))},teasp.Tsf.ReceiptList.prototype.search=function(e){teasp.Tsf.SearchList.prototype.search.call(this,e),this.setButtonDisplay()},teasp.Tsf.ReceiptList.prototype.setButtonDisplay=function(){var e=this.getArea(),t=teasp.Tsf.Dom.node("div.ts-section-form select",e),t=t&&t.value||null;
teasp.Tsf.Dom.show("div.ts-dialog-buttons .ts-dialog-ok",e,"2"==t),teasp.Tsf.Dom.show("div.ts-dialog-buttons .ts-cancel-apply",e,"2"==t)},teasp.Tsf.ReceiptList.prototype.showDataEnd=function(){teasp.Tsf.SearchList.prototype.showDataEnd.call(this);var e,t,s,a,o=teasp.Tsf.Dom.node("div.ts-section-form .ts-receipt-sum",this.getArea()),i=this.orgData.statusNums;i&&o&&(s=(e=i[0]||0)+(t=i[2]||0)+(i=i[9]||0),
teasp.Tsf.Dom.empty(o),o.innerHTML=teasp.message.getLabel("tf10005050",s,e,i,t),a=0,teasp.Tsf.Dom.query("a",o).forEach(function(e){this.getDomHelper().connect(e,"onclick",this,this.clickRecordCount),teasp.Tsf.Dom.addClass(e,a?1==a?"erro-count":"comp-count":"proc-count"),a++},this)),this.showListCheckbox()},teasp.Tsf.ReceiptList.prototype.showListCheckbox=function(){var e=this.getArea(),t=teasp.Tsf.Dom.node(
"div.ts-section-form select",e),s=t&&t.value||null;teasp.Tsf.Dom.query("table.ts-list-head, table.ts-list-body",e).forEach(function(e){teasp.Tsf.Dom.query('input[type="checkbox"]',e).forEach(function(e){teasp.Tsf.Dom.style(e,"display","0"==s?"none":"")})})},teasp.Tsf.ReceiptList.prototype.cancelReceipt=function(){var t,s,e=this.collectRecords();e.length<=0?this.showError(teasp.message.getLabel("tf10005060")):(
console.log(e),t=[],s=[],tsfManager.getInfo().isReceiptReaderConnect()?(dojo.forEach(e,function(e){e.ForeignId__c&&t.push(e.ForeignId__c)}),t.length):(dojo.forEach(e,function(e){e.Id&&s.push(e.Id)}),s.length&&teasp.tsConfirm(teasp.message.getLabel("tf10008860",s.length),this,function(e){e&&tsfManager.actionReceipt({action:"remove",empId:tsfManager.getEmpId(),recordIds:s.join(","),foreignIds:t.join(","),
notapi:!tsfManager.getInfo().isReceiptReaderConnect()},teasp.Tsf.Dom.hitch(this,function(e,t){e?(this.orgData.statusNums=t.statusNums,this.search()):this.showError(t)}))})))},teasp.Tsf.ExpApplyList=function(){},teasp.Tsf.ExpApplyList.prototype=new teasp.Tsf.SearchList,teasp.Tsf.ExpApplyList.prototype.showDataEnd=function(){this.orgData.sourceId?teasp.Tsf.Dom.style(teasp.Tsf.Dom.node("div.ts-dialog-buttons",
this.getArea()),"margin-top","6px"):teasp.Tsf.Dom.show("table.ts-moveto-null",this.getArea(),!1),teasp.Tsf.SearchList.prototype.showDataEnd.call(this)},teasp.Tsf.ExpApplyList.prototype.createButtons=function(e){this.createMoveToNull(e);var e=this.getDomHelper().create("div",{className:"ts-dialog-buttons"},e),t=this.getDomHelper().create("div",{className:"ts-edge-left"},e),s=this.getDomHelper().create("label",null,t),
s=(this.getDomHelper().create("input",{type:"checkbox"},s),this.getDomHelper().create("span",{innerHTML:" "+teasp.message.getLabel("tf10006340")},s),t=this.getDomHelper().create("div",null,e),teasp.Tsf.Dialog.createButton(this.getDomHelper(),teasp.message.getLabel("tf10006320"),"ts-dialog-ok",t)),e=(this.getDomHelper().connect(s,"onclick",this,teasp.Tsf.Dom.hitch(this,this.move)),teasp.Tsf.Dialog.createButton(
this.getDomHelper(),teasp.message.getLabel("cancel_btn_title"),"ts-dialog-cancel",t));this.getDomHelper().connect(e,"onclick",this,this.hide)},teasp.Tsf.ExpApplyList.prototype.createMoveToNull=function(e){e=this.getDomHelper().create("div",null,e),e=this.getDomHelper().create("td",null,this.getDomHelper().create("tr",null,this.getDomHelper().create("tbody",null,this.getDomHelper().create("table",{
className:"ts-moveto-null"},e)))),e=this.getDomHelper().create("label",null,e);this.getDomHelper().create("input",{type:"radio",name:this.fp.getDiscernment()},e),this.getDomHelper().create("span",{innerHTML:" "+teasp.message.getLabel("tf10006360")},e)},teasp.Tsf.ExpApplyList.prototype.dataProcessing=function(){this.records&&dojo.forEach(this.records,function(e){var t=e.EmpExp__r||[];e.Count__c=t.length},this)},
teasp.Tsf.ExpApplyList.prototype.move=function(){var s,t={method:"moveDetails",dstId:void 0,details:[],expenseType:null},e=this.collectData();0<e.length?t.dstId=e[0].Id:this.orgData.sourceId&&teasp.Tsf.Dom.node('table.ts-moveto-null input[type="radio"]',this.getArea()).checked&&(t.dstId=null,t.expenseType=this.orgData.expenseType),void 0===t.dstId?this.showError(teasp.message.getLabel("tf10006370")):(dojo.forEach(
this.orgData.values,function(e){t.details.push(e.Id)}),s=teasp.Tsf.Dom.node('.ts-edge-left input[type="checkbox"]',this.getArea()).checked?t.dstId:this.orgData.sourceId,tsfManager.potalAction(t,teasp.Tsf.Dom.hitch(this,function(e,t){e?(this.orgData.moveDone&&this.orgData.moveDone(s),this.hide()):this.showError(t)})))},teasp.Tsf.JobList=function(){},teasp.Tsf.JobList.prototype=new teasp.Tsf.SearchList,
teasp.Tsf.JobList.prototype.show=function(e,t){e&&e.values&&null==e.values.DeptId__c&&(e.values.DeptId__c="-1"),teasp.Tsf.SearchList.prototype.show.call(this,e,t)},teasp.Tsf.JobList.prototype.setSearchContent=function(e){teasp.Tsf.SearchList.prototype.setSearchContent.call(this,e);var t=teasp.Tsf.Dom.node("select.ts-form-select",e);t&&this.loadDeptSelect(t),teasp.Tsf.Dom.style(teasp.Tsf.Dom.node(
"div.ts-section-form > div.ts-form-row",e),"margin-bottom","0px")},teasp.Tsf.JobList.prototype.loadDeptSelect=function(e){for(var t=tsfManager.getDepts(),s=(teasp.Tsf.Dom.empty(e),this.getDomHelper().create("option",{value:"",innerHTML:teasp.message.getLabel("tk10000344")},e),this.getDomHelper().create("option",{value:"-1",innerHTML:teasp.message.getLabel("tk10000807")},e),!1),a=0;a<t.length;a++)this.getDomHelper(
).create("option",{value:t[a].getId()||"",innerHTML:t[a].getDisplayName()},e),null==t[a].getId()&&(s=!0);e.value=s?null:""},teasp.Tsf.MessageBox=function(){},teasp.Tsf.MessageBox.prototype.show=function(e,t){teasp.Tsf.Error.showError(),this.domHelper=new teasp.Tsf.Dom,this.dialog=new dijit.Dialog({title:e.title||"",className:"ts-dialog-message-box"}),this.dialog.attr("content",this.getContent(e)),this.dialog.startup(
),this.domHelper.connect(this.dialog,"onCancel",this,function(){this.hide()}),this.callback=t,this.showData(e)},teasp.Tsf.MessageBox.prototype.showData=function(e){this.dialog.show()},teasp.Tsf.MessageBox.prototype.getDomHelper=function(){return this.domHelper},teasp.Tsf.MessageBox.prototype.getFormEl=function(){return teasp.Tsf.Dom.node(".ts-section-form",teasp.Tsf.Dom.byId(this.dialog.id))},
teasp.Tsf.MessageBox.prototype.hide=function(){this.dialog&&(this.dialog.hide(),this.domHelper.free(),this.dialog.destroy(),tsfManager.removeDialog("MessageBox"))},teasp.Tsf.MessageBox.prototype.getContent=function(e){var t=this.getDomHelper().create("div",{className:"ts-dialog ts-message-box"}),s=(this.getDomHelper().create("div",null,this.getDomHelper().create("div",{className:"ts-error-area",style:"display:none;"}
,t)),this.getDomHelper().create("div",{className:"ts-section-form"},t)),s=(this.getDomHelper().create("div",{innerHTML:e.message,className:"ts-message"},s),this.getDomHelper().create("div",{className:"ts-option"},s)),e=e.option;return e&&"check"==e.type&&(s=this.getDomHelper().create("label",null,s),this.getDomHelper().create("input",{type:"checkbox"},s).checked=e.checked||!1,this.getDomHelper().create("span",{
innerHTML:" "+(e.name||"")},s)),this.createButtons(t),t},teasp.Tsf.MessageBox.prototype.createButtons=function(e){var e=this.getDomHelper().create("div",{className:"ts-dialog-buttons"},e),e=this.getDomHelper().create("div",null,e),t=teasp.Tsf.Dialog.createButton(this.getDomHelper(),teasp.message.getLabel("ok_btn_title"),"ts-dialog-ok",e),e=teasp.Tsf.Dialog.createButton(this.getDomHelper(),teasp.message.getLabel(
"cancel_btn_title"),"ts-dialog-cancel",e);this.getDomHelper().connect(t,"onclick",this,this.ok),this.getDomHelper().connect(e,"onclick",this,this.hide)},teasp.Tsf.MessageBox.prototype.showError=function(e){var t=teasp.Tsf.Dom.node(".ts-error-area",teasp.Tsf.Dom.byId(this.dialog.id));teasp.Tsf.Error.showError(e,t)},teasp.Tsf.MessageBox.prototype.ok=function(e){var t=teasp.Tsf.Dom.node('input[type="checkbox"]',
this.getFormEl()),t=t&&t.checked||!1;this.callback(t),this.hide()},teasp.Tsf.JsNaviImport=function(){this.fp=teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.dialogJsNaviImport),this.expImportRemarks=tsfManager.getInfo().getExpPreApplyConfigs().expImportRemarks||!1},teasp.Tsf.JsNaviImport.prototype.show=function(e,t){teasp.Tsf.Error.showError(),this.fp.setReadOnly(e.ro),this.dialog||(this.fp.fcLoop(function(e){
"ChargeDeptId__c"!=e.getApiKey()||tsfManager.isRequireChargeDept()||e.setNotUse(!0)},this),this.domHelper=new teasp.Tsf.Dom,this.dialog=new dijit.Dialog({title:e.dialogTitle||"",className:"ts-dialog-exp-item"}),this.dialog.attr("content",this.getContent()),this.dialog.startup(),this.domHelper.connect(this.dialog,"onCancel",this,function(){this.hide()}),9==dojo.isIE&&this.domHelper.connect(this.dialog,"onKeyDown",this
,function(e){return 13===e.keyCode&&dojo.stopEvent(e),!1})),this.entryExpItem=t,this.showData(e),this.ok()},teasp.Tsf.JsNaviImport.prototype.showData=function(e){var t=this.getFormEl(),s=(this.orgData=e,this.orgData.values),e=(this.expItemFilter={empExpItemClass:this.orgData.expItemClass,
deptExpItemClass:s.ChargeDeptId__r&&s.ChargeDeptId__r.ExpItemClass__c||this.orgData.assist&&this.orgData.assist.ChargeDeptId__r&&this.orgData.assist.ChargeDeptId__r.ExpItemClass__c||null,expenseType:this.orgData.assist&&this.orgData.assist.ExpenseType__c||null},this.fp.getElementByApiKey("ExpItemId__c",null,t)),e=(this.loadExpItems(e),this.getDomHelper().connect(e,"onchange",this,this.changedExpItem),
this.fp.getElementByApiKey("JobId__c",null,t)),a=(e&&(a=this.getValueByApiKey("EmpId__c",s,null),this.loadJobs(e,a),this.getDomHelper().connect(e,"onchange",this,this.changedJob)),this.fp.getElementByApiKey("ChargeDeptId__c",null,t));if(a&&(this.loadChargeDepts(a),this.getDomHelper().connect(a,"onchange",this,this.changedChargeDept)),this.remarksAddMax=0,this.expImportRemarks&&1<this.orgData.data.records.length){for(
var e=teasp.Tsf.Dom.node(".ts-row-detail div.ts-form-value",t),a=this.getDomHelper().create("label",null,e),e=this.getDomHelper().create("input",{type:"checkbox"},a),o=(this.getDomHelper().create("span",{innerHTML:" "+teasp.message.getLabel("ci00000230")},a),e.checked=!0,this.getDomHelper().connect(e,"onclick",this,function(){this.checkedAddToRemarks()}),0),i=this.orgData.data.records,p=0;p<i.length;p++){var r=(
i[p].Note__c||"")+" ";o<r.length&&(o=r.length)}this.remarksAddMax=Math.max(255-o,0),this.checkedAddToRemarks(t)}this.fp.fcLoop(function(e){e.isApiField(!0)&&e.drawText(this.getDomHelper(),s)},this),this.dialog.show()},teasp.Tsf.JsNaviImport.prototype.getDomHelper=function(){return this.domHelper},teasp.Tsf.JsNaviImport.prototype.getFormEl=function(){return teasp.Tsf.Dom.node(".ts-section-form",teasp.Tsf.Dom.byId(
this.dialog.id))},teasp.Tsf.JsNaviImport.prototype.getValueByApiKey=function(e,t,s){e=this.fp.getFcByApiKey(e);if(!e)return s;e=e.parseValue(t);return void 0===e.value||null===e.value?s:e.value},teasp.Tsf.JsNaviImport.prototype.hide=function(){this.dialog&&(this.dialog.hide(),this.domHelper.free(),this.dialog.destroy(),tsfManager.removeDialog("JsNaviImport"))},teasp.Tsf.JsNaviImport.prototype.getContent=function(){
var e=this.getDomHelper().create("div",{className:"ts-dialog ts-exp-detail",style:"width:530px;"}),s=(this.getDomHelper().create("div",null,this.getDomHelper().create("div",{className:"ts-error-area",style:"width:530px;display:none;"},e)),this.getDomHelper().create("div",{className:"ts-section-form"},e)),a=null,o=null;return this.fp.getFcByApiKey("ChargeDeptId__c").setRequired(2==tsfManager.isRequireChargeDept()?1:0)
,this.fp.fcLoop(function(e){var t;e.isHidden()?this.getDomHelper().create("input",{type:"hidden",id:e.getDomId()},s):(a&&a.isNoNL()||(t="ts-form-row","ExtraItem1__c"==e.getApiKey()?t+=" ts-row-extra1":"ExtraItem2__c"==e.getApiKey()?t+=" ts-row-extra2":"JobId__c"==e.getApiKey()?t+=" ts-row-job":"Detail__c"==e.getApiKey()&&(t+=" ts-row-detail"),o=this.getDomHelper().create("div",{className:t},s)),t=this.getDomHelper(
).create("div",{className:"ts-form-label"},o),e.getLw()&&teasp.Tsf.Dom.style(t,"width",e.getLw()),this.getDomHelper().create("div",{innerHTML:e.getLabel()},t),(e.isRequired()||/ExtraItem.__c/.test(e.getApiKey()))&&this.getDomHelper().create("div",{className:"ts-require"},t),e.appendFieldDiv(this.getDomHelper(),o),a=e)},this),this.setEventExpItem(s),this.setEventJob(s),this.setEventDept(s),this.showExtraItem(s),
teasp.Tsf.Dom.show(".ts-row-detail",s,this.expImportRemarks),this.createButtons(e),e},teasp.Tsf.JsNaviImport.prototype.createButtons=function(e){var e=this.getDomHelper().create("div",{className:"ts-dialog-buttons"},e),e=this.getDomHelper().create("div",null,e),t=teasp.Tsf.Dialog.createButton(this.getDomHelper(),teasp.message.getLabel("tf10001510"),"ts-dialog-ok",e),e=teasp.Tsf.Dialog.createButton(this.getDomHelper()
,teasp.message.getLabel("cancel_btn_title"),"ts-dialog-cancel",e);this.getDomHelper().connect(t,"onclick",this,this.ok),this.getDomHelper().connect(e,"onclick",this,this.hide)},teasp.Tsf.JsNaviImport.prototype.setEventExpItem=function(a){var e=this.fp.getElementByApiKey("ExpItemId__c",null,a);e&&(e=teasp.Tsf.Dom.getAncestorByCssName(e,"ts-form-row"))&&(e=teasp.Tsf.Dom.node("button.ts-form-find",e)
)&&this.getDomHelper().connect(e,"onclick",this,function(e){var t=[],s=tsfManager.getExpItems(this.expItemFilter,!0);dojo.forEach(s,function(e){t.push("'"+e.getId()+"'")}),t.length||t.push("''"),tsfManager.showSearchListDialog({discernment:"expItems",delay:!0,values:{Id:t.join(",")}},null,teasp.Tsf.Dom.hitch(this,function(e){e=e[0],e={ExpItemId__c:e.Id,ExpItemId__r:e};this.fp.getFcByApiKey("ExpItemId__c").drawText(
this.getDomHelper(),e,null,a)}))})},teasp.Tsf.JsNaviImport.prototype.setEventJob=function(o){var e=this.fp.getElementByApiKey("JobId__c",null,o);e&&(e=teasp.Tsf.Dom.getAncestorByCssName(e,"ts-form-row"))&&(e=teasp.Tsf.Dom.node("button.ts-form-find",e))&&this.getDomHelper().connect(e,"onclick",this,function(e){var t=teasp.util.date.formatDate(teasp.util.date.getToday()),s=this.getCurrentChargeDept(),
s=s&&s.Id||this.orgData.assist&&this.orgData.assist.ChargeDeptId__c||this.orgData.defaultDeptId;tsfManager.showSearchListDialog({discernment:"jobs",dialog:"JobList",delay:!0,values:{_date:[t],DeptId__c:s,_jobAssignClass:tsfManager.getEmpJobSearchCondition()}},null,teasp.Tsf.Dom.hitch(this,function(e){var s={},a=e[0];this.setImportJobs(a),dojo.forEach([{n:"JobId__r.JobCode__c",v:"JobCode__c"},{
n:"JobId__r.StartDate__c",v:"StartDate__c"},{n:"JobId__r.EndDate__c",v:"EndDate__c"},{n:"JobId__r.Active__c",v:"Active__c"},{n:"JobId__c",v:"Id",d:"Name"}],function(e){var t=this.fp.getFcByApiKey(e.n);t.fillValue(s,{value:a[e.v],nameValue:e.d?a[e.d]:null}),t.drawText(this.getDomHelper(),s,null,o)},this)}))})},teasp.Tsf.JsNaviImport.prototype.setEventDept=function(s){var e=this.fp.getElementByApiKey("ChargeDeptId__c",
null,s);e&&(e=teasp.Tsf.Dom.getAncestorByCssName(e,"ts-form-row"))&&(e=teasp.Tsf.Dom.node("button.ts-form-find",e))&&this.getDomHelper().connect(e,"onclick",this,function(e){var t=teasp.util.date.formatDate(teasp.util.date.getToday());tsfManager.showSearchListDialog({discernment:"depts",delay:!0,values:{_date:[t]}},null,teasp.Tsf.Dom.hitch(this,function(e){e=e[0],e={ChargeDeptId__c:e.Id,ChargeDeptId__r:{
DeptCode__c:e.DeptCode__c,ExpItemClass__c:e.ExpItemClass__c,Name:e.Name}};tsfManager.getInfo().setCacheDept(e),this.fp.getFcByApiKey("ChargeDeptId__c").drawText(this.getDomHelper(),e,null,s),this.expItemFilter.deptExpItemClass=e.ChargeDeptId__r.ExpItemClass__c||null,this.refreshExpItems()}))})},teasp.Tsf.JsNaviImport.prototype.loadExpItems=function(t){var e=t.value||"",s={};teasp.Tsf.Dom.empty(t),this.getDomHelper(
).create("option",{value:"",innerHTML:""},t),dojo.forEach(tsfManager.getExpItems(this.expItemFilter),function(e){e.isEkitanType()||e.isFixAmount()||e.isEnableQuantity()||e.isForeignFlag()||(this.getDomHelper().create("option",{value:e.getId(),innerHTML:e.getName()},t),s[e.getId()]=1)},this),t.value=s[e]&&e||""},teasp.Tsf.JsNaviImport.prototype.refreshExpItems=function(){var e=this.fp.getElementByApiKey("ExpItemId__c"
,null,this.getFormEl());e&&this.loadExpItems(e)},teasp.Tsf.JsNaviImport.prototype.loadJobs=function(t,e){var s=tsfManager.getEmpJobAssigns();teasp.Tsf.Dom.empty(t),this.getDomHelper().create("option",{value:"",innerHTML:""},t),dojo.forEach(s,function(e){this.getDomHelper().create("option",{value:e.getId(),innerHTML:e.getDisplayName()},t)},this)},teasp.Tsf.JsNaviImport.prototype.loadChargeDepts=function(e){var t;e&&(
teasp.Tsf.Dom.empty(e),t=tsfManager.getDefaultChargeDept(),this.getDomHelper().create("option",{value:"",innerHTML:""},e),t.ChargeDeptId__c&&(this.getDomHelper().create("option",{value:t.ChargeDeptId__c,innerHTML:t.ChargeDeptId__r.DeptCode__c+" "+t.ChargeDeptId__r.Name},e),tsfManager.getInfo().setCacheDept(t)))},teasp.Tsf.JsNaviImport.prototype.getCurrentExpItem=function(){return tsfManager.getExpItemById(
this.fp.getFcByApiKey("ExpItemId__c").fetchValue().value)},teasp.Tsf.JsNaviImport.prototype.changedExpItem=function(e){this.showExtraItem()},teasp.Tsf.JsNaviImport.prototype.showExtraItem=function(e){var t=this.getCurrentExpItem(),s=e||this.getFormEl(),e=t&&t.isRequireChargeJob()||0;teasp.Tsf.Dom.show(".ts-row-job",s,0<e),teasp.Tsf.Dom.show(".ts-row-job .ts-require",s,2==e);for(var a=1;a<=2;a++){var o,i,
p=t?t.getExtraItem(a):null;teasp.Tsf.Dom.show(".ts-row-extra"+a,s,!!p),p&&(o=teasp.Tsf.Dom.node(".ts-row-extra"+a,s),(i=teasp.Tsf.Dom.node("div.ts-form-label > div",o))&&(i.innerHTML=p.name||"&nbsp;"),teasp.Tsf.Dom.show(".ts-require",o,p.require),(i=teasp.Tsf.Dom.node("div.ts-form-value > input",o))&&(i.style.width=Math.min(p.widthN,346)+"px",i.maxLength=p.maxLength))}},
teasp.Tsf.JsNaviImport.prototype.changedJob=function(e){var t=this.getCurrentJob(),s=this.fp.getElementByApiKey("JobId__c",null,this.getFormEl()),a=teasp.Tsf.Dom.nextSibling(s);a&&"INPUT"==a.tagName&&(a.value=t&&t.getName()||""),(s=this.fp.getElementByApiKey("JobId__r.JobCode__c",null,this.getFormEl()))&&(s.value=t&&t.getCode()||"")},teasp.Tsf.JsNaviImport.prototype.getCurrentJob=function(){
var e=this.fp.getElementByApiKey("JobId__c",null,this.getFormEl()).value||null;if(e)for(var t=this.getJobChoices(),s=0;s<t.length;s++)if(t[s].getId()==e)return t[s];return null},teasp.Tsf.JsNaviImport.prototype.getJobChoices=function(){var e=tsfManager.getEmpJobAssigns();return this.impJobs?e.concat(this.impJobs):e},teasp.Tsf.JsNaviImport.prototype.setImportJobs=function(e){for(var t=this.getJobChoices(),s=!1,
a=0;a<t.length;a++)if(t[a].getId()==e.Id){s=!0;break}s||(this.impJobs=[new teasp.Tsf.Job(e)])},teasp.Tsf.JsNaviImport.prototype.changedChargeDept=function(e){var t=this.getCurrentChargeDept(),s=this.fp.getElementByApiKey("ChargeDeptId__c",null,this.getFormEl()),a=teasp.Tsf.Dom.nextSibling(s);a&&"INPUT"==a.tagName&&(a.value=t&&t.Name||""),(s=this.fp.getElementByApiKey("ChargeDeptId__r.DeptCode__c",null,this.getFormEl(
)))&&(s.value=t&&t.DeptCode__c||""),this.expItemFilter.deptExpItemClass=t&&t.ExpItemClass__c||null,this.refreshExpItems()},teasp.Tsf.JsNaviImport.prototype.getCurrentChargeDept=function(){var e=this.fp.getElementByApiKey("ChargeDeptId__c",null,this.getFormEl());return e&&tsfManager.getInfo().getCacheDept(e.value||null)||null},teasp.Tsf.JsNaviImport.prototype.showError=function(e){var t=teasp.Tsf.Dom.node(
".ts-error-area",teasp.Tsf.Dom.byId(this.dialog.id));teasp.Tsf.Error.showError(e,t)},teasp.Tsf.JsNaviImport.prototype.ok=function(e){if(this.entryExpItem){for(var t=["JL","NH","JE","SF","JN","HD","JW","交通","航空","新幹線"],s=["BH","RT","GT","HR","宿泊"],a=["レンタカー"],o=["その他","金額","共通"],i={},p={},r=[],n={},l=tsfManager.getJtbExpItems()||{},c=this.orgData.data,m=0;m<c.records.length;m++){var d=null,h=c.records[m],f=(
h.SystemType__c,h.FunctionCode__c),g=h.Data01__c,u=(0<(l.e4||[]).length&&(d=tsfManager.getExpItemById(l.e4[0])),(g=g.replace("(","（")).indexOf("（")),y=g.indexOf("）"),g=g.substring(u+1,y),u=(null!=h.SystemType__c&&"J"==h.SystemType__c?-1<t.indexOf(f)||null!=g&&-1<t.indexOf(g)?0<(l.j1||[]).length&&(d=tsfManager.getExpItemById(l.j1[0])):-1<s.indexOf(f)||null!=g&&-1<s.indexOf(g)?0<(l.j2||[]).length&&(
d=tsfManager.getExpItemById(l.j2[0])):null!=g&&-1<a.indexOf(g)?0<(l.j3||[]).length&&(d=tsfManager.getExpItemById(l.j3[0])):null!=g&&-1<o.indexOf(g)&&0<(l.j4||[]).length&&(d=tsfManager.getExpItemById(l.j4[0])):null!=h.SystemType__c&&"F"==h.SystemType__c?-1<t.indexOf(f)||null!=g&&-1<t.indexOf(g)?0<(l.f1||[]).length&&(d=tsfManager.getExpItemById(l.f1[0])):-1<s.indexOf(f)||null!=g&&-1<s.indexOf(g)?0<(l.f2||[]).length&&(
d=tsfManager.getExpItemById(l.f2[0])):null!=g&&-1<a.indexOf(g)?0<(l.f3||[]).length&&(d=tsfManager.getExpItemById(l.f3[0])):null!=g&&-1<o.indexOf(g)&&0<(l.f4||[]).length&&(d=tsfManager.getExpItemById(l.f4[0])):-1<t.indexOf(f)||null!=g&&-1<t.indexOf(g)?0<(l.e1||[]).length&&(d=tsfManager.getExpItemById(l.e1[0])):-1<s.indexOf(f)||null!=g&&-1<s.indexOf(g)?0<(l.e2||[]).length&&(d=tsfManager.getExpItemById(l.e2[0])
):null!=g&&-1<a.indexOf(g)&&0<(l.e3||[]).length&&(d=tsfManager.getExpItemById(l.e3[0])),this.fp.fcLoop(function(e){e.isApiField(!0)&&e.fillValue(i,e.fetchValue())},this),null);i.ExtraItem1__c=null,(i.ExtraItem2__c=null)!=d&&(u=0<d.isRequireChargeJob()?this.getCurrentJob():null,d.getExtraItem(1)||(i.ExtraItem1__c=null),d.getExtraItem(2)||(i.ExtraItem2__c=null));0<tsfManager.isRequireChargeDept()&&(
p.Id=i.ChargeDeptId__c||null,i.ChargeDeptId__r&&(p.DeptCode__c=i.ChargeDeptId__r.DeptCode__c||null,p.Name=i.ChargeDeptId__r.Name||null));var _=this.orgData.expApply;r.push(_.createEmpExpFromCard(d,u,p,i.ExtraItem1__c,i.ExtraItem2__c,h,this.orgData.expenseType||null,n))}_.addEmpExps(r),this.entryExpItem()}this.hide()},teasp.Tsf.JsNaviImport.prototype.checkedAddToRemarks=function(e){var e=e||this.getFormEl(),
e=teasp.Tsf.Dom.node(".ts-row-detail div.ts-form-value",e),t=teasp.Tsf.Dom.node('input[type="checkbox"]',e),e=teasp.Tsf.Dom.node("textarea",e);teasp.Tsf.Dom.setAttr(e,"maxLength",t.checked?this.remarksAddMax:255)},teasp.Tsf.ExternalExpense=function(){this.notOpenLink=!0},teasp.Tsf.ExternalExpense.prototype=new teasp.Tsf.SearchList,teasp.Tsf.ExternalExpense.prototype.show=function(e,t){
this.option.deleteExtExp=teasp.Tsf.Dom.hitch(this,this.deleteExtExp),teasp.Tsf.SearchList.prototype.show.call(this,e,t)},teasp.Tsf.ExternalExpense.prototype.getButtons=function(e){return[{key:"extExpImport",label:teasp.message.getLabel("tf10002260"),css:"ts-dialog-ok"},{key:"deleteExtExp",label:teasp.message.getLabel("tf10005040"),css:"ts-cancel-apply"},{key:"close",label:teasp.message.getLabel("cancel_btn_title")}]}
,teasp.Tsf.ExternalExpense.prototype.deleteExtExp=function(){var t,e=this.collectRecords();e.length<=0?this.showError(teasp.message.getLabel("tf10005060")):(t=[],dojo.forEach(e,function(e){t.push(e.Id)}),t.length&&teasp.tsConfirm(teasp.message.getLabel("pit10001080"),this,function(e){e&&tsfManager.actionExternal({action:"remove",empId:tsfManager.getEmpId(),externalIds:t},teasp.Tsf.Dom.hitch(this,function(e,t){e?(
this.orgData.statusNums=t.statusNums,this.search()):this.showError(t)}))}))},teasp.Tsf.Calendar=function(){this.dialog=new dijit.TooltipDialog({id:"tsfCalendar",content:'<div><div id="tsfCalendarArea"></div></div>',onClick:function(e){e.preventDefault(),e.stopPropagation()},onKeyPress:dojo.hitch(this,function(e){27===e.keyCode&&dijit.popup.close(this.dialog)})}),this.dialog.startup(),dojo.connect(this.dialog,"onOpen"
,this,function(e){var t;this.calendar&&(this.calendar.destroyRecursive(!0),dojo.disconnect(this.calendarEvent)),this.calendar=new dijit.Calendar({isDisabledDate:this.param.isDisabledDate},"tsfCalendarArea"),this.param.tagName&&(t=dojo.query('input[name="'+this.param.tagName+'"]'))&&t.length&&(t=teasp.util.date.parseDate(t[0].value)||new Date,this.calendar.setValue(t)),this.calendarEvent=dojo.connect(this.calendar,
"onValueSelected",this,function(t){this.param.tagName&&(dojo.query('input[name="'+this.param.tagName+'"]').forEach(function(e){e.value=teasp.util.date.formatDate(t,"SLA"),this.param.selectedDate&&this.param.selectedDate(e)},this),dijit.popup.close(this.dialog))}),this.calendar.startup()})},teasp.Tsf.Calendar.prototype.eventOpenCalendar=function(e,t,s,a,o){e.connect(t,"onclick",this,function(){this.param=a||{},
dijit.popup.open({popup:this.dialog,around:s})},o)},teasp.Tsf.Calendar.prototype.eventCloseCalendar=function(e,t,s,a){e.connect(window,"onclick",this,function(e){0<=e.target.className.indexOf("dijitCalendar")||dojo.hasClass(e.target,s)||dojo.hasClass(e.target,"ts-legacy-cal")||dojo.hasClass(e.target,"pp_btn_ektsrch")||dijit.popup.close(this.dialog)},a)},teasp.Tsf.SectionBase=function(e){this.parent=e,this.rowMax=0,
this.checkable=!0,this.objMap={}},teasp.Tsf.SectionBase.createSectionBar=function(e,t,s,a){var a=e.create("div",{className:a||"ts-section-bar2"}),o=e.create("label",null,a);return e.create("div",{className:"ts-section-vbar"},o),s&&(o.style.cursor="pointer",e.create("input",{type:"checkbox"},e.create("div",{className:"ts-section-check"},o))),e.create("div",{className:"ts-section-title",innerHTML:t},o),a},
teasp.Tsf.SectionBase.prototype.createSectionBar=function(e,t,s,a){return teasp.Tsf.SectionBase.createSectionBar(e,t,s,a)},teasp.Tsf.SectionBase.prototype.createSectionApron=function(){return null},teasp.Tsf.SectionBase.prototype.getTbody=function(){return teasp.Tsf.Dom.node("table."+this.getFormCss()+" tbody")},teasp.Tsf.SectionBase.prototype.getDomHelper=function(){return this.parent.getDomHelper()},
teasp.Tsf.SectionBase.prototype.getDiscernment=function(){return this.fp.getDiscernment()},teasp.Tsf.SectionBase.prototype.getTitle=function(){return this.fp.getTitle()?this.fp.getTitle():this.parent.getSectionTitle(this.getDiscernment())},teasp.Tsf.SectionBase.prototype.isChild=function(){return this.fp.isChild()},teasp.Tsf.SectionBase.prototype.getRelationshipName=function(){return this.fp.getRelationshipName()},
teasp.Tsf.SectionBase.prototype.getObjBase=function(){return this.parent.getObjBase()},teasp.Tsf.SectionBase.prototype.getValues=function(){return this.parent.getSectionValues(this.getDiscernment())},teasp.Tsf.SectionBase.prototype.getValuesByRowIndex=function(e){return this.source?e<this.source.values.length?this.source.values[e]:{}:this.parent.getSectionValuesByRowIndex(this.getDiscernment(),e)},
teasp.Tsf.SectionBase.prototype.getValuesByUniqKey=function(e){return this.parent.getSectionValuesByUniqKey(this.getDiscernment(),e)},teasp.Tsf.SectionBase.prototype.isReadOnly=function(){return this.fp.isReadOnly()},teasp.Tsf.SectionBase.prototype.setReadOnly=function(e){this.fp.setReadOnly(e)},teasp.Tsf.SectionBase.prototype.createArea=function(){return[]},teasp.Tsf.SectionBase.prototype.getDock=function(){
return this.fp.getDock()},teasp.Tsf.SectionBase.prototype.getAreaCss=function(){return" ts-main-form"},teasp.Tsf.SectionBase.prototype.getFormCss=function(){return this.fp.getFormCss()},teasp.Tsf.SectionBase.prototype.getFormEl=function(){return teasp.Tsf.Dom.node("div."+this.getFormCss())},teasp.Tsf.SectionBase.prototype.createTableArea=function(e){var t,s,a=this.getDomHelper().create("div",{
className:"ts-section-form "+this.getFormCss()+this.getAreaCss()}),o=(teasp.Tsf.Dom.show(a,null,!this.checkable),this.createSectionTop()),o=(o&&teasp.Tsf.Dom.append(a,o),this.getDomHelper().create("table",{className:"ts-section-content "+this.getFormCss()},a)),i=this.getDomHelper().create("thead",null,o),p=this.getDomHelper().create("tr",null,i),r=0,n=!1,l=(this.fp.fcLoop(function(e){e.isHidden()||(
r+=e.appendFieldHead(this.getDomHelper(),p),e.isCheck()&&(n=!0))},this),this.getDomHelper().create("tbody",null,o)),o=this.getDomHelper().create("tfoot",null,o),p=this.getDomHelper().create("tr",{className:"ts-table-empty-row"},o),c=(this.fp.fcLoop(function(e){e.isHidden()||e.appendFieldEmptyCell(this.getDomHelper(),p)},this),e&&!this.isReadOnly()&&(this.getDomHelper().create("td",{colSpan:r},this.getDomHelper(
).create("tr",{className:"ts-table-border-1"},o)),this.getDomHelper().create("td",{colSpan:r},this.getDomHelper().create("tr",{className:"ts-table-border-2"},o)),e=this.getDomHelper().create("td",{colSpan:r},this.getDomHelper().create("tr",{className:"ts-table-bottom"},o)),o=this.getDomHelper().create("tr",null,this.getDomHelper().create("table",null,e)),s=this.getDomHelper().create("button",{className:"png-add",
title:teasp.message.getLabel("tk10000985")},this.getDomHelper().create("div",null,this.getDomHelper().create("td",null,o))),c=this.getDomHelper().create("button",{className:"png-del",title:teasp.message.getLabel("delete_btn_title")},this.getDomHelper().create("div",null,this.getDomHelper().create("td",null,o))),m=this.getDomHelper().create("button",{className:"png-up",title:teasp.message.getLabel("up_btn_title")},
this.getDomHelper().create("div",null,this.getDomHelper().create("td",null,o))),t=this.getDomHelper().create("button",{className:"png-down",title:teasp.message.getLabel("down_btn_title")},this.getDomHelper().create("div",null,this.getDomHelper().create("td",null,o))),o=this.getDomHelper().create("button",{className:"png-ido",title:teasp.message.getLabel("tf10006300")},this.getDomHelper().create("div",null,
this.getDomHelper().create("td",null,o))),this.getDomHelper().connect(s,"onclick",this,this.pushInsert),this.getDomHelper().connect(c,"onclick",this,this.pushDelete),this.getDomHelper().connect(m,"onclick",this,this.upRow),this.getDomHelper().connect(t,"onclick",this,this.downRow),this.getDomHelper().connect(o,"onclick",this,this.pushMove),teasp.Tsf.Dom.show(o,null,!1),s=this.getDomHelper().create("button",{
innerHTML:teasp.message.getLabel("tf10001570"),style:"display:none;",className:"ts-save-order"},e),this.getDomHelper().connect(s,"onclick",this,this.saveOrder)),n&&this.getDomHelper().connect(teasp.Tsf.Dom.node('.ts-form-checkbox input[type="checkbox"]',i),"onclick",this,function(e){var t=teasp.Tsf.Dom.node('.ts-form-checkbox input[type="checkbox"]',i);teasp.Tsf.Dom.query('div.ts-form-checkbox input[type="checkbox"]'
,l).forEach(function(e){teasp.Tsf.Dom.isVisible(e)&&(e.checked=t.checked)},this)}),[]),m=(this.getTitle()&&c.push(this.createSectionBar(this.getDomHelper(),this.getTitle(),this.checkable)),c.push(a),this.createSectionApron());return m&&c.push(m),c},teasp.Tsf.SectionBase.prototype.refreshView=function(){},teasp.Tsf.SectionBase.prototype.refreshDiffView=function(){},
teasp.Tsf.SectionBase.prototype.createSectionTop=function(){return null},teasp.Tsf.SectionBase.prototype.getCheckedRowIndexes=function(){var t=[],e=this.getTbody();return teasp.Tsf.Dom.query('div.ts-form-checkbox input[type="checkbox"]',e).forEach(function(e){e.checked&&(e=teasp.Tsf.Dom.getAncestorByTagName(e,"TR"),t.push(e.rowIndex-1))},this),t},teasp.Tsf.SectionBase.prototype.setCheckedByIndexes=function(s){
var e=this.getTbody();teasp.Tsf.Dom.query('div.ts-form-checkbox input[type="checkbox"]',e).forEach(function(e){var t=teasp.Tsf.Dom.getAncestorByTagName(e,"TR").rowIndex-1;s.contains(t)&&(e.checked=!0)},this)},teasp.Tsf.SectionBase.prototype.pushInsert=function(e){return this.insertRow(),!1},teasp.Tsf.SectionBase.prototype.insertRow=function(e){return null},teasp.Tsf.SectionBase.prototype.pushDelete=function(e){
var t=this.getCheckedRowIndexes();t.length<=0||this.deleteRows(t)},teasp.Tsf.SectionBase.prototype.deleteRows=function(o,e){e||teasp.tsConfirm(teasp.message.getLabel("tm20004550",o.length),this,function(e){if(e){for(var t=this.getTbody(),s=o.length-1;0<=s;s--){var a=o[s];this.deleteRow(t.rows[a])}0<this.rowMax&&this.showPlusButton(this.getRowCount()<this.rowMax),this.setRowBgColor(),this.refreshDiffView(),
this.changedCurrency()}})},teasp.Tsf.SectionBase.prototype.deleteRow=function(e,t,s){var a=this.getUniqKeyByRow(e);t||this.parent.deleteSectionValueByUniqKey(this.getDiscernment(),a),this.getDomHelper().freeBy(teasp.Tsf.Fp.getHkey(e)),teasp.Tsf.Dom.destroy(e)},teasp.Tsf.SectionBase.prototype.getRemoveIdList=function(){return this.parent.getRemoveIdList(this.getDiscernment())},
teasp.Tsf.SectionBase.prototype.upRow=function(e){for(var t=this.getTbody(),s=null,a=0;a<t.rows.length;a++){var o=t.rows[a],i=teasp.Tsf.Dom.node('div.ts-form-checkbox input[type="checkbox"]',o);if(!i)break;s&&i.checked?dojo.place(o,s,"before"):s=i.checked?null:o}this.setRowBgColor()},teasp.Tsf.SectionBase.prototype.downRow=function(e){for(var t=this.getTbody(),s=null,a=t.rows.length-1;0<=a;a--){var o=t.rows[a],
i=teasp.Tsf.Dom.node('div.ts-form-checkbox input[type="checkbox"]',o);i&&(s&&i.checked?dojo.place(o,s,"after"):s=i.checked?null:o)}this.setRowBgColor()},teasp.Tsf.SectionBase.prototype.pushMove=function(e){var t=this.getCheckedRowIndexes();t.length<=0||this.moveCheck(t)},teasp.Tsf.SectionBase.prototype.moveStart=function(){var e=this.getCheckedRowIndexes();e.length<=0||this.moveLine(e)},
teasp.Tsf.SectionBase.prototype.moveCheck=function(e){},teasp.Tsf.SectionBase.prototype.moveLine=function(e){},teasp.Tsf.SectionBase.prototype.saveOrder=function(e){},teasp.Tsf.SectionBase.prototype.getUniqKeyByRow=function(e){return this.getValueByApiKey("_uniqKey",teasp.Tsf.Fp.getHkey(e))},teasp.Tsf.SectionBase.prototype.insertTableRow=function(e){var t,s=this.getDomHelper().create("tr",{className:"ts-table-row"}),
a=teasp.Tsf.Fp.setHkey(this.getDomHelper(),s,e),e=(this.fp.fcLoop(function(e){e.isHidden()?this.getDomHelper().create("input",{type:"hidden",id:e.getDomId(a)},s):e.appendFieldCell(this.getDomHelper(),s,a)},this),teasp.Tsf.Dom.node(".ts-form-cal",s)),o=(e&&(o=teasp.Tsf.Dom.node('input[type="text"]',e.parentNode))&&tsfManager.eventOpenCalendar(this.getDomHelper(),e,o,{tagName:o.name,isDisabledDate:function(e){return!1}
},a),teasp.Tsf.Dom.node(".ts-form-currency input",s)),e=(o&&teasp.Tsf.Currency.eventInput(this.getDomHelper(),o,teasp.Tsf.Dom.hitch(this,this.changedCurrency),a),this.insertTableRowEx(s,a),this.getRowCount()),i=this.getValuesByRowIndex(e),p={};for(t in i)!i.hasOwnProperty(t)||"_"==t.substring(0,1)&&"_temp_attach"!=t||(p[t]=i[t]);return this.objMap[a]=p,this.fp.fcLoop(function(e){e.drawText(this.getDomHelper(),i,a,s)}
,this),teasp.Tsf.Dom.append(this.getTbody(),s),teasp.Tsf.Dom.show('input[type="checkbox"]',s,!i._removed),this.setRowBgColor(),0<this.rowMax&&this.showPlusButton(this.getRowCount()<this.rowMax),s},teasp.Tsf.SectionBase.prototype.insertTableRowEx=function(e,t){},teasp.Tsf.SectionBase.prototype.getRowCount=function(){var e=this.getTbody();return e?e.rows.length:0},teasp.Tsf.SectionBase.prototype.empty=function(e,t){
var s=this.getTbody();if(s)for(var a=s.rows.length-1;0<=a;a--)this.deleteRow(s.rows[a],e,t)},teasp.Tsf.SectionBase.prototype.setRowBgColor=function(){var e=this.getTbody();if(e)for(var t=0;t<e.rows.length;t++){var s=e.rows[t];teasp.Tsf.Dom.toggleClass(s,"ts-row-even",!(t%2)),teasp.Tsf.Dom.toggleClass(s,"ts-row-odd",t%2)}},teasp.Tsf.SectionBase.prototype.showPlusButton=function(e){var t=teasp.Tsf.Dom.node(
"table."+this.getFormCss());e?teasp.Tsf.Dom.show(".png-add",t,!0):teasp.Tsf.Dom.show(".png-add",t,!1)},teasp.Tsf.SectionBase.prototype.refresh=function(e){this.source=e,this.objMap={},this.source&&this.source.title&&(s=teasp.Tsf.Dom.node("div."+this.getFormCss()),s=teasp.Tsf.Dom.previousSibling(s),(a=teasp.Tsf.Dom.node(".ts-section-title",s)).innerHTML=this.source.title,(t=teasp.Tsf.Dom.node(".ts-section-jump",s))||(
(t=this.getDomHelper().create("a",{className:"ts-section-jump"},s)).title=teasp.message.getLabel("tf10000480"),this.getDomHelper().create("div",null,t)),s="expApplyId="+(this.source.id||""),s+="&empId="+tsfManager.getEmpId(),tsfManager.isReadMode()&&(s+="&mode=read"),t.href=teasp.getPageUrl("empExpView")+"?"+s);for(var t=e?e.values:this.getValues(),s=this.getRowCount(),a=t.length-s,o=0;o<a;o++)this.insertRow()},
teasp.Tsf.SectionBase.prototype.changedCurrency=function(e){this.parent.changedCurrency(e)},teasp.Tsf.SectionBase.prototype.show=function(s){dojo.forEach(teasp.Tsf.Dom.query("div."+this.getFormCss()),function(e){var t=teasp.Tsf.Dom.previousSibling(e);teasp.Tsf.Dom.show(t,null,s),teasp.Tsf.Dom.show(e,null,s)})},teasp.Tsf.SectionBase.prototype.isVisible=function(){return teasp.Tsf.Dom.isVisible(teasp.Tsf.Dom.node(
"div."+this.getFormCss()))},teasp.Tsf.SectionBase.prototype.open=function(e){var t,s;this.checkable&&(s=teasp.Tsf.Dom.node("div."+this.getFormCss()),t=teasp.Tsf.Dom.previousSibling(s),teasp.Tsf.Dom.show(s,null,e),(s=teasp.Tsf.Dom.node('input[type="checkbox"]',t))&&(s.checked=e))},teasp.Tsf.SectionBase.prototype.isOpen=function(){var e;return!this.checkable||(e=teasp.Tsf.Dom.node("div."+this.getFormCss()),
e=teasp.Tsf.Dom.previousSibling(e),!(e=teasp.Tsf.Dom.node('input[type="checkbox"]',e))||e.checked)},teasp.Tsf.SectionBase.prototype.existValue=function(){var t,s,e=this.getValues();return this.fp.isChild()||this.fp.isVirChild()?0<e.length:(t=!1,s=this.getValuesByRowIndex(0),this.fp.fcLoop(function(e){!e.isHidden()&&e.parseSimple(s).value&&(t=!0)},this),t)},teasp.Tsf.SectionBase.prototype.setValueByApiKey=function(e,t
,s){e=this.fp.getElementByApiKey(e,t);e&&(e.value=s)},teasp.Tsf.SectionBase.prototype.getValueByApiKey=function(e,t){return this.fp.getFcByApiKey(e).fetchValue(t).value},teasp.Tsf.SectionBase.prototype.getChildValues=function(s,e,a,t,o){var i=this.objMap[s]||{};if(a){var p,r=[];for(p in i)!i.hasOwnProperty(p)||"_"!=p.substring(0,1)&&"checked"!=p||r.push(p);for(var n=0;n<r.length;n++)delete i[r[n]]}var l=0,c=[];if(
this.isChild()&&this.fp.fcLoop(function(e){var t;(e.getApiKey(null,a)||!a&&e.isCheck())&&(t=e.fillValue(i,e.fetchValue(s,a)),e.checkValid(t,o,c),t&&l++)},this),t&&0<l)for(var m=0;m<c.length;m++)t.push(c[m]);return i},teasp.Tsf.SectionBase.prototype.getDomValues=function(e,s){var a={objectName:this.fp.getObjectName(),values:[],types:{},fixes:{},removes:[]},t=this.getTbody(),o=teasp.Tsf.Fp.getHkeys(t),i=[];if(
this.isChild()){this.fp.fcLoop(function(e){var t;e.isApiField(!0)&&(t=e.getApiKey(),a.types[t]=e.getSObjType(),e.getFix()&&(a.fixes[t]=e.getFix()))},this);for(var p=0;p<o.length;p++)(l=this.getChildValues(o[p],t,e,i,s))._removed||a.values.push(l);a.removes=this.getRemoveIdList()}else{var r=this.isOpen();if(this.fp.isVirChild())for(var n=this.fp.getVirMax()||o.length,p=0;p<n;p++){var l={},c=0,m=[];this.fp.fcLoop(
function(e){var t;e.isApiField(!0)&&(t=e.getApiKey(p+1),l[t]=r&&p<o.length?e.fetchValue(o[p]).value:null,teasp.Tsf.Fc.setObjSimpleValue(l,t,l[t]),a.types[t]=e.getSObjType(),e.getFix()&&(a.fixes[t]=e.getFix()),r&&e.checkValid(l[t],s,m),l[t]&&c++)},this),a.values.push(l);for(var d=0;0<c&&d<m.length;d++)i.push(m[d])}else{l={},m=[];this.fp.fcLoop(function(e){var t;e.isApiField(!0)&&(t=e.getApiKey(),l[t]=r?e.fetchValue(
).value:null,teasp.Tsf.Fc.setObjSimpleValue(l,t,l[t]),a.types[t]=e.getSObjType(),e.getFix()&&(a.fixes[t]=e.getFix()),r&&e.checkValid(l[t],s,m))},this),a.values.push(l);for(d=0;d<m.length;d++)i.push(m[d])}s&&(a.ngList=i)}return a},teasp.Tsf.SectionBase.prototype.setAttachmentInfo=function(e){},teasp.Tsf.SectionBase.prototype.importEmpExps=function(e,t){},teasp.Tsf.SectionBase.prototype.restoreCheck=function(e){},
teasp.Tsf.SectionBase.prototype.getMisMatchFlag=function(){return 0},teasp.Tsf.SectionBase.prototype.getMisMatchFlagCheckedOnly=function(){return 0},teasp.Tsf.SectionBase.prototype.changedFilter=function(e){},teasp.Tsf.SectionAllowance=function(e){this.parent=e,this.fp=teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.sectionAllowance),this.checkable=!1,this.reskey="A",this.pageNo=1,this.rowMax=7},
teasp.Tsf.SectionAllowance.prototype=new teasp.Tsf.SectionBase,teasp.Tsf.SectionAllowance.prototype.insertRow=function(e){return this.insertTableRow(e)},teasp.Tsf.SectionAllowance.prototype.insertTableRowEx=function(e,t){teasp.Tsf.Dom.query("select.ts-form-select",e).forEach(function(e){/^SecAllow.+Allow$/.test(e.id)?this.setAllowanceItem(e):/^SecAllow.+Hotel$/.test(e.id)&&this.setHotelItem(e),this.getDomHelper(
).connect(e,"onchange",this,this.changedSelect,t)},this)},teasp.Tsf.SectionAllowance.prototype.setAllowanceItem=function(t){teasp.Tsf.Dom.empty(t),this.getDomHelper().create("option",{value:"",innerHTML:""},t);var e=tsfManager.getExpItems(this.expItemFilter);dojo.forEach(e,function(e){e.isAllowance()&&this.getDomHelper().create("option",{value:e.getId(),innerHTML:e.getName()},t)},this)},
teasp.Tsf.SectionAllowance.prototype.setHotelItem=function(t){teasp.Tsf.Dom.empty(t),this.getDomHelper().create("option",{value:"",innerHTML:""},t);var e=tsfManager.getExpItems(this.expItemFilter);dojo.forEach(e,function(e){e.isHotel()&&this.getDomHelper().create("option",{value:e.getId(),innerHTML:e.getName()},t)},this)},teasp.Tsf.SectionAllowance.prototype.loadExpItemFilter=function(){var e=this.parent.getAssist();
this.expItemFilter={empExpItemClass:tsfManager.getTargetEmp().getExpItemClass(),deptExpItemClass:e&&e.ChargeDeptId__r&&e.ChargeDeptId__r.ExpItemClass__c||null,expenseType:e&&e.ExpenseType__c||null}},teasp.Tsf.SectionAllowance.prototype.createArea=function(){return this.loadExpItemFilter(),this.createTableArea()},teasp.Tsf.SectionAllowance.prototype.createTableArea=function(e){
var e=teasp.Tsf.SectionBase.prototype.createTableArea.call(this,e),t=this.getDomHelper().create("div",{className:"allowance-mismatch",style:"display:none;"},e[e.length-1]);return this.getDomHelper().create("div",{className:"pp_ico_ng"},t),this.getDomHelper().create("div",{className:"ng-message"},t),e},teasp.Tsf.SectionAllowance.prototype.createSectionTop=function(){return this.getDomHelper().create("div",{
className:"ts-list-paging"})},teasp.Tsf.SectionAllowance.prototype.rebuild=function(e){this.startDate=e.startDate,this.endDate=e.endDate,this.tryChangePage(1),this.changedCurrency()},teasp.Tsf.SectionAllowance.prototype.getValuesByRowIndex=function(e){e=this.rowMax*(this.pageNo-1)+e;return teasp.Tsf.SectionBase.prototype.getValuesByRowIndex.call(this,e)},teasp.Tsf.SectionAllowance.prototype.deleteRow=function(e,t,s){
this.getDomHelper().freeBy(teasp.Tsf.Fp.getHkey(e)),teasp.Tsf.Dom.destroy(e)},teasp.Tsf.SectionAllowance.prototype.tryChangePage=function(e){for(var t=teasp.Tsf.SectionBase.prototype.getDomValues.call(this),t=this.parent.rebuildExpPreApplyDay(this.startDate,this.endDate,t),e=(this.loadExpItemFilter(),this.empty(),this.pageNo=e,this.recordCount=t.length,this.recordCount-this.rowMax*(this.pageNo-1)),
s=e<this.rowMax?e:this.rowMax,a=0;a<s;a++)this.insertRow();t=teasp.Tsf.Dom.node(".ts-list-paging",teasp.Tsf.Dom.node("div."+this.getFormCss()));teasp.Tsf.ListBase.setPaging({pageNo:this.pageNo,cntAll:this.recordCount,rowLimit:this.rowMax},t,this.getDomHelper(),"paging",this),this.checkExpMatching()},teasp.Tsf.SectionAllowance.prototype.changePage=function(e){var t=e,s=this;return function(){s.tryChangePage(t)}},
teasp.Tsf.SectionAllowance.prototype.getDomValues=function(e){e=teasp.Tsf.SectionBase.prototype.getDomValues.call(this,e);return e.values=this.parent.rebuildExpPreApplyDay(this.startDate,this.endDate,e),e},teasp.Tsf.SectionAllowance.prototype.refreshView=function(){this.tryChangePage(this.pageNo)},teasp.Tsf.SectionAllowance.prototype.checkExpMatching=function(){this.loadExpItemFilter();var e=this.getDomValues();
this.misMatchObj={};for(var t=0;t<e.values.length;t++){var s=e.values[t],a=this.getExpMatching(s);this.misMatchObj[s.Date__c]=a}this.showExpMatching()},teasp.Tsf.SectionAllowance.prototype.getMisMatchCount=function(){var e,t,s=0;for(e in this.misMatchObj||{})!this.misMatchObj.hasOwnProperty(e)||(t=this.misMatchObj[e])&&(t.aflag&&s++,t.hflag&&s++);return s},teasp.Tsf.SectionAllowance.prototype.getExpMatching=function(
e){var t=e.AllowanceItemId__c?tsfManager.getExpItemById(e.AllowanceItemId__c):null,e=e.HotelItemId__c?tsfManager.getExpItemById(e.HotelItemId__c):null,s=0,a=0;return t&&(t.checkExpenseType(this.expItemFilter.expenseType)||(s=teasp.Tsf.EmpExp.MISMATCH_EXPENSE_TYPE),t.isSelectable(this.expItemFilter.empExpItemClass)||t.isSelectable(this.expItemFilter.deptExpItemClass)||(s|=teasp.Tsf.EmpExp.MISMATCH_EXPITEM_CLASS)),e&&(
e.checkExpenseType(this.expItemFilter.expenseType)||(a=teasp.Tsf.EmpExp.MISMATCH_EXPENSE_TYPE),e.isSelectable(this.expItemFilter.empExpItemClass)||e.isSelectable(this.expItemFilter.deptExpItemClass)||(a|=teasp.Tsf.EmpExp.MISMATCH_EXPITEM_CLASS)),s||a?{aflag:s,hflag:a}:null},teasp.Tsf.SectionAllowance.prototype.showExpMatching=function(){if(this.parent.isShowMisMatch()){for(var e=this.getTbody(),
t=teasp.Tsf.Fp.getHkeys(e),s=0;s<t.length;s++){var a,o,i,p=teasp.Tsf.Fp.getRowByHkey(e,t[s]),r=teasp.Tsf.Dom.node("td.ts-form-date",p);r&&(a=teasp.Tsf.Dom.node("div",r),r=teasp.Tsf.Dom.node('input[type="hidden"]',r),i=[],(r=(o=this.misMatchObj[r.value])&&o.aflag|o.hflag||0)&teasp.Tsf.EmpExp.MISMATCH_EXPENSE_TYPE&&i.push(teasp.message.getLabel("tf10006860")),r&teasp.Tsf.EmpExp.MISMATCH_EXPITEM_CLASS&&i.push(
teasp.message.getLabel("tf10006870")),teasp.Tsf.Dom.toggleClass(a,"ts-mismatch2",!!i.length),r=teasp.Tsf.Dom.node("div.pp_ico_ng",a),i.length?r||this.getDomHelper().create("div",{className:"pp_ico_ng"},a):r&&teasp.Tsf.Dom.destroy(r),a.title=i.length?i.join("\r\n"):"",teasp.Tsf.Dom.query("select.ts-form-select",p).forEach(function(e){/^SecAllow.+Allow$/.test(e.id)?teasp.Tsf.Dom.style(e,"backgroundColor",
o&&o.aflag?"#FFDEE4":"white"):/^SecAllow.+Hotel$/.test(e.id)&&teasp.Tsf.Dom.style(e,"backgroundColor",o&&o.hflag?"#FFDEE4":"white")},this))}var n,l=teasp.Tsf.Dom.node("div.allowance-mismatch",this.getFormEl());l&&(n=this.getMisMatchCount(),teasp.Tsf.Dom.show(l,null,!!n),teasp.Tsf.Dom.node("div.ng-message",l).innerHTML=n?teasp.message.getLabel("tf10006910",n):"")}},
teasp.Tsf.SectionAllowance.prototype.changedSelect=function(e){var t;this.misMatchObj&&(e=teasp.Tsf.Dom.getAncestorByTagName(e.target,"TR"),t={},teasp.Tsf.Dom.query("select.ts-form-select",e).forEach(function(e){/^SecAllow.+Allow$/.test(e.id)?t.AllowanceItemId__c=e.value||null:/^SecAllow.+Hotel$/.test(e.id)&&(t.HotelItemId__c=e.value||null)},this),(e=teasp.Tsf.Dom.node('td.ts-form-date input[type="hidden"]',e))&&(
t.Date__c=e.value,this.misMatchObj[t.Date__c]=this.getExpMatching(t)),this.showExpMatching()),this.changedCurrency()},teasp.Tsf.SectionAllowance.prototype.getMisMatchFlag=function(){var e,t,s=0;for(e in this.misMatchObj||{})!this.misMatchObj.hasOwnProperty(e)||(t=this.misMatchObj[e])&&(s|=t.aflag|t.hflag);return s},teasp.Tsf.SectionCoupon=function(e){this.parent=e,this.fp=teasp.Tsf.Fp.createFp(
teasp.Tsf.formParams.sectionCoupon),this.rowMax=2},teasp.Tsf.SectionCoupon.prototype=new teasp.Tsf.SectionBase,teasp.Tsf.SectionCoupon.prototype.insertRow=function(e){return this.insertTableRow(e)},teasp.Tsf.SectionCoupon.prototype.insertTableRowEx=function(e,t){var s=this.fp.getElementByApiKey("couponName",t,e);s&&(this.getDomHelper().create("option",{value:"",innerHTML:""},s),dojo.forEach(
tsfManager.getExpCouponList(),function(e){this.getDomHelper().create("option",{value:e,innerHTML:e},s)},this))},teasp.Tsf.SectionCoupon.prototype.createArea=function(){return this.createTableArea(!0)},teasp.Tsf.SectionDetail=function(e,t){this.parent=e,this.fp=teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.sectionDetail,t),this.checkable=!1,this.lastDate=null,this.misMatch=0,this.filter=null},
teasp.Tsf.SectionDetail.prototype=new teasp.Tsf.SectionBase,teasp.Tsf.SectionDetail.prototype.createSectionBar=function(e,t,s){var e=teasp.Tsf.SectionBase.createSectionBar(e,t,s),t=(this.fp.getSubkey()&&teasp.Tsf.Dom.style(e,"marginTop","10px"),this.getDomHelper().create("div",{className:"ts-section-option"},e)),s=this.getDomHelper().create("label",null,t),a=this.getDomHelper().create("input",{type:"checkbox"},s);
return a.checked=tsfManager.isDiffView(),this.getDomHelper().create("span",{innerHTML:" "+teasp.message.getLabel("tf10001930")},s),this.getDomHelper().connect(a,"onclick",this,function(e){tsfManager.setDiffView(a.checked),this.refreshDiffView()}),teasp.Tsf.Dom.show(t,null,!1),e},teasp.Tsf.SectionDetail.prototype.createSectionApron=function(){var e=this.getDomHelper().create("div",{
className:"ts-form-apron"+this.getAreaCss()}),t=this.getDomHelper().create("tr",null,this.getDomHelper().create("tbody",null,this.getDomHelper().create("table",{className:"ts-form-control"},this.getDomHelper().create("div",{className:"ts-form-edge-left"},e))));return 0==this.parent.getFormStyle()&&this.getDomHelper().create("button",{innerHTML:teasp.message.getLabel("tf10001500")},this.getDomHelper().create("td",{
className:"ts-form-cardread ts-std-button"},t)),this.getDomHelper().create("button",{innerHTML:teasp.message.getLabel("tf10003570")},this.getDomHelper().create("td",{className:"ts-form-histexp ts-std-button"},t)),0==this.parent.getFormStyle()&&tsfManager.isUsingReceiptSystem()&&this.getDomHelper().create("button",{innerHTML:teasp.message.getLabel("tf10004950")},this.getDomHelper().create("td",{
className:"ts-form-receipt ts-std-button"},t)),0==this.parent.getFormStyle()&&tsfManager.isUsingJsNaviSystem()&&this.getDomHelper().create("button",{innerHTML:teasp.message.getLabel("jt13000010")},this.getDomHelper().create("td",{className:"ts-form-jtb ts-std-button"},t)),0==this.parent.getFormStyle()&&tsfManager.isUseConnectICExpense()&&this.getDomHelper().create("button",{innerHTML:teasp.message.getLabel(
"pit10001010")},this.getDomHelper().create("td",{className:"ts-form-pitexp ts-std-button"},t)),tsfManager.getInfo().isUseCsvImport(this.parent.getObjBase().getTypeName())&&!teasp.Tsf.util.isSforceOne()&&this.getDomHelper().create("button",{innerHTML:teasp.message.getLabel("ci00000010")},this.getDomHelper().create("td",{className:"ts-form-csvup ts-std-button"},t)),0==this.parent.getFormStyle()&&teasp.Tsf.Dom.style(e,
"width","100%"),e},teasp.Tsf.SectionDetail.prototype.refresh=function(e){this.misMatch=0,teasp.Tsf.SectionBase.prototype.refresh.call(this,e);var t,e=teasp.Tsf.Dom.nextSibling(teasp.Tsf.Dom.getAncestorByTagName(this.getTbody(),"DIV"));e&&(this.source?teasp.Tsf.Dom.show(e,null,!1):(t=this.isVisible()&&!this.parent.isReadOnly(),teasp.Tsf.Dom.show(e,null,t),t&&teasp.Tsf.Dom.hasClass(e,"ts-main-form")&&((
t=teasp.Tsf.Dom.node("div.ts-section-detail"))&&teasp.Tsf.Dom.style(t,"margin-bottom","0px")))),this.isPre()||this.source||teasp.Tsf.Dom.show("button.png-ido",this.getFormEl(),!0)},teasp.Tsf.SectionDetail.prototype.refreshView=function(e){this.refreshDiffView(null,e)},teasp.Tsf.SectionDetail.prototype.refreshDiffView=function(e,t){var s=this.getDomValues();this.source?(this.source.values=s.values,dojo.forEach(
this.source.values,function(e){e._route=new teasp.Tsf.EmpExp(e)})):(t||(this.parent.getObjBase().obj.EmpExp__r=s.values),e&&(this.parent.getObjBase().obj.EmpExp__r=this.parent.getObjBase().obj.EmpExp__r.concat(e)),this.parent.getObjBase().linkPreApplyAll()),this.empty(!0,!0),this.refresh(this.source)},teasp.Tsf.SectionDetail.prototype.pushInsert=function(e){var t,s=e.target;return 0<=s.className.indexOf(
"ts-content-invoiceURL")||("A"==s.tagName?(t=(t=teasp.Tsf.Dom.getAncestorByTagName(s,"TR"))?teasp.Tsf.Fp.getHkey(t):null)&&this.openDetail(t):"BUTTON"==s.tagName&&this.openDetail(),e.preventDefault(),e.stopPropagation()),!1},teasp.Tsf.SectionDetail.prototype.clickRow=function(e){"INPUT"==e.target.tagName&&"checkbox"==e.target.type||(e=teasp.Tsf.Dom.getAncestorByCssName(e.target,"ts-table-row"))&&(
e=teasp.Tsf.Dom.node('div.ts-form-checkbox input[type="checkbox"]',e))&&(e.checked=!e.checked)},teasp.Tsf.SectionDetail.prototype.getLastOrderOfSource=function(){var t=0;return this.source&&dojo.forEach(this.source.values,function(e){t<e.Order__c&&(t=e.Order__c)}),t},teasp.Tsf.SectionDetail.prototype.openDetail=function(e){var t=this.source?this.source.assist:this.parent.getAssist(this.getFilterExpenseType()),e={
hkey:e||teasp.Tsf.Fp.createHkey(),ro:this.isReadOnly(),pre:this.isPre(),expItemClass:this.getObjBase().getEmpExpItemClass(),defaultDeptId:this.getObjBase().getDeptId(!0),values:e?this.getChildValues(e,this.getTbody()):this.getObjBase().createEmpExp(t),targetDate:this.source&&this.source.targetDate||null,defaultDate:this.lastDate,nextOrder:this.getLastOrderOfSource()+1,assist:t,
isShowMisMatch:this.parent.isShowMisMatch(),expenseType:this.getFilterExpenseType()};tsfManager.showDialog("ExpDetail",e,teasp.Tsf.Dom.hitch(this,this.entryDetail))},teasp.Tsf.SectionDetail.prototype.insertRow=function(e){var e=this.insertTableRow(e),t=teasp.Tsf.Fp.getHkey(e),s=(this.parent.injectTimeReportLink&&!tsfManager.isDisabledTimeReport()&&this.parent.injectTimeReportLink(e),this.getValueByApiKey("_removed",t
));return this.isReadOnly()||s||teasp.Tsf.Dom.style(e,"cursor","pointer"),this.getDomHelper().connect(e,"onclick",this,this.clickRow,t),this.getDomHelper().connect(teasp.Tsf.Dom.query("a",e),"onclick",this,this.pushInsert,t),this.misMatch|=this.checkExpMatching(e,this.getChildValues(t,this.getTbody())),e},teasp.Tsf.SectionDetail.prototype.insertTableRowEx=function(e,t){return e},
teasp.Tsf.SectionDetail.prototype.entryDetail=function(e){var t,s,a;this.source?tsfManager.showFormT(e.empExps,e.targetDate):(t=e.hkey,this.getDomHelper().freeBy(t),!(s=teasp.Tsf.Fp.getRowByHkey(this.getTbody(),t))?s=this.insertRow(t):this.getDomHelper().connect(s,"onclick",this,this.clickRow,t),(a=this.objMap[t]=e.values)._route=new teasp.Tsf.EmpExp(a,this.isPre()),this.fp.fcLoop(function(e){e.drawText(
this.getDomHelper(),a,t)},this),this.getDomHelper().connect(teasp.Tsf.Dom.query("a",s),"onclick",this,this.pushInsert,t),this.refreshDiffView(),this.changedCurrency())},teasp.Tsf.SectionDetail.prototype.createArea=function(){return this.createTableArea(!0)},teasp.Tsf.SectionDetail.prototype.isPre=function(){return!(tsfManager.getTarget()==teasp.Tsf.Manager.EXP_APPLY)},
teasp.Tsf.SectionDetail.prototype.getAreaCss=function(){return this.isPre()?teasp.Tsf.SectionBase.prototype.getAreaCss.call(this):""},teasp.Tsf.SectionDetail.prototype.getDomValues=function(e){var e=teasp.Tsf.SectionBase.prototype.getDomValues.call(this,e),a={},o=null;return dojo.forEach(e.values,function(e){e.CurrencyRate__c=teasp.Tsf.util.getNumStr(e.CurrencyRate__c),e.ForeignAmount__c=teasp.Tsf.util.getNumStr(
e.ForeignAmount__c),e.Tax__c=teasp.Tsf.util.getNumStr(e.Tax__c),e.WithoutTax__c=teasp.Tsf.util.getNumStr(e.WithoutTax__c),e.UnitPrice__c=teasp.Tsf.util.getNumStr(e.UnitPrice__c),e.Cost__c=teasp.Tsf.util.getNumStr(e.Cost__c),e.TaxType__c=teasp.Tsf.util.getNumStr(e.TaxType__c);var t,s=teasp.util.date.formatDate(e.Date__c);s&&((t=(t=a[s])||(a[s]=[])).push(e),e.Order__c=t.length,(!o||o<s)&&(o=s))},this),this.lastDate=o,e
},teasp.Tsf.SectionDetail.prototype.empty=function(e,t){teasp.Tsf.SectionBase.prototype.empty.call(this,e,t),this.changedCurrency()},teasp.Tsf.SectionDetail.prototype.setAttachmentExist=function(e,t){var s=this.getTbody();if(s)for(var a=0;a<s.rows.length;a++){var o=s.rows[a],i=teasp.Tsf.Fp.getHkey(o);if(this.getValueByApiKey("Id",i)==e){teasp.Tsf.EmpExp.setAttachmentExist2(this.getDomHelper(),o,this.objMap[i],t);
break}}},teasp.Tsf.SectionDetail.prototype.deleteRows=function(i){this.source?teasp.tsConfirm(teasp.message.getLabel("tm20004550",i.length),this,function(e){if(e){for(var t=[],s=this.getTbody(),a=i.length-1;0<=a;a--){var o=i[a],o=s.rows[o],o=teasp.Tsf.Fp.getHkey(o),o=this.getValueByApiKey("Id",o);t.push(o)}e={EmpId__c:tsfManager.getEmpId(),date:this.source.targetDate,idset:t};tsfManager.deleteEmpExp(e,
teasp.Tsf.Dom.hitch(this,function(e,t){e?(tsfManager.showFormT(t.empExps,t.targetDate),this.changedCurrency()):teasp.Tsf.Error.showError(t)}))}}):teasp.Tsf.SectionBase.prototype.deleteRows.call(this,i,!1)},teasp.Tsf.SectionDetail.prototype.saveOrder=function(e){var t=this.getDomValues(),t={EmpId__c:tsfManager.getEmpId(),ExpApplyId__c:null,ExpPreApplyId__c:null,date:this.source&&this.source.targetDate||null,
exps:t.values};tsfManager.saveEmpExp(t,teasp.Tsf.Dom.hitch(this,function(e,t){e?this.refreshDiffView():teasp.Tsf.Error.showError(t)}))},teasp.Tsf.SectionDetail.prototype.setRowBgColor=function(){if(teasp.Tsf.SectionBase.prototype.setRowBgColor.call(this),this.source){for(var e=[],t=this.source.values||[],s=0;s<t.length;s++)e.push(t[s].Id);for(var a=[],o=this.getTbody(),s=0;s<o.rows.length;s++){var i=o.rows[s],
i=teasp.Tsf.Fp.getHkey(i);a.push(this.getValueByApiKey("Id",i))}var p=e.join(":")!=a.join(":");teasp.Tsf.Dom.show("button.ts-save-order",null,p)}},teasp.Tsf.SectionDetail.prototype.selectHistory=function(){for(var e,t=teasp.Tsf.formParams.expHistory,s=[],a=t.searchFields||[],o=0;o<a.length;o++)"ExpItemId__c"==a[o].apiKey&&(e=this.parent.getAssist(this.getFilterExpenseType()),e={
empExpItemClass:tsfManager.getTargetEmp().getExpItemClass(),deptExpItemClass:e&&e.ChargeDeptId__r&&e.ChargeDeptId__r.ExpItemClass__c||null,expenseType:e&&e.ExpenseType__c||null},e=tsfManager.getExpItems(e,!0),a[o].pickList=[{n:teasp.message.getLabel("tk10004480"),v:""}],dojo.forEach(e,function(e){a[o].pickList.push({n:e.getName(),v:e.getId()}),s.push("'"+e.getId()+"'")}));s.length?(t=this.isPre()?"!=null":"=null",
tsfManager.showSearchListDialog({discernment:"expHistory",values:{ExpPreApplyId__c:t}},{histImport:teasp.Tsf.Dom.hitch(this,this.openHistImport),filts:[{filtVal:"ExpPreApplyId__c"+t},{filtVal:"ExpItemId__c in ("+s.join(",")+")"}]})):teasp.tsAlert(teasp.message.getLabel("tf10006780"))},teasp.Tsf.SectionDetail.prototype.openHistImport=function(e,t,s){e.records.length<=0?s(teasp.message.getLabel("tf10001760")):(
s=this.getObjBase().createEmpExpFromExp(e.records[0]),this.isPre()&&delete s.Publisher__c,e={hkey:teasp.Tsf.Fp.createHkey(),ro:this.isReadOnly(),pre:this.isPre(),expItemClass:this.getObjBase().getEmpExpItemClass(),defaultDeptId:this.getObjBase().getDeptId(!0),values:s,fromHist:!0,targetDate:null,nextOrder:1,assist:this.parent.getAssist(this.getFilterExpenseType()),parentHide:t,
isShowMisMatch:this.parent.isShowMisMatch(),expenseType:this.getFilterExpenseType()},tsfManager.showDialog("ExpDetail",e,teasp.Tsf.Dom.hitch(this,this.entryDetail)))},teasp.Tsf.SectionDetail.prototype.moveCheck=function(e){for(var t=this.getTbody(),s=0;s<e.length;s++){var a=e[s];if("JTB"==this.getChildValues(teasp.Tsf.Fp.getHkey(t.rows[a])).Item__c)return void teasp.tsAlert(teasp.message.getLabel("tf10008130"))}
tsfManager.checkDiff()?teasp.tsConfirm(teasp.message.getLabel("tf10006350"),this,function(e){e&&tsfManager.saveExpApply(!0,teasp.Tsf.Dom.hitch(this,function(e,t){e?tsfManager.changeView(null,t.id,teasp.Tsf.Dom.hitch(this,function(){tsfManager.restoreCheck(t.exps),tsfManager.moveStart()})):teasp.Tsf.Error.showError(t)}))}):this.moveLine(e)},teasp.Tsf.SectionDetail.prototype.moveLine=function(e){for(var t,s,a,o,i=[],
p=this.getTbody(),r=0;r<e.length;r++){var n=e[r];i.push(this.getChildValues(teasp.Tsf.Fp.getHkey(p.rows[n]),p))}i.length&&(t=this.getObjBase().getId(),s={filts:[{filtVal:teasp.Tsf.util.formatString("EmpId__c = '{0}'",tsfManager.getEmpId())},{filtVal:"StatusD__c in ('未申請','却下','申請取消','確定取消')"}]},t&&s.filts.push({filtVal:teasp.Tsf.util.formatString("Id != '{0}'",t)}),o=null,this.parent.isUseExpFilter()&&(o=(
a=this.parent.getAssist(this.getFilterExpenseType()))&&a.ExpenseType__c||null),tsfManager.showSearchListDialog({discernment:"expApplyList",values:i,dialog:"ExpApplyList",title:teasp.message.getLabel("tf10006330"),sourceId:t,moveDone:teasp.Tsf.Dom.hitch(this,function(e){tsfManager.changeView(null,e)}),expenseType:o},s))},teasp.Tsf.SectionDetail.prototype.restoreCheck=function(e){for(var t={},s=(dojo.forEach(e||[],
function(e){t[e.Id]=e.checked}),this.getTbody()),a=0;a<s.rows.length;a++){var o=s.rows[a],i=teasp.Tsf.Fp.getHkey(o),i=this.getValueByApiKey("Id",i);!t[i]||(i=teasp.Tsf.Dom.node('div.ts-form-checkbox input[type="checkbox"]',o))&&(i.checked=!0)}},teasp.Tsf.SectionDetail.prototype.getExpMatching=function(e){var t,s,a=this.source?this.source.assist:this.parent.getAssist(this.getFilterExpenseType()),o=0,i=null,p=null,
r=tsfManager.getExpItemById(e.ExpItemId__c),n=(r&&(a={empExpItemClass:tsfManager.getTargetEmp().getExpItemClass(),deptExpItemClass:e.ChargeDeptId__r&&e.ChargeDeptId__r.ExpItemClass__c||a&&a.ChargeDeptId__r&&a.ChargeDeptId__r.ExpItemClass__c||null,expenseType:a&&a.ExpenseType__c||null},r.checkExpenseType(a.expenseType)||(o=teasp.Tsf.EmpExp.MISMATCH_EXPENSE_TYPE),r.isSelectable(a.empExpItemClass)||r.isSelectable(
a.deptExpItemClass)||(o|=teasp.Tsf.EmpExp.MISMATCH_EXPITEM_CLASS),t=tsfManager.getPayeeTypeNums(a.expenseType),s=e.PayeeId__r&&e.PayeeId__r.PayeeType__c||null,n=e.PayeeId__r&&e.PayeeId__r.ExpenseType__c||null,t[s||1]||!a.expenseType&&1==(s||1)||(o|=teasp.Tsf.EmpExp.MISMATCH_PAY_TYPE),!n||a.expenseType&&n.split(/,/).contains(a.expenseType)||(o|=teasp.Tsf.EmpExp.MISMATCH_PAY_EXPENSE_TYPE),2!=r.isRequireChargeJob(
)||e.JobId__c||(o|=teasp.Tsf.EmpExp.EMPTY_JOB),2!=tsfManager.isRequireChargeDept()||e.ChargeDeptId__c||(o|=teasp.Tsf.EmpExp.EMPTY_CHARGE_DEPT),"1"!=e.TransportType__c&&"2"!=e.TransportType__c||e.startName__c&&e.endName__c||(o|=teasp.Tsf.EmpExp.EMPTY_ROUTE),(t=r.getExtraItem(1))&&t.require&&!e.ExtraItem1__c&&(o|=teasp.Tsf.EmpExp.EMPTY_EXTRA1,i=t.name),(s=r.getExtraItem(2))&&s.require&&!e.ExtraItem2__c&&(
o|=teasp.Tsf.EmpExp.EMPTY_EXTRA2,p=s.name),"JTB"!=e.Item__c||e.JsNaviActualId__c||(o|=teasp.Tsf.EmpExp.JTB_ACTUAL_OLD)),{flag:o});return i&&(n.extra1Name=i),p&&(n.extra2Name=p),n},teasp.Tsf.SectionDetail.prototype.checkExpMatching=function(e,t){if(!t)return 0;t=this.getExpMatching(t);return this.showExpMatching(e,t),t.flag},teasp.Tsf.SectionDetail.prototype.showExpMatching=function(e,t){var s,a,o,i,p,r,n;
this.parent.isShowMisMatch()&&(s=-1,a=0,this.fp.fcLoop(function(e){e.isHidden()||e.isSkip()||("ExpItemId__c"==e.getApiKey()&&s<0&&(s=a),a++)},this),(o=0<=s?e.cells[s]:null)&&(r=[],t.flag&teasp.Tsf.EmpExp.MISMATCH_EXPENSE_TYPE&&r.push(teasp.message.getLabel("tf10006860")),t.flag&teasp.Tsf.EmpExp.MISMATCH_EXPITEM_CLASS&&r.push(teasp.message.getLabel("tf10006870")),o.title=0<r.length?r.join("\r\n"):"",(
o=teasp.Tsf.Dom.node("div.ts-form-select a",o))&&(teasp.Tsf.Dom.toggleClass(o.parentNode,"ts-mismatch",!!r.length),n=teasp.Tsf.Dom.nextSibling(o),r.length?(p=(n=n||this.getDomHelper().create("div",null,o,"after")).firstChild)||this.getDomHelper().create("div",{className:"pp_ico_ng"},n):n&&teasp.Tsf.Dom.destroy(n))),(o=teasp.Tsf.Dom.node("div.ts-route-icons",e))&&(r=[],t.flag&(
teasp.Tsf.EmpExp.MISMATCH_PAY_TYPE|teasp.Tsf.EmpExp.MISMATCH_PAY_EXPENSE_TYPE)&&r.push(teasp.message.getLabel("tf10006860")),t.flag&teasp.Tsf.EmpExp.JTB_ACTUAL_OLD&&r.push(teasp.message.getLabel("jt13000100")),o.title=0<r.length?r.join("\r\n"):"",(n=teasp.Tsf.Dom.node("div",o))?(p=teasp.Tsf.Dom.node("div",n),r.length?p||this.getDomHelper().create("div",{className:"pp_ico_ng"},n):p&&teasp.Tsf.Dom.destroy(p)
):r.length&&(n=this.getDomHelper().create("div",null,o),this.getDomHelper().create("div",{className:"pp_ico_ng"},n)),r=[],t.flag&teasp.Tsf.EmpExp.EMPTY_ROUTE&&r.push(teasp.message.getLabel("tm20004260")),t.flag&teasp.Tsf.EmpExp.EMPTY_EXTRA1&&(i=t.extra1Name||teasp.message.getLabel("tk10000715"),r.push(teasp.message.getLabel("tk10000495",i))),t.flag&teasp.Tsf.EmpExp.EMPTY_EXTRA2&&(
i=t.extra2Name||teasp.message.getLabel("tk10000721"),r.push(teasp.message.getLabel("tk10000495",i))),(p=teasp.Tsf.Dom.node("div.ts-route-icons > .pp_ico_ng",e))?r.length||teasp.Tsf.Dom.destroy(p):r.length&&this.getDomHelper().create("div",{className:"pp_ico_ng",title:r.join("\r\n")},o)),(i=teasp.Tsf.Dom.node("div.ts-form-route > div.ts-form-route",e))&&(p=teasp.Tsf.Dom.node("div.ng-charge-dept",i),
t.flag&teasp.Tsf.EmpExp.EMPTY_CHARGE_DEPT?((p=p||this.getDomHelper().create("div",{className:"pp_ico_ng ng-charge-dept"},i)).title=teasp.message.getLabel("tf10007910"),(n=p.previousSibling)&&"&nbsp;"==n.innerHTML&&(n.innerHTML="")):p&&teasp.Tsf.Dom.destroy(p)),(r=this.fp.getFcByApiKey("JobId__c"))&&(n=teasp.Tsf.Dom.byId(r.getDomId(teasp.Tsf.Fp.getHkey(e))))&&t.flag&teasp.Tsf.EmpExp.EMPTY_JOB&&(teasp.Tsf.Dom.empty(n),
this.getDomHelper().create("div",{className:"pp_ico_ng",title:teasp.message.getLabel("tf10007920")},n)))},teasp.Tsf.SectionDetail.prototype.getMisMatchFlag=function(){return this.misMatch},teasp.Tsf.SectionDetail.prototype.getMisMatchFlagCheckedOnly=function(){for(var e=0,t=this.getTbody(),s=0;s<t.rows.length;s++){var a=t.rows[s],o=teasp.Tsf.Fp.getHkey(a),o=this.getChildValues(o,t);o.checked&&(
e|=this.checkExpMatching(a,o))}return e},teasp.Tsf.SectionDetail.prototype.importEmpExps=function(t,e){var s=this.getObjBase(),a=[];dojo.forEach(e.valids,function(e){a.push(s.createEmpExpFromCsv(t,e,this.getFilterExpenseType()))},this),this.refreshDiffView(a),this.changedCurrency()},teasp.Tsf.SectionDetail.prototype.changedFilter=function(e){this.filter=e},
teasp.Tsf.SectionDetail.prototype.getFilterExpenseType=function(){return this.filter&&this.filter.expenseType},teasp.Tsf.SectionForeign=function(e){this.parent=e,this.fp=teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.sectionForeign),this.checkable=!1},teasp.Tsf.SectionForeign.prototype=new teasp.Tsf.SectionBase,teasp.Tsf.SectionForeign.prototype.createArea=function(){var a=this.getDomHelper().create("div",{
className:"ts-main-form ts-section-form "+this.getFormCss()}),o=this.getDomHelper().create("div",{className:"ts-section-z1"},a),i=this.getDomHelper().create("div",{className:"ts-section-z2"},a);return this.fp.fcLoop(function(e){var t,s;e.isHidden()?this.getDomHelper().create("input",{type:"hidden",id:e.getDomId()},a):(t=this.getDomHelper().create("div",{className:"ts-form-row"},"z2"==e.getAreaKey()?i:o),
s=this.getDomHelper().create("div",{className:"ts-form-label"},t),this.getDomHelper().create("div",{innerHTML:e.getLabel()},s),e.isRequired()&&this.getDomHelper().create("div",{className:"ts-require"},s),teasp.Tsf.Dom.append(t,e.createFieldDiv(this.getDomHelper()).areaTags))},this),[this.createSectionBar(this.getDomHelper(),this.fp.getTitle(),this.checkable),a]},teasp.Tsf.SectionForeign.prototype.insertRow=function(
){var t=teasp.Tsf.Dom.node("."+this.getFormCss()),s=this.getValuesByRowIndex(0);return this.fp.fcLoop(function(e){e.drawText(this.getDomHelper(),s,null,t)},this),null},teasp.Tsf.SectionJtb=function(e){this.parent=e,this.fp=teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.sectionJtb),this.checkable=!0},teasp.Tsf.SectionJtb.prototype=new teasp.Tsf.SectionBase,teasp.Tsf.SectionJtb.prototype.insertRow=function(e){
return this.insertTableRow(e)},teasp.Tsf.SectionJtb.prototype.createArea=function(){var e,t=this.parent.objBase.getStatus(),s=this.parent.objBase.getPayStatus(),a=this.createTableArea(),o=a[a.length-1],i=this.parent.getObjBase().obj.ExpJsNavi__r,p=!1,r=this.parent.getObjBase().obj.PlannedAmount__c;return r&&0<r&&(p=!0),
"承認済み"!=t&&"確定済み"!=t&&"精算済み"!=t||"承認待ち"==s||"承認済み"==s||"確定済み"==s||"精算済み"==s||!p?"承認待ち"!=s&&"承認済み"!=s&&"確定済み"!=s&&"精算済み"!=s||!p?(null!=i&&0!=i.length||teasp.Tsf.Dom.show(".ts-section-jtb",o,!1),e=this.getDomHelper().create("div",{style:"clear:both; margin:10px 0px;"})):(e=this.getDomHelper().create("div",{className:"ts-jtb-button-area"},o),r=this.getDomHelper().create("table",{className:"ts-form-control",
id:"ts-jtb-reserve-table",style:"width:0;"},e),s=this.getDomHelper().create("tbody",null,r),p=this.getDomHelper().create("tr",null,s),this.getDomHelper().create("div",{className:"ts-jtb-logo"},this.getDomHelper().create("td",null,p)),i=this.getDomHelper().create("button",{innerHTML:teasp.message.getLabel("jt12000030")},this.getDomHelper().create("td",{className:"ts-std-button",id:"ts-jtb-reserve-confirm"},p)),
this.getDomHelper().connect(i,"onclick",this,this.jtbConfirmTicket)):(e=this.getDomHelper().create("div",{className:"ts-jtb-button-area"},o),r=this.getDomHelper().create("div",{className:"ts-form-control-container"},e),this.getDomHelper().create("div",{className:"ts-jtb-logo",style:"margin-top: 5px; margin-right: 3px;"},this.getDomHelper().create("div",null,r)),s=this.getDomHelper().create("button",null,
this.getDomHelper().create("div",{className:"ts-jtb-button"},r)),p=this.getDomHelper().create("button",null,this.getDomHelper().create("div",{className:"ts-jtb-button"},r)),i=this.getDomHelper().create("button",{innerHTML:teasp.message.getLabel("jt12000030")},this.getDomHelper().create("div",{className:"ts-std-button",id:"ts-jtb-reserve-confirm",style:"margin-left: 6px;"},r)),o=this.getDomHelper().create("button",{
innerHTML:teasp.message.getLabel("jt12000040")},this.getDomHelper().create("div",{className:"ts-std-jtb-button",style:"margin-left: auto; margin-right: 3px;"},r)),this.getDomHelper().create("div",{className:"ts-jtb-travel"},s),this.getDomHelper().create("div",{className:"ts-std-button-text",innerHTML:teasp.message.getLabel("jt12000010")},s),this.getDomHelper().create("div",{className:"ts-jtb-refresh"},p),
this.getDomHelper().create("div",{className:"ts-std-button-text",innerHTML:teasp.message.getLabel("jt12000050")},p),this.getDomHelper().connect(s,"onclick",this,this.jtbTicket),this.getDomHelper().connect(p,"onclick",this,this.jtbSynchro),this.getDomHelper().connect(i,"onclick",this,this.jtbConfirmTicket),this.getDomHelper().connect(o,"onclick",this,this.jtbRelation)),this.getDomHelper().create("div",{
className:"ts-jtb-form",style:"display:none;"},e).appendChild(teasp.Tsf.Dom.toDom(tsfManager.getJtbForm())),"承認済み"!=t&&"確定済み"!=t||this.jtbSynchro(!0),a},teasp.Tsf.SectionJtb.prototype.createSectionTop=function(){var e=this.parent.objBase.getStatus(),t=this.getDomHelper().create("div",{style:"margin:10px 0px;"}),s=this.getDomHelper().create("div",{id:"tsfWarningArea",className:"ts-error-area",
style:"margin:0 0 8px 0; padding:0;"},t),s=(this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("jt12000140")},s),this.getDomHelper().create("div",{style:"float:left;"},t)),s=this.getDomHelper().create("div",{className:"ts-form-row"},s),a=this.getDomHelper().create("div",{className:"ts-form-label",style:"width:155px;"},s),o=this.getDomHelper().create("div",{id:"plannedAmountHelp",
className:"pp_base pp_icon_help",style:"float:right; margin:6px 5px 0 3px;"},a),i=(this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("jt12000110"),style:"float:right; margin-right:0"},a),this.getDomHelper().create("div",{className:"ts-require"},a),this.getDomHelper().createTooltip({connectId:o,label:teasp.message.getLabel("jt12000130"),position:["above"],showDelay:200},
this.EXPITEM_RECEIPT_TOOLTIP_HKEY),"承認待ち"==e||"承認済み"==e||"確定済み"==e||"精算済み"==e?(n=this.getDomHelper().create("div",{className:"ts-form-value ts-form-currency"},s),this.getDomHelper().create("div",{id:"plannedAmountInput",className:"ts-form-currency",innerHTML:teasp.Tsf.Currency.formatMoney(this.parent.getObjBase().obj.PlannedAmount__c,teasp.Tsf.Currency.V_YEN,!1,!0)},n)):(n=this.getDomHelper().create("div",{
className:"ts-form-value ts-form-currency"},s),this.getDomHelper().create("input",{type:"text",maxlength:"17",id:"plannedAmountInput",className:"ts-form-currency"},n)),this.parent.getObjBase().obj.ExpJsNavi__r),p=0;if("未申請"!=e&&(0!=i.length||"承認済み"==e||"確定済み"==e||"精算済み"==e)){for(var r=0;r<i.length;r++)p+=parseInt(i[r].Cost__c);var a=this.getDomHelper().create("div",{style:"float:left;margin-left:20px;"},t),
o=this.getDomHelper().create("div",{className:"ts-form-row"},a),s=this.getDomHelper().create("div",{className:"ts-form-label"},o),n=(this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("jt12000120")},s),this.getDomHelper().create("div",{className:"ts-form-value ts-form-currency"},o));this.getDomHelper().create("div",{id:"ActualAmount",className:"ts-form-currency ts-actual-amount",
innerHTML:teasp.Tsf.Currency.formatMoney(p,teasp.Tsf.Currency.V_YEN,!1,!0)},n)}return this.getDomHelper().create("div",{style:"clear:both; margin:10px 0px;"},t),t},teasp.Tsf.SectionJtb.prototype.jtbTicket=function(e){this.parent.getObjBase().getDataObj().ExpPreApplyNo__c?this.openJtbWindow("0"):tsfManager.saveExpPreApply(!0,teasp.Tsf.Dom.hitch(this,function(e,t){e?tsfManager.changeView(null,t,function(){
tsfManager.openJtbWindow("0")}):teasp.Tsf.Error.showError(t)}))},teasp.Tsf.SectionJtb.prototype.jtbRelation=function(e){this.parent.getObjBase().getDataObj().ExpPreApplyNo__c?this.openJtbWindow("1"):tsfManager.saveExpPreApply(!0,teasp.Tsf.Dom.hitch(this,function(e,t){e?tsfManager.changeView(null,t,function(){tsfManager.openJtbWindow("1")}):teasp.Tsf.Error.showError(t)}))},
teasp.Tsf.SectionJtb.prototype.jtbConfirmTicket=function(e){this.openJtbWindow("3")},teasp.Tsf.SectionJtb.prototype.openJtbWindow=function(e){var t=this.parent.getObjBase().getDataObj();t.ssoMode=e,this.getConnectParameter(t,document,this.jtbWindow)},teasp.Tsf.SectionJtb.prototype.jtbWindow=function(e,t,s){if(tsfManager.isUseJsNaviDummy())teasp.Tsf.SectionJtb.jtbWindowDummy(e,t,s);else{if(t.jtbform.action=e.mainUrl,
e.isUsingJsNaviSystem2&&(t.jtbform.acceptCharset="utf-8"),t.jtbform.EbbaKey.value=e.EbbaKey,t.jtbform.ENCRYPTMODE.value=e.ENCRYPTMODE,t.jtbform.LOCATIONCODE.value=e.LOCATIONCODE,t.jtbform.LOCATIONPASSWORD.value=e.LOCATIONPASSWORD,t.jtbform.USERID.value=e.USERID,t.jtbform.USERPASSWORD.value=e.USERPASSWORD,t.jtbform.PAYINGCCCD.value=e.PAYINGCCCD,e.DRIUSERID&&(t.jtbform.DRIUSERID.value=e.DRIUSERID),"ja"==dojo.locale){
var a=teasp.util.date.formatDate(s.StartDate__c,"SLA"),o=teasp.util.date.formatDate(s.EndDate__c,"SLA");if("???"==a)return void teasp.Tsf.Error.showError(teasp.message.getLabel("tf10007940",teasp.message.getLabel("tf10000770")));if("???"==o)return void teasp.Tsf.Error.showError(teasp.message.getLabel("tf10007940",teasp.message.getLabel("tf10000800")));t.jtbform.TRIPSTARTDAY.value=a,t.jtbform.TRIPENDDAY.value=o}else{
a=teasp.util.date.parseDate(s.StartDate__c),o=teasp.util.date.parseDate(s.EndDate__c);try{t.jtbform.TRIPSTARTDAY.value=dojo.date.locale.format(a,{selector:"date",datePattern:"yyyy/MM/dd"})}catch(e){return void teasp.Tsf.Error.showError(teasp.message.getLabel("tf10007940",teasp.message.getLabel("tf10000770")))}try{t.jtbform.TRIPENDDAY.value=dojo.date.locale.format(o,{selector:"date",datePattern:"yyyy/MM/dd"})}catch(e
){return void teasp.Tsf.Error.showError(teasp.message.getLabel("tf10007940",teasp.message.getLabel("tf10000800")))}}t.jtbform.TCKOPERATIONMODE.value=s.ssoMode,t.jtbform.OPERATIONNUMBER.value="P"+s.ExpPreApplyNo__c,t.jtbform.SUBNUMBER.value="00",t.jtbform.BUSINESSNAME.value=s.DestinationType__c&&"2"==s.DestinationType__c?"F0":"J0",t.jtbform.MEMO1.value=s.Content__c?s.Content__c.substr(0,10):"",console.log(
"処理番号="+t.jtbform.OPERATIONNUMBER.value);a=dojo.isIE||0<=window.navigator.userAgent.toLowerCase().indexOf("trident"),o=-1!==window.navigator.userAgent.toLowerCase().indexOf("edge");!a&&!o||e.isUsingJsNaviSystem2||(t.charset="Shift_JIS"),teasp.Tsf.SectionJtb.jtbOpen(),!a&&!o||e.isUsingJsNaviSystem2||(t.charset="utf-8")}},teasp.Tsf.SectionJtb.jtbOpen=function(){window.open("","TICKET_WEB",
"toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,width=1014,height=712,top=0,left=0"),document.jtbform.target="TICKET_WEB",document.jtbform.submit()},teasp.Tsf.SectionJtb.prototype.jtbSynchro=function(e){tsfManager.isUsingJsNaviSystem()&&(e&&!this.parent.getObjBase().getDataObj().ExpPreApplyNo__c?console.log("申請番号が発行されていません"):(e={method:"syncJsNaviReserveData",id:(e=this.parent.getObjBase().getDataObj()
).Id,empId:tsfManager.getEmpId(),proxyEmpId:tsfManager.getSessionEmpId(),operationNo:"P"+e.ExpPreApplyNo__c},tsfManager.jtbAction(e,teasp.Tsf.Dom.hitch(this,function(e,t){console.log("result:"+t),e?(this.refreshView(t.data),t.hasActualData&&(teasp.Tsf.Dom.show(".ts-jtb-button",null,!1),teasp.Tsf.Dom.show(".ts-std-jtb-button",null,!1)),t.disableJtbButtons&&(teasp.Tsf.Dom.show(".ts-jtb-button",null,!1),
teasp.Tsf.Dom.show("#ts-jtb-reserve-confirm",null,!1),teasp.Tsf.Dom.show(".ts-std-jtb-button",null,!1))):teasp.Tsf.Error.showError(t)}))))},teasp.Tsf.SectionJtb.prototype.refreshView=function(e){console.log("refresh"),console.log(e);var t=0;if(this.empty(),this.parent.getObjBase().obj.ExpJsNavi__r=e)for(var s=0;s<e.length;s++)e[s].Date__c&&(e[s].Date__c=e[s].Date__c.replace(/[\/]/g,"-")),this.insertRow(),t+=parseInt(
e[s].Cost__c);teasp.Tsf.Dom.html(".ts-actual-amount",null,teasp.Tsf.Currency.formatMoney(t,teasp.Tsf.Currency.V_YEN,!1,!0)),this.changedCurrency()},teasp.Tsf.SectionJtb.prototype.getConnectParameter=function(s,a,o){var e={method:"getJsNaviParameter",empId:s.EmpId__c};tsfManager.jtbAction(e,teasp.Tsf.Dom.hitch(this,function(e,t){e?o(t,a,s):teasp.Tsf.Error.showError(t)}))},
teasp.Tsf.SectionJtb.prototype.existValue=function(){var e=this.parent.getObjBase().obj.PlannedAmount__c;return!!(e&&0<e)},teasp.Tsf.SectionJtb.prototype.getDomValues=function(e,t){var s=this.parent.fp.getElementByApiKey("PlannedAmount__c",null,null),s=teasp.Tsf.util.parseInt((s.value||"").replace(/\\/g,"").split(",").join("")),e=teasp.Tsf.SectionBase.prototype.getDomValues.call(this,e,t);
return!t||1!=t||!this.isOpen()||s&&0!=s||(e.ngList||(e.ngList=[]),t=this.parent.fp.getFcByApiKey("PlannedAmount__c"),e.ngList.push({ngType:1,fc:t})),e},teasp.Tsf.SectionJtb.jtbWindowDummy=function(e,t,s){window.open(teasp.getPageUrl("timeSheetView")+"?support=jtb&z="+(new Date).getTime()+"#!compo!id:"+(s.Id||"")+"!ssoMode:"+(s.ssoMode||""),"jsNaviDummy","width=800,height=750,resizable=yes,scrollbars=yes")},
teasp.Tsf.SectionProvisional=function(e,t,s){this.parent=e,this.fp=teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.sectionProvisional),this.checkable="boolean"!=typeof t||t,this.type=s||0,this.fp.getFcByApiKey("ProvisionalPaymentApplication__c").setNotUse(!!this.type)},teasp.Tsf.SectionProvisional.prototype=new teasp.Tsf.SectionBase,teasp.Tsf.SectionProvisional.TYPE1=1,
teasp.Tsf.SectionProvisional.prototype.createArea=function(){var a=this.getDomHelper().create("div",{className:"ts-main-form ts-section-form "+this.getFormCss()}),o=(teasp.Tsf.Dom.show(a,null,!this.checkable),this.getDomHelper().create("div",{className:"ts-section-z1"},a)),i=this.getDomHelper().create("div",{className:"ts-section-z2"},a);return this.fp.fcLoop(function(e){var t,s;e.isHidden()?this.getDomHelper(
).create("input",{type:"hidden",id:e.getDomId()},a):(t=this.getDomHelper().create("div",{className:"ts-form-row"},"z2"==e.getAreaKey()?i:o),s=this.getDomHelper().create("div",{className:"ts-form-label"},t),this.getDomHelper().create("div",{innerHTML:e.getLabel()},s),e.isRequired()&&this.getDomHelper().create("div",{className:"ts-require"},s),e.appendFieldDiv(this.getDomHelper(),t))},this),teasp.Tsf.Dom.setlimitChars(
this.getDomHelper(),teasp.Tsf.Dom.query("textarea",a),this.fp),[this.createSectionBar(this.getDomHelper(),this.fp.getTitle(),this.checkable),a]},teasp.Tsf.SectionProvisional.prototype.insertRow=function(){var t=teasp.Tsf.Dom.node("."+this.getFormCss()),s=this.getValuesByRowIndex(0);return this.fp.fcLoop(function(e){e.drawText(this.getDomHelper(),s,null,t)},this),null},teasp.Tsf.SectionTicket=function(e){this.parent=e
,this.fp=teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.sectionTicket),this.rowMax=5},teasp.Tsf.SectionTicket.prototype=new teasp.Tsf.SectionBase,teasp.Tsf.SectionTicket.prototype.insertRow=function(e){return this.insertTableRow(e)},teasp.Tsf.SectionTicket.prototype.createArea=function(){return this.createTableArea(!0)},teasp.Tsf.SectionEmp=function(e){this.parent=e,this.fp=teasp.Tsf.Fp.createFp(
teasp.Tsf.formParams.sectionEmp)},teasp.Tsf.SectionEmp.prototype=new teasp.Tsf.SectionBase,teasp.Tsf.SectionEmp.prototype.createArea=function(){var a=this.getDomHelper().create("div",{className:"ts-section-form "+this.getFormCss()}),o=this.getDomHelper().create("div",{className:"ts-section-z1"},a),i=this.getDomHelper().create("div",{className:"ts-section-z2"},a),p=this.getDomHelper().create("div",{
className:"ts-section-z3"},a),t=(this.fp.fcLoop(function(e){var t,s="z3"==e.getAreaKey()?p:"z2"==e.getAreaKey()?i:o;e.isHidden()?this.getDomHelper().create("input",{type:"hidden",id:e.getDomId()},a):("photo"==e.getDomType()?t=this.getDomHelper().create("div",{className:"ts-form-row"},s):(t=this.getDomHelper().create("div",{className:"ts-form-row"},s),this.getDomHelper().create("div",{innerHTML:e.getLabel()},
this.getDomHelper().create("div",{className:"ts-form-label"},t))),teasp.Tsf.Dom.append(t,e.createFieldDiv(this.getDomHelper()).areaTags))},this),dojo.clone(tsfManager.getTargetEmp().getEmp()));return t.DeptId__c=this.parent.getDeptId(),t.DeptId__r=this.parent.getDept(),this.fp.fcLoop(function(e){e.drawText(this.getDomHelper(),t,null,a)},this),teasp.Tsf.Dom.show(a,null,tsfManager.isOthers()),a},
teasp.Tsf.SectionExpHead=function(e){this.parent=e;e=this.parent.objBase.expPreApply?this.parent.objBase.expPreApply.obj.Type__c:null;this.fp=teasp.Tsf.Fp.createFp(tsfManager.isUsingJsNaviSystem()&&e==teasp.constant.EXP_PRE_FORM1?teasp.Tsf.formParams.sectionExpHeadJtb:teasp.Tsf.formParams.sectionExpHead)},teasp.Tsf.SectionExpHead.prototype=new teasp.Tsf.SectionBase,
teasp.Tsf.SectionExpHead.prototype.createArea=function(){var e,s=this.getDomHelper().create("div",{className:"ts-section-form "+this.getFormCss()}),t=(this.getDomHelper().create("div",{className:"ts-section-z1"},s),this.getDomHelper().create("div",{className:"ts-section-z2"},s),this.getDomHelper().create("div",{className:"ts-section-z3"},s),this.getDomHelper().create("div",{className:"ts-section-z4"},s),
this.getDomHelper().create("div",{className:"ts-section-z5"},s),this.createSectionBar(this.getDomHelper(),teasp.message.getLabel("tf10006060"),!1,"ts-section-bar2 margin-top-10")),a=(this.fp.fcLoop(function(e){var t=teasp.Tsf.Dom.node(".ts-section-"+e.getAreaKey(),s);e.isHidden()?this.getDomHelper().create("input",{type:"hidden",id:e.getDomId()},s):t&&(t=this.getDomHelper().create("div",{className:"ts-form-row"},t),
this.getDomHelper().create("div",{innerHTML:e.getLabel()},this.getDomHelper().create("div",{className:"ts-form-label"},t)),teasp.Tsf.Dom.append(t,e.createFieldDiv(this.getDomHelper()).areaTags))},this),this.getValuesByRowIndex(0)),o=(this.fp.fcLoop(function(e){e.drawText(this.getDomHelper(),a,null,s)},this),this.getObjBase().getExpPreApplyId());return o?(e=teasp.getPageUrl("expPreApplyView"
)+"?id="+o+"&mode="+tsfManager.getMode(),teasp.isSforce1()?this.getDomHelper().connect(teasp.Tsf.Dom.query("a",s),"onclick",this,function(){sforce.one.navigateToURL(e)}):(teasp.Tsf.Dom.setAttr2("a",s,"href",e),teasp.Tsf.Dom.setAttr2("a",s,"target","_blank"))):(teasp.Tsf.Dom.show(s,null,!1),teasp.Tsf.Dom.show(t,null,!1)),[t,s]},teasp.Tsf.SectionExpRingi=function(e){this.parent=e,this.fp=teasp.Tsf.Fp.createFp(
teasp.Tsf.formParams.sectionExpRingi)},teasp.Tsf.SectionExpRingi.prototype=new teasp.Tsf.SectionBase,teasp.Tsf.SectionExpRingi.prototype.createArea=function(){var a=this.getDomHelper().create("div",{className:"ts-section-form "+this.getFormCss()}),t=(this.getDomHelper().create("div",{className:"ts-section-z1"},a),this.getDomHelper().create("div",{className:"ts-section-z2"},a),this.getDomHelper().create("div",{
className:"ts-section-z3"},a),this.fp.setReadOnly(!0),this.fp.fcLoop(function(e){var t,s=teasp.Tsf.Dom.node(".ts-section-"+e.getAreaKey(),a);e.isHidden()?this.getDomHelper().create("input",{type:"hidden",id:e.getDomId()},a):s&&(s=this.getDomHelper().create("div",{className:"ts-form-row"},s),t=this.getDomHelper().create("div",{className:"ts-form-label"},s),e.getLw()&&teasp.Tsf.Dom.style(t,"width",e.getLw()),
this.getDomHelper().create("div",{innerHTML:e.getLabel()},t),teasp.Tsf.Dom.append(s,e.createFieldDiv(this.getDomHelper()).areaTags))},this),this.getValuesByRowIndex(0)),s=(this.fp.fcLoop(function(e){e.drawText(this.getDomHelper(),t,null,a)},this),this.getObjBase().getRingiApplyId());return s&&(teasp.isSforce1()?this.getDomHelper().connect(teasp.Tsf.Dom.query("a",a),"onclick",this,function(){sforce.one.navigateToURL(
"/"+s)}):teasp.Tsf.Dom.query("a",a).forEach(function(e){e.href="/"+s,e.target="_blank"})),[this.createSectionBar(this.getDomHelper(),this.fp.getTitle(),!1,"ts-section-bar2 margin-top-10"),a]},teasp.Tsf.SectionExpComment=function(e){this.parent=e,this.fp=teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.sectionExpComment)},teasp.Tsf.SectionExpComment.prototype=new teasp.Tsf.SectionBase,
teasp.Tsf.SectionExpComment.prototype.createArea=function(){var s=this.getDomHelper().create("div",{className:"ts-section-form "+this.getFormCss()}),t=(this.getDomHelper().create("div",{className:"ts-section-z1"},s),this.fp.fcLoop(function(e){var t=teasp.Tsf.Dom.node(".ts-section-"+e.getAreaKey(),s);e.isHidden()?this.getDomHelper().create("input",{type:"hidden",id:e.getDomId()},s):t&&(t=this.getDomHelper().create(
"div",{className:"ts-form-row"},t),this.getDomHelper().create("div",{innerHTML:e.getLabel()},this.getDomHelper().create("div",{className:"ts-form-label"},t)),teasp.Tsf.Dom.append(t,e.createFieldDiv(this.getDomHelper()).areaTags))},this),this.getValuesByRowIndex(0));return this.fp.fcLoop(function(e){e.drawText(this.getDomHelper(),t,null,s)},this),s};teasp.Tsf.SectionExpAssist=function(e){this.parent=e,
this.fp=teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.sectionExpAssist),this.dataObj=null,this.active=!1},teasp.Tsf.SectionExpAssist.prototype=new teasp.Tsf.SectionBase,teasp.Tsf.SectionExpAssist.isUse=function(e){var t=e.getTypeName(),e=e.getId()?e.getDataObj():null,s=tsfManager.getInfo();return s.getUseTitle(t,e)||s.isUseExpenseType(t,e)||s.isUsePayMethod(t,e)||s.isUseApplyDate(t,e)||s.isUsePayDate(t,e
)||s.isUseProvisional(t,e)||s.isUseChargeJob(t,e)||s.isUseChargeDept(t,e)||s.isUseExtraItem1(t,e)||s.isUseExtraItem2(t,e)},teasp.Tsf.SectionExpAssist.prototype.createArea=function(){var o=this.getDomHelper().create("div",{className:"ts-section-form "+this.getFormCss()}),e=(0==this.parent.getFormStyle()&&this.getDomHelper().create("div",{className:"ts-section-z0"},o),this.getDomHelper().create("div",{
className:"ts-section-zp"},o)),i=(this.getDomHelper().create("div",{className:"ts-section-z1"},e),null),e=(0==this.parent.getFormStyle()&&(i=this.getDomHelper().create("div",{className:"ts-section-z2"},e)),null),t=(0==this.parent.getFormStyle()&&(e=this.createSectionBar(this.getDomHelper(),teasp.message.getLabel("tf10002150"),!1,"ts-section-bar2 margin-top-10")),this.getObjBase().getId()),s=this.getObjBase(
).getTypeName(),a=this.fp.getFcByApiKey("ExpenseType__c");if(this.getObjBase().isEditableStatus()&&a.setWeak(!0),this.dataObj=teasp.Tsf.Dom.clone(this.getValuesByRowIndex(0)),tsfManager.getInfo().setCacheDept(this.dataObj),tsfManager.getInfo().setCacheJob(this.dataObj),t||this.getObjBase().isCreateFlag()){this.active=!0;var a=this.getUsingFcs(s,t?this.dataObj:null),p=1;if(dojo.forEach(a,function(e){var t,
s=e.getAreaKey(),a=teasp.Tsf.Dom.node(".ts-section-"+(s||(i&&p%2==0?"z2":"z1")),o);e.isHidden()?this.getDomHelper().create("input",{type:"hidden",id:e.getDomId()},a):(a=this.getDomHelper().create("div",{className:"ts-form-row"},a),t=this.getDomHelper().create("div",{className:"ts-form-label"},a),this.getDomHelper().create("div",{innerHTML:e.getLabel()},t),e.isRequired()&&this.getDomHelper().create("div",{
className:"ts-require"},t),e.appendFieldDiv(this.getDomHelper(),a)),s||p++},this),!this.isReadOnly()){a=tsfManager.getInfo().getCacheDept(this.dataObj.ChargeDeptId__c),a=a&&a.ExpItemClass__c||null;if(!t)if(!tsfManager.getInfo().isUseExpenseType(s)||this.dataObj.ExpenseType__c||0<(t=tsfManager.getInfo().getExpenseTypes(tsfManager.getTargetEmp().getExpenseTypes())).length&&(this.dataObj.ExpenseType__c=t[0]),
tsfManager.getInfo().isUsePayMethod(s)){var r=tsfManager.getInfo().getPayItems(this.getExpItemFilter(this.dataObj.ExpenseType__c,a)),n=0<r.length?r[0].getId():null;if(this.dataObj.PayExpItemId__c)for(var l=0;l<r.length;l++)if(this.dataObj.PayExpItemId__c==r[l].getId()){n=this.dataObj.PayExpItemId__c;break}this.dataObj.PayExpItemId__c=n}this.loadPayMethods(o,this.dataObj.ExpenseType__c,a,!0),this.loadChargeDepts(o),
this.loadJobs(o),this.loadProvisionalPayments(o),this.setEventHandler(o)}this.fp.fcLoop(function(e){e.drawText(this.getDomHelper(),this.dataObj,null,o)},this)}else this.active=!1,teasp.Tsf.Dom.show(o,null,!1),e&&teasp.Tsf.Dom.show(e,null,!1);this.showExpMatching(o);t=[o];return e&&t.unshift(e),t},teasp.Tsf.SectionExpAssist.prototype.getUsingFcs=function(e,t){var s=[],a=tsfManager.getInfo(),o=this.fp.getFcByApiKey(
"Title__c"),i=a.getUseTitle(e,t);return i?(o.setNotUse(!1),2==i&&o.setRequired(1),s.push(o)):o.setNotUse(!0),(o=this.fp.getFcByApiKey("ExpenseType__c")).setPickList(a.getExpenseTypes(tsfManager.getTargetEmp().getExpenseTypes(),!0)),a.isUseExpenseType(e,t)?(o.setNotUse(!1),s.push(o)):o.setNotUse(!0),o=this.fp.getFcByApiKey("PayExpItemId__c"),a.isUsePayMethod(e,t)?(o.setNotUse(!1),s.push(o)):o.setNotUse(!0),
o=this.fp.getFcByApiKey("ApplyDate__c"),a.isUseApplyDate(e,t)?(o.setNotUse(!1),s.push(o)):o.setNotUse(!0),o=this.fp.getFcByApiKey("ExpectedPayDate__c"),a.isUsePayDate(e,t)?(o.setNotUse(!1),s.push(o)):o.setNotUse(!0),o=this.fp.getFcByApiKey("ProvisionalPaymentId__c"),a.isUseProvisional(e,t)?(o.setNotUse(!1),s.push(o)):o.setNotUse(!0),o=this.fp.getFcByApiKey("ChargeJobId__c"),a.isUseChargeJob(e,t)?(o.setNotUse(!1),
s.push(o)):o.setNotUse(!0),o=this.fp.getFcByApiKey("ChargeDeptId__c"),a.isUseChargeDept(e,t)?(o.setNotUse(!1),s.push(o)):o.setNotUse(!0),(o=this.fp.getFcByApiKey("ExtraItem1__c")).setLabel(a.getExtraItemOutputDataName1()),a.isUseExtraItem1(e,t)?(o.setNotUse(!1),s.push(o)):o.setNotUse(!0),(o=this.fp.getFcByApiKey("ExtraItem2__c")).setLabel(a.getExtraItemOutputDataName2()),a.isUseExtraItem2(e,t)?(o.setNotUse(!1),
s.push(o)):o.setNotUse(!0),(o=this.fp.getFcByApiKey("ProvisionalPaymentId__r.ProvisionalPaymentAmount__c"))&&s.push(o),s},teasp.Tsf.SectionExpAssist.prototype.setEventHandler=function(e){var t;teasp.Tsf.Dom.query(".ts-form-cal",e).forEach(function(e){var t=teasp.Tsf.Dom.node('div.ts-form-date > input[type="text"]',e.parentNode.parentNode);t&&tsfManager.eventOpenCalendar(this.getDomHelper(),e,t,{tagName:t.name,
isDisabledDate:function(e){return!1}})},this),(t=this.fp.getElementByApiKey("ExpenseType__c",null,e))&&this.getDomHelper().connect(t,"onchange",this,this.changedExpenseType),(t=this.fp.getElementByApiKey("PayExpItemId__c",null,e))&&this.getDomHelper().connect(t,"onchange",this,function(){this.showExpMatching(e)}),(t=this.fp.getElementByApiKey("ChargeDeptId__c",null,e))&&this.getDomHelper().connect(t,"onchange",this,
this.changedExpenseType),(t=this.fp.getElementByApiKey("ProvisionalPaymentId__c",null,e))&&this.getDomHelper().connect(t,"onchange",this,this.changedProvisionalPayment),this.setEventDept(e),this.setEventJob(e),this.setEventProvisionalPayment(e)},teasp.Tsf.SectionExpAssist.prototype.changedExpenseType=function(e){var t=this.getCurrentExpenseType();this.loadPayMethods(this.getFormEl(),t,null,!0),this.showExpMatching(),
this.parent&&this.parent.changedAssist()},teasp.Tsf.SectionExpAssist.prototype.getCurrentExpenseType=function(e){e=this.fp.getElementByApiKey("ExpenseType__c",null,e||this.getFormEl());return e?"DIV"==e.tagName?this.dataObj.ExpenseType__c:e.value:null},teasp.Tsf.SectionExpAssist.prototype.loadPayMethods=function(e,t,s,a){var o,i,p,r=this.fp.getElementByApiKey("PayExpItemId__c",null,e);r&&(e=r.value,
o=tsfManager.getInfo().getPayExpItemId(),i=null,p={},teasp.Tsf.Dom.empty(r),this.getDomHelper().create("option",{value:"",innerHTML:""},r),t=this.getExpItemFilter(t,s),dojo.forEach(tsfManager.getInfo().getPayItems(t),function(e){this.getDomHelper().create("option",{value:e.getId(),innerHTML:e.getName()},r),p[e.getId()]=1,i=i||e.getId()},this),e&&p[e]?r.value=e:e&&!p[e]?((s=tsfManager.getInfo().getPayItemById(e)
)&&this.getDomHelper().create("option",{value:s.getId(),innerHTML:s.getName()},r),r.value=s.getId()):o&&p[o]?r.value=o:i&&t.expenseType&&a?r.value=i:r.value="")},teasp.Tsf.SectionExpAssist.prototype.loadChargeDepts=function(e){var t,e=this.fp.getElementByApiKey("ChargeDeptId__c",null,e);e&&(teasp.Tsf.Dom.empty(e),t=tsfManager.getDefaultChargeDept(),this.getDomHelper().create("option",{value:"",innerHTML:""},e),
t.ChargeDeptId__c&&(this.getDomHelper().create("option",{value:t.ChargeDeptId__c,innerHTML:t.ChargeDeptId__r.DeptCode__c+" "+t.ChargeDeptId__r.Name},e),tsfManager.getInfo().setCacheDept(t)))},teasp.Tsf.SectionExpAssist.prototype.setEventDept=function(s){var e=this.fp.getElementByApiKey("ChargeDeptId__c",null,s);e&&(e=teasp.Tsf.Dom.getAncestorByCssName(e,"ts-form-row"))&&(e=teasp.Tsf.Dom.node("button.ts-form-find",e)
)&&this.getDomHelper().connect(e,"onclick",this,function(e){var t=teasp.util.date.formatDate(teasp.util.date.getToday());tsfManager.showSearchListDialog({discernment:"depts",delay:!0,values:{_date:[t]}},null,teasp.Tsf.Dom.hitch(this,function(e){e=e[0];tsfManager.getInfo().setCacheDept(e.Id,e),this.fp.getFcByApiKey("ChargeDeptId__c").drawText(this.getDomHelper(),{ChargeDeptId__c:e.Id,ChargeDeptId__r:e},null,s),
this.changedExpenseType()}))})},teasp.Tsf.SectionExpAssist.prototype.getCurrentChargeDept=function(e){e=this.fp.getElementByApiKey("ChargeDeptId__c",null,e||this.getFormEl());return tsfManager.getInfo().getCacheDept(e?"DIV"==e.tagName?this.dataObj.ChargeDeptId__c:e.value:null)},teasp.Tsf.SectionExpAssist.prototype.loadJobs=function(e){var s,a,o,i=this.fp.getElementByApiKey("ChargeJobId__c",null,e);i&&(s=i.value,
e=this.getJobChoices(),a=teasp.util.date.formatDate(teasp.util.date.getToday()),o={},teasp.Tsf.Dom.empty(i),this.getDomHelper().create("option",{value:"",innerHTML:""},i),dojo.forEach(e,function(e){var t=e.getId();!e.activeOnDate(a)&&t!=s||o[t]||(this.getDomHelper().create("option",{value:t,innerHTML:e.getDisplayName()},i),tsfManager.getInfo().setCacheJob(e.getId(),{JobCode__c:e.getCode(),Name:e.getName()}),o[t]=1)},
this),o[s]&&(i.value=s))},teasp.Tsf.SectionExpAssist.prototype.getJobChoices=function(){var e=tsfManager.getEmpJobAssigns();return this.impJobs?e.concat(this.impJobs):e},teasp.Tsf.SectionExpAssist.prototype.setEventJob=function(a){var e=this.fp.getElementByApiKey("ChargeJobId__c",null,a);e&&(e=teasp.Tsf.Dom.getAncestorByCssName(e,"ts-form-row"))&&(e=teasp.Tsf.Dom.node("button.ts-form-find",e))&&this.getDomHelper(
).connect(e,"onclick",this,function(e){var t=teasp.util.date.formatDate(teasp.util.date.getToday()),s=this.getValues(),s=s&&s.ChargeDeptId__c||this.getObjBase().getDeptId(!0);tsfManager.showSearchListDialog({discernment:"jobs",dialog:"JobList",delay:!0,values:{_date:[t],DeptId__c:s,_jobAssignClass:tsfManager.getEmpJobSearchCondition()}},null,teasp.Tsf.Dom.hitch(this,function(e){e=e[0];tsfManager.getInfo(
).setCacheJob(e.Id,e),this.fp.getFcByApiKey("ChargeJobId__c").drawText(this.getDomHelper(),{ChargeJobId__c:e.Id,ChargeJobId__r:e},null,a)})),this.showExpMatching()})},teasp.Tsf.SectionExpAssist.prototype.loadProvisionalPayments=function(e){e=this.fp.getElementByApiKey("ProvisionalPaymentId__c",null,e);e&&(teasp.Tsf.Dom.empty(e),this.getDomHelper().create("option",{value:"",innerHTML:""},e))},
teasp.Tsf.SectionExpAssist.prototype.setEventProvisionalPayment=function(s){var e=this.fp.getElementByApiKey("ProvisionalPaymentId__c",null,s);e&&(e=teasp.Tsf.Dom.getAncestorByCssName(e,"ts-form-row"))&&(e=teasp.Tsf.Dom.node("button.ts-form-find",e))&&this.getDomHelper().connect(e,"onclick",this,function(e){tsfManager.showSearchListDialog({discernment:"provisionalPayments",delay:!0,values:{}},{
dataProcessingExt:teasp.Tsf.Dom.hitch(this,this.processProvisionalPayment)},teasp.Tsf.Dom.hitch(this,function(e){var e=e[0],t={ProvisionalPaymentId__c:e.Id,ProvisionalPaymentId__r:e};tsfManager.getInfo().setCacheProvis(e.Id,e),this.fp.getFcByApiKey("ProvisionalPaymentId__c").drawText(this.getDomHelper(),t,null,s),this.changedProvisionalPayment()}))})},
teasp.Tsf.SectionExpAssist.prototype.changedProvisionalPayment=function(){this.parent&&this.parent.changedCurrency()},teasp.Tsf.SectionExpAssist.prototype.processProvisionalPayment=function(e){dojo.forEach(e,function(e){(e.AdjustmentExpApply__r&&0<e.AdjustmentExpApply__r.length||e.ExpApplications__r&&0<e.ExpApplications__r.length)&&(e.noChoose=!0)},this)},teasp.Tsf.SectionExpAssist.prototype.getValues=function(s,a){
var o,i={ExpenseType__c:null,ChargeDeptId__c:null,ChargeDeptId__r:null};return this.active&&(o={},this.fp.fcLoop(function(e){var t;e.isApiField(!0)&&!e.isNotUse()&&(t=e.getApiKey(),o[t]=1,teasp.Tsf.Fc.setObjSimpleValue(i,t,e.fetchValue().value),e.checkValid(i[t],s,a))},this),o.ChargeDeptId__c&&(i.ChargeDeptId__r=tsfManager.getInfo().getCacheDept(i.ChargeDeptId__c)),o.ChargeJobId__c&&(
i.ChargeJobId__r=tsfManager.getInfo().getCacheJob(i.ChargeJobId__c)),o.ProvisionalPaymentId__c&&(i.ProvisionalPaymentId__r=tsfManager.getInfo().getCacheProvis(i.ProvisionalPaymentId__c))),i.ChargeDeptId__r||(i.ChargeDeptId__r={ExpItemClass__c:tsfManager.getTargetEmp().getDeptExpItemClass()}),i},teasp.Tsf.SectionExpAssist.prototype.getDomValues=function(e,t){var s=[],t=this.getValues(t,s);return{
objectName:this.parent.fp.getObjectName(),values:[t],types:{},fixes:{},removes:[],ngList:s}},teasp.Tsf.SectionExpAssist.prototype.getExpItemFilter=function(e,t){var s=this.getValues();return{empExpItemClass:tsfManager.getTargetEmp().getExpItemClass(),deptExpItemClass:t||s.ChargeDeptId__r&&s.ChargeDeptId__r.ExpItemClass__c||null,expenseType:e||s.ExpenseType__c||null}},
teasp.Tsf.SectionExpAssist.prototype.getExpMatching=function(e){var t=this.fp.getElementByApiKey("PayExpItemId__c",null,e||this.getFormEl()),t=t?"DIV"==t.tagName?this.dataObj.PayExpItemId__c:t.value:null,t=tsfManager.getInfo().getPayItemById(t),s=0,a=this.getCurrentChargeDept(e||this.getFormEl()),a=a&&a.ExpItemClass__c||null,e=this.getExpItemFilter(this.getCurrentExpenseType(e||this.getFormEl()),a);return t&&(
t.checkExpenseType(e.expenseType)||(s=teasp.Tsf.EmpExp.MISMATCH_EXPENSE_TYPE),t.isSelectable(e.empExpItemClass)||t.isSelectable(e.deptExpItemClass)||(s|=teasp.Tsf.EmpExp.MISMATCH_EXPITEM_CLASS)),s},teasp.Tsf.SectionExpAssist.prototype.showExpMatching=function(e){var t,s;this.parent.isShowMisMatch()&&(t=this.getExpMatching(e),e=this.fp.getElementByApiKey("PayExpItemId__c",null,e||this.getFormEl()),(
e=teasp.Tsf.Dom.node("div.ts-form-label",teasp.Tsf.Dom.getAncestorByCssName(e,"ts-form-row")))&&((s=teasp.Tsf.Dom.node("div.ts-mismatch",e))&&teasp.Tsf.Dom.destroy(s),s=[],t&teasp.Tsf.EmpExp.MISMATCH_EXPENSE_TYPE&&s.push(teasp.message.getLabel("tf10006860")),t&teasp.Tsf.EmpExp.MISMATCH_EXPITEM_CLASS&&s.push(teasp.message.getLabel("tf10006870")),s.length&&this.getDomHelper().create("div",{className:"pp_ico_ng"},
this.getDomHelper().create("div",{className:"ts-mismatch"},e)),e.title=s.length?s.join("\r\n"):""))},teasp.Tsf.SectionExpAssist.prototype.getMisMatchFlag=function(){return this.getExpMatching()},teasp.Tsf.SectionExpAttach=function(e){this.parent=e,this.fp=teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.sectionExpAttach),this.checkable=!1,this.ATTACH_TABLE_KEY="attach_table_key"},
teasp.Tsf.SectionExpAttach.prototype=new teasp.Tsf.SectionBase,teasp.Tsf.SectionExpAttach.prototype.createArea=function(){var e=this.getDomHelper().create("div",{className:"ts-section-form "+this.getFormCss()});return[this.createSectionBar(this.getDomHelper(),this.fp.getTitle(),!1,"ts-section-bar2 margin-top-10"),e]},teasp.Tsf.SectionExpAttach.prototype.refresh=function(e){
teasp.Tsf.SectionBase.prototype.refresh.call(this,e);var t=this.getObjBase().getAttachments(),e=tsfManager.getInfo().isUseAttachment(this.getObjBase().getTypeName()),s=this.getFormEl();if(this.getDomHelper().freeBy(this.ATTACH_TABLE_KEY),teasp.Tsf.Dom.empty(s),0<t.length)for(var a=this.getDomHelper().create("tbody",null,this.getDomHelper().create("table",null,s)),o=0;o<t.length;o++){var i=t[o],p=this.getDomHelper(
).create("tr",{data:i.Id},a),p=this.getDomHelper().create("a",{innerHTML:i.Name},this.getDomHelper().create("div",null,this.getDomHelper().create("td",null,p)));this.getDomHelper().connect(p,"onclick",this,function(t){return function(e){this.openAttachment(t)}}(i.Id),this.ATTACH_TABLE_KEY)}this.isReadOnly()||(s=this.getDomHelper().create("button",{className:"png-add"},this.getDomHelper().create("div",{
className:"ts-attach-button"},s)),this.getObjBase().getId()?this.getDomHelper().connect(s,"onclick",this,function(){this.openAttachment(null)},this.ATTACH_TABLE_KEY):this.getDomHelper().createTooltip({connectId:s,label:teasp.message.getLabel("tf10001660"),position:["below"],showDelay:200})),!this.getObjBase().getId()&&!this.getObjBase().isCreateFlag()||!e&&!t.length?this.show(!1):this.show(!0)},
teasp.Tsf.SectionExpAttach.prototype.openAttachment=function(e){var t,s=screen.availHeight||540,a=(540<s&&(s=540),this.getObjBase().isReadOnly()),e=teasp.getPageUrl("expPrintView")+"?action=attach&id="+this.getObjBase().getId()+"&attachId="+(e||"")+"&mode="+(a?"read":"edit");teasp.isSforce1()?sforce.one.navigateToURL(e):(t=window.open(e,"expAttach","width=700,height="+s+",resizable=yes,scrollbars=yes"),setTimeout(
function(){t.resizeTo(710,s),t.focus()},100))},teasp.Tsf.SectionExpAttach.prototype.setAttachmentInfo=function(e){if(this.getObjBase().getId()==e.id){for(var t=[],s=e.deleted||[],a=0;a<e.attachs.length;a++){var o=e.attachs[a];s.contains(o.Id)||t.push(o)}this.getObjBase().setAttachments(t),this.refresh()}},teasp.Tsf.SectionExpFilter=function(e){this.parent=e,this.fp=teasp.Tsf.Fp.createFp(
teasp.Tsf.formParams.sectionExpFilter),this.currentExpenseType=null},teasp.Tsf.SectionExpFilter.prototype=new teasp.Tsf.SectionBase,teasp.Tsf.SectionExpFilter.prototype.createArea=function(){var a=this.getDomHelper().create("div",{className:"ts-section-form "+this.getFormCss()}),e=this.getDomHelper().create("div",{className:"ts-section-zp",style:"margin-bottom:10px;"},a),e=(this.getDomHelper().create("div",{
className:"ts-section-z1"},e),this.fp.getFcByApiKey("ExpenseType__c")),t=this.parent.getPullExpenseTypes(),e=(e.setPickList(t),this.fp.fcLoop(function(e){var t,s=teasp.Tsf.Dom.node(".ts-section-z1",a);e.isHidden()?this.getDomHelper().create("input",{type:"hidden",id:e.getDomId()},a):s&&(s=this.getDomHelper().create("div",{className:"ts-form-row"},s),t=this.getDomHelper().create("div",{className:"ts-form-label"},s),
e.getLw()&&teasp.Tsf.Dom.style(t,"width",e.getLw()),this.getDomHelper().create("div",{innerHTML:e.getLabel()},t),teasp.Tsf.Dom.append(s,e.createFieldDiv(this.getDomHelper()).areaTags))},this),tsfManager.getInfo().getExpFilter());return e&&e.expenseType?(this.currentExpenseType=e&&e.expenseType,this.setCurrentExpenseType(this.currentExpenseType,a)):(this.currentExpenseType=this.getCurrentExpenseType(a),
tsfManager.getInfo().setExpFilter({expenseType:this.currentExpenseType})),this.setEventHandler(a),teasp.Tsf.Dom.show(a,null,!0),[this.createSectionBar(this.getDomHelper(),this.fp.getTitle(),!1,"ts-section-bar2 ts-section-bar-filter margin-top-10"),a]},teasp.Tsf.SectionExpFilter.prototype.setEventHandler=function(e){e=this.fp.getElementByApiKey("ExpenseType__c",null,e);e&&this.getDomHelper().connect(e,"onchange",this,
this.changedExpenseType)},teasp.Tsf.SectionExpFilter.prototype.existValue=function(){return!0},teasp.Tsf.SectionExpFilter.prototype.changedExpenseType=function(e){var t=e.target;tsfManager.checkDiff()?teasp.tsConfirm(teasp.message.getLabel("tf10001611"),this,function(e){e?(this.currentExpenseType=t.value,this.parent.changedFilter(this.getFilter())):t.value=this.currentExpenseType}):(this.currentExpenseType=t.value,
this.parent.changedFilter(this.getFilter()))},teasp.Tsf.SectionExpFilter.prototype.getExpenseTypeNode=function(e){return this.fp.getElementByApiKey("ExpenseType__c",null,e||this.getFormEl())},teasp.Tsf.SectionExpFilter.prototype.getCurrentExpenseType=function(e){e=this.getExpenseTypeNode(e);return e?e.value:null},teasp.Tsf.SectionExpFilter.prototype.setCurrentExpenseType=function(e,t){t=this.getExpenseTypeNode(t);
t&&(t.value=e||"")},teasp.Tsf.SectionExpFilter.prototype.resetExpenseTypes=function(){var e=this.fp.getFcByApiKey("ExpenseType__c"),t=(e.setPickList(this.parent.getPullExpenseTypes()),this.getExpenseTypeNode());t&&e.loadPickList(this.getDomHelper(),t,t.value)},teasp.Tsf.SectionExpFilter.prototype.getFilter=function(){return{expenseType:this.getCurrentExpenseType()}},teasp.Tsf.ListExpPreApply=function(){
var e=teasp.Tsf.formParams.ListExpPreApply;tsfManager.getInfo().isExtendedExpenseFunction()&&(e.filts&&0<e.filts.length&&"精算済み以外"==e.filts[0].value&&(e.filts[0].value="仕訳済み以外"),e.childFilts&&0<e.childFilts.length&&"StatusD__c = '精算済み'"==e.childFilts[0].filtVal&&(e.childFilts[0].filtVal="StatusD__c = '仕訳済み'")),this.fp=teasp.Tsf.Fp.createFp(e),this.searchObj={values:this.fp.getDefaultFilts()||{}},this.listMode=1},
teasp.Tsf.ListExpPreApply.prototype=new teasp.Tsf.ListBase,teasp.Tsf.ListExpPreApply.prototype.createBase=function(){var e=null,t=(tsfManager.isEmpTargetMode()&&(this.sectionEmp=new teasp.Tsf.SectionEmp(this),e=this.sectionEmp.createArea()),this.getDomHelper().create("div",{className:"ts-list-top"})),s=this.getDomHelper().create("tr",null,this.getDomHelper().create("tbody",null,this.getDomHelper().create("table",null
,this.getDomHelper().create("div",{className:"ts-form-edge-left"},t)))),a=(this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10006161"),className:"ts-exp-apply-title"},this.getDomHelper().create("td",{className:"ts-exp-apply-head",style:"display:none;"},s)),this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10001440")},this.getDomHelper().create("td",{
className:"ts-list-top-label ts-exp-disp-range"},s)),this.getDomHelper().create("select",{className:"ts-list-top-range"},this.getDomHelper().create("div",null,this.getDomHelper().create("td",{className:"ts-list-top-select ts-exp-disp-range"},s)))),a=(this.getDomHelper().create("option",{value:"1",innerHTML:teasp.message.getLabel("tf10001310")},a),this.getDomHelper().create("option",{value:"2",
innerHTML:teasp.message.getLabel("tf10001320")},a),this.getDomHelper().create("option",{value:"3",innerHTML:teasp.message.getLabel("tf10001330")},a),this.getDomHelper().create("div",{className:"ts-list-paging"},this.getDomHelper().create("td",{className:"ts-space"},s)),a.value=""+(this.listMode||1),this.getDomHelper().connect(a,"onchange",this,this.refresh),s=this.getDomHelper().create("tr",null,this.getDomHelper(
).create("tbody",null,this.getDomHelper().create("table",null,this.getDomHelper().create("div",{className:"ts-form-edge-right"},t)))),this.getDomHelper().create("button",{innerHTML:teasp.message.getLabel("tf10001460")},this.getDomHelper().create("td",{className:"ts-search-button"},s)),teasp.Tsf.Dom.node(".ts-search-button button",s)),s=(a&&this.getDomHelper().connect(a,"onclick",this,function(e){this.search()}),
tsfManager.isEmpTargetMode()),a=(teasp.Tsf.Dom.show("td.ts-exp-disp-range",t,!s),teasp.Tsf.Dom.show("td.ts-exp-apply-head",t,s),teasp.Tsf.ListBase.prototype.createBase.call(this)),s=[];return e&&s.push(e),s.push(t),s.push(a),s},teasp.Tsf.ListExpPreApply.prototype.getListMode=function(){var e=teasp.Tsf.Dom.node(".ts-list-top select.ts-list-top-range",this.getArea());return parseInt(e.value,10)},
teasp.Tsf.ListExpPreApply.prototype.dataProcessing=function(){this.records&&dojo.forEach(this.records,function(e){var t=e.ExpApplications__r||[];0<t.length&&(e._payId=t[0].Id,e._payStatus=t[0].StatusD__c)},this)},teasp.Tsf.ListExpPreApply.prototype.search=function(){for(var e=teasp.Tsf.formParams.searchExpPreApply.fields,t=0;t<e.length;t++){var s=e[t];("StatusD__c"==s.apiKey||"_childStatus"==s.apiKey)&&(
s.pickList=tsfManager.getInfo().getStatusPickList())}this.searchDialog=new teasp.Tsf.SearchCondition(teasp.Tsf.formParams.searchExpPreApply),this.searchDialog.show(this.searchObj||{},teasp.Tsf.Dom.hitch(this,function(e){this.setFreeFilts(e.filts),this.setChildFilts(e.childFilts),this.searchObj=e,this.refresh()}))},teasp.Tsf.ListExpPreApply.prototype.refresh=function(){this.listMode=this.getListMode(),
teasp.Tsf.ListBase.prototype.refresh.call(this)},teasp.Tsf.ListExpPreApply.prototype.drawData=function(e){var s;teasp.Tsf.ListBase.prototype.drawData.call(this,e),this.firstEmptyRowKey&&!tsfManager.isReadMode()&&(tsfManager.isEmpTargetMode()||tsfManager.getSessionEmpId()&&1==this.listMode)&&tsfManager.isEditable()&&((e=this.fp.getElementByApiKey("ApplyTime__c",this.firstEmptyRowKey,e)).innerHTML="",
e=this.getDomHelper().create("div",{className:"png-add"},e),s=[],dojo.forEach(tsfManager.getViewConfig(),function(t){s.push({name:t.name,method:function(e){tsfManager.changeView(t.view)}})},this),this.getDomHelper().createMenu([e],s,this.reskey))},teasp.Tsf.ListExpPreApply.prototype.getTargetEmpId=function(){return tsfManager.isEmpTargetMode()?tsfManager.getArgEmpId():null},teasp.Tsf.ListExpApply=function(){
var e=teasp.Tsf.formParams.ListExpApply;if(tsfManager.getInfo().isExtendedExpenseFunction())for(var t=e.filts||[],s=0;s<t.length;s++)"精算済み以外"==t[s].value&&(t[s].value="仕訳済み以外");this.fp=teasp.Tsf.Fp.createFp(e),this.searchObj={values:this.fp.getDefaultFilts()||{}}},teasp.Tsf.ListExpApply.prototype=new teasp.Tsf.ListBase,teasp.Tsf.ListExpApply.prototype.createBase=function(){this.sectionEmp=new teasp.Tsf.SectionEmp(
this);var e=this.sectionEmp.createArea(),t=this.getDomHelper().create("div",{className:"ts-list-top"}),s=this.getDomHelper().create("tr",null,this.getDomHelper().create("tbody",null,this.getDomHelper().create("table",{className:"ts-list-control"},this.getDomHelper().create("div",{className:"ts-form-edge-left"},t)))),a=this.getDomHelper().create("td",{className:"ts-space ts-exp-apply-head"},s),a=(this.getDomHelper(
).create("div",{className:"ts-exp-apply-title",innerHTML:teasp.message.getLabel("tf10006160")},a),this.getDomHelper().create("div",{className:"ts-list-paging"},a),this.getDomHelper().create("button",{innerHTML:teasp.message.getLabel("tf10006170")},this.getDomHelper().create("div",{className:"ts-exp-apply-not"},a))),a=(this.getDomHelper().connect(a,"onclick",this,function(e){tsfManager.changeView()}),
s=this.getDomHelper().create("tr",null,this.getDomHelper().create("tbody",null,this.getDomHelper().create("table",null,this.getDomHelper().create("div",{className:"ts-form-edge-right"},t)))),this.getDomHelper().create("button",{innerHTML:teasp.message.getLabel("tf10001460")},this.getDomHelper().create("td",{className:"ts-search-button"},s)),teasp.Tsf.Dom.node(".ts-search-button button",s));
return a&&this.getDomHelper().connect(a,"onclick",this,function(e){this.search()}),[e,t,teasp.Tsf.ListBase.prototype.createBase.call(this)]},teasp.Tsf.ListExpApply.prototype.drawData=function(e){teasp.Tsf.ListBase.prototype.drawData.call(this,e),this.firstEmptyRowKey&&!tsfManager.isReadMode()&&tsfManager.getSessionEmpId()&&tsfManager.isEditable()&&((e=this.fp.getElementByApiKey("ApplyTime__c",this.firstEmptyRowKey,e)
).innerHTML="",e=this.getDomHelper().create("div",{className:"png-add"},e),this.getDomHelper().connect(e,"onclick",this,function(e){tsfManager.changeView(teasp.Tsf.Manager.EXP_APPLY_NEW)}))},teasp.Tsf.ListExpApply.prototype.getTargetEmpId=function(){return tsfManager.isEmpTargetMode()?tsfManager.getArgEmpId():null},teasp.Tsf.ListExpApply.prototype.search=function(){for(var e=teasp.Tsf.formParams.searchExpApply.fields
,t=0;t<e.length;t++){var s=e[t];if("StatusD__c"==s.apiKey){s.pickList=tsfManager.getInfo().getStatusPickList();break}}this.searchDialog=new teasp.Tsf.SearchCondition(teasp.Tsf.formParams.searchExpApply),this.searchDialog.show(this.searchObj||{},teasp.Tsf.Dom.hitch(this,function(e){this.setFreeFilts(e.filts),this.setChildFilts(e.childFilts),this.searchObj=e,this.refresh()}))},teasp.Tsf.ListExpPay=function(e){
this.listType=e;e="ListExpPay"+(this.listType||""),e=teasp.Tsf.formParams[e];e||(this.listType="1",e=teasp.Tsf.formParams.ListExpPay1),this.fp=teasp.Tsf.Fp.createFp(e),this.searchObj={values:this.fp.getDefaultFilts()||{}},this.mask=1},teasp.Tsf.ListExpPay.prototype=new teasp.Tsf.ListBase,teasp.Tsf.ListExpPay.SELECTION_LIMIT=2e3,teasp.Tsf.ListExpPay.LOOP_SIZE=200,teasp.Tsf.ListExpPay.prototype.createBase=function(){
var e=this.getDomHelper().create("div",{className:"ts-list-top"}),t=this.getDomHelper().create("tr",null,this.getDomHelper().create("tbody",null,this.getDomHelper().create("table",null,this.getDomHelper().create("div",{className:"ts-form-edge-left"},e)))),s=(this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10001430")},this.getDomHelper().create("td",{className:"ts-list-top-label"},t)),
this.getDomHelper().create("select",{className:"ts-list-top-range"},this.getDomHelper().create("div",null,this.getDomHelper().create("td",{className:"ts-list-top-select"},t)))),s=(this.getDomHelper().create("option",{value:"1",innerHTML:teasp.message.getLabel("tf10001360")},s),this.getDomHelper().create("option",{value:"2",innerHTML:teasp.message.getLabel("tf10001370")},s),this.getDomHelper().create("option",{
value:"3",innerHTML:teasp.message.getLabel("tf10001380")},s),this.getDomHelper().create("option",{value:"4",innerHTML:teasp.message.getLabel("tf10001450")},s),s.value=this.listType,this.getDomHelper().connect(s,"onchange",this,this.changeList),this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10004981")},this.getDomHelper().create("td",{className:"ts-list-top-label"},t)),s=this.getDomHelper(
).create("select",{className:"ts-list-top-status"},this.getDomHelper().create("div",null,this.getDomHelper().create("td",{className:"ts-list-top-status"},t))),this.getDomHelper().create("option",{value:"0",innerHTML:teasp.message.getLabel("tk10000078")},s),this.getDomHelper().create("option",{value:"1",innerHTML:teasp.message.getLabel("reimbursement_label")},s),this.getDomHelper().connect(s,"onchange",this,
this.changeStatus),this.getDomHelper().create("div",{className:"ts-list-paging"},this.getDomHelper().create("td",{className:"ts-space"},t)),t=this.getDomHelper().create("tr",null,this.getDomHelper().create("tbody",null,this.getDomHelper().create("table",null,this.getDomHelper().create("div",{className:"ts-form-edge-right"},e)))),tsfManager.getInfo().getCommon().isUseExpPayPrint()&&this.getDomHelper().create("button",
{innerHTML:teasp.message.getLabel("print_btn_title")},this.getDomHelper().create("td",{className:"ts-form-print ts-std-button"},t)),this.getDomHelper().create("button",{innerHTML:teasp.message.getLabel("tk10000755")},this.getDomHelper().create("td",{className:"ts-form-csv ts-std-button"},t)),this.getDomHelper().create("button",{innerHTML:teasp.message.getLabel("tk10000779")},this.getDomHelper().create("td",{
className:"ts-output-zengin-button"},t)),this.getDomHelper().create("button",{innerHTML:teasp.message.getLabel("tf10001460")},this.getDomHelper().create("td",{className:"ts-search-button"},t)),this.getDomHelper().create("button",{innerHTML:teasp.message.getLabel("tk10000762")},this.getDomHelper().create("td",{className:"ts-pay-button"},t)),this.getDomHelper().create("button",{innerHTML:teasp.message.getLabel(
"tk10000763")},this.getDomHelper().create("td",{className:"ts-reset-button"},t)),teasp.Tsf.Dom.show(teasp.Tsf.Dom.node("td.ts-reset-button",t),!1),teasp.Tsf.Dom.node(".ts-output-zengin-button button",t));s&&this.getDomHelper().connect(s,"onclick",this,function(e){this.openZengin()}),(s=teasp.Tsf.Dom.node(".ts-search-button button",t))&&this.getDomHelper().connect(s,"onclick",this,function(e){this.search()}),(
s=teasp.Tsf.Dom.node(".ts-form-print button",t))&&this.getDomHelper().connect(s,"onclick",this,function(e){this.openPrint()}),(s=teasp.Tsf.Dom.node(".ts-form-csv button",t))&&this.getDomHelper().connect(s,"onclick",this,function(e){this.csvOut()}),(s=teasp.Tsf.Dom.node(".ts-pay-button button",t))&&this.getDomHelper().connect(s,"onclick",this,function(e){var t=this.getCheckedIds();t.length<=0?teasp.tsAlert(
teasp.message.getLabel("tf10001870")):t.length>teasp.Tsf.ListExpPay.SELECTION_LIMIT?teasp.tsAlert(teasp.message.getLabel("tf10004840",teasp.Tsf.ListExpPay.SELECTION_LIMIT)):tsfManager.showDialog("PayOption",{listType:this.listType,ids:t},teasp.Tsf.Dom.hitch(this,this.setPaid))});(s=teasp.Tsf.Dom.node(".ts-reset-button button",t))&&this.getDomHelper().connect(s,"onclick",this,this.resetPaid);var t=this.getDomHelper(
).create("div",{className:"ts-list-countDiv"}),s=(this.getDomHelper().create("div",{className:"ts-list-countMsg"},t),this.getDomHelper().create("div",{className:"ts-list-caution",style:"color:red;"},t),this.createExpPayBase()),a=this.fp.getRowLimit()*this.fp.getPageLimit();return this.cntOverMessage=teasp.message.getLabel("tk10000343",a,a),[e,t,s]},teasp.Tsf.ListExpPay.prototype.changeList=function(){
var e=teasp.Tsf.Dom.node(".ts-list-top select.ts-list-top-range",this.getArea());tsfManager.refreshList(e.value)},teasp.Tsf.ListExpPay.prototype.changeStatus=function(){var e="0"==teasp.Tsf.Dom.node(".ts-list-top select.ts-list-top-status",this.getArea()).value;teasp.Tsf.Dom.show("td.ts-pay-button",this.getArea(),e),teasp.Tsf.Dom.show("td.ts-reset-button",this.getArea(),!e);var t="4"==teasp.Tsf.Dom.node(
".ts-list-top select.ts-list-top-range",this.getArea()).value;e||!tsfManager.getInfo().getCommon().isUseScannerStorage()||t||tsfManager.getInfo().getCommon().isExpCancelable()||(teasp.Tsf.Dom.setAttr("td.ts-reset-button > button","disabled","disabled"),teasp.Tsf.Dom.setAttr("td.ts-reset-button > button","title",teasp.message.getLabel("ex00001170"))),this.mask=e?1:2,this.searchObj={values:this.fp.getDefaultFilts()||{}
},this.setFreeFilts([]),this.refresh()},teasp.Tsf.ListExpPay.prototype.getListMode=function(){return 3},teasp.Tsf.ListExpPay.prototype.dataProcessing=function(){this.records&&dojo.forEach(this.records,function(e){var t=this.fp.parseValueByDomType(e,"status");e.approved=0<t.length&&["承認済み","確定済み","精算済み"].contains(t[0].value)||!1},this)},teasp.Tsf.ListExpPay.prototype.setAnchor=function(e){var t,s=teasp.Tsf.Dom.node(
"a",e);s&&(e=teasp.Tsf.Fp.getHkey(e),t=this.getTargetObj(),(e=this.fp.getFcByApiKey("EmpExp"==t?"ExpApplyId__c":"Id").fetchValue(e).value)&&(s.href="EmpExp"==t||"ExpApply"==t?teasp.getPageUrl("empExpView")+"?expApplyId="+e:teasp.getPageUrl("expPreApplyView")+"?id="+e,s.target="_blank"))},teasp.Tsf.ListExpPay.prototype.openZengin=function(){const s=teasp.Tsf.Dom.node(".ts-list-top select.ts-list-top-range",
this.getArea()).value,a=moment().add("month",-1).startOf("month").format("YYYY-MM-DD");tsfManager.potalAction({method:"getExpPayHistory",baseDate:a,payeeType:s},teasp.Tsf.Dom.hitch(this,function(e,t){e||(console.log("error: "),console.log(t));e=t.records;this.outputZenginDialog=new teasp.Tsf.OutputZengin({searchParams:{baseDate:a,payeeType:s},expPayHistories:e}),this.outputZenginDialog.show()}))},
teasp.Tsf.ListExpPay.prototype.search=function(){var e="searchExpPay"+this.listType;this.searchDialog=new teasp.Tsf.SearchCondition(teasp.Tsf.formParams[e],this.mask),this.searchDialog.show(this.searchObj||{},teasp.Tsf.Dom.hitch(this,function(e){this.setFreeFilts(e.filts),this.searchObj=e,this.refresh()}))},teasp.Tsf.ListExpPay.prototype.disableCheckBox=function(){var e=teasp.Tsf.Dom.node(
".ts-list-top select.ts-list-top-status",this.getArea());if(e){var t=teasp.Tsf.Dom.node(".ts-list-top select.ts-list-top-range",this.getArea());if(t){t="4"==t.value;if(!("0"==e.value)&&tsfManager.getInfo().getCommon().isUseScannerStorage()&&!t&&!tsfManager.getInfo().getCommon().isExpCancelable())for(var e=this.getCheckboxHead(),s=(e&&teasp.Tsf.Dom.setAttr2('input[type="checkbox"]',e,"disabled","disabled"),
this.getCheckboxBody()),a=0;a<s.rows.length;a++){var o=s.rows[a],i=teasp.Tsf.Fp.getHkey(o);this.fp.getFcByApiKey("Id").fetchValue(i).value&&teasp.Tsf.Dom.setAttr2('input.ts-check[type="checkbox"]',o,"disabled","disabled")}}}},teasp.Tsf.ListExpPay.prototype.refresh=function(){teasp.Tsf.ListBase.prototype.refresh.call(this),this.setSelectedCountMax(1==this.mask?tsfManager.getInfo().getCommon().getExpPayCountMax():0)},
teasp.Tsf.ListExpPay.prototype.getTargetObj=function(){var e;switch(this.listType){case"1":e="ExpApply";break;case"2":case"3":e="EmpExp";break;default:e="ExpPreApply"}return e},teasp.Tsf.ListExpPay.prototype.setPaid=function(e){console.log(e),this.setPaidLoop(e,0,teasp.util.date.getToday(1))},teasp.Tsf.ListExpPay.prototype.setPaidLoop=function(s,a,o){var e=s.values,t=this.getTargetObj();if(a>=s.ids.length
)return console.log("setPaidLoop finish"),void this.setPaidLoopEnd(s);console.log("setPaidLoop of "+a);var i=teasp.Tsf.ListExpPay.LOOP_SIZE,i=s.ids.slice(a,a+(i="ExpApply"!=t?2e3:i)),t=(a+=i.length,{method:"setPaid"+t,idset:i,param:{actionTime:teasp.util.date.formatDateTime(o),expItemId:e.expItemId,payDate:e.payDate,payMethod:e.payMethod,sourceAccountId:e.zgDataCheck?e.sourceAccountId:null,
outputJournal:e.outputJournal}});tsfManager.setPaid(t,teasp.Tsf.Dom.hitch(this,function(e,t){e?(console.log("succeed "),this.setPaidLoop(s,a,o)):teasp.Tsf.Error.showError(t)}))},teasp.Tsf.ListExpPay.prototype.setPaidLoopEnd=function(e){var t=e.values,s=this.getTargetObj(),e={idset:e.ids,param:{expItemId:t.expItemId,payDate:t.payDate,payMethod:t.payMethod,sourceAccountId:t.zgDataCheck?t.sourceAccountId:null,
outputJournal:t.outputJournal}};e.param.outputJournal&&(t=tsfManager.getInfo().getCommon().getExpEntryDataUrl(),this.openOutputPage(s,e,t,!0)()),e.param.sourceAccountId&&setTimeout(this.openOutputPage(s,e,teasp.getPageUrl("ebDataView")),1e3),this.refresh()},teasp.Tsf.ListExpPay.prototype.openOutputPage=function(e,t,s,a){return teasp.Tsf.Dom.hitch(this,function(){dojo.byId("payFormTarget").value=e,dojo.byId(
"payFormExpApplyId").value=t.idset.join(","),dojo.byId("payFormAdjustExpItem").value=t.param.expItemId||"",dojo.byId("payFormPayDate").value=t.param.payDate||"",dojo.byId("payFormRemarks").value=t.param.payMethod||"",dojo.byId("payFormSourceAccountId").value=t.param.sourceAccountId||"",dojo.attr("expPayForm","target",a?"_blank":"_top"),dojo.attr("expPayForm","action",s),dojo.byId("expPayForm").submit()})},
teasp.Tsf.ListExpPay.prototype.resetPaid=function(e){this.getTargetObj();var t=this.getCheckedIds();t.length<=0?teasp.tsAlert(teasp.message.getLabel("tf10001880")):(console.log("checkIds is "+t.length),teasp.tsConfirm(teasp.message.getLabel("tf10001900",t.length),this,function(e){e&&this.resetPaidLoop(0)}))},teasp.Tsf.ListExpPay.prototype.resetPaidLoop=function(s){console.log("resetPaidLoop of index "+s);
var e=this.getTargetObj(),t=this.getCheckedIds();if(s>=t.length)return console.log("resetPaidLoop finish"),void this.refresh();var a=200,t=t.slice(s,s+(a="ExpApply"!=e?2e3:a)),a=(s+=t.length,{method:"resetPaid"+e,idset:t});tsfManager.resetPaid(a,teasp.Tsf.Dom.hitch(this,function(e,t){e?this.resetPaidLoop(s):teasp.Tsf.Error.showError(t)}))},teasp.Tsf.ListExpPay.prototype.openPrint=function(){var e=this.getFilt(),
t=teasp.getPageUrl("expPrintView")+"?target=ExpPay&listType="+this.listType,s=(t+="&filt="+encodeURIComponent(e),window.open(t,"print-pay","width=800,height=800,resizable=yes,scrollbars=yes"));setTimeout(function(){s.resizeTo(810,800)},100)},teasp.Tsf.ListExpPay.prototype.csvOut=function(){var e="";switch(this.listType){case"1":e="p";break;case"2":e="i";break;case"3":e="c";break;default:e="t"}var s=(
1==this.mask?"pay":"paid")+"_"+e+"_"+teasp.util.date.formatDate(new Date,"yyyyMMdd")+".csv";this.csvDataRead(teasp.Tsf.Dom.hitch(this,function(e,t){e?this.csvOutput(s,t):teasp.Tsf.Error.showError(t)}))},teasp.Tsf.ListExpPay.prototype.csvDataRead=function(s){var a=1,o=!0,i=0,p=[],r=teasp.Tsf.Dom.hitch(this,function(){this.searchData(a++,100,o,!1,function(e,t){if(e){if(o){if((i=t.recordsCount)>teasp.constant.QUERY_MAX
)return teasp.tsConfirmA(teasp.message.getLabel("tf10007240",teasp.constant.QUERY_MAX),this,function(){o=!1,a=1,r()},function(){s(!1,teasp.message.getLabel("tf10007250",teasp.message.getLabel("tk10000755")))}),void(i=teasp.constant.QUERY_MAX);p=t.records||[],o=!1}else p=p.concat(t.records||[]);p.length<i?r():s(!0,p)}else s(!1,t)})});r()},teasp.Tsf.ListExpPay.prototype.csvOutput=function(e,t){if(t.length){for(var s=[]
,a=(this.fp.fcLoop(function(e){e.isHidden()||e.isCheck()||s.push(teasp.Tsf.util.escapeCsv(e.getLabel()))},this),""),o=0;o<t.length;o++){var i=t[o],p=[];this.fp.fcLoop(function(e){var t;e.isHidden()||e.isCheck()||(t=e.parseValue(i),"status"==e.getDomType()?p.push(teasp.Tsf.util.escapeCsv(teasp.constant.getDisplayStatus(t.dispValue))):p.push(teasp.Tsf.util.escapeCsv(t.dispValue)))},this),a=a+p.join(",")+"\r\n"}
this.csvDownload(e,s.join(","),a)}else teasp.tsAlert(teasp.message.getLabel("tm20003020"))},teasp.Tsf.ListExpPay.prototype.csvDownload=function(s,e,t){if((window.navigator.msSaveBlob||dojo.isChrome||dojo.isFF)&&!teasp.isSforce()){var a,o=new Uint8Array([239,187,191]),o=new Blob([o,e+"\r\n"+t],{type:"text/csv"});window.navigator.msSaveBlob?window.navigator.msSaveBlob(o,s):((a=dojo.byId("expTsfCsvDL")
).href=URL.createObjectURL(o),a.download=s,a.click(),setTimeout(function(){URL.revokeObjectURL(a.href)},3e3))}else{tsfManager.loading.show();for(var i=""+(new Date).getTime(),p=teasp.util.splitByLength(t,3e4),r=[],n=Math.ceil(p.length/9),l=0,c=0;c<n;c++){r[c]=[];for(var m=0;m<9;m++){var d=9*l+m;d<p.length&&r[c].push(p[d])}l++}for(var h=[],c=0;h.push({method:"inputData",key:i,head:0==c?e:null,values:r[c],order:c+1,
hideBusy:!0}),++c<r.length;);var f=0,g=null;(g=teasp.Tsf.Dom.hitch(this,function(){tsfManager.potalAction(h[f],teasp.Tsf.Dom.hitch(this,function(e,t){e?h.length<=f+1?(tsfManager.loading.hide(),teasp.downloadHref(teasp.getPageUrl("extCsvView")+"?key="+i+(s?"&fname="+s:""))):(f++,setTimeout(g,100)):(tsfManager.loading.hide(),teasp.Tsf.Error.showError(t))}))}))()}},
teasp.Tsf.ListExpPay.prototype.createExpPayBase=function(){var e=this.getCheckboxTable(),t=(e?teasp.Tsf.Dom.empty(e):e=this.getDomHelper().create("table",{className:"ts-list-body ts-list-head"}),this.drawHead(e)),s=this.getDomHelper().create("tbody",null,e);return this.records=[],this.recordCount=0,this.drawData(s),(tr=this.getDomHelper().create("tr",null,this.getDomHelper().create("tfoot",null,e))
).style.height="0px",this.getDomHelper().create("td",{colSpan:t},tr),e},teasp.Tsf.ListExpPay.prototype.drawHead=function(e){e=e||this.getCheckboxTable();var t=this.getCheckboxHead(),s=(t?teasp.Tsf.Dom.empty(t):t=this.getDomHelper().create("thead",null,e),this.getDomHelper().create("tr",null,t)),a=teasp.Tsf.Fp.setHkey(this.getDomHelper(),s),o=0,e=(this.fp.fcLoop(function(e){var t;e.isHidden()||(t=this.getDomHelper(
).create("th",{id:e.getDomId(a),style:{width:e.getWidth()}},s),o++,e.isSortable()&&(teasp.Tsf.Dom.style(t,"cursor","pointer"),this.getDomHelper().connect(t,"onclick",this,this.sortBy)),e.isCheck()?this.getDomHelper().create("input",{type:"checkbox"},t):(t=this.getDomHelper().create("div",null,t),this.getDomHelper().create("div",{innerHTML:e.getLabel()},t)))},this),teasp.Tsf.Dom.node('input[type="checkbox"]',s));
return e&&this.getDomHelper().connect(e,"onclick",this,this.checkAll),o},teasp.Tsf.ListExpPay.prototype.drawData=function(e){var t=this.drawHead();this.setSortMarker(),teasp.Tsf.ListBase.prototype.drawData.call(this,e),this.disableCheckBox(),this.drawFoot(t)},teasp.Tsf.ListExpPay.prototype.drawFoot=function(e){var t=this.getCheckboxTable(),s=this.getCheckboxFoot(),t=(s?teasp.Tsf.Dom.empty(s):s=this.getDomHelper(
).create("tfoot",null,t),this.getDomHelper().create("tr",null,s));t.style.height="0px",this.getDomHelper().create("td",{colSpan:e},t)},teasp.Tsf.ListExpPay.prototype.getCheckboxTable=function(e){return this.getListArea()},teasp.Tsf.ListExpPay.prototype.getCheckboxFoot=function(e){return teasp.Tsf.Dom.node("tfoot",this.getListArea())},teasp.Tsf.ListPrintExpPay=function(e){this.listType=e},
teasp.Tsf.ListPrintExpPay.prototype=new teasp.Tsf.ListBase,teasp.Tsf.ListPrintExpPay.prototype.init=function(){var e=tsfManager.getParams(),t=e.target||"",e=(this.filt=" "+decodeURIComponent(e.filt),"Print"+t+(this.listType||"1")),t=teasp.Tsf.formParams[e];if(!t)throw new Error(teasp.message.getLabel("tf10001670"));this.fp=teasp.Tsf.Fp.createFp(t),teasp.Tsf.ListBase.prototype.init.call(this)},
teasp.Tsf.ListPrintExpPay.prototype.refresh=function(){this.fp&&teasp.Tsf.ListBase.prototype.refresh.call(this)},teasp.Tsf.ListPrintExpPay.prototype.getFilt=function(e){return(e?" where ":"")+this.filt},teasp.Tsf.ListPrintExpPay.prototype.getArea=function(){return teasp.Tsf.Dom.byId("printExpView")},teasp.Tsf.ListPrintExpPay.prototype.createBase=function(){var e=this.getDomHelper().create("div",{
className:"ts-print-buttons",style:"padding:6px 2px;"}),t=this.getDomHelper().create("button",{innerHTML:teasp.message.getLabel("printOut_btn_title"),className:"ts-print-out"},e),s=this.getDomHelper().create("button",{innerHTML:teasp.message.getLabel("close_btn_title"),className:"ts-close"},e),t=(this.getDomHelper().connect(t,"onclick",this,function(){return window.print(),!1}),this.getDomHelper().connect(s,"onclick"
,this,function(){return(window.open("","_top").opener=top).close(),!1}),this.getDomHelper().create("div",{className:"ts-list-info",style:"text-align:left;"})),s=this.getDomHelper().create("div",{className:"ts-list-count",style:"text-align:left;"}),a=(this.getDomHelper().create("span",{innerHTML:teasp.message.getLabel("tf10010790")},s),this.getDomHelper().create("table",{className:"ts-list-body ts-list-head",
style:"display:none;"})),o=this.getDomHelper().create("tr",null,this.getDomHelper().create("thead",null,a)),i=teasp.Tsf.Fp.setHkey(this.getDomHelper(),o);return this.fp.fcLoop(function(e){var t;e.isHidden()||(t=this.getDomHelper().create("th",{id:e.getDomId(i),style:"width:"+e.getWidth()+";white-space:nowrap;"},o),e.isSortable()&&(teasp.Tsf.Dom.style(t,"cursor","pointer"),this.getDomHelper().connect(t,"onclick",this,
this.sortBy)),e.isCheck()?this.getDomHelper().create("input",{type:"checkbox"},t):(t=this.getDomHelper().create("div",null,t),this.getDomHelper().create("div",{innerHTML:e.getLabel()},t)))},this),this.getDomHelper().create("tbody",null,a),[e,t,s,a]},teasp.Tsf.ListPrintExpPay.prototype.searchData=function(e,t,s,a,o){this.showInfo(),1==this.listType?teasp.Tsf.ListBase.prototype.searchData.call(this,e,t,s,a,o):((t={
limit:t,offset:t*(e-1),countUp:s,piw:a}).soql=this.fp.createSoql(this.getFilt(!0),this.getChildFilt()),t.soqlForCnt=s?this.fp.createSoqlForCnt(this.getFilt(!0)):null,t.irregularType=this.fp.getIrregularType(),t.countUp=!0,tsfManager.searchData(t,teasp.Tsf.Dom.hitch(this,function(e,t){o(!!e,t)})))},teasp.Tsf.ListPrintExpPay.prototype.showInfo=function(){var e=teasp.Tsf.Dom.node(".ts-list-info",this.getArea());switch(
this.getDomHelper().create("span",{innerHTML:teasp.message.getLabel("tf10001430")+": "},e),this.listType){case"1":this.getDomHelper().create("span",{innerHTML:teasp.message.getLabel("tf10001360")},e);break;case"2":this.getDomHelper().create("span",{innerHTML:teasp.message.getLabel("tf10001370")},e);break;case"3":this.getDomHelper().create("span",{innerHTML:teasp.message.getLabel("tf10001380")},e);break;case"4":
this.getDomHelper().create("span",{innerHTML:teasp.message.getLabel("tf10001450")},e)}},teasp.Tsf.ListPrintExpPay.prototype.showRecordCount=function(){var e=teasp.Tsf.Dom.node(".ts-list-count",this.getArea()),t=(teasp.Tsf.Dom.empty(e),""),t=this.recordCount>this.fp.getRowLimit()?teasp.message.getLabel("tk10000343",this.fp.getRowLimit(),this.fp.getRowLimit()):teasp.message.getLabel("tf10010780",this.recordCount);
this.getDomHelper().create("span",{innerHTML:t},e)},teasp.Tsf.ListPrintExpPay.prototype.showData=function(e){this.showError(),this.pageNo=1,this.setSortMarker(),this.searchData(1,this.fp.getRowLimit(),!0,this.fp.isPiw(),teasp.Tsf.Dom.hitch(this,function(e,t){e?(this.recordCount=t.recordsCount,this.records=t.records||[],this.dataProcessing(),this.fetchJournal()):this.showError(t)}))},
teasp.Tsf.ListPrintExpPay.prototype.dataProcessing=function(){if(this.records)for(var e=this.records.length-1;0<=e;e--){var t=this.records[e];1==this.listType?(t.EmpExp__r&&t.EmpExp__r.length?(t.cost=t.AmountDueToPay__c,t.paid="精算済み"==t.StatusC__c,t.paid||(t.payDate__c=null,t.payMethod__c=null)):(this.records.splice(e,1),this.recordCount--),t._status=teasp.constant.getDisplayStatus(t.StatusD__c)
):2==this.listType||3==this.listType?(t.cost=t.Cost__c,t.paid=t.IsPaid__c,t._status=t.IsPaid__c?teasp.constant.getDisplayStatus("精算済み"):teasp.constant.getDisplayStatus("承認済み")):(t.cost=t.ProvisionalPaymentAmount__c,t.paid="精算済み"==t.StatusC__c,t._status=teasp.constant.getDisplayStatus(t.StatusD__c))}},teasp.Tsf.ListPrintExpPay.prototype.fetchJournal=function(){if(1==this.listType)this.drawData(),this.showDataEnd(
);else{for(var e,t=[],s=0;s<this.records.length;s++){var a=this.records[s];a.paid&&t.push(a.Id)}t.length?(e="select Id,JournalId__r.Date__c,JournalId__r.Note__c,CreatedDate,EmpExpId__c,EmpExpId__r.ExpApplyId__c,ExpPreApplyId__c from AtkJournalDetail__c where Removed__c = false",2==this.listType||3==this.listType?e+=" and EmpExpId__c in ('"+t.join("','")+"')":e+=" and ExpPreApplyId__c in ('"+t.join("','")+"')",
tsfManager.searchData({soql:e,limit:1e4,offset:0,countUp:!1,piw:!1,soqlForCnt:null,irregularType:null},teasp.Tsf.Dom.hitch(this,function(e,t){e?(console.log(t),this.mergeJournal(t.records),this.drawData(),this.showDataEnd()):this.showError(t)}))):(this.drawData(),this.showDataEnd())}},teasp.Tsf.ListPrintExpPay.prototype.mergeJournal=function(a){dojo.forEach(this.records,function(e){if(e.paid)for(
var t=0;t<a.length;t++){var s=a[t];(4==this.listType&&e.Id==s.ExpPreApplyId__c||e.Id==s.EmpExpId__c)&&(e._payDate=s.JournalId__r.Date__c,e._payNote=s.JournalId__r.Note__c)}},this)},teasp.Tsf.ListPrintExpPay.prototype.drawData=function(e){for(var t,s=e||this.getCheckboxBody(),a=(this.getDomHelper().freeBy(this.reskey),teasp.Tsf.Dom.empty(s),this.showRecordCount(),this.fp.getRowLimit(),null),o=0,
i=0;i<this.records.length;i++){var p=this.records[i],r=this.getEmpInfo(p),n=(a&&a.empId==r.empId||(a&&this.addSmallSum(s,a),t=this.getDomHelper().create("tr",null,s),n=this.getDomHelper().create("td",{colSpan:7,className:"ts-print-emp-row"},t),this.getDomHelper().create("div",{className:"ts-print-emp-c",innerHTML:teasp.message.getLabel("empCode_label")+":"},n),this.getDomHelper().create("div",{
className:"ts-print-emp-v",innerHTML:r.empCode},n),this.getDomHelper().create("div",{className:"ts-print-emp-c",innerHTML:teasp.message.getLabel("empName_label")+":"},n),this.getDomHelper().create("div",{className:"ts-print-emp-v",innerHTML:r.empName},n),this.getDomHelper().create("div",{className:"ts-print-emp-c",innerHTML:teasp.message.getLabel("dept_label")+":"},n),this.getDomHelper().create("div",{
className:"ts-print-emp-v",innerHTML:r.deptName?r.deptCode+"-"+r.deptName:""},n),a=r),p.cost),l=(a.cost+=n,o+=n,t=this.getDomHelper().create("tr",null,s),teasp.Tsf.Fp.setHkey(this.getDomHelper(),t));this.fp.fcLoop(function(e){e.isHidden()?this.getDomHelper().create("input",{type:"hidden",id:e.getDomId(l)},t):e.appendFieldCell(this.getDomHelper(),t,l)},this),this.fp.fcLoop(function(e){e.drawText(this.getDomHelper(),p,
l,t)},this)}a&&this.addSmallSum(s,a),this.addEmptyRow(s),this.addLargeSum(s,o),teasp.Tsf.Dom.show("table.ts-list-body",this.getArea(),!0)},teasp.Tsf.ListPrintExpPay.prototype.addEmptyRow=function(e){e=this.getDomHelper().create("tr",{className:"ts-print-empty-row"},e);this.getDomHelper().create("td",{colSpan:7},e)},teasp.Tsf.ListPrintExpPay.prototype.addSmallSum=function(e,t){var t=teasp.Tsf.Currency.formatMoney(
t.cost,teasp.Tsf.Currency.V_YEN,!1,!0),e=this.getDomHelper().create("tr",null,e),s=this.getDomHelper().create("td",{className:"ts-print-emp-sum1"},e);this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tm30001050")},s),s=this.getDomHelper().create("td",{className:"ts-print-emp-sum2 ts-form-currency"},e),this.getDomHelper().create("div",{innerHTML:t},s),this.getDomHelper().create("td",{colSpan:5,
className:"ts-print-emp-sum3"},e)},teasp.Tsf.ListPrintExpPay.prototype.addLargeSum=function(e,t){var t=teasp.Tsf.Currency.formatMoney(t,teasp.Tsf.Currency.V_YEN,!1,!0),e=this.getDomHelper().create("tr",null,e),s=this.getDomHelper().create("td",{className:"ts-print-emp-sum1"},e);this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("total_label")},s),s=this.getDomHelper().create("td",{
className:"ts-print-emp-sum2 ts-form-currency"},e),this.getDomHelper().create("div",{innerHTML:t},s),this.getDomHelper().create("td",{colSpan:5,className:"ts-print-emp-sum3"},e)},teasp.Tsf.ListPrintExpPay.prototype.getEmpInfo=function(e){return{empId:this.getValueByApiKey("EmpId__c",e,""),empCode:this.getValueByApiKey("EmpId__r.EmpCode__c",e,""),empName:this.getValueByApiKey("EmpId__r.Name",e,""),
deptCode:this.getValueByApiKey("EmpId__r.DeptId__r.DeptCode__c",e,""),deptName:this.getValueByApiKey("EmpId__r.DeptId__r.Name",e,""),cost:0}},teasp.Tsf.ListPrintExpPay.prototype.getValueByApiKey=function(e,t,s){e=this.fp.getFcByApiKey(e);if(!e)return s;e=e.parseValue(t);return void 0===e.value||null===e.value?s:e.value},teasp.Tsf.ListExpPrint=function(e){this.listType=e},
teasp.Tsf.ListExpPrint.prototype=new teasp.Tsf.ListBase,teasp.Tsf.ListExpPrint.prototype.init=function(){},teasp.Tsf.ListExpPrint.prototype.refresh=function(){this.fp},teasp.Tsf.ListExpPrint.prototype.getArea=function(){return teasp.Tsf.Dom.byId("printExpView")},teasp.Tsf.ListExpJsNavi=function(e){this.listType=e;e=teasp.Tsf.formParams.ListExpJsNavi,this.fp=teasp.Tsf.Fp.createFp(e),this.searchObj={
values:this.fp.getDefaultFilts()||{}},e=teasp.util.date.getToday();e.setMonth(e.getMonth()-1),this.targetYM=e.getFullYear()+("0"+(e.getMonth()+1)).slice(-2),this.targetStatus=0,this.payStatus=1,this.totalUseAmount=0,this.totalInvoiceAmount=0},teasp.Tsf.ListExpJsNavi.prototype=new teasp.Tsf.ListBase,teasp.Tsf.ListExpJsNavi.SELECTION_LIMIT=200,teasp.Tsf.ListExpJsNavi.prototype.createBase=function(){for(
var e=this.getDomHelper().create("div",{className:"ts-list-top"}),t=this.getDomHelper().create("tr",null,this.getDomHelper().create("tbody",null,this.getDomHelper().create("table",null,this.getDomHelper().create("div",{className:"ts-form-edge-left"},e)))),s=(this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tk10000063")},this.getDomHelper().create("td",{className:"ts-list-top-label"},t)),
this.getDomHelper().create("select",{className:"ts-list-top-range",id:"ymSelect"},this.getDomHelper().create("div",null,this.getDomHelper().create("td",{className:"ts-list-top-select"},t)))),a=[],o=teasp.util.date.getToday(),i=(o.setMonth(o.getMonth()),o.getFullYear()+("0"+(o.getMonth()+1)).slice(-2)),p=0;p<7;p++){var r=o.getFullYear()+("0"+(o.getMonth()+1)).slice(-2);a.push(r),o.setMonth(o.getMonth()-1)}
teasp.util.monthlyPulldown.create(s,a,i,!0,!0),s.value=this.targetYM,this.getDomHelper().connect(s,"onchange",this,this.changeList),this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("status_label")},this.getDomHelper().create("td",{className:"ts-list-top-label"},t)),s=this.getDomHelper().create("select",{className:"ts-list-top-status",id:"statusSelect"},this.getDomHelper().create("div",null,
this.getDomHelper().create("td",{className:"ts-list-top-status"},t))),this.getDomHelper().create("option",{value:"0",innerHTML:teasp.message.getLabel("all_label")},s),this.getDomHelper().create("option",{value:"1",innerHTML:teasp.message.getLabel("jt18000180")},s),this.getDomHelper().create("option",{value:"2",innerHTML:teasp.message.getLabel("jt18000100")},s),this.getDomHelper().create("option",{value:"3",
innerHTML:teasp.message.getLabel("jt18000190")},s),this.getDomHelper().connect(s,"onchange",this,this.changeStatus),this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10004981")},this.getDomHelper().create("td",{className:"ts-list-top-label"},t)),s=this.getDomHelper().create("select",{className:"ts-list-top-status",id:"payStatus"},this.getDomHelper().create("div",null,this.getDomHelper().create(
"td",{className:"ts-list-top-status"},t))),this.getDomHelper().create("option",{value:"1",innerHTML:teasp.message.getLabel("tk10000078")},s),this.getDomHelper().create("option",{value:"2",innerHTML:teasp.message.getLabel("reimbursement_label")},s),this.getDomHelper().connect(s,"onchange",this,this.changePayStatus),t=this.getDomHelper().create("tr",null,this.getDomHelper().create("tbody",null,this.getDomHelper(
).create("table",{className:"ts-form-control"},this.getDomHelper().create("div",{className:"ts-form-edge-right"},e)))),this.getDomHelper().create("div",{className:"",innerHTML:teasp.message.getLabel("jt18000130")},this.getDomHelper().create("td",{className:"ts-payValue-label"},t)),this.getDomHelper().create("div",{id:"totalUseAmount",className:"",innerHTML:""},this.getDomHelper().create("td",{
className:"ts-payValue-value ts-form-currency"},t)),this.getDomHelper().create("div",{innerHTML:"&nbsp;"},this.getDomHelper().create("td",{className:""},t)),this.getDomHelper().create("div",{className:"",innerHTML:teasp.message.getLabel("jt18000140")},this.getDomHelper().create("td",{className:"ts-payValue-label"},t)),this.getDomHelper().create("div",{id:"totalInvoiceAmount",className:"",innerHTML:""},
this.getDomHelper().create("td",{className:"ts-payValue-value ts-form-currency"},t)),this.getDomHelper().create("div",{innerHTML:"&nbsp;"},this.getDomHelper().create("td",{className:""},t)),this.getDomHelper().create("div",{className:"",innerHTML:teasp.message.getLabel("jt18000150")},this.getDomHelper().create("td",{className:"ts-payValue-label"},t)),this.getDomHelper().create("div",{id:"diffAmount",className:"",
innerHTML:""},this.getDomHelper().create("td",{className:"ts-dueToPay-value ts-form-currency"},t)),this.getDomHelper().create("div",{innerHTML:"&nbsp;"},this.getDomHelper().create("td",{className:""},t)),this.getDomHelper().create("button",{innerHTML:teasp.message.getLabel("tf10001460")},this.getDomHelper().create("td",{className:"ts-search-button"},t));i=teasp.Tsf.Dom.node(".ts-search-button button",t);
return i&&this.getDomHelper().connect(i,"onclick",this,function(e){this.search()}),[e,this.getDomHelper().create("div",{className:"ts-list-paging",style:"margin-left:21px; margin-bottom:5px;"}),teasp.Tsf.ListBase.prototype.createBase.call(this)]},teasp.Tsf.ListExpJsNavi.prototype.changeList=function(){var t=teasp.Tsf.Dom.node("#ymSelect",this.getArea());if("*"==t.value){var s=[],e=teasp.util.date.getToday();
e.setMonth(e.getMonth());for(var a=0;a<7;a++){var o=e.getFullYear()+("0"+(e.getMonth()+1)).slice(-2);s.push(o),e.setMonth(e.getMonth()-1)}teasp.util.monthlyPulldown.changed(t,this.targetYM,teasp.Tsf.Dom.hitch(this,function(e){s.indexOf(""+e)<0?teasp.util.monthlyPulldown.create(t,s,e,!0,!0):t.value=""+e,this.targetYM=t.value,this.clear(),this.refresh()}))}else this.targetYM=t.value,this.clear(),this.refresh()},
teasp.Tsf.ListExpJsNavi.prototype.changePayStatus=function(){var e=teasp.Tsf.Dom.node("#payStatus",this.getArea());this.payStatus=e.value,this.clear(),this.refresh()},teasp.Tsf.ListExpJsNavi.prototype.changeStatus=function(){var e=teasp.Tsf.Dom.node("#statusSelect",this.getArea());this.targetStatus=e.value,this.clear(),this.refresh()},teasp.Tsf.ListExpJsNavi.prototype.getFilt=function(e){var o=this.freeFilts||[],p=[]
,t=!0,s=(0<o.length&&dojo.forEach(o,function(e){e=e.filtVal;e&&-1!=e.indexOf("Date__c")&&(t=!1)}),t&&p.push("YearMonth__c = "+this.targetYM),"1"==this.targetStatus||"2"==this.targetStatus?p.push("(ExpApplyId__r.Status__c = '承認済み' or ExpApplyId__r.Status__c = '精算済み' or ExpApplyId__r.Status__c = '確定済み' or ExpApplyId__r.Status__c = '仕訳済み')"):"3"==this.targetStatus&&p.push(
"(ExpApplyId__r.Status__c != '承認済み' and ExpApplyId__r.Status__c != '精算済み' and ExpApplyId__r.Status__c != '確定済み' and ExpApplyId__r.Status__c != '仕訳済み')"),0<o.length&&dojo.forEach(o,function(e){if(e.filtVal)p.push(e.filtVal);else if(e.ors){for(var t=[],s=0;s<e.ors.length;s++){for(var a=e.ors[s]||[],o=[],i=0;i<a.length;i++)o.push(a[i].filtVal);t.push("("+o.join(" and ")+")")}p.push("("+t.join(" or ")+")")}}),
this.fp.getFilts());return dojo.forEach(s,function(e){if(e.fix||o.length<=0)if(e.filtVal)"empId"==e.filtKey?p.push(teasp.Tsf.util.formatString(e.filtVal,tsfManager.getEmpId())):"userId"==e.filtKey?p.push(teasp.Tsf.util.formatString(e.filtVal,tsfManager.getEmpUserId())):"today"==e.filtKey?p.push(teasp.Tsf.util.formatString(e.filtVal,teasp.util.date.formatDate(teasp.util.date.getToday()))
):e.mask&&e.mask!=this.mask||p.push(e.filtVal);else if(e.apiKey&&e.value&&!/^_/.test(e.apiKey)){var t=this.fp.getFcByApiKey(e.apiKey);if(t){var s=[];t.setFilts(s,[{value:e.value}]);for(var a=0;a<s.length;a++)p.push(s[a].filtVal)}}},this),p.length<=0?"":(e?" where ":"")+p.join(" and ")},teasp.Tsf.ListExpJsNavi.prototype.getListMode=function(){return 3},teasp.Tsf.ListExpJsNavi.prototype.dataProcessing=function(){
console.log("dataProcessing"),this.records&&dojo.forEach(this.records,function(e){console.log(e)},this)},teasp.Tsf.ListExpJsNavi.prototype.drawData=function(e){var t=e||this.getCheckboxBody();this.getDomHelper().freeBy(this.reskey),teasp.Tsf.Dom.empty(t),this.firstEmptyRowKey=null;for(var s=this.getFilt().split(" and "),a={},o=0;o<s.length;o++){var i,p,r=s[o].replace(/\s+/g,"");r&&(-1!=r.indexOf("Date__c")?(
i=r.indexOf(">="),p=r.indexOf("<="),-1!=i?a.dateFrom=r.substr(i+2,10):-1!=p&&(a.dateTo=r.substr(p+2,10))):a.yearMonth=this.targetYM)}for(var n=this.fp.getRowLimit()+1,o=0;o<n;o++){var l=this.getDomHelper().create("tr",null,t),c=teasp.Tsf.Fp.setHkey(this.getDomHelper(),l),m=(this.fp.fcLoop(function(e){e.isHidden()?this.getDomHelper().create("input",{type:"hidden",id:e.getDomId(c)},l):e.appendFieldCell(
this.getDomHelper(),l,c)},this),this.getDomHelper().create("td",{className:"last",style:"width:16px;display:none;"},l),o<this.records.length?this.records[o]:{});o==this.records.length&&(this.firstEmptyRowKey=c),null!=m.totalInvoiceAmount&&(m._DetailLink=teasp.message.getLabel("jt18000120")),m.ExpApplyId__c&&0<m.ExpApplyId__c.length&&(m._ApplyNo=m.ExpApplyNo__c),m.ExpPreApplyId__c&&0<m.ExpPreApplyId__c.length&&(
m._PreApplyNo=m.ExpPreApplyNo__c),this.fp.fcLoop(function(e){e.drawText(this.getDomHelper(),m,c,l)},this),o<this.records.length?(l.style.cursor="pointer",this.getDomHelper().connect(l,"onclick",this,this.clickTr,this.reskey)):l.style.cursor="default",this.setInvoiceDetailAnchor(l,m,a),this.setExpAnchor(l,m)}this.setCheckedIds();e=teasp.Tsf.Dom.byId("totalUseAmount"),e&&(e.textContent=teasp.Tsf.Currency.formatMoney(
this.totalUseAmount,teasp.Tsf.Currency.V_YEN,!1,!0)),e=teasp.Tsf.Dom.byId("totalInvoiceAmount"),e&&(e.textContent=teasp.Tsf.Currency.formatMoney(this.totalInvoiceAmount,teasp.Tsf.Currency.V_YEN,!1,!0)),e=teasp.Tsf.Dom.byId("diffAmount");e&&(e.textContent=teasp.Tsf.Currency.formatMoney(this.totalInvoiceAmount-this.totalUseAmount,teasp.Tsf.Currency.V_YEN,!1,!0)),teasp.Tsf.ListBase.setPaging({pageNo:this.pageNo,
cntAll:this.recordCount,rowLimit:this.fp.getRowLimit()},teasp.Tsf.Dom.node(".ts-list-paging",this.getArea()),this.getDomHelper(),"paging",this)},teasp.Tsf.ListExpJsNavi.prototype.setExpAnchor=function(e,t){var s,a,o=dojo.query("a",e);o&&o.length&&1<o.length&&(s=o[1],o=o[2],e=teasp.Tsf.Fp.getHkey(e),a=this.fp.getFcByApiKey("ExpApplyId__c").fetchValue(e).value,e=this.fp.getFcByApiKey("ExpPreApplyId__c").fetchValue(e
).value,a&&s&&(s.href=teasp.getPageUrl("empExpView")+"?expApplyId="+a,s.target="_blank"),e&&o&&(o.href=teasp.getPageUrl("expPreApplyView")+"?id="+e,o.target="_blank"))},teasp.Tsf.ListExpJsNavi.prototype.setInvoiceDetailAnchor=function(e,t,s){var a,o,i="?targetStatus="+this.targetStatus,s=(i+="&payStatus="+this.payStatus,s.yearMonth&&(i+="&targetYM="+s.yearMonth),s.dateFrom&&(i+="&dFrom="+s.dateFrom),s.dateTo&&(
i+="&dTo="+s.dateTo),dojo.query("a",e));s&&s.length&&(e=s[0],a=teasp.getPageUrl("jtbDetailView")+i,t.EmpId__c&&(a+="&targetEmpId="+t.EmpId__c),t.ExpApplyId__c&&(a+="&expApplyId="+t.ExpApplyId__c),t.ExpPreApplyId__c&&(a+="&expPreApplyId="+t.ExpPreApplyId__c),a=encodeURI(a),s=screen.availHeight||800,o="width=1024,height="+(s=800<s?800:s)+",resizable=yes,scrollbars=yes",this.getDomHelper().connect(e,"onclick",this,
function(){window.open(a,"detail",o)},this.reskey))},teasp.Tsf.ListExpJsNavi.prototype.search=function(){this.searchDialog=new teasp.Tsf.SearchCondition(teasp.Tsf.formParams.searchExpJsNavi),this.searchDialog.show(this.searchObj||{},teasp.Tsf.Dom.hitch(this,function(e){this.setFreeFilts(e.filts),this.searchObj=e,this.refresh()}))},teasp.Tsf.ListExpJsNavi.prototype.searchData=function(e,t,s,a,o){t={limit:t,offset:t*(
e-1),countUp:s,piw:a};t.target=this.fp.getObjectName(),t.countUp=!0,t.mode=this.getListMode(),t.targetEmpId=null,t.orderBy=this.fp.createOrderBy(),t.filt=this.getFilt(),t.childFilt=this.getChildFilt(),t.childNega=this.getChildNega(),t.payManage=this.fp.getPayManage(),t.irregularType=this.fp.getIrregularType(),t.targetStatus=this.targetStatus,t.payStatus=this.payStatus,t.targetYM=this.targetYM,tsfManager.getList(t,
teasp.Tsf.Dom.hitch(this,function(e,t){e?(this.totalUseAmount=t.totalUseAmount,this.totalInvoiceAmount=t.totalInvoiceAmount,o(!0,t)):o(!1,t)}))},teasp.Tsf.ListExpJsNavi.prototype.clear=function(){this.totalUseAmount=0,this.totalInvoiceAmount=0},teasp.Tsf.ListExpJsNaviDetail=function(){var e=teasp.Tsf.formParams.ListExpJsNaviDetail;this.fp=teasp.Tsf.Fp.createFp(e),(this.searchObj=null)==tsfManager.params.targetym?((
e=teasp.util.date.getToday()).setMonth(e.getMonth()-1),this.targetYM=e.getFullYear()+("0"+(e.getMonth()+1)).slice(-2)):this.targetYM=tsfManager.params.targetym,this.targetStatus=0},teasp.Tsf.ListExpJsNaviDetail.prototype=new teasp.Tsf.ListBase,teasp.Tsf.ListExpJsNaviDetail.SELECTION_LIMIT=200,teasp.Tsf.ListExpJsNaviDetail.prototype.createBase=function(){var e=this.getDomHelper().create("div",{className:"ts-list-top"}
),t=this.getDomHelper().create("tr",null,this.getDomHelper().create("tbody",null,this.getDomHelper().create("table",null,this.getDomHelper().create("div",{className:"ts-form-edge-left"},e))));return this.getDomHelper().create("div",{className:"ts-list-paging"},this.getDomHelper().create("td",{className:"ts-space"},t)),this.getDomHelper().create("tr",null,this.getDomHelper().create("tbody",null,this.getDomHelper(
).create("table",null,this.getDomHelper().create("div",{className:"ts-form-edge-right"},e)))),[e,teasp.Tsf.ListBase.prototype.createBase.call(this)]},teasp.Tsf.ListExpJsNaviDetail.prototype.getFilt=function(e){var o=[],i=[],t=tsfManager.params.targetstatus,s=tsfManager.params.targetym,a=tsfManager.params.dfrom,p=tsfManager.params.dto,r=tsfManager.params.appno?decodeURI(tsfManager.params.appno):null,
n=tsfManager.params.empdept?decodeURI(tsfManager.params.empdept):null,l=tsfManager.params.appdept?decodeURI(tsfManager.params.appdept):null,c=tsfManager.params.empcd?decodeURI(tsfManager.params.empcd):null,m=tsfManager.params.empnm?decodeURI(tsfManager.params.empnm):null,t=(t&&("1"==t||"2"==t?i.push(
"(ExpApplyId__r.Status__c = '承認済み' or ExpApplyId__r.Status__c = '精算済み' or ExpApplyId__r.Status__c = '確定済み' or ExpApplyId__r.Status__c = '仕訳済み')"):"3"==t&&i.push("(ExpApplyId__r.Status__c != '承認済み' and ExpApplyId__r.Status__c != '精算済み' and ExpApplyId__r.Status__c != '確定済み' and ExpApplyId__r.Status__c != '仕訳済み')")),a||p?a&&p?i.push("(Date__c >= "+a+" and Date__c <= "+p+")"):!a&&p?i.push("Date__c <= "+p):a&&!p&&i.push(
"Date__c >= "+a):i.push("YearMonth__c = "+s),r&&i.push("ExpApplyId__r.ExpApplyNo__c like '%"+r+"'"),(n||l)&&(n&&l?i.push("(EmpId__r.DeptId__r.Name like '%"+n+"%' or ExpApplyId__r.DeptId__r.Name like '%"+l+"%')"):!n&&l?i.push("ExpApplyId__r.DeptId__r.Name like '%"+l+"%'"):n&&!l&&i.push("EmpId__r.DeptId__r.Name like '%"+n+"%'")),c&&i.push("EmpId__r.EmpCode__c like '"+c+"%'"),m&&i.push("EmpId__r.Name like '%"+m+"%'"),
this.fp.getFilts());return dojo.forEach(t,function(e){if(e.fix||o.length<=0)if(e.filtVal)"empId"==e.filtKey?i.push(teasp.Tsf.util.formatString(e.filtVal,tsfManager.getEmpId())):"userId"==e.filtKey?i.push(teasp.Tsf.util.formatString(e.filtVal,tsfManager.getEmpUserId())):"today"==e.filtKey?i.push(teasp.Tsf.util.formatString(e.filtVal,teasp.util.date.formatDate(teasp.util.date.getToday()))
):e.mask&&e.mask!=this.mask||i.push(e.filtVal);else if(e.apiKey&&e.value&&!/^_/.test(e.apiKey)){var t=this.fp.getFcByApiKey(e.apiKey);if(t){var s=[];t.setFilts(s,[{value:e.value}]);for(var a=0;a<s.length;a++)i.push(s[a].filtVal)}}},this),i.length<=0?"":(e?" where ":"")+i.join(" and ")},teasp.Tsf.ListExpJsNaviDetail.prototype.getListMode=function(){return 3},
teasp.Tsf.ListExpJsNaviDetail.prototype.dataProcessing=function(){this.records&&dojo.forEach(this.records,function(e){console.log(e)},this)},teasp.Tsf.ListExpJsNaviDetail.prototype.drawData=function(e){for(var t=e||this.getCheckboxBody(),s=(this.getDomHelper().freeBy(this.reskey),teasp.Tsf.Dom.empty(t),this.firstEmptyRowKey=null,this.fp.getRowLimit()+1),a=0;a<s;a++){var o=this.getDomHelper().create("tr",null,t),
i=teasp.Tsf.Fp.setHkey(this.getDomHelper(),o),p=(this.fp.fcLoop(function(e){e.isHidden()?this.getDomHelper().create("input",{type:"hidden",id:e.getDomId(i)},o):e.appendFieldCell(this.getDomHelper(),o,i)},this),this.getDomHelper().create("td",{className:"last",style:"width:16px;display:none;"},o),a<this.records.length?this.records[a]:{});a==this.records.length&&(this.firstEmptyRowKey=i),
p.ExpPreApplyId__c&&0<p.ExpPreApplyId__c.length&&(p._PreApplyNo=p.ExpPreApplyId__r.ExpPreApplyNo__c),this.fp.fcLoop(function(e){e.drawText(this.getDomHelper(),p,i,o)},this),a<this.records.length?(o.style.cursor="pointer",this.getDomHelper().connect(o,"onclick",this,this.clickTr,this.reskey)):o.style.cursor="default",this.setExpAnchor(o,p)}this.setCheckedIds(),teasp.Tsf.ListBase.setPaging({pageNo:this.pageNo,
cntAll:this.recordCount,rowLimit:this.fp.getRowLimit()},teasp.Tsf.Dom.node(".ts-list-paging",this.getArea()),this.getDomHelper(),"paging",this)},teasp.Tsf.ListExpJsNaviDetail.prototype.setExpAnchor=function(e,t){var s=teasp.Tsf.Dom.node("a",e);s&&(e=teasp.Tsf.Fp.getHkey(e),(e=this.fp.getFcByApiKey("ExpPreApplyId__c").fetchValue(e).value)&&(s.href=teasp.getPageUrl("expPreApplyView")+"?id="+e,s.target="_blank"))},
teasp.Tsf.ListExpJsNaviDetail.prototype.search=function(){this.searchDialog=new teasp.Tsf.SearchCondition(teasp.Tsf.formParams.searchExpJsNavi),this.searchDialog.show(this.searchObj||{},teasp.Tsf.Dom.hitch(this,function(e){this.setFreeFilts(e.filts),this.searchObj=e,this.refresh()}))},teasp.Tsf.ListExpJsNaviDetail.prototype.searchData=function(e,t,s,a,o){t={limit:t,offset:t*(e-1),countUp:s,piw:a};
t.target=this.fp.getObjectName(),t.countUp=!0,t.mode=this.getListMode(),t.targetEmpId=tsfManager.params.targetempid,t.orderBy=this.fp.createOrderBy(),t.filt=this.getFilt(),t.childFilt=this.getChildFilt(),t.childNega=this.getChildNega(),t.payManage=this.fp.getPayManage(),t.irregularType=this.fp.getIrregularType(),t.targetStatus=this.targetStatus,t.targetYM=tsfManager.params.targetym,
t.expPreApplyId=tsfManager.params.exppreapplyid,t.expApplyId=tsfManager.params.expapplyid,tsfManager.getList(t,teasp.Tsf.Dom.hitch(this,function(e,t){o(!!e,t)}))},teasp.Tsf.ListCsvUpload=function(e){this.listType=e},teasp.Tsf.ListCsvUpload.prototype=new teasp.Tsf.ListBase,teasp.Tsf.ListCsvUpload.prototype.init=function(){},teasp.Tsf.ListCsvUpload.prototype.refresh=function(){this.fp},
teasp.Tsf.ListCsvUpload.prototype.getArea=function(){return teasp.Tsf.Dom.byId("printExpView")},teasp.Tsf.ListEmpTable=function(){var e=tsfManager.getType(),t="Time"==e||"Job"==e?teasp.Tsf.formParams.ListEmpTable2:teasp.Tsf.formParams.ListEmpTable;this.fp=teasp.Tsf.Fp.createFp(t),"Time"==e?this.fp.setChildren({EmpR1__r:{fields:[{apiKey:"EmpApplyId__r.Status__c"},{apiKey:"Id"},{apiKey:"YearMonth__c"},{
apiKey:"SubNo__c"},{apiKey:"EmpTypeId__r.Name"}]}}):"Job"==e&&this.fp.setChildren({AtkJobApplyR2__r:{fields:[{apiKey:"Status__c"},{apiKey:"Id"},{apiKey:"YearMonth__c"},{apiKey:"SubNo__c"}]}}),this.listAreaHeight=100},teasp.Tsf.ListEmpTable.prototype=new teasp.Tsf.ListBase,teasp.Tsf.ListEmpTable.prototype.init=function(){teasp.Tsf.ListBase.prototype.init.call(this),teasp.Tsf.MainEmpTable.resize()},
teasp.Tsf.ListEmpTable.prototype.createBase=function(){var e=this.getDomHelper().create("div",{className:"ts-emp-table"}),t=this.getDomHelper().create("div",{className:"ts-search-list"},e);return this.createScrollTable(t),teasp.Tsf.Dom.show("div.ts-search-list-box",e,!1),e},teasp.Tsf.ListEmpTable.prototype.setSearchContent=function(e){var t=this.getDomHelper().create("div",{className:"ts-tool-top",
style:"position:relative;"},e),s=(this.getDomHelper().create("span",{innerHTML:teasp.message.getLabel("tk10000063")},this.getDomHelper().create("div",{className:"ts-tool-label"},t)),this.getDomHelper().create("select",{className:"ts-month-select"},this.getDomHelper().create("div",{className:"ts-tool-value"},t))),a=tsfManager.getInfo().getMonthList(),a=(dojo.forEach(a,function(e){this.getDomHelper().create("option",{
value:e.value,innerHTML:e.label},s)},this),s.value=tsfManager.getInfo().getMonth(),this.domHelper.connect(s,"onchange",this,this.changedMonth),this.getDomHelper().create("span",{innerHTML:teasp.message.getLabel("tk10000335")},this.getDomHelper().create("div",{className:"ts-tool-label"},t)),s=this.getDomHelper().create("select",{style:"width:300px;",className:"ts-dept-select"},this.getDomHelper().create("div",{
className:"ts-tool-value"},t)),this.loadDeptSelect(s),this.domHelper.connect(s,"onchange",this,this.changedDept),this.getDomHelper().create("button",{innerHTML:teasp.message.getLabel("search_btn_title"),className:"ts-search"},this.getDomHelper().create("div",null,t))),a=(this.domHelper.connect(a,"onclick",this,this.search),teasp.isSforce1()||(a=this.getDomHelper().create("button",{innerHTML:teasp.message.getLabel(
"close_btn_title"),className:"ts-close"},this.getDomHelper().create("div",null,t)),this.domHelper.connect(a,"onclick",this,function(){return(window.open("","_top").opener=top).close(),!1})),this.getDomHelper().create("div",{style:"position:absolute;left:190px;top:29px;z-index:1;display:none !important;",className:"ts-dept-recur"},t)),t=this.getDomHelper().create("label",null,a);this.getDomHelper().create("input",{
type:"checkbox"},t),this.getDomHelper().create("span",{innerHTML:" "+teasp.message.getLabel("tf10008150")},t),this.collectFilts(e),this.initUnderDept(e)},teasp.Tsf.ListEmpTable.prototype.drawData=function(e){var t=e||this.getCheckboxBody();this.getDomHelper().freeBy(this.reskey),teasp.Tsf.Dom.empty(t);for(var s=0;s<this.records.length;s++){var a=this.getDomHelper().create("tr",null,t),o=(teasp.Tsf.Dom.toggleClass(a,
"ts-row-even",!(s%2)),teasp.Tsf.Dom.toggleClass(a,"ts-row-odd",s%2),teasp.Tsf.Fp.setHkey(this.getDomHelper(),a)),i=(this.fp.fcLoop(function(e){e.isHidden()?this.getDomHelper().create("input",{type:"hidden",id:e.getDomId(o)},a):e.appendFieldCell(this.getDomHelper(),a,o)},this),this.records[s]);this.fp.fcLoop(function(e){e.drawText(this.getDomHelper(),i,o,a)},this),this.getDomHelper().connect(teasp.Tsf.Dom.query("a",a)
,"onclick",this,this.clickEmp(s))}teasp.Tsf.ListBase.setPaging({pageNo:this.pageNo,cntAll:this.recordCount,rowLimit:this.fp.getRowLimit()},teasp.Tsf.Dom.node(".ts-list-paging",this.getArea()),this.getDomHelper(),"paging",this),this.recordCount||(teasp.Tsf.Dom.node(".ts-list-paging .ts-page-message",this.getArea()).innerHTML="<br/>"),teasp.Tsf.Dom.show("div.ts-search-list-box",this.getArea(),!0),
this.tableHeight=t.offsetHeight+2,teasp.Tsf.Dom.show("div.ts-dept-recur",this.getArea(),!0);e=teasp.Tsf.Dom.node("div.ts-list-paging",this.getArea()).offsetWidth;teasp.Tsf.Dom.style(teasp.Tsf.Dom.node("div.ts-section-form",this.getArea()),"margin-top",180<e?"20px":"4px"),teasp.Tsf.MainEmpTable.resize()},teasp.Tsf.ListEmpTable.prototype.clickEmp=function(i){return teasp.Tsf.Dom.hitch(this,function(){console.log(
this.records[i]);var e=this.records[i],t=null,s=tsfManager.getType(),a=this.getOpenMode(e,"ExpPre"==s||"Exp"==s),a=a?"&mode="+a:"";if("ExpPre"==s)t=teasp.getPageUrl("expPreApplyView")+"?empId="+e.Id+a;else if("Exp"==s)t=teasp.getPageUrl("empExpView")+"?empId="+e.Id+a;else if("Time"==s)var o=this.getMonth(),t=teasp.getPageUrl("workTimeView")+"?empId="+e.Id+"&month="+o.ym+"&subNo="+(o.sn||"")+a;else{if("Job"!=s)return;
o=this.getMonth();t=teasp.getPageUrl("empJobView")+"?empId="+e.Id+"&month="+o.ym+"&subNo="+(o.sn||"")+a}teasp.isSforce1()?sforce.one.navigateToURL(t,!0):(opener||(window.open("","_top").opener=top),opener&&(opener.teasp.locationHref(t),opener.focus()))})},teasp.Tsf.ListEmpTable.prototype.collectFilts=function(e){var t,s=[],a=teasp.Tsf.Dom.node("select.ts-dept-select",e),o=(a.value&&("-1"==(t=a.value)?s.push({
filtVal:"DeptId__c = null"}):teasp.Tsf.Dom.node('input[type="checkbox"]',e).checked?(o=tsfManager.getUnderDeptIds(t),s.push({filtVal:"DeptId__c in ('"+o.join("','")+"')"})):s.push({filtVal:"DeptId__c = '"+t+"'"})),a=teasp.Tsf.Dom.node("select.ts-month-select",e),tsfManager.getInfo().getStartEndByYearMonth(a.value));s.push({
filtVal:"(EntryDate__c = null or EntryDate__c <= "+o.endDate+") and (EndDate__c = null or EndDate__c >= "+o.startDate+")"}),this.setFreeFilts(s)},teasp.Tsf.ListEmpTable.prototype.getMonth=function(){var e=(select=teasp.Tsf.Dom.node("select.ts-month-select",this.getArea())).value.split(".");return{ym:e[0],sn:1<e.length&&e[1]||null,key:select.value}},teasp.Tsf.ListEmpTable.prototype.getChildFilt=function(){
var e=this.getMonth();return" where YearMonth__c = "+e.ym+" and SubNo__c = "+(e.sn||"null")},teasp.Tsf.ListEmpTable.prototype.loadDeptSelect=function(e){for(var t=tsfManager.getDepts(),s=tsfManager.getInfo().getSelectDeptId(),a=(teasp.Tsf.Dom.empty(e),this.getDomHelper().create("option",{value:"",innerHTML:teasp.message.getLabel("tk10000344")},e),this.getDomHelper().create("option",{value:"-1",
innerHTML:teasp.message.getLabel("tk10000436")},e),!1),o=0;o<t.length;o++)this.getDomHelper().create("option",{value:t[o].getId()||"",innerHTML:t[o].getDisplayName()},e),t[o].getId()==s&&(a=!0);e.value=a||"-1"==s?s:""},teasp.Tsf.ListEmpTable.prototype.changedMonth=function(e){var s=teasp.Tsf.Dom.node("select.ts-dept-select",this.getArea()),e=(tsfManager.getInfo().setSelectDeptId(s.value),teasp.Tsf.Dom.setAttr(s,
"disabled",!0),tsfManager.getInfo().getStartEndByYearMonth(e.target.value));e.method="getDeptList",tsfManager.getDeptList(e,teasp.Tsf.Dom.hitch(this,function(e,t){teasp.Tsf.Dom.setAttr(s,"disabled",!1),e&&(tsfManager.getInfo().replaceDeptList(t.depts),this.loadDeptSelect(s))}))},teasp.Tsf.ListEmpTable.prototype.changedDept=function(e){this.initUnderDept(this.getArea())},
teasp.Tsf.ListEmpTable.prototype.initUnderDept=function(e){var t=teasp.Tsf.Dom.node("select.ts-dept-select",e).value;teasp.Tsf.Dom.node('input[type="checkbox"]',e).disabled=!t||"-1"==t},teasp.Tsf.ListEmpTable.prototype.search=function(e){this.collectFilts(this.getArea()),this.refresh()},teasp.Tsf.ListEmpTable.prototype.resizedArea=function(e){var t,s=teasp.Tsf.Dom.node("div.ts-search-list-box",this.getArea());s&&(
t=teasp.Tsf.Dom.top(s)+20,this.listAreaHeight=e.h-t,(t=Math.min(this.tableHeight,this.listAreaHeight))<0&&(t=0),teasp.Tsf.Dom.style(s,"height",t+"px"),teasp.Tsf.Dom.style(teasp.Tsf.Dom.node(".ts-popup-win > div > table"),"width",s.offsetWidth+"px"))},teasp.Tsf.ListEmpTable.prototype.dataProcessing=function(){var e,t=this.fp.getChildren()||{},s=null;for(e in t)t.hasOwnProperty(e)&&(s=e);for(
var a=s&&t[s]&&t[s].fields||[],o=null,i=null,p=(dojo.forEach(a,function(e){"EmpApplyId__r.Status__c"==e.apiKey||"Status__c"==e.apiKey?o=e:"EmpTypeId__r.Name"==e.apiKey&&(i=e)}),new teasp.Tsf.Fc(o||{})),r=i?new teasp.Tsf.Fc(i):this.fp.getFcByApiKey("EmpTypeId__r.Name"),n=this.records||[],l=0;l<n.length;l++){var c,m=n[l],d=m[s]||[],d=d.length?d[0]:null;d&&d.YearMonth__c?(c=p.parseSimple(d),
m._status=teasp.constant.getDisplayStatus(c.value||"未確定"),(c=r.parseSimple(d)).value||(c=r.parseSimple(m))):(m._status="－",c=r.parseSimple(m)),m._empTypeName=c.value||""}},teasp.Tsf.ListEmpTable.prototype.getOpenMode=function(e,t){var s=tsfManager.getParamByKey("mode")||"";if("read"!=s){var a=tsfManager.getSessionEmp(),o=tsfManager.getInfo().getSessionUser().getId();if(tsfManager.isSysAdmin()||a.isAdmin(
)||a.isAllEditor()||t&&a.isExpAdmin()||e.UserId__c==o||e.Manager__c==o)return s;var t=e.DeptId__r||null,a=t&&t.ParentId__r||null,e=a&&a.ParentId__r||null,i=e&&e.ParentId__r||null;if(t&&(t.ManagerId__c==o||t.Manager1Id__c==o||t.Manager2Id__c==o)||a&&(a.ManagerId__c==o||a.Manager1Id__c==o||a.Manager2Id__c==o)||e&&(e.ManagerId__c==o||e.Manager1Id__c==o||e.Manager2Id__c==o)||i&&(
i.ManagerId__c==o||i.Manager1Id__c==o||i.Manager2Id__c==o))return s}return"read"},teasp.Tsf.ListEmpTable.prototype.getOrgTarget=function(){return tsfManager.getType()},teasp.Tsf.FormBase=function(){this.parentId="tsfFormArea",this.sectionExpAssist=null,this.sectionExpFilter=null},teasp.Tsf.FormBase.factory=function(e){return new teasp.Tsf[e]},teasp.Tsf.FormBase.erase=function(e){return e&&(e.destroy(),delete e),null}
,teasp.Tsf.FormBase.prototype.getFormStyle=function(){return 0},teasp.Tsf.FormBase.prototype.getArea=function(){return teasp.Tsf.Dom.byId(this.fp.getAreaId())},teasp.Tsf.FormBase.prototype.getTailArea=function(){return teasp.Tsf.Dom.node("div.ts-form-tail",this.getArea())},teasp.Tsf.FormBase.prototype.getObjBase=function(){return this.objBase},teasp.Tsf.FormBase.prototype.isReadOnly=function(){
return!!this.objBase&&this.objBase.isReadOnly()},teasp.Tsf.FormBase.prototype.isChangableEditMode=function(){return!!this.objBase&&this.objBase.isChangableEditMode()},teasp.Tsf.FormBase.prototype.setReadOnly=function(e){this.fp.setReadOnly(e);for(var t=0;t<this.sections.length;t++)this.sections[t].setReadOnly(e)},teasp.Tsf.FormBase.prototype.getDeptId=function(){return this.objBase&&this.objBase.getDeptId()||null},
teasp.Tsf.FormBase.prototype.getDept=function(){return this.objBase&&this.objBase.getDept()||null},teasp.Tsf.FormBase.prototype.destroy=function(){this.domHelper&&(this.domHelper.free(),teasp.Tsf.Dom.empty(this.parentId),teasp.Tsf.Dom.empty(this.getTailArea()),delete this.domHelper),this.domHelper=null},teasp.Tsf.FormBase.prototype.savePoint=function(){this.saveData=teasp.Tsf.util.toJson(this.getDomValues(!0))},
teasp.Tsf.FormBase.prototype.checkDiff=function(){var e=teasp.Tsf.util.toJson(this.getDomValues(!0));return this.saveData!=e},teasp.Tsf.FormBase.prototype.connect=function(e,t,s,a,o){this.domHelper.connect(e,t,s,a,o)},teasp.Tsf.FormBase.prototype.hide=function(){teasp.Tsf.Dom.show(this.fp.getAreaId(),teasp.Tsf.Dom.byId(teasp.Tsf.ROOT_AREA_ID),!1)},teasp.Tsf.FormBase.prototype.show=function(){var e=teasp.Tsf.Dom.byId(
teasp.Tsf.ROOT_AREA_ID);teasp.Tsf.Dom.show(this.fp.getAreaId(),e,!0)},teasp.Tsf.FormBase.prototype.refresh=function(e,t){this.objBase=e,this.objBase.setMode(t);var e=tsfManager.getArea(),t=(this.setReadOnly(this.isReadOnly()),this.init(),!this.objBase.getId()&&!this.objBase.isCreateFlag()&&tsfManager.getInfo().isHiddenApplyBtn()),t=(teasp.Tsf.Dom.query(".ts-apply-no",e).forEach(function(e){
e.innerHTML=this.objBase.getApplyNo()||teasp.message.getLabel("tf10001940")},this),teasp.Tsf.Dom.query(".ts-form-control .ts-form-status button",e).forEach(function(e){teasp.Tsf.Dom.empty(e),this.getDomHelper().create("div",{className:"png-"+this.objBase.getStatusInfo().icon},e),this.getDomHelper().create("div",{innerHTML:this.objBase.getStatusInfo().text},e)},this),this.objBase.isRemoved()&&this.getDomHelper(
).create("div",{innerHTML:teasp.message.getLabel("tf10007760"),className:"ts-form-removed"},dojo.byId("tsfFormArea").firstChild,"before"),this.loadJobs(this.objBase.getStartDate(),this.objBase.getEndDate()),this.checkImportJobs(this.objBase.getDataObj()),this.fp.fcLoop(function(e){e.drawText(this.getDomHelper(),this.objBase.getDataObj())},this),this.beforeRefreshSections(),dojo.forEach(this.sections,function(e){
e.refresh(),e.open(e.existValue())},this),teasp.Tsf.Dom.show(".ts-form-control .ts-form-status-label",null,!t),teasp.Tsf.Dom.show(".ts-form-control .ts-form-status",null,!t),t||(teasp.Tsf.Dom.setAttr2(".ts-form-control .ts-form-status button",e,"disabled",!this.objBase.getId()),this.getDomHelper().connect(teasp.Tsf.Dom.query(".ts-form-control .ts-form-status > button",e),"onclick",this,this.statusHistory)),
t?null:this.getApplyButtonLabel()),t=(teasp.Tsf.Dom.show(".ts-form-control .ts-form-delete",e,this.objBase.isDeletable()),teasp.Tsf.Dom.show(".ts-form-control .ts-form-copy",e,this.objBase.isCopyable()),teasp.Tsf.Dom.show(".ts-form-control .ts-form-save",e,this.objBase.isEditable(!0)),teasp.Tsf.Dom.show(".ts-form-control .ts-form-cancel",e,this.objBase.isEditable(!0)&&this.objBase.isManifestEditMode()),
teasp.Tsf.Dom.show(".ts-form-control .ts-apply-button",e,t),t&&(teasp.Tsf.Dom.query(".ts-form-control .ts-apply-button > button",e).forEach(function(e){e.innerHTML=this.getApplyButtonLabel()},this),this.domHelper.connect(teasp.Tsf.Dom.query(".ts-form-control .ts-apply-button > button",e),"onclick",this,this.submitApply)),teasp.Tsf.Dom.show(".ts-form-control .ts-approve-button",e,this.objBase.isPiwk()),
this.objBase.isPiwk()&&(t=teasp.Tsf.Dom.query(".ts-form-control .ts-approve-button > button",e),this.objBase.isCancelApplyWait()?(teasp.Tsf.Dom.html(".ts-approve-button > button",null,teasp.message.getLabel("tf10006250")),this.domHelper.connect(t,"onclick",this,this.approveCancelApply)):(teasp.Tsf.Dom.html(".ts-approve-button > button",null,teasp.message.getLabel("tf10000270")),this.domHelper.connect(t,"onclick",this
,this.approveApply))),teasp.Tsf.Dom.query(".ts-form-control .ts-apply-start > button",e)),t=(this.objBase.getId()||this.objBase.isCreateFlag()||!tsfManager.getInfo().isApplyByDetails()?teasp.Tsf.Dom.show(".ts-form-control .ts-apply-start",e,!1):(teasp.Tsf.Dom.html(".ts-apply-start > button",null,teasp.message.getLabel("tf10009570")),teasp.Tsf.Dom.show(".ts-form-control .ts-apply-start",e,!0),this.domHelper.connect(t,
"onclick",this,this.createExpApplyCheck)),teasp.Tsf.Dom.node(".ts-form-control .ts-form-print > button")),t=(t&&this.domHelper.connect(t,"onclick",this,function(){this.openPrintCheck()}),this.isChangableEditMode()),s=teasp.Tsf.Dom.node(".ts-form-control .ts-edit-button",e),t=(s&&(teasp.Tsf.Dom.show(s,null,t),t&&this.domHelper.connect(teasp.Tsf.Dom.query("button",s),"onclick",this,this.changeEditMode)),
teasp.Tsf.Dom.node(".ts-form-control .ts-form-copy > button",e)),s=(t&&this.getDomHelper().connect(t,"onclick",this,this.doCopy),teasp.Tsf.Dom.node(".ts-form-control .ts-form-histexp > button",e));s&&this.getDomHelper().connect(s,"onclick",this,function(){this.selectHistory()}),(s=teasp.Tsf.Dom.node(".ts-form-control .ts-form-csvup > button",e))&&this.getDomHelper().connect(s,"onclick",this,this.openCsvImport),
this.domHelper.connect(teasp.Tsf.Dom.query(".ts-form-control .ts-form-save > button",tsfManager.getArea()),"onclick",this,this.temporarySave),this.domHelper.connect(teasp.Tsf.Dom.query(".ts-form-control .ts-form-cancel > button",tsfManager.getArea()),"onclick",this,function(e){tsfManager.changeView(null,this.objBase.getId())}),this.show(),this.adjustTopMargin()},teasp.Tsf.FormBase.prototype.temporarySave=function(e){
tsfManager.saveExpPreApply(!this.objBase.getId(),teasp.Tsf.Dom.hitch(this,function(e,t){e?tsfManager.changeView(null,t):teasp.Tsf.Error.showError(t)}))},teasp.Tsf.FormBase.prototype.adjustTopMargin=function(){for(var e=teasp.Tsf.Dom.query("div.ts-section-bar2"),t=0;t<e.length;t++){var s=e[t];if(teasp.Tsf.Dom.isVisible(s)){div=teasp.Tsf.Dom.style(s,"margin-top","0px");break}}},
teasp.Tsf.FormBase.prototype.init=function(){this.domHelper=new teasp.Tsf.Dom,this.createBase(),teasp.Tsf.Dom.html(".ts-form-header .ts-form-title > div",null,this.fp.getTitle()),this.domHelper.connect(teasp.Tsf.Dom.query('.ts-section-check input[type="checkbox"]'),"onclick",this,function(e){var t=teasp.Tsf.Dom.getAncestorByCssName(e.target,"ts-section-bar2");this.toggleSection(t,e.target.checked)})},
teasp.Tsf.FormBase.prototype.createBase=function(){var e,i=this.getDomHelper().create("div",{id:this.fp.getAreaId()}),t=(this.sectionEmp=new teasp.Tsf.SectionEmp(this),teasp.Tsf.Dom.append(i,this.sectionEmp.createArea()),this.getSectionTitle()&&teasp.Tsf.Dom.append(i,teasp.Tsf.SectionBase.createSectionBar(this.getDomHelper(),this.getSectionTitle(),!1)),this.isUseExpFilter(!0)&&(
this.sectionExpFilter=new teasp.Tsf.SectionExpFilter(this),teasp.Tsf.Dom.append(i,this.sectionExpFilter.createArea())),this.getDomHelper().create("div",{className:"ts-main-form ts-section-form ts-zone-type1"},i)),s=null,a=(teasp.Tsf.SectionExpAssist.isUse(this.objBase)?(this.sectionExpAssist=new teasp.Tsf.SectionExpAssist(this),this.sectionExpAssist.setReadOnly(this.isReadOnly()),0==this.getFormStyle()?(
teasp.Tsf.Dom.append(i,this.sectionExpAssist.createArea()),s=t):(s=this.getDomHelper().create("div",{className:"ts-section-z1"},t),r=this.getDomHelper().create("div",{className:"ts-section-z2"},t),teasp.Tsf.Dom.append(r,this.sectionExpAssist.createArea()))):s=t,null),o=null,p=0,r=(this.fp.fcLoop(function(e){var t;e.isHidden()?this.getDomHelper().create("input",{type:"hidden",id:e.getDomId()},s):(o&&o.isNoNL()||(
a=this.getDomHelper().create("div",{className:"ts-form-row"},s)),t=this.getDomHelper().create("div",{className:"ts-form-label"},a),e.getTooltipMsgId()&&teasp.Tsf.Dom.addClass(t,"ts-tooltip"),e.getLw()&&teasp.Tsf.Dom.style(t,"width",e.getLw()),this.getDomHelper().create("div",{innerHTML:e.getLabel()},t),e.isRequired()&&this.getDomHelper().create("div",{className:"ts-require"},t),e.getTooltipMsgId()&&(
t=this.getDomHelper().create("div",{className:"pp_base pp_icon_help"},t),this.getDomHelper().createTooltip({connectId:t,label:teasp.message.getLabel(e.getTooltipMsgId()),position:["below"],showDelay:200})),e.appendFieldDiv(this.getDomHelper(),a),o=e,p++)},this),teasp.Tsf.Dom.show(t,null,0<p),this.createSections(i),teasp.Tsf.Dom.append(teasp.Tsf.Dom.byId(this.parentId),i),this.isReadOnly()&&teasp.Tsf.Dom.query(
'div.ts-section-bar2 .ts-section-check > input[type="checkbox"]').forEach(function(e){teasp.Tsf.Dom.show(e,null,!1)}),this.showTotalValue(),this.fillDeptField(i),this.setEventDateField(i),this.setEventTimeField(i),this.setEventCurrencyField(i),teasp.Tsf.Dom.setlimitChars(this.getDomHelper(),teasp.Tsf.Dom.query("textarea",i),this.fp),this.fp.getElementByApiKey("ChargeJobId__c",null,i)),t=(r&&((e=teasp.Tsf.Dom.node(
"button.ts-form-find",teasp.Tsf.Dom.getAncestorByCssName(r,"ts-form-row")))&&this.getDomHelper().connect(e,"onclick",this,function(e){var t=this.fp.getFcByApiKey("StartDate__c").fetchValue().value||teasp.util.date.formatDate(teasp.util.date.getToday()),s=this.getAssist(),s=s&&s.ChargeDeptId__c||this.objBase.getDeptId(!0);tsfManager.showSearchListDialog({discernment:"jobs",dialog:"JobList",delay:!0,values:{_date:[t],
DeptId__c:s,_jobAssignClass:tsfManager.getEmpJobSearchCondition()}},null,teasp.Tsf.Dom.hitch(this,function(e){var s={},a=e[0];this.setImportJobs(a),dojo.forEach([{n:"ChargeJobId__r.JobCode__c",v:"JobCode__c"},{n:"ChargeJobId__r.StartDate__c",v:"StartDate__c"},{n:"ChargeJobId__r.EndDate__c",v:"EndDate__c"},{n:"ChargeJobId__r.Active__c",v:"Active__c"},{n:"ChargeJobId__c",v:"Id",d:"Name"}],function(e){
var t=this.fp.getFcByApiKey(e.n);t.fillValue(s,{value:a[e.v],nameValue:e.d?a[e.d]:null}),t.drawText(this.getDomHelper(),s,null,i)},this)}))}),this.getDomHelper().connect(r,"onchange",this,this.changedJob)),this.fp.getElementByApiKey("AccountName__c",null,i));return t&&(e=teasp.Tsf.Dom.node("button.ts-form-find",teasp.Tsf.Dom.getAncestorByCssName(t,"ts-form-row")))&&this.getDomHelper().connect(e,"onclick",this,
function(e){tsfManager.showSearchListDialog({discernment:"accounts"},null,teasp.Tsf.Dom.hitch(this,function(e){var t=this.fp.getFcByApiKey("AccountName__c"),s=this.fp.getFcByApiKey("AccountId__c"),a={value:e[0].dispValue},e={value:e[0].value},o={};t.fillValue(o,a),s.fillValue(o,e),t.drawText(this.getDomHelper(),o,null,i),s.drawText(this.getDomHelper(),o,null,i)}))}),i},teasp.Tsf.FormBase.prototype.loadJobs=function(e
,t){var s,a,o,i,p,r=this.fp.getElementByApiKey("ChargeJobId__c",null,this.getArea());r&&"SELECT"==r.tagName&&(s=r.value,a=this.getJobChoices(),o=e||this.getStartDate(),i=t||this.getEndDate(),p={},teasp.Tsf.Dom.empty(r),this.getDomHelper().create("option",{value:"",innerHTML:""},r),dojo.forEach(a,function(e){var t=e.getId();!e.activeOnDate(o,i)&&t!=s||p[t]||(this.getDomHelper().create("option",{value:t,
innerHTML:e.getDisplayName()},r),p[t]=1)},this),p[s]&&(r.value=s))},teasp.Tsf.FormBase.prototype.getCurrentJob=function(){var e=this.fp.getElementByApiKey("ChargeJobId__c",null,this.getArea());if(e){var t=e.value||null;if(t)for(var s=this.getJobChoices(),a=0;a<s.length;a++)if(s[a].getId()==t)return s[a]}return null},teasp.Tsf.FormBase.prototype.getJobChoices=function(){var e=tsfManager.getEmpJobAssigns();
return this.impJobs?e.concat(this.impJobs):e},teasp.Tsf.FormBase.prototype.setImportJobs=function(e){for(var t=this.getJobChoices(),s=!1,a=0;a<t.length;a++)if(t[a].getId()==e.Id){s=!0;break}s||(this.impJobs=[new teasp.Tsf.Job(e)])},teasp.Tsf.FormBase.prototype.checkImportJobs=function(e){e.ChargeJobId__c&&e.ChargeJobId__r&&this.setImportJobs({Id:e.ChargeJobId__c,JobCode__c:e.ChargeJobId__r.JobCode__c||"",
Name:e.ChargeJobId__r.Name||"",IsAssigned__c:!1,JobAssignId:null,StartDate__c:e.ChargeJobId__r.StartDate__c||null,EndDate__c:e.ChargeJobId__r.EndDate__c||null,Active__c:void 0===e.ChargeJobId__r.Active__c||e.ChargeJobId__r.Active__c})},teasp.Tsf.FormBase.prototype.changedJob=function(e){var t=this.getCurrentJob(),s=this.fp.getElementByApiKey("ChargeJobId__c",null,this.getArea()),a=teasp.Tsf.Dom.nextSibling(s);
a&&"INPUT"==a.tagName&&(a.value=t&&t.getName()||""),(s=this.fp.getElementByApiKey("ChargeJobId__r.JobCode__c",null,this.getArea()))&&(s.value=t&&t.getCode()||""),(s=this.fp.getElementByApiKey("ChargeJobId__r.StartDate__c",null,this.getArea()))&&(s.value=t&&t.getStartDate()||""),(s=this.fp.getElementByApiKey("ChargeJobId__r.EndDate__c",null,this.getArea()))&&(s.value=t&&t.getEndDate()||"")},
teasp.Tsf.FormBase.prototype.getDomHelper=function(){return this.domHelper},teasp.Tsf.FormBase.prototype.getCurrentObjectId=function(){return this.objBase?this.objBase.getId():null},teasp.Tsf.FormBase.prototype.getCurrentObjectIdSet=function(){return{id:this.objBase?this.objBase.getId():null,cancelApplyId:this.objBase?this.objBase.getCancelApplyId():null,
isCancelApplyWait:!!this.objBase&&this.objBase.isCancelApplyWait()}},teasp.Tsf.FormBase.prototype.getStartDate=function(){return this.getDate("StartDate__c")},teasp.Tsf.FormBase.prototype.getEndDate=function(){return this.getDate("EndDate__c")},teasp.Tsf.FormBase.prototype.getDate=function(e){e=this.fp.getFcByApiKey(e),e=teasp.util.strToDate(e.fetchValue().value);return e.failed?null:e.datef},
teasp.Tsf.FormBase.prototype.getSectionTitle=function(e){return this.fp.getSectionTitle(e)},teasp.Tsf.FormBase.prototype.getStoreFrom=function(){return this.storeFrom||(this.storeFrom=teasp.Tsf.Dom.createStoreMemory(tsfManager.getStationFromHist())),this.storeFrom},teasp.Tsf.FormBase.prototype.getStoreTo=function(){return this.storeTo||(this.storeTo=teasp.Tsf.Dom.createStoreMemory(tsfManager.getStationToHist())),
this.storeTo},teasp.Tsf.FormBase.prototype.getSectionValues=function(e){return this.objBase?this.objBase.getSectionValues(e):[]},teasp.Tsf.FormBase.prototype.getSectionValuesByRowIndex=function(e,t){return this.objBase?this.objBase.getSectionValuesByRowIndex(e,t):[]},teasp.Tsf.FormBase.prototype.getSectionValuesByUniqKey=function(e,t){return this.objBase?this.objBase.getSectionValuesByUniqKey(e,t):null},
teasp.Tsf.FormBase.prototype.setSectionValuesByUniqKey=function(e,t,s){this.objBase&&this.objBase.setSectionValueByUniqKey(e,t,s)},teasp.Tsf.FormBase.prototype.deleteSectionValueByUniqKey=function(e,t){this.objBase&&this.objBase.deleteSectionValueByUniqKey(e,t)},teasp.Tsf.FormBase.prototype.getRemoveIdList=function(e){return this.objBase?this.objBase.getRemoveIdList(e):null},
teasp.Tsf.FormBase.prototype.toggleSection=function(e,t){e=this.getSectionVisible(e);e.area&&(t||void 0===t&&!e.visible?teasp.Tsf.Dom.show(e.area,null,!0):teasp.Tsf.Dom.show(e.area,null,!1))},teasp.Tsf.FormBase.prototype.getSectionVisible=function(e){var e=teasp.Tsf.Dom.hasClass(e,"ts-section-bar2")?e:e.parentNode,t=teasp.Tsf.Dom.nextSibling(e);return{bar:e,area:t,visible:t&&teasp.Tsf.Dom.hasClass(t,"ts-section-form"
)&&teasp.Tsf.Dom.isVisible(t)}},teasp.Tsf.FormBase.prototype.createSections=function(e){for(var t=0;t<this.sections.length;t++){var s=this.sections[t],a=s.getDock()?this.getTailArea():e;a&&teasp.Tsf.Dom.append(a,s.createArea())}},teasp.Tsf.FormBase.prototype.getSectionByDiscernment=function(e){for(var t=0;t<this.sections.length;t++)if(this.sections[t].getDiscernment()==e)return this.sections[t];return null},
teasp.Tsf.FormBase.prototype.showSection=function(e,t){e=this.getSectionByDiscernment(e);e&&e.show(t)},teasp.Tsf.FormBase.prototype.existSectionValue=function(e){e=this.getSectionByDiscernment(e);return!!e&&e.existValue()},teasp.Tsf.FormBase.prototype.fillDeptField=function(e){teasp.Tsf.Dom.query("div.ts-form-dept > select",e).forEach(function(e){var t=tsfManager.getDepts();teasp.Tsf.Dom.empty(e),this.getDomHelper(
).create("option",{value:"",innerHTML:""},e);for(var s=0;s<t.length;s++)this.getDomHelper().create("option",{value:t[s].getId()||"",innerHTML:t[s].getDisplayName()},e)},this)},teasp.Tsf.FormBase.prototype.setEventDateField=function(e){teasp.Tsf.Dom.query("button.ts-form-cal",e).forEach(function(e){var t=teasp.Tsf.Dom.node('input[type="text"]',e.parentNode.parentNode);t&&t.name&&tsfManager.eventOpenCalendar(
this.getDomHelper(),e,t,{tagName:t.name,isDisabledDate:function(e){return!1},selectedDate:dojo.hitch(this,this.selectedDate)})},this)},teasp.Tsf.FormBase.prototype.selectedDate=function(e,t){this.loadJobs()},teasp.Tsf.FormBase.prototype.changedCurrency=function(e){teasp.Tsf.Error.showError()},teasp.Tsf.FormBase.prototype.setEventTimeField=function(e){teasp.Tsf.Dom.query(".ts-form-time input",e).forEach(function(e){
teasp.Tsf.Time.eventInput(this.getDomHelper(),e)},this)},teasp.Tsf.FormBase.prototype.setEventCurrencyField=function(e){teasp.Tsf.Dom.query(".ts-form-currency input",e).forEach(function(e){teasp.Tsf.Currency.eventInput(this.getDomHelper(),e,teasp.Tsf.Dom.hitch(this,this.changedCurrency))},this)},teasp.Tsf.FormBase.prototype.submitApply=function(e){var t=this.objBase.getPayId();if(t)tsfManager.jumpExpApplyView(t
);else{t=this.objBase.isApproved();if(t||this.objBase.isInstant())this.generateExpFromPreApply(t);else{t=this.getDomValues(!1,1);if(0<t.ngList.length)teasp.Tsf.Error.showError(teasp.Tsf.Error.messageFromNgList(t.ngList));else if(0!=(t.misMatch&teasp.Tsf.EmpExp.MISMATCH_MASK))teasp.Tsf.Error.showError(teasp.message.getLabel("tf10006880",teasp.message.getLabel(tsfManager.isExpWorkflow()?"tf10006890":"tf10006900"))
);else{var s,a=t.misMatch&teasp.Tsf.EmpExp.EMPTY_MASK;if(0!=a)return s=[],a&teasp.Tsf.EmpExp.EMPTY_JOB&&s.push(teasp.message.getLabel("job_label")),a&teasp.Tsf.EmpExp.EMPTY_CHARGE_DEPT&&s.push(teasp.message.getLabel("tf10006000")),a&teasp.Tsf.EmpExp.EMPTY_ROUTE&&s.push(teasp.message.getLabel("tk10000616")),a&(teasp.Tsf.EmpExp.EMPTY_EXTRA1|teasp.Tsf.EmpExp.EMPTY_EXTRA2)&&s.push(teasp.message.getLabel("tk10000616")),
void teasp.Tsf.Error.showError(teasp.message.getLabel("tf10007120",s.join(teasp.message.getLabel("tm10001560"))));a=teasp.Tsf.util.parseInt(t.values[0].TotalAmount__c);a<0?teasp.tsAlert(teasp.message.getLabel("tm30001145",teasp.util.currency.addFigure(a),teasp.message.getLabel("cunit_jps"),teasp.util.currency.addFigure(teasp.constant.CU_TOTAL_LOWER_LIMIT),teasp.message.getLabel("cunit_jps"))):tsfManager.showDialog(
"ApplyCommentExpPre",{key:"submitApply",title:this.getApplyButtonLabel(),formCss:"ts-dialog-comment",buttons:[{key:"submitApply",label:this.getApplyButtonLabel()},{key:"cancel",label:teasp.message.getLabel("cancel_btn_title")}]},teasp.Tsf.Dom.hitch(this,function(e){tsfManager.changeView(null,e.id)}))}}}},teasp.Tsf.FormBase.prototype.generateExpFromPreApply=function(e){e?tsfManager.generateExpFromPreApply():0<(
e=this.getDomValues(!1,1)).ngList.length?teasp.Tsf.Error.showError(teasp.Tsf.Error.messageFromNgList(e.ngList)):!this.objBase.getId()||tsfManager.checkDiff()?tsfManager.saveExpPreApply(!0,teasp.Tsf.Dom.hitch(this,function(e,t){e?tsfManager.changeView(null,t,function(){setTimeout(function(){tsfManager.generateExpFromPreApply(!0)},100)}):teasp.Tsf.Error.showError(t)})):tsfManager.generateExpFromPreApply(!0)},
teasp.Tsf.FormBase.prototype.cancelApply=function(e,t){if(tsfManager.isUsingJsNaviSystem()&&tsfManager.getInfo().objects)for(var s=0;s<tsfManager.getInfo().objects.length;s++){var a=tsfManager.getInfo().objects[s];if(null!=a.obj.ExpJsNavi__r&&0<a.obj.ExpJsNavi__r.length)return void teasp.tsAlert(teasp.message.getLabel("jt12000150"))}var o=this.objBase.getCancelLabel(),i=this.objBase.getStatus(),p="承認済み"==i||"確定済み"==i
,i=p?teasp.message.getLabel("承認済み"==i?"tf10007740":"tf10007750"):"";tsfManager.showDialog("ApplyCommentCancel",{key:"cancelApply",title:o,formCss:"ts-dialog-comment",buttons:[{key:"cancelApply",label:o,css:"ts-cancel-apply"},{key:"cancel",label:teasp.message.getLabel("cancel_btn_title")}],solve:this.objBase.isSolve(),parentHide:t,noComment:p,warning:i},teasp.Tsf.Dom.hitch(this,function(e){tsfManager.changeView(null,e
)}))},teasp.Tsf.FormBase.prototype.approveApply=function(){tsfManager.showDialog("ApplyCommentApprove",{key:"approveApply",title:teasp.message.getLabel(this.objBase.isCancelApplyWait()?"tf10006250":"tf10000270"),formCss:"ts-dialog-comment",buttons:[{key:"approveApply",label:teasp.message.getLabel(this.objBase.isCancelApplyWait()?"tf10006260":"tm30004010")},{key:"rejectApply",label:teasp.message.getLabel(
this.objBase.isCancelApplyWait()?"tf10006270":"tm10003490"),css:"ts-cancel-apply"},{key:"cancel",label:teasp.message.getLabel("cancel_btn_title")}]},teasp.Tsf.Dom.hitch(this,function(e){tsfManager.changeView(null,e)}))},teasp.Tsf.FormBase.prototype.approveCancelApply=function(){tsfManager.showDialog("ApplyCommentApprove",{key:"approveApply",title:teasp.message.getLabel("tf10006250"),formCss:"ts-dialog-comment",
buttons:[{key:"approveApply",label:teasp.message.getLabel("tf10006260")},{key:"rejectApply",label:teasp.message.getLabel("tf10006270"),css:"ts-cancel-apply"},{key:"cancel",label:teasp.message.getLabel("cancel_btn_title")}]},teasp.Tsf.Dom.hitch(this,function(e){tsfManager.changeView(null,e)}))},teasp.Tsf.FormBase.prototype.statusHistory=function(e){var t=tsfManager.getCurrentObjectIdSet();
t.id&&tsfManager.showProcessInstanceSteps({id:t.id,cancelApplyId:t.cancelApplyId,cancelable:this.objBase.isCancelable(),cancelLabel:this.objBase.getCancelLabel(),expApply:this.objBase,cancelCallback:teasp.Tsf.Dom.hitch(this,this.cancelApply)})},teasp.Tsf.FormBase.prototype.openStandardView=function(e){var t=tsfManager.getCurrentObjectId();t&&(teasp.isSforce1()?sforce.one.navigateToURL("/"+t):window.open("/"+t))},
teasp.Tsf.FormBase.prototype.openCancelApplyStandardView=function(e){var t=tsfManager.getCurrentObjectIdSet();t.cancelApplyId&&(teasp.isSforce1()?sforce.one.navigateToURL("/"+t.cancelApplyId):window.open("/"+t.cancelApplyId))},teasp.Tsf.FormBase.prototype.getDomValues=function(a,o,i){var p={objectName:this.fp.getObjectName(),values:[],types:{},fixes:{}},s=this.objBase.getDataObj(),r=[],e=(this.fp.fcLoop(function(e){
var t;e.isApiField()&&(t=e.getApiKey(),s[t]=e.fetchValue().value,p.types[t]=e.getSObjType(),e.getFix()&&(p.fixes[t]=e.getFix()),e.checkValid(s[t],o,r))},this),this.objBase.getTypeName()==teasp.constant.EXP_PRE_FORM4?this.fp.getFcByApiKey("ApplyDate__c")&&s.ApplyDate__c&&(s.EndDate__c=s.StartDate__c=s.ApplyDate__c):(m=this.fp.getFcByApiKey("StartDate__c"),e=this.fp.getFcByApiKey("EndDate__c"),m&&e&&((
!s.EndDate__c&&s.StartDate__c||e.isHidden())&&(s.EndDate__c=s.StartDate__c),s.StartDate__c>s.EndDate__c?r.push({ngType:4,fc:e,message:teasp.message.getLabel("tf10001850",m.getLabel(),e.getLabel())}):s.StartDate__c==s.EndDate__c&&(m=s.DepartureTime__c,e=s.ReturnTime__c,"number"==typeof m&&"number"==typeof e&&e<m&&(e=this.fp.getFcByApiKey("DepartureTime__c"),m=this.fp.getFcByApiKey("ReturnTime__c"),r.push({ngType:4,
fc:m,message:teasp.message.getLabel("tf10001850",e.getLabel(),m.getLabel())}))))),this.getObjBase().addElement(s),this.getCurrentJob()),n=(e&&!e.activeOnDate(s.StartDate__c,s.EndDate__c)&&r.push({ngType:4,fc:this.fp.getFcByApiKey("ChargeJobId__c"),message:teasp.message.getLabel("tf10001820")}),p.values.push(s),this.getMisMatchFlag()),l=0;if(dojo.forEach(this.sections,function(e){var t=e.getDomValues(a,o);if(
e.isChild())p[e.getRelationshipName()]=t;else{for(var s=0;s<t.values.length;s++)teasp.Tsf.util.mixin(p.values[0],t.values[s]);teasp.Tsf.util.mixin(p.types,t.types)}r=r.concat(t.ngList||[]),n|=e.getMisMatchFlag(),i&&(l|=e.getMisMatchFlagCheckedOnly())},this),this.sectionExpAssist){for(var t=this.sectionExpAssist.getDomValues(a,o),c=0;c<t.values.length;c++)teasp.Tsf.util.mixin(p.values[0],t.values[c]);
teasp.Tsf.util.mixin(p.types,t.types),r=r.concat(t.ngList||[]),n|=this.sectionExpAssist.getMisMatchFlag()}var m=tsfManager.getExpCountLimit();return"AtkExpPreApply__c"==p.objectName&&this.objBase.getEmpExps().length>m&&r.push({ngType:4,fc:this.fp.getFcByApiKey("Id"),message:teasp.message.getLabel("tf10007700",this.objBase.getEmpExps().length+"/"+m)}),o&&(p.ngList=r,p.misMatch=n,p.misCheckOnly=l),p},
teasp.Tsf.FormBase.prototype.changeEditMode=function(){tsfManager.showForm(this.getObjBase(),null,"edit"==this.getObjBase().getMode()?"read":"edit")},teasp.Tsf.FormBase.prototype.canDiffView=function(){var e=this.getObjBase();return!!e&&e.canDiffView()},teasp.Tsf.FormBase.prototype.getApplyButtonLabel=function(){return this.objBase.getApplyButtonLabel()},teasp.Tsf.FormBase.prototype.setAttachmentExist=function(t,s){
dojo.forEach(this.sections,function(e){e.setAttachmentExist&&e.setAttachmentExist(t,s)},this)},teasp.Tsf.FormBase.prototype.getAssist=function(e){var t,s;return this.sectionExpAssist?((t=this.sectionExpAssist.getValues())&&!t.ExpenseType__c&&e&&(t.ExpenseType__c=e),t&&!t.ChargeJobId__c&&(s=this.getCurrentJob())&&(t.ChargeJobId__c=s.getId(),t.ChargeJobId__r=s.getObj()),t||null):(t={ChargeDeptId__r:{
ExpItemClass__c:tsfManager.getTargetEmp().getDeptExpItemClass()},ExpenseType__c:e||null},(s=this.getCurrentJob())&&(t.ChargeJobId__c=s.getId(),t.ChargeJobId__r=s.getObj()),t)},teasp.Tsf.FormBase.prototype.openPrintCheck=function(){!this.getCurrentObjectId()||tsfManager.checkDiff()?teasp.tsConfirm(teasp.message.getLabel("tf10006580"),this,function(e){e&&tsfManager.saveExpPreApply(!0,teasp.Tsf.Dom.hitch(this,function(e
,t){e?tsfManager.changeView(null,t,function(){tsfManager.openPrintView()}):teasp.Tsf.Error.showError(t)}))}):this.openPrintView()},teasp.Tsf.FormBase.prototype.openPrintView=function(){var e,t=screen.availHeight||800,s=(800<t&&(t=800),this.getCurrentObjectId()),s=teasp.getPageUrl("expPrintView")+"?target=ExpPreApply"+(s?"&id="+s:"")+"&mode=read";teasp.isSforce1()?sforce.one.navigateToURL(s):(e=window.open(s,
"preprint","width=800,height="+t+",resizable=yes,scrollbars=yes"),setTimeout(function(){e.resizeTo(810,t),e.focus()},100))},teasp.Tsf.FormBase.prototype.setAttachmentInfo=function(t){dojo.forEach(this.sections,function(e){e.setAttachmentInfo(t)},this)},teasp.Tsf.FormBase.prototype.importEmpExps=function(t,s){dojo.forEach(this.sections,function(e){e.importEmpExps(t,s)},this)},
teasp.Tsf.FormBase.prototype.showTotalValue=function(){teasp.Tsf.Dom.show("td.ts-total-label, td.ts-total-value",teasp.Tsf.Dom.byId(teasp.Tsf.ROOT_AREA_ID),4!=this.getFormStyle())},teasp.Tsf.FormBase.prototype.restoreCheck=function(t){dojo.forEach(this.sections,function(e){e.restoreCheck(t)},this)},teasp.Tsf.FormBase.prototype.moveStart=function(){var e=this.getSectionByDiscernment(
teasp.Tsf.formParams.sectionDetail.discernment);e&&e.moveStart()},teasp.Tsf.FormBase.prototype.selectHistory=function(){var e=this.getSectionByDiscernment(teasp.Tsf.formParams.sectionDetail.discernment);e&&e.selectHistory()},teasp.Tsf.FormBase.prototype.doCopy=function(){!this.getCurrentObjectId()||tsfManager.checkDiff()?teasp.tsConfirm(teasp.message.getLabel("tf10006840"),this,function(e){
e&&tsfManager.saveExpPreApply(!0,teasp.Tsf.Dom.hitch(this,function(e,t){e?tsfManager.changeView(null,t,teasp.Tsf.Dom.hitch(this,function(){tsfManager.copyExpApply()})):teasp.Tsf.Error.showError(t)}))}):tsfManager.copyExpApply()},teasp.Tsf.FormBase.prototype.changedAssist=function(){dojo.forEach(this.sections,function(e){e.refreshView()},this),this.changedCurrency()},
teasp.Tsf.FormBase.prototype.getMisMatchFlag=function(){return 0},teasp.Tsf.FormBase.prototype.isShowMisMatch=function(){return this.getObjBase().isShowMisMatch()},teasp.Tsf.FormBase.prototype.openCsvImport=function(){},teasp.Tsf.FormBase.prototype.getAssistParam=function(){return null},teasp.Tsf.FormBase.prototype.getToken=function(){return null},teasp.Tsf.FormBase.prototype.isUseExpFilter=function(e){return!1},
teasp.Tsf.FormBase.prototype.changedFilter=function(e){},teasp.Tsf.FormBase.prototype.beforeRefreshSections=function(){},teasp.Tsf.FormBase.prototype.jtbSynchro=function(){var e=this.getSectionByDiscernment(teasp.Tsf.formParams.sectionJtb.discernment);return e?e.jtbSynchro():null},teasp.Tsf.Form0=function(){this.fp=teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.form0),this.sections=[new teasp.Tsf.SectionDetail(this),
new teasp.Tsf.SectionExpAttach(this),new teasp.Tsf.SectionExpRingi(this)],this.filter=null},teasp.Tsf.Form0.prototype=new teasp.Tsf.FormBase,teasp.Tsf.Form0.prototype.createBase=function(){var e=teasp.Tsf.FormBase.prototype.createBase.call(this),t=(this.sectionExpHead=new teasp.Tsf.SectionExpHead(this),teasp.Tsf.Dom.node("div.ts-section-bar2",e));return dojo.forEach(this.sectionExpHead.createArea(),function(e){
teasp.Tsf.Dom.place(e,t,"before")}),e},teasp.Tsf.Form0.prototype.refresh=function(e,t){teasp.Tsf.FormBase.prototype.refresh.call(this,e,t),this.changedCurrency();const s=e.obj.EmpExp__r||[];s.filter(function(e){return null!=e.EmpExpHistories__r&&1<e.EmpExpHistories__r.length}).map(function(e){return new teasp.Tsf.Form0.prototype.EmpExpNode(e.Id)}).forEach(function(e){var t=e.detailColumnNode,s=dojo.create("div");
const a=dojo.create("a",{"data-expid":e.id,innerHTML:teasp.message.getLabel("ex00000200"),href:"javascript:void(0)"},s);a.onclick=function(e){tsfManager.openExpHistoryView(e.target.dataset.expid)},dojo.place(s,t,"before")});var a,o,i=this.getApplyNoList(),e=(i&&(teasp.Tsf.Dom.empty(i),this.objBase.isCreateFlag()&&this.getDomHelper().create("option",{innerHTML:teasp.message.getLabel("tf10006180"),value:""},i),
this.getDomHelper().create("option",{innerHTML:teasp.message.getLabel("tm10003560"),value:""},i),t=tsfManager.getExpApplyNoList(),a={applyNo:this.objBase.getApplyNo(),id:this.objBase.getId()},o=null,dojo.forEach(t,function(e){this.getDomHelper().create("option",{innerHTML:e.applyNo,value:e.id},i),a.id&&teasp.Tsf.util.equalId(e.id,a.id)&&(o=e)},this),!o&&a.id&&this.getDomHelper().create("option",{innerHTML:a.applyNo,
value:a.id},i),i.value=a.id||"",this.getDomHelper().connect(i,"onchange",this,this.selectApply)),this.getPrevButton()),t=this.getNextButton(),t=(e&&this.getDomHelper().connect(e,"onclick",this,this.prevApply),t&&this.getDomHelper().connect(t,"onclick",this,this.nextApply),this.domHelper.connect(teasp.Tsf.Dom.node(".ts-form-control .ts-apply-list > button"),"onclick",this,function(){tsfManager.showSearchListDialog({
discernment:"expApplyList"},{dataProcessingExt:teasp.Tsf.Dom.hitch(this,this.processApplyList)},teasp.Tsf.Dom.hitch(this,this.changeTo))}),this.changeApply(0,!0),tsfManager.isUseScannerStorage()&&(e=this.withCardExp(this.objBase),t=teasp.Tsf.Dom.node(".ts-form-control .ts-form-copy > button"),this.resetButtonDisable(t,e,"ex00000230")),tsfManager.isUseScannerStorage()&&teasp.constant.STATUS_FIX.contains(
this.objBase.getStatus()));if(t){e=teasp.Tsf.Dom.node(".ts-table-bottom");const l=teasp.Tsf.Dom.node("button.png-add",e),c=teasp.Tsf.Dom.node("button.png-del",e),m=teasp.Tsf.Dom.node("button.png-ido",e);l&&(l.setAttribute("disabled","disabled"),l.title=teasp.message.getLabel("ex00000220")),c&&(c.setAttribute("disabled","disabled"),c.title=teasp.message.getLabel("ex00000080")),m&&(m.setAttribute("disabled","disabled")
,m.title=teasp.message.getLabel("ex00000180"))}e=teasp.Tsf.Dom.node(".ts-form-control .ts-form-cardread > button"),e&&t?this.resetButtonDisable(e,!0,"ex00000220"):e&&!this.isReadOnly()&&this.domHelper.connect(e,"onclick",this,function(){var e=teasp.util.date.formatDate(teasp.util.date.getToday());tsfManager.showSearchListDialog({discernment:"cardStatement",values:{PaymentDate__c:[e]}},{expImport:teasp.Tsf.Dom.hitch(
this,this.openExpImport),dataProcessingExt:teasp.Tsf.Dom.hitch(this,this.processCardStatement),filts:[{filtVal:"PaymentDate__c >= "+e}],dialogTitle:teasp.message.getLabel("tf10001500")})}),e=teasp.Tsf.Dom.node(".ts-form-control .ts-form-histexp > button"),e&&t&&this.resetButtonDisable(e,!0,"ex00000220"),e=teasp.Tsf.Dom.node(".ts-form-control .ts-form-receipt > button"),e&&t?this.resetButtonDisable(e,!0,"ex00000220"
):e&&!this.isReadOnly()&&tsfManager.isUsingReceiptSystem()&&(this.domHelper.connect(e,"onclick",this,this.loadReceipt),teasp.Tsf.Dom.show(e,null,!this.isReadOnly())),e=teasp.Tsf.Dom.node(".ts-form-control .ts-form-pitexp > button"),e&&t?this.resetButtonDisable(e,!0,"ex00000220"):e&&!this.isReadOnly()&&this.domHelper.connect(e,"onclick",this,function(){tsfManager.showSearchListDialog({discernment:"externalExpense",
dialog:"ExternalExpense"},{extExpImport:teasp.Tsf.Dom.hitch(this,this.openExtExpImport),dataProcessingExt:teasp.Tsf.Dom.hitch(this,this.processExternalExpense),dialogTitle:teasp.message.getLabel("pit10001010")})}),e=teasp.Tsf.Dom.node(".ts-form-control .ts-form-jtb > button");if(e&&t)this.resetButtonDisable(e,!0,"ex00000220");else if(e&&!this.isReadOnly()&&tsfManager.isUsingJsNaviSystem()&&(this.domHelper.connect(e,
"onclick",this,this.loadJsNaviData),teasp.Tsf.Dom.show(e,null,!this.isReadOnly()),this.objBase.obj.JsNaviData&&this.objBase.obj.JsNaviData.message&&0<this.objBase.obj.JsNaviData.message.length)){for(var p="",r=0;r<this.objBase.obj.JsNaviData.message.length;r++)p+=teasp.message.getLabel(this.objBase.obj.JsNaviData.message[r])+"<br/>";teasp.Tsf.Error.showMessage(p)}var n=teasp.Tsf.Dom.node(
".ts-form-control .ts-form-csvup > button"),t=(n&&t&&this.resetButtonDisable(n,!0,"ex00000220"),e&&tsfManager.isUsingJsNaviSystem()&&this.objBase.obj.JsNaviData&&this.objBase.obj.JsNaviData.isPossibilityNewActualDataDelivered&&(this.objBase.isPiwk()?teasp.Tsf.Error.showMessage(teasp.message.getLabel("jt13000160")):teasp.Tsf.Error.showMessage(teasp.message.getLabel("jt13000170"))),this.showSection("expRingi",
this.getObjBase().getRingiApplyId()),teasp.Tsf.Dom.node("div.ts-section-bar2 div.ts-section-option",this.getArea()));t&&teasp.Tsf.Dom.show(t,null,this.getObjBase().getExpPreApplyId()),tsfManager.isOpenReceipt()&&setTimeout(teasp.Tsf.Dom.hitch(this,this.loadReceipt),500)},teasp.Tsf.Form0.prototype.temporarySave=function(e){tsfManager.saveExpApply(!(!this.objBase.isCreateFlag()||this.objBase.getId()),
teasp.Tsf.Dom.hitch(this,function(e,t){e?tsfManager.changeView(null,t.id):teasp.Tsf.Error.showError(t)}))},teasp.Tsf.Form0.prototype.openExpImport=function(e,t,s){if(e.records.length<=0)s(teasp.message.getLabel("tf10001760"));else{if(tsfManager.isUseScannerStorage()){var a=1;if(dojo.some(e.records,function(e){if("領収書"==e.RecordType.Name&&!e.Publisher__c)return s(teasp.message.getLabel("ex00000070")),!(a=0)}),!a
)return}var o=e.records[0].RecordType&&e.records[0].RecordType.Name||null,i=tsfManager.getDefaultChargeDept(),p=this.getAssist(this.getFilterExpenseType()),i={expItemClass:this.getObjBase().getEmpExpItemClass(),defaultDeptId:this.getObjBase().getDeptId(!0),values:{EmpId__c:this.getObjBase().getEmpId(),ChargeDeptId__c:i.ChargeDeptId__c,ChargeDeptId__r:i.ChargeDeptId__r},expApply:this.getObjBase(),recordType:o,
dialogTitle:e.dialogTitle||null,data:e,assist:p,expenseType:this.getFilterExpenseType()};p&&(p.ChargeDeptId__c&&(i.values.ChargeDeptId__c=p.ChargeDeptId__c,i.values.ChargeDeptId__r=p.ChargeDeptId__r),p.ChargeJobId__c&&(i.values.JobId__c=p.ChargeJobId__c,i.values.JobId__r=p.ChargeJobId__r),tsfManager.isDoNotCopyExtraItem()||(i.values.ExtraItem1__c=p.ExtraItem1__c,i.values.ExtraItem2__c=p.ExtraItem2__c)),
1==e.records.length&&(i.values.Detail__c=e.records[0].Note__c),console.log(i),tsfManager.showDialog("ExpImport",i,teasp.Tsf.Dom.hitch(this,function(){t(),this.sections[0].empty(!0),this.sections[0].refresh()}))}},teasp.Tsf.Form0.prototype.openExtExpImport=function(e,t,s){var a,o;e.records.length<=0?s(teasp.message.getLabel("tf10001760")):(a=[],dojo.forEach(e.records,function(e){a.contains(e.UsageType__c)||a.push(
e.UsageType__c)},this),1<a.length?s(teasp.message.getLabel("pit10001070")):(s=tsfManager.getDefaultChargeDept(),o=this.getAssist(this.getFilterExpenseType()),s={isExternalExpense:!0,expItemClass:this.getObjBase().getEmpExpItemClass(),defaultDeptId:this.getObjBase().getDeptId(!0),values:{EmpId__c:this.getObjBase().getEmpId(),ChargeDeptId__c:s.ChargeDeptId__c,ChargeDeptId__r:s.ChargeDeptId__r},expApply:this.getObjBase(
),dialogTitle:e.dialogTitle||null,data:e,assist:o,expenseType:this.getFilterExpenseType()},o&&(o.ChargeDeptId__c&&(s.values.ChargeDeptId__c=o.ChargeDeptId__c,s.values.ChargeDeptId__r=o.ChargeDeptId__r),o.ChargeJobId__c&&(s.values.JobId__c=o.ChargeJobId__c,s.values.JobId__r=o.ChargeJobId__r),tsfManager.isDoNotCopyExtraItem()||(s.values.ExtraItem1__c=o.ExtraItem1__c,s.values.ExtraItem2__c=o.ExtraItem2__c)),console.log(
s),tsfManager.showDialog("ExpImport",s,teasp.Tsf.Dom.hitch(this,function(){t(),this.sections[0].empty(!0),this.sections[0].refresh()}))))},teasp.Tsf.Form0.prototype.processApplyList=function(e){dojo.forEach(e,function(e){"申請取消"==e.StatusC__c&&(!e.EmpExp__r||e.EmpExp__r.length<=0)&&(e.noChoose=!0)},this)},teasp.Tsf.Form0.prototype.processCardStatement=function(e){var s=this.collectCardStatementId(),t=this.getAssist(
this.getFilterExpenseType()),a=t&&t.ExpenseType__c||null;dojo.forEach(e,function(e){var t;e.EmpExp__r&&0<e.EmpExp__r.length||s.contains(e.Id)?e.noChoose=!0:!(t=e.PayeeId__r&&e.PayeeId__r.ExpenseType__c||null)||a&&t.split(",").contains(a)||(e.noChoose=!0,e.noChoosePlus={className:"pp_ico_ban",title:teasp.message.getLabel("tf10006860")})},this)},teasp.Tsf.Form0.prototype.collectCardStatementId=function(){
var e=this.sections[0].getDomValues(),t=[];return dojo.forEach(e.values,function(e){e.CardStatementLineId__c&&t.push(e.CardStatementLineId__c)},this),t},teasp.Tsf.Form0.prototype.processExternalExpense=function(e){var t=this.collectExternalICExpenseId();dojo.forEach(e,function(e){(e.EmpExps__r&&0<e.EmpExps__r.length||t.contains(e.Id))&&(e.noChoose=!0)},this)},
teasp.Tsf.Form0.prototype.collectExternalICExpenseId=function(){var e=this.sections[0].getDomValues(),t=[];return dojo.forEach(e.values,function(e){e.ExternalICExpenseId__c&&t.push(e.ExternalICExpenseId__c)},this),t},teasp.Tsf.Form0.prototype.getApplyNoList=function(){return teasp.Tsf.Dom.node(".ts-form-control .ts-form-pulldown > select")},teasp.Tsf.Form0.prototype.getPrevButton=function(){return teasp.Tsf.Dom.node(
".ts-form-control .ts-form-prev > button")},teasp.Tsf.Form0.prototype.getNextButton=function(){return teasp.Tsf.Dom.node(".ts-form-control .ts-form-next > button")},teasp.Tsf.Form0.prototype.setPrevDisabled=function(e){var t=this.getPrevButton();teasp.Tsf.Dom.toggleClass(t,"disabled",e),t.disabled=e},teasp.Tsf.Form0.prototype.setNextDisabled=function(e){var t=this.getNextButton();teasp.Tsf.Dom.toggleClass(t,
"disabled",e),t.disabled=e},teasp.Tsf.Form0.prototype.changeApply=function(e,t){var s=this.getApplyNoList();if(!s)return null;var e=s.selectedIndex+(e||0),a=s.options.length-1;return this.setNextDisabled(!(e=a<(e=e<0?0:e)?a:e)),this.setPrevDisabled(e==a),s.options[e].value},teasp.Tsf.Form0.prototype.withCardExp=function(e){for(var t=e.getEmpExps(),s=0;s<=t.length-1;s++){var a=t[s];if(
a.CardStatementLineId__r&&a.CardStatementLineId__r.RecordType&&"カード明細"==a.CardStatementLineId__r.RecordType.Name)return!0}return!1},teasp.Tsf.Form0.prototype.resetButtonDisable=function(e,t,s){e&&(t?(e.setAttribute("disabled","disabled"),teasp.Tsf.Dom.toggleClass(e,"disabled",!0),e.setAttribute("title",teasp.message.getLabel(s))):(e.removeAttribute("disabled"),teasp.Tsf.Dom.toggleClass(e,"disabled",!1),
e.removeAttribute("title")))},teasp.Tsf.Form0.prototype.changeView=function(t){this.checkDiff()?teasp.tsConfirm(teasp.message.getLabel("tf10001610"),this,function(e){e?tsfManager.changeView(null,this.changeApply(t)):this.getApplyNoList().value=this.objBase.getId()||""}):tsfManager.changeView(null,this.changeApply(t))},teasp.Tsf.Form0.prototype.changeTo=function(e){var t=e[0];this.checkDiff()?teasp.tsConfirm(
teasp.message.getLabel("tf10001610"),this,function(e){e&&tsfManager.changeView(null,t.value)}):tsfManager.changeView(null,t.value)},teasp.Tsf.Form0.prototype.selectApply=function(e){this.changeView(0)},teasp.Tsf.Form0.prototype.prevApply=function(e){this.changeView(1)},teasp.Tsf.Form0.prototype.nextApply=function(e){this.changeView(-1)},teasp.Tsf.Form0.prototype.openPrintCheck=function(){this.objBase.isCreateFlag(
)&&!this.objBase.getId()||tsfManager.checkDiff()?teasp.tsConfirm(teasp.message.getLabel("tf10006580"),this,function(e){e&&tsfManager.saveExpApply(!0,teasp.Tsf.Dom.hitch(this,function(e,t){e?tsfManager.changeView(null,t.id,function(){tsfManager.restoreCheck(t.exps),tsfManager.openPrintView()}):teasp.Tsf.Error.showError(t)}))}):this.openPrintView()},teasp.Tsf.Form0.prototype.openPrintView=function(){var e,
t=screen.availHeight||800,s=(800<t&&(t=800),this.objBase.getId()),a=this.getFilterExpenseType(),s=teasp.getPageUrl("expPrintView")+"?target=ExpApply&empId="+tsfManager.getEmpId()+"&expApplyId="+(s||"")+"&mode=read"+(a?"&expenseType="+encodeURIComponent(a):"");teasp.isSforce1()?sforce.one.navigateToURL(s):(e=window.open(s,"print","width=800,height="+t+",resizable=yes,scrollbars=yes"),setTimeout(function(){e.resizeTo(
810,t),e.focus()},100))},teasp.Tsf.Form0.prototype.submitApply=function(e){if(0<(d=this.getDomValues(!1,1,!0)).ngList.length)teasp.Tsf.Error.showError(teasp.Tsf.Error.messageFromNgList(d.ngList));else{var t=(d=teasp.Tsf.util.clone(d)).values[0],s=(t.ExpApplyId__c=t.Id,t.exps=d.EmpExp__r&&d.EmpExp__r.values||[],t.Id||(t.removeExpIds=this.getObjBase().getRemoveExpIds(t.exps)),[]),a=[],o=[],i=0,p=[],r=[];if(
dojo.forEach(t.exps,function(e){s.push(e.Id||e._uniqKey),e.checked&&(o.push(e.Id||e._uniqKey),i+=teasp.Tsf.util.parseInt(e.Cost__c)||0,p.push(e.Date__c)),e.ExpItemId__c||r.push(e.ExpItemId__c),a.push(e.Date__c)}),s.length||t.Id||t.createFlag){var n=d.misMatch&(teasp.Tsf.EmpExp.MISMATCH_MASK|teasp.Tsf.EmpExp.EMPTY_MASK),l=d.misCheckOnly&(teasp.Tsf.EmpExp.MISMATCH_MASK|teasp.Tsf.EmpExp.EMPTY_MASK),
c=!o.length||t.Id||t.createFlag?n:l;if(0!=(c&teasp.Tsf.EmpExp.MISMATCH_MASK))teasp.Tsf.Error.showError(teasp.message.getLabel("tf10006880",teasp.message.getLabel(tsfManager.isExpWorkflow()?"tf10006890":"tf10006900")));else if(0<r.length)teasp.Tsf.Error.showError(teasp.message.getLabel("tf10007090",teasp.message.getLabel(tsfManager.isExpWorkflow()?"tf10006890":"tf10006900")));else{var m,d,
c=c&teasp.Tsf.EmpExp.EMPTY_MASK;if(0!=c)return m=[],c&teasp.Tsf.EmpExp.EMPTY_JOB&&m.push(teasp.message.getLabel("job_label")),c&teasp.Tsf.EmpExp.EMPTY_CHARGE_DEPT&&m.push(teasp.message.getLabel("tf10006000")),c&teasp.Tsf.EmpExp.EMPTY_ROUTE&&m.push(teasp.message.getLabel("route_head")),c&(teasp.Tsf.EmpExp.EMPTY_EXTRA1|teasp.Tsf.EmpExp.EMPTY_EXTRA2)&&m.push(teasp.message.getLabel("tk10000616")),
void teasp.Tsf.Error.showError(teasp.message.getLabel("tf10007120",m.join(teasp.message.getLabel("tm10001560"))));0!=(d.misMatch&teasp.Tsf.EmpExp.JTB_ACTUAL_OLD)?teasp.Tsf.Error.showError(teasp.message.getLabel("jt13000110")):(c=teasp.Tsf.Dom.byId("Form0TotalAmount").value,m=teasp.Tsf.util.parseInt(c),d=t.Id?m<0:i<=0&&m<=0&&(i<0||m<0),!tsfManager.isAllowMinusApply()&&d?teasp.tsAlert(teasp.message.getLabel(
"tm30001145",t.Id?teasp.util.currency.addFigure(m):teasp.message.getLabel("tk10001052"),t.Id?teasp.message.getLabel("cunit_jps"):"",teasp.util.currency.addFigure(teasp.constant.CU_TOTAL_LOWER_LIMIT),teasp.message.getLabel("cunit_jps"))):(c=this.checkDiff(),tsfManager.showDialog("ApplyCommentExp",{key:"submitApply",title:this.getApplyButtonLabel(),formCss:"ts-dialog-comment",buttons:[{key:"submitApply",
label:this.getApplyButtonLabel()},{key:"cancel",label:teasp.message.getLabel("cancel_btn_title")}],targetChoice:!t.Id&&!t.createFlag,allList:s,allDates:a,totalCost:m,checkedList:o,checkedTotalCost:i,checkedDates:p,objBase:this.getObjBase(),expApply:c?t:null,checkedOnly:o.length&&n&&!l},teasp.Tsf.Dom.hitch(this,function(e){tsfManager.changeView(null,e.id)}))))}}else teasp.Tsf.Error.showError(teasp.message.getLabel(
"tf10001650"))}},teasp.Tsf.Form0.prototype.createExpApplyCheck=function(){tsfManager.checkDiff()?teasp.tsConfirm(teasp.message.getLabel("tf10008880"),this,function(e){e&&tsfManager.saveExpApply(!0,teasp.Tsf.Dom.hitch(this,function(e,t){e?tsfManager.changeView(null,t.id,function(){tsfManager.restoreCheck(t.exps),tsfManager.startCreateExpApply()}):teasp.Tsf.Error.showError(t)}))}):this.createExpApply()},
teasp.Tsf.Form0.prototype.createExpApply=function(){var e,t=this.getDomValues(!1,2),s=(t=teasp.Tsf.util.clone(t)).values[0],a=(s.ExpApplyId__c=s.Id,s.exps=t.EmpExp__r&&t.EmpExp__r.values||[],[]),o=[],i=[],p=[],r=[],t=null;dojo.forEach(s.exps,function(e){a.push(e.Id||e._uniqKey),e.checked&&(i.push(e.Id||e._uniqKey),p.push(e.Date__c)),e.ExpItemId__c||r.push(e.ExpItemId__c),o.push(e.Date__c)}),
0<r.length?teasp.Tsf.Error.showError(teasp.message.getLabel("tf10007090",teasp.message.getLabel(tsfManager.isExpWorkflow()?"tf10006890":"tf10006900"))):(this.isUseExpFilter()&&(t=(e=this.getAssist(this.getFilterExpenseType()))&&e.ExpenseType__c||null),tsfManager.showDialog("ApplyCreateExp",{key:"createExpApply",title:teasp.message.getLabel("tf10009570"),formCss:"ts-dialog-comment",buttons:[{key:"createExpApply",
label:teasp.message.getLabel("ok_btn_title")},{key:"cancel",label:teasp.message.getLabel("cancel_btn_title")}],allList:a,allDates:o,checkedList:i,checkedDates:p,expenseType:t,expApply:s},teasp.Tsf.Dom.hitch(this,function(e){tsfManager.changeView(null,e.id)})))},teasp.Tsf.Form0.prototype.changedCurrency=function(e){var t=tsfManager.getArea(),s=this.getTotalAmount(!0);teasp.Tsf.Dom.html(".ts-payValue-value > div",t,
teasp.Tsf.Currency.formatMoney(s.payValue,teasp.Tsf.Currency.V_YEN,!1,!0)),teasp.Tsf.Dom.html(".ts-provis-value > div",t,teasp.Tsf.Currency.formatMoney(s.provis,teasp.Tsf.Currency.V_YEN,!1,!0)),teasp.Tsf.Dom.html(".ts-dueToPay-value > div",t,teasp.Tsf.Currency.formatMoney(s.duetopay,teasp.Tsf.Currency.V_YEN,!1,!0)),teasp.Tsf.Dom.html(".ts-credit-value > div",t,teasp.Tsf.Currency.formatMoney(s.credit,
teasp.Tsf.Currency.V_YEN,!1,!0)),teasp.Tsf.Dom.html(".ts-invoice-value > div",t,teasp.Tsf.Currency.formatMoney(s.invoice,teasp.Tsf.Currency.V_YEN,!1,!0)),teasp.Tsf.Dom.html("div#JsNaviActualAmount",t,0==s.jtb?"&nbsp;":teasp.Tsf.Currency.formatMoney(s.jtb,teasp.Tsf.Currency.V_YEN,!1,!0)),teasp.Tsf.Dom.byId("JsNaviActualAmount")&&(teasp.Tsf.Dom.byId("JsNaviActualAmount"
).style.backgroundColor=s.jtb>s.jtbPre?"#ffccff":null),teasp.Tsf.Dom.byId("Form0TotalAmount").value=""+s.total,teasp.Tsf.Dom.show("td.ts-provis-label",t,s.provis),teasp.Tsf.Dom.show("td.ts-provis-value",t,s.provis),teasp.Tsf.Dom.show("td.ts-dueToPay-label",t,s.duetopay),teasp.Tsf.Dom.show("td.ts-dueToPay-value",t,s.duetopay),teasp.Tsf.Dom.show("td.ts-credit-label",t,s.credit),teasp.Tsf.Dom.show("td.ts-credit-value",t
,s.credit),teasp.Tsf.Dom.show("td.ts-invoice-label",t,s.invoice),teasp.Tsf.Dom.show("td.ts-invoice-value",t,s.invoice),this.sectionExpFilter&&this.sectionExpFilter.resetExpenseTypes(),teasp.Tsf.FormBase.prototype.changedCurrency.call(this)},teasp.Tsf.Form0.prototype.getTotalAmount=function(e){for(var t=this.objBase.getDataObj(),s=this.getAssist(this.getFilterExpenseType()),s=(
s&&t.ProvisionalPaymentId__c!=s.ProvisionalPaymentId__c&&(t.ProvisionalPaymentId__c=s.ProvisionalPaymentId__c,t.ProvisionalPaymentId__r=s.ProvisionalPaymentId__c?s.ProvisionalPaymentId__r:null),t.ProvisionalPaymentAmount__c||0),t=(this.objBase.getId()&&!e||(s=(t.ProvisionalPaymentId__r&&teasp.Tsf.util.parseInt(t.ProvisionalPaymentId__r.ProvisionalPaymentAmount__c)||0)+(t.ExpPreApplyId__r&&teasp.Tsf.util.parseInt(
t.ExpPreApplyId__r.ProvisionalPaymentAmount__c)||0)),t.AmountDueToPay__c||0),a=t-s,o=0,i=0,p=this.objBase.expPreApply&&this.objBase.expPreApply.obj.PlannedAmount__c||0,r=0,n=teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.sectionDetail),l=this.objBase.getSectionValues(n.getDiscernment()),c=0,m=0,d=0;d<l.length;d++){var h,f=l[d];f._removed||(h=teasp.Tsf.util.parseInt(f.Cost__c)||0,
f.PayeeId__r?"2"==f.PayeeId__r.PayeeType__c?i+=h:"3"==f.PayeeId__r.PayeeType__c?o+=h:c+=h:c+=h,"JTB"==f.Item__c&&(r+=h),m+=h)}return{payValue:a=this.objBase.getId()&&!e?a:(t=c)-s,provis:s,duetopay:t,credit:o,invoice:i,jtbPre:p,jtb:r,total:m}},teasp.Tsf.Form0.prototype.injectTimeReportLink=function(e){var t,s,a,o,e=teasp.Tsf.Dom.node("td.ts-form-date a",e);e&&(t=this.getDomHelper().create("div",{
className:"pp_ico_trepo",style:{float:"left"}},e,"before"),this.getDomHelper().create("div",{style:{clear:"both"}},e,"after"),s=teasp.util.date.parseDate(e.innerHTML),t.title=teasp.message.getLabel("tf10004770",e.innerHTML),this.getDomHelper().connect(t,"onclick",this,(a=tsfManager.getEmpId(),o=teasp.util.date.formatDate(s,"yyyyMMdd"),function(e){teasp.locationHref(teasp.getPageUrl("timeReportView"
)+"?empId="+a+"&date="+o+(tsfManager.isReadMode()?"&mode=read":"")),e.preventDefault(),e.stopPropagation()})))},teasp.Tsf.Form0.prototype.loadReceipt=function(){tsfManager.actionReceipt({action:"load",empId:tsfManager.getEmpId(),notapi:!tsfManager.getInfo().isReceiptReaderConnect()},teasp.Tsf.Dom.hitch(this,function(e,t){e?tsfManager.showSearchListDialog({discernment:"receipts",values:{Status__c:["2"]},
dialog:"ReceiptList",statusNums:t.statusNums},{expImport:teasp.Tsf.Dom.hitch(this,this.openExpImport),dataProcessingExt:teasp.Tsf.Dom.hitch(this,this.processCardStatement),filts:[{filtVal:"Status__c = '2'"}],dialogTitle:teasp.message.getLabel("tf10004950")}):teasp.tsConfirm("エラー："+teasp.Tsf.Error.getMessage(t)+"\n\n続行するには OK をクリックしてください",this,function(e){e&&tsfManager.showSearchListDialog({discernment:"receipts",
values:{Status__c:["2"]},dialog:"ReceiptList",statusNums:t.statusNums},{expImport:teasp.Tsf.Dom.hitch(this,this.openExpImport),dataProcessingExt:teasp.Tsf.Dom.hitch(this,this.processCardStatement),filts:[{filtVal:"Status__c = '2'"}],dialogTitle:teasp.message.getLabel("tf10004950")})})}))},teasp.Tsf.Form0.prototype.doCopy=function(){!this.getCurrentObjectId()||tsfManager.checkDiff()?teasp.tsConfirm(
teasp.message.getLabel("tf10006840"),this,function(e){e&&tsfManager.saveExpApply(!0,teasp.Tsf.Dom.hitch(this,function(e,t){e?tsfManager.changeView(null,t.id,teasp.Tsf.Dom.hitch(this,function(){tsfManager.restoreCheck(t.exps),tsfManager.copyExpApply()})):teasp.Tsf.Error.showError(t)}))}):tsfManager.copyExpApply()},teasp.Tsf.Form0.prototype.openCsvImport=function(){var e,t;this.sections[0].getRowCount(
)>=tsfManager.getExpCountLimit()?teasp.tsAlert(teasp.message.getLabel("ci00000190",tsfManager.getExpCountLimit())):(e=new Date,this.csvImportToken=e.getTime()+"C"+Math.floor(100*Math.random()),(t=window.open(teasp.getPageUrl("csvUploadView"),"expCsvUpload","width=700,height=340,resizable=yes,scrollbars=yes"))&&(tsfManager.setCsvImportFlag(!0),setTimeout(function(){t.focus()},100),teasp.Tsf.Dom.setBusyPanel(!0,{
domHelper:this.getDomHelper(),method:function(){this.csvImportToken&&(this.csvImportToken=null,teasp.Tsf.Dom.setBusyPanel(!1),window.open("","expCsvUpload").close(),tsfManager.setCsvImportFlag(!1))},hkey:"csvImport",context:this,message:teasp.message.getLabel("ci00000160"),btnLabel:teasp.message.getLabel("ci00000170")})))},teasp.Tsf.Form0.prototype.getAssistParam=function(){return this.getAssist(
this.getFilterExpenseType())},teasp.Tsf.Form0.prototype.getToken=function(){var e=this.sections[0].getRowCount();return{csvImportToken:this.csvImportToken,rowCount:e}},teasp.Tsf.Form0.prototype.isUseExpFilter=function(e){return(!e||!this.getObjBase().isCreateFlag()&&!this.getObjBase().getId())&&!!tsfManager.getInfo().getExpPreApplyConfigs().expenseTypeFirst},teasp.Tsf.Form0.prototype.changedFilter=function(t){
this.filter=t,tsfManager.getInfo().setExpFilter(this.filter),this.getObjBase().filterEmpExp(this.filter),this.getObjBase().clearTrashs(teasp.Tsf.formParams.sectionDetail.discernment),dojo.forEach(this.sections,function(e){e.changedFilter(t),e.refreshView(!0)},this),this.changedCurrency(),this.savePoint()},teasp.Tsf.Form0.prototype.beforeRefreshSections=function(){var e;
this.filter=this.sectionExpFilter&&this.sectionExpFilter.getFilter()||null,this.filter&&(this.getObjBase().filterEmpExp(this.filter),(e=this.getSectionByDiscernment(teasp.Tsf.formParams.sectionDetail.discernment))&&e.changedFilter(this.filter))},teasp.Tsf.Form0.prototype.getFilterExpenseType=function(){return this.filter&&this.filter.expenseType},teasp.Tsf.Form0.prototype.getPullExpenseTypes=function(){
return this.getObjBase().getPullExpenseTypes()},teasp.Tsf.Form0.prototype.openJsNaviImport=function(e,t,s){var a,o;e.records.length<=0?s(teasp.message.getLabel("tf10001760")):(s=e.records[0].RecordType&&e.records[0].RecordType.Name||null,o=tsfManager.getDefaultChargeDept(),a=this.getAssist(),o={expItemClass:this.getObjBase().getEmpExpItemClass(),defaultDeptId:this.getObjBase().getDeptId(!0),values:{
EmpId__c:this.getObjBase().getEmpId(),ChargeDeptId__c:o.ChargeDeptId__c,ChargeDeptId__r:o.ChargeDeptId__r},expApply:this.getObjBase(),recordType:s,dialogTitle:e.dialogTitle||null,data:e,assist:a},a&&(a.ChargeDeptId__c&&(o.values.ChargeDeptId__c=a.ChargeDeptId__c,o.values.ChargeDeptId__r=a.ChargeDeptId__r),a.ChargeJobId__c&&(o.values.JobId__c=a.ChargeJobId__c,o.values.JobId__r=a.ChargeJobId__r),
o.values.ExtraItem1__c=a.ExtraItem1__c,o.values.ExtraItem2__c=a.ExtraItem2__c),console.log(o),tsfManager.showDialog("JsNaviImport",o,teasp.Tsf.Dom.hitch(this,function(){t(),this.sections[0].empty(!0),this.sections[0].refresh()})))},teasp.Tsf.Form0.prototype.processJsNaviStatement=function(e){console.log("records"),console.log(e);var t=this.collectJsNaviActualId();dojo.forEach(e,function(e){e.JsNaviActualId__c=e.Id,
e.startName__c=e.Data03__c,e.endName__c=e.Data04__c,e.Note__c=e.Data01__c||"",e.PayContent__c&&(e.Note__c+="("+e.PayContent__c+")"),e.Note__c&&(e.Note__c=e.Note__c.substr(0,255)),t.contains(e.Id)&&(e.noChoose=!0)},this)},teasp.Tsf.Form0.prototype.collectJsNaviActualId=function(){var e=this.sections[0].getDomValues(),t=[];return dojo.forEach(e.values,function(e){e.JsNaviActualId__c&&t.push(e.JsNaviActualId__c)},this),
t},teasp.Tsf.Form0.prototype.loadJsNaviData=function(){tsfManager.showSearchListDialog({discernment:"actualExpense",values:{}},{expImport:teasp.Tsf.Dom.hitch(this,this.openJsNaviImport),dataProcessingExt:teasp.Tsf.Dom.hitch(this,this.processJsNaviStatement),filts:[{}],dialogTitle:teasp.message.getLabel("jt13000010")})},teasp.Tsf.Form0.prototype.checkDiff=function(){var t=!1;return dojo.forEach(this.objBase.orgExpIds,
function(e){e||(t=!0)}),teasp.Tsf.FormBase.prototype.checkDiff.call(this)||t},teasp.Tsf.Form0.prototype.EmpExpNode=function(e){this.id=e,this.rowNode=dojo.query("input[value="+e+"]")[0].parentNode,this.rowSeq=dojo.query("input.ts-row-seq",this.rowNode)[0].value,this.detailColumnNode=dojo.byId("SectDetail"+this.rowSeq+"Detail")},teasp.Tsf.Form1=function(){this.fp=teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.form1),
this.sections=[new teasp.Tsf.SectionJtb(this),new teasp.Tsf.SectionAllowance(this),new teasp.Tsf.SectionCoupon(this),new teasp.Tsf.SectionTicket(this),new teasp.Tsf.SectionForeign(this),new teasp.Tsf.SectionProvisional(this),new teasp.Tsf.SectionDetail(this),new teasp.Tsf.SectionExpAttach(this)]},teasp.Tsf.Form1.prototype=new teasp.Tsf.FormBase,teasp.Tsf.Form1.prototype.getFormStyle=function(){return 1},
teasp.Tsf.Form1.prototype.init=function(){var e=this.objBase.getTypeName();if(this.dptArvFlagsOptional=tsfManager.getInfo().isDptArvFlagsOptional(e),this.useOverseaTravel=tsfManager.getInfo().isUseOverseaTravel(e),this.useOneDayTrip=tsfManager.getInfo().isUseOneDayTrip(e),this.useJtbSect=tsfManager.getInfo().isUseJtbSect(e)&&tsfManager.isUsingJsNaviSystem(),this.useAllowanceSect=tsfManager.getInfo(
).isUseAllowanceSect(e),this.useCouponTicketSect=tsfManager.getInfo().isUseCouponTicketSect(e),this.useTicketArrangeSect=tsfManager.getInfo().isUseTicketArrangeSect(e),this.useProvisionalSect=tsfManager.getInfo().isUseProvisionalSect(e),this.useFreeInputSect=tsfManager.getInfo().isUseFreeInputSect(e),this.dptArvFlagsOptional&&(e=this.fp.getFcByApiKey("DepartureType__c"),t=this.fp.getFcByApiKey("ReturnType__c"),
e&&e.setRequired(0),t&&t.setRequired(0)),!this.useOverseaTravel||!this.useOneDayTrip){for(var e=this.objBase.getDestinationType(),t=(this.useOverseaTravel||e!=teasp.Tsf.ExpPreApply.DESTINATION_TYPE_OVERSEA?this.useOneDayTrip||e!=teasp.Tsf.ExpPreApply.DESTINATION_TYPE_DAYTRIP||(this.useOneDayTrip=!0):this.useOverseaTravel=!0,this.useOverseaTravel||this.useOneDayTrip||this.objBase.setDestinationType(
teasp.Tsf.ExpPreApply.DESTINATION_TYPE_DOMESTIC),this.fp.getFcByApiKey("DestinationType__c")),s=t.getPickList(),a=s.length-1;0<=a;a--){var o=s[a];(!this.useOverseaTravel&&o.v==teasp.Tsf.ExpPreApply.DESTINATION_TYPE_OVERSEA||!this.useOneDayTrip&&o.v==teasp.Tsf.ExpPreApply.DESTINATION_TYPE_DAYTRIP)&&s.splice(a,1)}t.setPickList(s)}teasp.Tsf.FormBase.prototype.init.call(this),this.objBase.getProvisionalPaymentId()&&(
this.useProvisionalSect=!1),!this.useJtbSect&&this.existSectionValue("jtbDetail")&&(this.useJtbSect=!0),!this.useAllowanceSect&&this.existSectionValue("allowance")&&(this.useAllowanceSect=!0),!this.useCouponTicketSect&&this.existSectionValue("coupon")&&(this.useCouponTicketSect=!0),!this.useTicketArrangeSect&&this.existSectionValue("ticket")&&(this.useTicketArrangeSect=!0),
!this.useProvisionalSect&&this.existSectionValue("provisional")&&(this.useProvisionalSect=!0),!this.useFreeInputSect&&this.existSectionValue("detail")&&(this.useFreeInputSect=!0),this.showSection("jtbDetail",this.useJtbSect),this.showSection("allowance",this.useAllowanceSect),this.showSection("coupon",this.useCouponTicketSect),this.showSection("ticket",this.useTicketArrangeSect),this.showSection("provisional",
this.useProvisionalSect),this.showSection("detail",this.useFreeInputSect),this.showSection("foreign",!1);e=this.fp.getElementByApiKey("DestinationType__c",null,void 0);e&&this.getDomHelper().connect(e,"onchange",this,function(e){e.target.value==teasp.Tsf.ExpPreApply.DESTINATION_TYPE_OVERSEA?this.showSection("foreign",!0):this.showSection("foreign",!1)}),this.useAllowanceSect&&(t=teasp.Tsf.Dom.byId(this.fp.getAreaId()
),teasp.Tsf.Dom.query('input[name="form1StartDate"], input[name="form1EndDate"]',t).forEach(function(e){this.getDomHelper().connect(e,"onblur",this,function(e){this.selectedDate(e.target)})},this))},teasp.Tsf.Form1.prototype.refresh=function(e,t){teasp.Tsf.FormBase.prototype.refresh.call(this,e,t),teasp.Tsf.Dom.html(".ts-total-amount",null,this.objBase.getTotalAmount()||"&nbsp;"),
null==this.objBase.obj.PlannedAmount__c||0==this.objBase.obj.PlannedAmount__c?dojo.byId("plannedAmountInput").value="":dojo.byId("plannedAmountInput").value=teasp.Tsf.Currency.formatMoney(this.objBase.obj.PlannedAmount__c,teasp.Tsf.Currency.V_YEN,!1,!0),this.showSection("foreign",this.objBase.getDestinationType()==teasp.Tsf.ExpPreApply.DESTINATION_TYPE_OVERSEA),this.useAllowanceSect&&this.selectedDate()},
teasp.Tsf.Form1.prototype.createBase=function(){var e,t=teasp.Tsf.FormBase.prototype.createBase.call(this);return this.useJtbSect&&(e=teasp.Tsf.Dom.node("div.ts-zone-type1",t),this.getDomHelper().create("div",{className:"ts-jtb-zone"},e)),t},teasp.Tsf.Form1.prototype.changedCurrency=function(e){var t=this.getDomValues(),o=0;dojo.forEach(t.ExpPreApplyDay__r.values,function(e){var t,s=e.AllowanceItemId__c,
a=e.HotelItemId__c,s=s?tsfManager.getExpItemById(s):null,a=a?tsfManager.getExpItemById(a):null;s&&(t=s.getCost(e.Date__c),o+=t),a&&(t=a.getCost(e.Date__c),o+=t)}),dojo.forEach(t.EmpExp__r.values,function(e){o+=teasp.Tsf.util.parseInt(e.Cost__c)||0}),this.useJtbSect&&(t=teasp.Tsf.Dom.byId("Form1PlannedAmount").value.replace(/\\/g,"").split(",").join(""),o+=teasp.Tsf.util.parseInt(t)),teasp.Tsf.Dom.html(
".ts-total-amount",null,teasp.Tsf.Currency.formatMoney(o,teasp.Tsf.Currency.V_YEN,!1,!0)),teasp.Tsf.Dom.byId("Form1TotalAmount").value=""+o,teasp.Tsf.FormBase.prototype.changedCurrency.call(this)},teasp.Tsf.Form1.prototype.selectedDate=function(){var e=this.fp.getFcByApiKey("StartDate__c").fetchValue().value,t=this.fp.getFcByApiKey("EndDate__c").fetchValue().value,s=teasp.util.strToDate(e),a=teasp.util.strToDate(t),
e=s.failed?null:s.datef,t=a.failed?null:a.datef,s=(s.failed||this.fp.getFcByApiKey("StartDate__c").drawText(this.getDomHelper(),{StartDate__c:s.datef}),a.failed||this.fp.getFcByApiKey("EndDate__c").drawText(this.getDomHelper(),{EndDate__c:a.datef}),this.getSectionByDiscernment(teasp.Tsf.formParams.sectionAllowance.discernment));s&&s.rebuild({startDate:teasp.util.date.formatDate(e),endDate:teasp.util.date.formatDate(t
)}),teasp.Tsf.FormBase.prototype.selectedDate.call(this)},teasp.Tsf.Form1.prototype.rebuildExpPreApplyDay=function(e,t,s){return this.useAllowanceSect?this.objBase.rebuildExpPreApplyDay(e,t,s):[]},teasp.Tsf.Form1.prototype.checkDiff=function(){var e=teasp.Tsf.util.toJson(this.getDomValues(!0)),t=JSON.parse(this.saveData),e=JSON.parse(e);return delete t.ExpJsNavi__r,delete t.values[0].ExpJsNavi__r,
delete e.ExpJsNavi__r,delete e.values[0].ExpJsNavi__r,delete e.values[0].ssoMode,JSON.stringify(t)!=JSON.stringify(e)},teasp.Tsf.Form1.prototype.getDomValues=function(e,t,s){var a=this.fp.getElementByApiKey("PlannedAmount__c",null,this.getArea()),o=(a.value=dojo.byId("plannedAmountInput").value,this.getSectionByDiscernment(teasp.Tsf.formParams.sectionJtb.discernment)),o=(o&&!o.isOpen()&&(a.value=null),
teasp.Tsf.util.parseInt((a.value||"").replace(/\\/g,"").split(",").join(""))),a=0;return null!=dojo.byId("ActualAmount")&&(a=teasp.Tsf.util.parseInt(dojo.byId("ActualAmount").innerHTML.replace(/\\/g,"").split(",").join(""))),dojo.byId("tsfWarningArea").style.display=o<a?"":"none",teasp.Tsf.FormBase.prototype.getDomValues.call(this,e,t,s)},teasp.Tsf.Form2=function(){this.fp=teasp.Tsf.Fp.createFp(
teasp.Tsf.formParams.form2),this.sections=[new teasp.Tsf.SectionProvisional(this),new teasp.Tsf.SectionExpAttach(this)]},teasp.Tsf.Form2.prototype=new teasp.Tsf.FormBase,teasp.Tsf.Form2.prototype.getFormStyle=function(){return 2},teasp.Tsf.Form2.prototype.init=function(){var e=this.objBase.getTypeName();this.useProvisionalSect=tsfManager.getInfo().isUseProvisionalSect(e),teasp.Tsf.FormBase.prototype.init.call(this),
this.objBase.getProvisionalPaymentId()&&(this.useProvisionalSect=!1),!this.useProvisionalSect&&this.existSectionValue("provisional")&&(this.useProvisionalSect=!0),this.showSection("provisional",this.useProvisionalSect)},teasp.Tsf.Form2.prototype.refresh=function(e,t){teasp.Tsf.FormBase.prototype.refresh.call(this,e,t);e=this.fp.getElementByApiKey("SocialExpItemId__c",null,this.getArea()),this.getObjBase().getId(
)||e.value||!tsfManager.getSocialExpenseItemId()||(e.value=tsfManager.getSocialExpenseItemId()),this.isReadOnly()?(t=tsfManager.getExpItemById(this.getObjBase().getDataObj().SocialExpItemId__c),this.initShowNumberItem(),this.changedSocialExpItemOnReadOnly(t),this.willShowNumberIfItIsValidAndSet(t),this.willShowNumberIfItIsValidAndUnset(t)):this.getObjBase().getId()?(this.initShowNumberItem(),
this.changedSocialExpItem(e),this.willShowNumberIfItIsValidAndSet(this.getSocialExpItem(e)),this.willShowNumberIfItIsValidAndUnset(this.getSocialExpItem(e))):(this.initShowNumberItem(),this.changedSocialExpItem(e),this.rewriteParticipantsByTemplate(e),this.rewriteParticipantsNumber(e),this.rewritePlace(e)),this.changedNumber(),teasp.Tsf.Dom.html(".ts-total-amount",null,this.objBase.getTotalAmount()||"&nbsp;"),
t=teasp.Tsf.Dom.getAncestorByCssName(this.fp.getElementByApiKey("InternalParticipants__c",null,this.getArea()),"ts-form-row"),dojo.query("textarea",t).style("height","90px"),e=teasp.Tsf.Dom.getAncestorByCssName(this.fp.getElementByApiKey("ExternalParticipants__c",null,this.getArea()),"ts-form-row");dojo.query("textarea",e).style("height","90px")},teasp.Tsf.Form2.prototype.changedSocialExpItemOnReadOnly=function(e){
this.willShowParticipantsIfItIsSet(e),this.changedNumber(),this.showExpMatching()},teasp.Tsf.Form2.prototype.createBase=function(){var e=teasp.Tsf.FormBase.prototype.createBase.call(this),t=(this.loadSocialExpItem(),this.fp.getElementByApiKey("SocialExpItemId__c",null,e)),t=(this.getDomHelper().connect(t,"onchange",this,this.selectedSocialExpItem),this.fp.getElementByApiKey("StartDate__c",null,e)),t=(
this.getDomHelper().connect(t,"onblur",this,this.changedNumber),this.getDomHelper().connect(t,"onkeypress",this,this.pressedNumber),this.fp.getElementByApiKey("OurNumber__c",null,e)),s=this.fp.getElementByApiKey("TheirNumber__c",null,e),t=(this.getDomHelper().connect(t,"onblur",this,this.retreatOurNumber),this.getDomHelper().connect(s,"onblur",this,this.retreatTheirNumber),this.getDomHelper().connect(t,"onkeypress",
this,this.pressedOurNumber),this.getDomHelper().connect(s,"onkeypress",this,this.pressedTheirNumber),this.fp.getElementByApiKey("TotalAmount__c",null,e));return this.getDomHelper().connect(t,"onblur",this,this.changedNumber),this.getDomHelper().connect(t,"onblur",this,this.pressedNumber),this.createAmountPerParticipants(),e},teasp.Tsf.Form2.prototype.loadSocialExpItem=function(e){this.loadExpItemFilter();
var t=this.fp.getElementByApiKey("SocialExpItemId__c",null,e),s=t.value||"",a=null;teasp.Tsf.Dom.empty(t),this.getDomHelper().create("option",{value:"",innerHTML:""},t),dojo.forEach(tsfManager.getExpItems(this.expItemFilter),function(e){e.isSocial()&&(this.getDomHelper().create("option",{value:e.getId(),innerHTML:e.getName()},t),s==e.getId()&&(a=e.getId()))},this),a?t.value=a:s&&(e=tsfManager.getExpItemById(s))&&(
this.getDomHelper().create("option",{value:e.getId(),innerHTML:e.getName()},t),t.value=s)},teasp.Tsf.Form2.prototype.getPricePerTotalPart=function(){var e,t,s,a,o=this.getSocialExpItem(),o=(o&&(a=this.fp.getFcByApiKey("StartDate__c",null,this.getArea()).fetchValue().value,e=(a=(o=(s=(t=(e=o.isTaxFlag()?o.getTaxType():1,o.isAllowMinus()),tsfManager.getTaxRoundFlag()),o.getTaxRate(a)),!0),teasp.Tsf.ExpDetail.calcTax(
this.fp.getFcByApiKey("TotalAmount__c").fetchValue().value||0,0,0,0,e,o,a,s,t).withoutTax)),this.fp.getFcByApiKey("_totalNumber").fetchValue().value);return o&&e&&""!==o&&""!==e&&0!==o?teasp.message.getLabel("tf10011000")+teasp.message.getLabel("tm10001590")+teasp.Tsf.Currency.formatMoney(teasp.Tsf.Currency.roundSameAsSalesforce(e/o),teasp.Tsf.Currency.V_YEN,!1,!0):teasp.message.getLabel("tf10011000"
)+teasp.message.getLabel("tm10001590")+teasp.message.getLabel("cunit_text")+"-"},teasp.Tsf.Form2.prototype.selectedSocialExpItem=function(e){var t=this.fp.getElementByApiKey("SocialExpItemId__c",null,this.getArea());this.initShowNumberItem(),this.changedSocialExpItem(t),this.switchToZeroParticipantsNumberByInvalidSetting(t),this.rewriteParticipantsByTemplate(t),this.rewriteParticipantsNumber(t),this.rewritePlace(t),
this.clearParticipantsIfExpItemNull(),this.clearParticipantsNumberIfExpItemNull(),this.clearPlaceIfExpItemNull()},teasp.Tsf.Form2.prototype.changedSocialExpItem=function(e){teasp.Tsf.Error.showError();var t,s,e=e.value||null;e&&(t=tsfManager.getExpItemById(e),(e=this.fp.getElementByApiKey("TotalAmount__c",null,this.getArea()))&&t&&(t.getCost()&&(e.value=teasp.Tsf.Currency.formatMoney(t.getCost(),
teasp.Tsf.Currency.V_YEN,!1,!0),this.changedCurrency()),s=t.isFixAmount()&&t.getCost(),teasp.Tsf.Dom.setAttr(e,"readOnly",s),teasp.Tsf.Dom.toggleClass(e,"read-only",s))),this.willShowParticipantsIfItIsSet(t),this.changedNumber(),this.showExpMatching()},teasp.Tsf.Form2.prototype.createAmountPerParticipants=function(){var e=teasp.Tsf.Dom.getAncestorByCssName(this.fp.getElementByApiKey("TotalAmount__c",null,
this.getArea()),"ts-form-row"),e=this.getDomHelper().create("div",{innerHTML:this.getPricePerTotalPart(),id:"pricePerTotalPartDisp"},e,"last");teasp.Tsf.Dom.style(e,"padding-left","20px")},teasp.Tsf.Form2.prototype.changedNumber=function(e){this.recalcTotalNumber(e)},teasp.Tsf.Form2.prototype.retreatOurNumber=function(e){var t={OurNumber__c:this.treatNumber("OurNumber__c")};this.fp.getFcByApiKey("OurNumber__c"
).drawText(this.getDomHelper(),t),this.recalcTotalNumber(e)},teasp.Tsf.Form2.prototype.retreatTheirNumber=function(e){var t={TheirNumber__c:this.treatNumber("TheirNumber__c")};this.fp.getFcByApiKey("TheirNumber__c").drawText(this.getDomHelper(),t),this.recalcTotalNumber(e)},teasp.Tsf.Form2.prototype.recalcTotalNumber=function(e){var t=null,s=null,a=this.getSocialExpItem(),o=this.fp.getElementByApiKey("OurNumber__c",
null,this.getArea()),o=teasp.Tsf.Dom.getAncestorByCssName(o,"ts-form-row"),o=teasp.Tsf.Dom.isVisible(o,this.getArea(),!1),i=this.fp.getElementByApiKey("TheirNumber__c",null,this.getArea()),i=teasp.Tsf.Dom.getAncestorByCssName(i,"ts-form-row"),i=teasp.Tsf.Dom.isVisible(i,this.getArea(),!1),t=o?this.treatNumber("OurNumber__c"):null,s=i?this.treatNumber("TheirNumber__c"):null;this.fp.getFcByApiKey("_totalNumber"
).drawText(this.getDomHelper(),{_totalNumber:(null===t?"":t)+(null===s?"":s)}),this.recalcPricePerTotalPart(a)},teasp.Tsf.Form2.prototype.recalcPricePerTotalPart=function(e){e&&(e.isInternalParticipants()||e.isExternalParticipants())?teasp.Tsf.Dom.setAttr2("#pricePerTotalPartDisp",this.getArea(),"innerHTML",this.getPricePerTotalPart()):teasp.Tsf.Dom.setAttr2("#pricePerTotalPartDisp",this.getArea(),"innerHTML","")},
teasp.Tsf.Form2.prototype.treatNumber=function(e){var e=this.fp.getFcByApiKey(e).fetchValue().value,t=teasp.Tsf.util.parseInt(e);return 0<=e?t:null},teasp.Tsf.Form2.prototype.pressedNumber=function(e){""===e.keyChar&&13===e.keyCode&&(e.preventDefault(),e.stopPropagation(),this.changedNumber(e))},teasp.Tsf.Form2.prototype.pressedOurNumber=function(e){""===e.keyChar&&13===e.keyCode&&(e.preventDefault(),
e.stopPropagation(),this.retreatOurNumber(e))},teasp.Tsf.Form2.prototype.pressedTheirNumber=function(e){""===e.keyChar&&13===e.keyCode&&(e.preventDefault(),e.stopPropagation(),this.retreatTheirNumber(e))},teasp.Tsf.Form2.prototype.changedCurrency=function(e){var t=this.fp.getFcByApiKey("TotalAmount__c").fetchValue().value||0;teasp.Tsf.Dom.html(".ts-total-amount",null,teasp.Tsf.Currency.formatMoney(t,
teasp.Tsf.Currency.V_YEN,!1,!0)),teasp.Tsf.FormBase.prototype.changedCurrency.call(this)},teasp.Tsf.Form2.prototype.loadExpItemFilter=function(){var e=this.getAssist();this.expItemFilter={empExpItemClass:tsfManager.getTargetEmp().getExpItemClass(),deptExpItemClass:e&&e.ChargeDeptId__r&&e.ChargeDeptId__r.ExpItemClass__c||null,expenseType:e&&e.ExpenseType__c||null}},teasp.Tsf.Form2.prototype.getExpMatching=function(){
var e=this.fp.getFcByApiKey("SocialExpItemId__c").fetchValue().value||null,e=e?tsfManager.getExpItemById(e):null,t=0;return e&&(e.checkExpenseType(this.expItemFilter.expenseType)||(t=teasp.Tsf.EmpExp.MISMATCH_EXPENSE_TYPE),e.isSelectable(this.expItemFilter.empExpItemClass)||e.isSelectable(this.expItemFilter.deptExpItemClass)||(t|=teasp.Tsf.EmpExp.MISMATCH_EXPITEM_CLASS)),t},
teasp.Tsf.Form2.prototype.changedAssist=function(){this.loadSocialExpItem(this.getArea()),this.showExpMatching()},teasp.Tsf.Form2.prototype.showExpMatching=function(){var e,t,s;this.isShowMisMatch()&&(e=this.getExpMatching(),t=this.fp.getElementByApiKey("SocialExpItemId__c",null,this.getArea()),(t=teasp.Tsf.Dom.node("div.ts-form-label",teasp.Tsf.Dom.getAncestorByCssName(t,"ts-form-row")))&&((s=teasp.Tsf.Dom.node(
"div.ts-mismatch",t))&&teasp.Tsf.Dom.destroy(s),s=[],e&teasp.Tsf.EmpExp.MISMATCH_EXPENSE_TYPE&&s.push(teasp.message.getLabel("tf10006860")),e&teasp.Tsf.EmpExp.MISMATCH_EXPITEM_CLASS&&s.push(teasp.message.getLabel("tf10006870")),s.length&&this.getDomHelper().create("div",{className:"pp_ico_ng"},this.getDomHelper().create("div",{className:"ts-mismatch"},t)),t.title=s.length?s.join("\r\n"):""))},
teasp.Tsf.Form2.prototype.getMisMatchFlag=function(){return this.getExpMatching()},teasp.Tsf.Form2.prototype.getDomValues=function(e,t,s){this.fp.getFcByApiKey("OurNumber__c",null,this.getArea()).setRequired(0),this.fp.getFcByApiKey("TheirNumber__c",null,this.getArea()).setRequired(0);var a,o,i,e=teasp.Tsf.FormBase.prototype.getDomValues.call(this,e,t,s);return this.fp.getFcByApiKey("OurNumber__c",null,this.getArea()
).setRequired(1),this.fp.getFcByApiKey("TheirNumber__c",null,this.getArea()).setRequired(1),e&&e.ngList&&(s=(t=this.fp.getFcByApiKey("_totalNumber",null,this.getArea())).fetchValue().value,(a=this.getSocialExpItem())&&(a.isInternalParticipants()&&null!==(o=(i=this.fp.getFcByApiKey("OurNumber__c",null,this.getArea())).fetchValue().value)&&o<0&&e.ngList.push({ngType:4,fc:i,message:teasp.message.getLabel("tf10001852")})
,a.isExternalParticipants()&&null!==(i=(o=this.fp.getFcByApiKey("TheirNumber__c",null,this.getArea())).fetchValue().value)&&i<0&&e.ngList.push({ngType:4,fc:o,message:teasp.message.getLabel("tf10001852")}),!0===a.isInternalParticipants()&&!1===a.isExternalParticipants()?null!==s&&0===s&&e.ngList.push({ngType:4,fc:t,message:teasp.message.getLabel("tf10001854")}):!1===a.isInternalParticipants(
)&&!0===a.isExternalParticipants()?null!==s&&0===s&&e.ngList.push({ngType:4,fc:t,message:teasp.message.getLabel("tf10001855")}):!0===a.isInternalParticipants()&&!0===a.isExternalParticipants()&&null!==s&&0===s&&e.ngList.push({ngType:4,fc:t,message:teasp.message.getLabel("tf10001851")}))),e},teasp.Tsf.Form2.prototype.rewriteParticipantsByTemplate=function(e){var t,e=this.getSocialExpItem(e);e&&(
e.isInternalParticipants()?(t=e.expItem.InternalParticipantsTemplateText__c||"",this.fp.getFcByApiKey("InternalParticipants__c").drawText(this.getDomHelper(),{InternalParticipants__c:t})):this.fp.getFcByApiKey("InternalParticipants__c").drawText(this.getDomHelper(),{InternalParticipants__c:""}),e.isExternalParticipants()?(t=e.expItem.ExternalParticipantsTemplateText__c||"",this.fp.getFcByApiKey(
"ExternalParticipants__c").drawText(this.getDomHelper(),{ExternalParticipants__c:t})):this.fp.getFcByApiKey("ExternalParticipants__c").drawText(this.getDomHelper(),{ExternalParticipants__c:""}),(e.isInternalParticipants()||e.isExternalParticipants())&&this.changedNumber())},teasp.Tsf.Form2.prototype.clearParticipantsIfExpItemNull=function(){this.getSocialExpItem()||(this.fp.getFcByApiKey("InternalParticipants__c"
).drawText(this.getDomHelper(),{InternalParticipants__c:""}),this.fp.getFcByApiKey("ExternalParticipants__c").drawText(this.getDomHelper(),{ExternalParticipants__c:""}))},teasp.Tsf.Form2.prototype.rewritePlace=function(e){e=this.getSocialExpItem(e);e&&!e.isPlace()&&(this.fp.getFcByApiKey("PlaceName__c").drawText(this.getDomHelper(),{PlaceName__c:""}),this.fp.getFcByApiKey("PlaceAddress__c").drawText(
this.getDomHelper(),{PlaceAddress__c:""}))},teasp.Tsf.Form2.prototype.clearPlaceIfExpItemNull=function(){this.getSocialExpItem()||(this.fp.getFcByApiKey("PlaceName__c").drawText(this.getDomHelper(),{PlaceName__c:""}),this.fp.getFcByApiKey("PlaceAddress__c").drawText(this.getDomHelper(),{PlaceAddress__c:""}))},teasp.Tsf.Form2.prototype.switchToNullParticipantsNumber=function(){var e=this.getSocialExpItem();e&&(
e.isValidInternalParticipants()&&!e.isInternalParticipants()&&this.fp.getFcByApiKey("OurNumber__c").drawText(this.getDomHelper(),{OurNumber__c:""}),e.isValidExternalParticipants()&&!e.isExternalParticipants()&&this.fp.getFcByApiKey("TheirNumber__c").drawText(this.getDomHelper(),{TheirNumber__c:""}),this.changedNumber())},teasp.Tsf.Form2.prototype.switchToZeroParticipantsNumberByInvalidSetting=function(){
var e=this.getSocialExpItem();e&&(e.isValidInternalParticipants()||this.fp.getFcByApiKey("OurNumber__c").drawText(this.getDomHelper(),{OurNumber__c:0}),e.isValidExternalParticipants()||this.fp.getFcByApiKey("TheirNumber__c").drawText(this.getDomHelper(),{TheirNumber__c:0}),this.changedNumber())},teasp.Tsf.Form2.prototype.rewriteParticipantsNumber=function(){var e=this.getSocialExpItem();e&&(
e.isValidInternalParticipants()&&(e.isInternalParticipants()?this.fp.getFcByApiKey("OurNumber__c").drawText(this.getDomHelper(),{OurNumber__c:0}):this.fp.getFcByApiKey("OurNumber__c").drawText(this.getDomHelper(),{OurNumber__c:""})),e.isValidExternalParticipants()&&(e.isExternalParticipants()?this.fp.getFcByApiKey("TheirNumber__c").drawText(this.getDomHelper(),{TheirNumber__c:0}):this.fp.getFcByApiKey(
"TheirNumber__c").drawText(this.getDomHelper(),{TheirNumber__c:""})),this.changedNumber())},teasp.Tsf.Form2.prototype.clearParticipantsNumberIfExpItemNull=function(){this.getSocialExpItem()||(this.fp.getFcByApiKey("OurNumber__c").drawText(this.getDomHelper(),{OurNumber__c:""}),this.fp.getFcByApiKey("TheirNumber__c").drawText(this.getDomHelper(),{TheirNumber__c:""}),this.changedNumber())},
teasp.Tsf.Form2.prototype.getSocialExpItem=function(e){e=e?e.value||null:this.isReadOnly()?this.getObjBase().getDataObj().SocialExpItemId__c:this.fp.getElementByApiKey("SocialExpItemId__c",null,this.getArea()).value||null;return e&&tsfManager.getExpItemById(e)||null},teasp.Tsf.Form2.prototype.savePoint=function(){this.getObjBase().getId()&&this.combackNullNumber(),teasp.Tsf.FormBase.prototype.savePoint.call(this),
this.isReadOnly()||(this.getObjBase().getId(),this.clearParticipantsIfExpItemNull(),this.clearParticipantsNumberIfExpItemNull(),this.clearPlaceIfExpItemNull())},teasp.Tsf.Form2.prototype.willShowNumberIfItIsValidAndSet=function(e){var t,s=!1;e&&(e.isValidInternalParticipants()&&!e.isInternalParticipants()&&null!==(t=this.treatNumber("OurNumber__c"))&&1<=t&&(t=this.fp.getElementByApiKey("OurNumber__c",null,
this.getArea()),t=teasp.Tsf.Dom.getAncestorByCssName(t,"ts-form-row"),teasp.Tsf.Dom.show(t,this.getArea(),!0),s=!0),e.isValidExternalParticipants()&&!e.isExternalParticipants()&&null!==(t=this.treatNumber("TheirNumber__c"))&&1<=t&&(e=this.fp.getElementByApiKey("TheirNumber__c",null,this.getArea()),t=teasp.Tsf.Dom.getAncestorByCssName(e,"ts-form-row"),teasp.Tsf.Dom.show(t,this.getArea(),!0),s=!0)),s&&(
e=this.fp.getElementByApiKey("_totalNumber",null,this.getArea()),t=teasp.Tsf.Dom.getAncestorByCssName(e,"ts-form-row"),teasp.Tsf.Dom.show(t,this.getArea(),!0))},teasp.Tsf.Form2.prototype.willShowNumberIfItIsValidAndUnset=function(e){var t,s=!1;e&&(e.isValidInternalParticipants()||null!==(t=this.treatNumber("OurNumber__c"))&&1<=t&&(t=this.fp.getElementByApiKey("OurNumber__c",null,this.getArea()),
t=teasp.Tsf.Dom.getAncestorByCssName(t,"ts-form-row"),teasp.Tsf.Dom.show(t,this.getArea(),!0),s=!0),e.isValidExternalParticipants()||null!==(t=this.treatNumber("TheirNumber__c"))&&1<=t&&(e=this.fp.getElementByApiKey("TheirNumber__c",null,this.getArea()),t=teasp.Tsf.Dom.getAncestorByCssName(e,"ts-form-row"),teasp.Tsf.Dom.show(t,this.getArea(),!0),s=!0)),s&&(e=this.fp.getElementByApiKey("_totalNumber",null,
this.getArea()),t=teasp.Tsf.Dom.getAncestorByCssName(e,"ts-form-row"),teasp.Tsf.Dom.show(t,this.getArea(),!0))},teasp.Tsf.Form2.prototype.willShowParticipantsIfItIsSet=function(e){var t,s,a,o,i,p,r,n,l,c,m,d,h,f,g=!1;e&&(e.isValidInternalParticipants()&&(e.isInternalParticipants()?(t=this.fp.getElementByApiKey("InternalParticipants__c",null,this.getArea()),s=this.fp.getElementByApiKey("OurNumber__c",null,
this.getArea()),a=teasp.Tsf.Dom.getAncestorByCssName(t,"ts-form-row"),o=teasp.Tsf.Dom.getAncestorByCssName(s,"ts-form-row"),teasp.Tsf.Dom.show(a,this.getArea(),!0),teasp.Tsf.Dom.show(o,this.getArea(),!0),g=!0):(t=this.fp.getElementByApiKey("InternalParticipants__c",null,this.getArea()),s=this.fp.getElementByApiKey("OurNumber__c",null,this.getArea()),a=teasp.Tsf.Dom.getAncestorByCssName(t,"ts-form-row"),
o=teasp.Tsf.Dom.getAncestorByCssName(s,"ts-form-row"),teasp.Tsf.Dom.show(a,this.getArea(),!1),teasp.Tsf.Dom.show(o,this.getArea(),!1))),e.isValidExternalParticipants()&&(e.isExternalParticipants()?(i=this.fp.getElementByApiKey("ExternalParticipants__c",null,this.getArea()),p=this.fp.getElementByApiKey("TheirNumber__c",null,this.getArea()),r=teasp.Tsf.Dom.getAncestorByCssName(i,"ts-form-row"),
n=teasp.Tsf.Dom.getAncestorByCssName(p,"ts-form-row"),teasp.Tsf.Dom.show(r,this.getArea(),!0),teasp.Tsf.Dom.show(n,this.getArea(),!0),g=!0):(i=this.fp.getElementByApiKey("ExternalParticipants__c",null,this.getArea()),p=this.fp.getElementByApiKey("TheirNumber__c",null,this.getArea()),r=teasp.Tsf.Dom.getAncestorByCssName(i,"ts-form-row"),n=teasp.Tsf.Dom.getAncestorByCssName(p,"ts-form-row"),teasp.Tsf.Dom.show(r,
this.getArea(),!1),teasp.Tsf.Dom.show(n,this.getArea(),!1))),e.isPlace()?(l=this.fp.getElementByApiKey("PlaceName__c",null,this.getArea()),c=this.fp.getElementByApiKey("PlaceAddress__c",null,this.getArea()),m=teasp.Tsf.Dom.getAncestorByCssName(l,"ts-form-row"),d=teasp.Tsf.Dom.getAncestorByCssName(c,"ts-form-row"),teasp.Tsf.Dom.show(m,this.getArea(),!0),teasp.Tsf.Dom.show(d,this.getArea(),!0)):(
l=this.fp.getElementByApiKey("PlaceName__c",null,this.getArea()),c=this.fp.getElementByApiKey("PlaceAddress__c",null,this.getArea()),m=teasp.Tsf.Dom.getAncestorByCssName(l,"ts-form-row"),d=teasp.Tsf.Dom.getAncestorByCssName(c,"ts-form-row"),teasp.Tsf.Dom.show(m,this.getArea(),!1),teasp.Tsf.Dom.show(d,this.getArea(),!1))),g?(h=this.fp.getElementByApiKey("_totalNumber",null,this.getArea()),
f=teasp.Tsf.Dom.getAncestorByCssName(h,"ts-form-row"),teasp.Tsf.Dom.show(f,this.getArea(),!0)):(h=this.fp.getElementByApiKey("_totalNumber",null,this.getArea()),f=teasp.Tsf.Dom.getAncestorByCssName(h,"ts-form-row"),teasp.Tsf.Dom.show(f,this.getArea(),!1)),this.willShowPricePerTotalPartIfItIsSet(e)},teasp.Tsf.Form2.prototype.willShowPricePerTotalPartIfItIsSet=function(e){e&&(e.isInternalParticipants(
)||e.isExternalParticipants())?teasp.Tsf.Dom.show("#pricePerTotalPartDisp",this.getArea(),!0):teasp.Tsf.Dom.show("#pricePerTotalPartDisp",this.getArea(),!1)},teasp.Tsf.Form2.prototype.initShowNumberItem=function(){var e=this.fp.getElementByApiKey("ExternalParticipants__c",null,this.getArea()),t=this.fp.getElementByApiKey("TheirNumber__c",null,this.getArea()),e=teasp.Tsf.Dom.getAncestorByCssName(e,"ts-form-row"),
t=teasp.Tsf.Dom.getAncestorByCssName(t,"ts-form-row"),e=(teasp.Tsf.Dom.show(e,this.getArea(),!1),teasp.Tsf.Dom.show(t,this.getArea(),!1),this.fp.getElementByApiKey("InternalParticipants__c",null,this.getArea())),t=this.fp.getElementByApiKey("OurNumber__c",null,this.getArea()),e=teasp.Tsf.Dom.getAncestorByCssName(e,"ts-form-row"),t=teasp.Tsf.Dom.getAncestorByCssName(t,"ts-form-row"),e=(teasp.Tsf.Dom.show(e,
this.getArea(),!1),teasp.Tsf.Dom.show(t,this.getArea(),!1),this.fp.getElementByApiKey("PlaceName__c",null,this.getArea())),t=this.fp.getElementByApiKey("PlaceAddress__c",null,this.getArea()),e=teasp.Tsf.Dom.getAncestorByCssName(e,"ts-form-row"),t=teasp.Tsf.Dom.getAncestorByCssName(t,"ts-form-row"),e=(teasp.Tsf.Dom.show(e,this.getArea(),!1),teasp.Tsf.Dom.show(t,this.getArea(),!1),this.fp.getElementByApiKey(
"_totalNumber",null,this.getArea())),t=teasp.Tsf.Dom.getAncestorByCssName(e,"ts-form-row");teasp.Tsf.Dom.show(t,this.getArea(),!1)},teasp.Tsf.Form2.prototype.combackNullNumber=function(){var e=this.fp.getFcByApiKey("OurNumber__c").parseSimple(this.getObjBase().getDataObj()),t=this.fp.getFcByApiKey("TheirNumber__c").parseSimple(this.getObjBase().getDataObj());null===e.value&&this.fp.getFcByApiKey("OurNumber__c"
).drawText(this.getDomHelper(),{OurNumber__c:""}),null===t.value&&this.fp.getFcByApiKey("TheirNumber__c").drawText(this.getDomHelper(),{TheirNumber__c:""})},teasp.Tsf.Form3=function(){this.fp=teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.form3),this.sections=[new teasp.Tsf.SectionProvisional(this),new teasp.Tsf.SectionDetail(this),new teasp.Tsf.SectionExpAttach(this)]},teasp.Tsf.Form3.prototype=new teasp.Tsf.FormBase,
teasp.Tsf.Form3.prototype.getFormStyle=function(){return 3},teasp.Tsf.Form3.prototype.init=function(){var e=this.objBase.getTypeName();this.useProvisionalSect=tsfManager.getInfo().isUseProvisionalSect(e),teasp.Tsf.FormBase.prototype.init.call(this),this.objBase.getProvisionalPaymentId()&&(this.useProvisionalSect=!1),!this.useProvisionalSect&&this.existSectionValue("provisional")&&(this.useProvisionalSect=!0),
this.showSection("provisional",this.useProvisionalSect)},teasp.Tsf.Form3.prototype.refresh=function(e,t){teasp.Tsf.FormBase.prototype.refresh.call(this,e,t),teasp.Tsf.Dom.html(".ts-total-amount",null,this.objBase.getTotalAmount()||"&nbsp;")},teasp.Tsf.Form3.prototype.changedCurrency=function(e){var t=this.getDomValues(),s=0;dojo.forEach(t.EmpExp__r.values,function(e){s+=teasp.Tsf.util.parseInt(e.Cost__c)||0}),
teasp.Tsf.Dom.html(".ts-total-amount",null,teasp.Tsf.Currency.formatMoney(s,teasp.Tsf.Currency.V_YEN,!1,!0)),teasp.Tsf.Dom.byId("Form3TotalAmount").value=""+s,teasp.Tsf.FormBase.prototype.changedCurrency.call(this)},teasp.Tsf.Form4=function(){this.fp=teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.form4),this.sections=[new teasp.Tsf.SectionProvisional(this,!1,teasp.Tsf.SectionProvisional.TYPE1),
new teasp.Tsf.SectionExpAttach(this)]},teasp.Tsf.Form4.prototype=new teasp.Tsf.FormBase,teasp.Tsf.Form4.prototype.getFormStyle=function(){return 4},teasp.Tsf.FormT=function(e){this.fp=teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.formT),this.sections=[],this.targetDate=e},teasp.Tsf.FormT.prototype=new teasp.Tsf.FormBase,teasp.Tsf.FormT.prototype.createBase=function(){for(var e=this.getDomHelper().create("div",{
id:this.fp.getAreaId()}),t=this.objBase.getSectionDetailCount(),s=0;s<t;s++){var a=new teasp.Tsf.SectionDetail(this,"_sect"+(s+1));a.setReadOnly(this.isReadOnly()||0<s),this.sections.push(a)}return this.createSections(e),teasp.Tsf.Dom.append(teasp.Tsf.Dom.byId(this.parentId),e),teasp.Tsf.Dom.query("table.ts-section-content",e).forEach(function(e){teasp.Tsf.Dom.style(e,"width","100%")},this),e},
teasp.Tsf.FormT.prototype.refresh=function(e,t){this.objBase=e,this.objBase.setMode(t),this.setReadOnly(this.isReadOnly()),this.init();var s=this.objBase.getSectionDetailObjs(),a=0;dojo.forEach(this.sections,function(e){var t=s[a++];t.targetDate=this.targetDate,e.refresh(t)},this)},teasp.Tsf.FormExpAttach=function(e,t,s){this.parent=e,this.fp=t,this.domHelper=s,this.IMAGE_EVENT_KEY="expAttach"},
teasp.Tsf.FormExpAttach.prototype.getDomHelper=function(){return this.domHelper},teasp.Tsf.FormExpAttach.prototype.isReadOnly=function(){return this.parent.isReadOnly()},teasp.Tsf.FormExpAttach.prototype.createTr=function(e){var e=this.getDomHelper().create("tr",null,e),t=(this.getDomHelper().create("td",{className:"attach-table"},e),this.angle=null,this.zoom=100,this.ZOOM_K=10,teasp.Tsf.Dom.node(
"#attachExpCtrl .pb_btn_rotate_left")),s=teasp.Tsf.Dom.node("#attachExpCtrl .pb_btn_rotate_right"),a=teasp.Tsf.Dom.node("#attachExpCtrl .pb_btn_zoom_out"),o=teasp.Tsf.Dom.node("#attachExpCtrl .pb_btn_zoom_in");return this.getDomHelper().connect(t,"onclick",this,function(){this.controlImage("L")}),this.getDomHelper().connect(s,"onclick",this,function(){this.controlImage("R")}),this.getDomHelper().connect(a,"onclick",
this,function(){this.controlImage("Zo")}),this.getDomHelper().connect(o,"onclick",this,function(){this.controlImage("Zi")}),t.title=teasp.message.getLabel("roleLeft_btn_title"),s.title=teasp.message.getLabel("roleRight_btn_title"),a.title=teasp.message.getLabel("zoomIn_btn_title"),o.title=teasp.message.getLabel("zoomOut_btn_title"),e},teasp.Tsf.FormExpAttach.prototype.refreshAttach=function(e){this.objBase=e;for(
var e=teasp.Tsf.Dom.node(".attach-table",teasp.Tsf.Dom.byId("tsfArea")),t=(this.getDomHelper().create("div",{innerHTML:this.getAttachTitle(this.objBase)},e),this.getDomHelper().create("tbody",null,this.getDomHelper().create("table",null,e))),s=this.objBase.getAttachments(),a=tsfManager.getArgAttachId(),o=null,i=0;i<s.length;i++){var p=s[i],r=this.getDomHelper().create("tr",null,t),n=this.getDomHelper().create("td",{
className:"attach-name"},r),l=this.getDomHelper().create("label",null,n),c=this.getDomHelper().create("input",{type:"radio",name:"attachSelect"},l);p.Id==a&&(c.checked=!0,o=p),this.getDomHelper().connect(c,"onclick",this,this.showAttach(p)),this.getDomHelper().create("span",{innerHTML:" "+p.Name},l),n=this.getDomHelper().create("td",null,r),this.isReadOnly()||(c=this.getDomHelper().create("a",{
innerHTML:teasp.message.getLabel("tf10006390")},n),this.getDomHelper().connect(c,"onclick",this,this.deleteAttach(p)))}o&&this.showAttach(o).apply(this),this.deletedAttachs=[],this.isReadOnly()?teasp.Tsf.Dom.show(teasp.Tsf.Dom.byId("attachToggle"),null,!1):this.sendToOpener()},teasp.Tsf.FormExpAttach.prototype.getAttachTitle=function(e){e="AtkExpApply__c"==this.fp.getObjectName()?teasp.message.getLabel(
"image_files_expenses",e.getApplyNo()):teasp.message.getLabel("image_files",e.getApplyNo());return e},teasp.Tsf.FormExpAttach.prototype.sendToOpener=function(){var e=window.opener;null!=e&&e.tsfManager.appliedAttach({id:this.objBase.getId(),attachs:this.objBase.getAttachments(),deleted:this.deletedAttachs})},teasp.Tsf.FormExpAttach.prototype.clearAttach=function(){var e=teasp.Tsf.Dom.byId("attachExpView");
return this.getDomHelper().freeBy(this.IMAGE_EVENT_KEY),teasp.Tsf.Dom.empty(e),this.imageDisped=!1,e},teasp.Tsf.FormExpAttach.prototype.resetAttach=function(){this.clearAttach(),teasp.Tsf.Dom.show(teasp.Tsf.Dom.byId("attachExpCtrl"),null,!1),teasp.Tsf.Dom.show(teasp.Tsf.Dom.byId("attachExpView"),null,!1)},teasp.Tsf.FormExpAttach.prototype.showAttach=function(a){return function(e){cancelAttach();var t,
s=this.clearAttach();/^image/i.test(a.ContentType)?(teasp.Tsf.Dom.show(teasp.Tsf.Dom.byId("attachExpCtrl"),null,!0),teasp.Tsf.Dom.show(teasp.Tsf.Dom.byId("attachExpView"),null,!0),t=this.getDomHelper().create("img",{src:"/servlet/servlet.FileDownload?file="+a.Id},this.getDomHelper().create("div",{className:"image-area"},s)),this.getDomHelper().connect(t,"onload",this,this.onLoadImage,this.IMAGE_EVENT_KEY),
teasp.Tsf.MainExpPrint.resize()):(teasp.Tsf.Dom.show(teasp.Tsf.Dom.byId("attachExpCtrl"),null,!1),teasp.Tsf.Dom.show(teasp.Tsf.Dom.byId("attachExpView"),null,!0),this.getDomHelper().create("a",{href:"/servlet/servlet.FileDownload?file="+a.Id,innerHTML:a.Name,target:"_blank"},this.getDomHelper().create("div",{className:"no-image-area"},s)))}},teasp.Tsf.FormExpAttach.prototype.deleteAttach=function(a){return function(e
){var s=teasp.Tsf.Dom.getAncestorByTagName(e.target,"TR");teasp.tsConfirm(teasp.message.getLabel("tf10006380",a.Name),this,function(e){e&&(e={method:"deleteAttach",attachmentId:a.Id},tsfManager.potalAction(e,teasp.Tsf.Dom.hitch(this,function(e,t){e?((e=teasp.Tsf.Dom.node('input[type="radio"]',s)).checked&&(e.checked=!1,this.resetAttach()),teasp.Tsf.Dom.show(s,null,!1),this.deletedAttachs.push(a.Id),this.sendToOpener(
)):teasp.Tsf.Error.showError(t),teasp.Tsf.MainExpPrint.resize()})))})}},teasp.Tsf.FormExpAttach.prototype.onLoadImage=function(e){var t,e=e.target;!this.imageDisped&&e.width&&(this.imageWidth=e.width,this.imageHeight=e.height,t=teasp.Tsf.Dom.node(".image-area",teasp.Tsf.Dom.byId("attachExpView")),this.imageDisped=!0,this.zoom=Math.ceil((t.offsetWidth-20)/this.imageWidth*100),100<this.zoom&&(this.zoom=100),
this.setZoom(e))},teasp.Tsf.FormExpAttach.prototype.controlImage=function(e){var t=teasp.Tsf.Dom.node("#attachExpView img");null===this.angle&&(this.angle=0),"L"!=e&&"R"!=e||("L"==e?(this.angle-=90,this.angle<0&&(this.angle+=360)):(this.angle+=90,360<this.angle&&(this.angle-=360)),this.rotateImage(t)),"Zi"!=e&&"Zo"!=e||("Zo"==e?10<this.zoom&&(this.zoom%this.ZOOM_K?this.zoom=Math.floor(this.zoom/this.ZOOM_K
)*this.ZOOM_K:this.zoom-=this.ZOOM_K):this.zoom<200&&(this.zoom%this.ZOOM_K?this.zoom=Math.ceil(this.zoom/this.ZOOM_K)*this.ZOOM_K:this.zoom+=this.ZOOM_K),this.setZoom(t))},teasp.Tsf.FormExpAttach.prototype.setZoom=function(e){e.width=this.imageWidth*(this.zoom/100),e.height=this.imageHeight*(this.zoom/100),teasp.Tsf.Dom.node("#attachExpCtrl input.zoomDisp").value=this.zoom+"%"},
teasp.Tsf.FormExpAttach.prototype.rotateImage=function(e){var t=dojo.isIE<=8?"_ie8":"",t=(dojo.toggleClass(e,"rotate0"+t,0==this.angle),dojo.toggleClass(e,"rotate90"+t,90==this.angle),dojo.toggleClass(e,"rotate180"+t,180==this.angle),dojo.toggleClass(e,"rotate270"+t,270==this.angle),90==this.angle?this.imageHeight/this.imageWidth*50:50),s=270==this.angle?this.imageWidth/this.imageHeight*50:50;dojo.attr(e,"style",
"-webkit-transform-origin:"+t+"% "+s+"%;-moz-transform-origin:"+t+"% "+s+"%;-ms-transform-origin:"+t+"% "+s+"%;-o-transform-origin:"+t+"% "+s+"%;")},teasp.Tsf.FormExpPrint=function(){this.sections=[],this.IMAGE_EVENT_KEY="expPrint"},teasp.Tsf.FormExpPrint.prototype=new teasp.Tsf.FormBase,teasp.Tsf.FormExpPrint.prototype.initFp=function(e){var e=e.getConfig(),t=null;"Form1"==e.view?(t=teasp.Tsf.formParams.form1,
this.formType=1):"Form2"==e.view?(t=teasp.Tsf.formParams.form2,this.formType=2):"Form3"==e.view?(t=teasp.Tsf.formParams.form3,this.formType=3):"Form4"==e.view?(t=teasp.Tsf.formParams.form4,this.formType=4):(t=teasp.Tsf.formParams.form0,this.formType=0),this.fp=teasp.Tsf.Fp.createFp(t)},teasp.Tsf.FormExpPrint.prototype.isReadOnly=function(){return tsfManager.isReadMode()},
teasp.Tsf.FormExpPrint.prototype.isAttach=function(){return"attach"==tsfManager.getAction()},teasp.Tsf.FormExpPrint.prototype.getDispValue=function(e,t,s){t=(t||this.fp).getDispValueByApiKey(s||this.objBase.getDataObj(),e);return t=(t=teasp.Tsf.util.entitizf(t))&&"string"==typeof t?t.replace(/\r?\n/g,"<br/>"):t},teasp.Tsf.FormExpPrint.prototype.getExpContent=function(e){return e._route.getExpContent(
this.getDomHelper(),teasp.Tsf.Fp.createHkey(),null,!0)},teasp.Tsf.FormExpPrint.prototype.getBigTitle=function(){return this.fp.getTitle()||""},teasp.Tsf.FormExpPrint.isImage=function(e){if(/^image/i.test(e.ContentType))return!0;if(e.ContentDocument){const t=["JPG","JPEG","JPE","PNG","GIF"];if(-1!==t.indexOf(e.ContentDocument.FileType))return!0}return!1},teasp.Tsf.FormExpPrint.prototype.getImageList=function(e){
var t=[];return dojo.forEach(this.objBase.getAttachments(),function(e){teasp.Tsf.FormExpPrint.isImage(e)&&t.push(e)}),t},teasp.Tsf.FormExpPrint.prototype.getReceiptImageList=function(e){var t=[],s=this.getAllAttachs();return dojo.forEach(s,function(e){e.receipt&&(teasp.Tsf.FormExpPrint.isImage(e.attach)||e.uber)&&t.push(e.attach)}),t},teasp.Tsf.FormExpPrint.prototype.useJtbSect=function(){
return tsfManager.isUsingJsNaviSystem()&&tsfManager.getInfo().isUseJtbSect(this.objBase.getTypeName())},teasp.Tsf.FormExpPrint.prototype.useAllowanceSect=function(){return tsfManager.getInfo().isUseAllowanceSect(this.objBase.getTypeName())},teasp.Tsf.FormExpPrint.prototype.useCouponTicketSect=function(){return tsfManager.getInfo().isUseCouponTicketSect(this.objBase.getTypeName())},
teasp.Tsf.FormExpPrint.prototype.useTicketArrangeSect=function(){return tsfManager.getInfo().isUseTicketArrangeSect(this.objBase.getTypeName())},teasp.Tsf.FormExpPrint.prototype.useProvisionalSect=function(){var e=tsfManager.getInfo().isUseProvisionalSect(this.objBase.getTypeName());return e=this.objBase.getProvisionalPaymentId()?!1:e},teasp.Tsf.FormExpPrint.prototype.useFreeInputSect=function(){
return tsfManager.getInfo().isUseFreeInputSect(this.objBase.getTypeName())},teasp.Tsf.FormExpPrint.prototype.useOverseaTravel=function(){return"2"==this.objBase.getDestinationType()},teasp.Tsf.FormExpPrint.prototype.refresh=function(e,t){this.objBase=e,this.objBase.setMode(t),this.expenseType=tsfManager.getParamByKey("expenseType",!0),this.expenseType&&this.objBase.filterEmpExp({expenseType:this.expenseType}),
this.setReadOnly(this.isReadOnly()),teasp.Tsf.Dom.show(teasp.Tsf.Dom.byId("attachExpView"),null,!1),this.init(),this.isAttach()&&this.expAttach.refreshAttach(e),this.show()},teasp.Tsf.FormExpPrint.prototype.createBase=function(){var e,t,s,a,o,i,p=this.getDomHelper().create("table",{id:this.fp.getAreaId(),style:"width:100%;"}),r=this.getDomHelper().create("tbody",null,p);return this.createTop1(this.getDomHelper(
).create("td",null,this.getDomHelper().create("tr",null,r))),this.isAttach()?(this.expAttach=new teasp.Tsf.FormExpAttach(this,this.fp,this.getDomHelper()),this.expAttach.createTr(r)):(this.createTop2(this.getDomHelper().create("td",null,this.getDomHelper().create("tr",null,r))),4!=this.formType&&this.createTop3(this.getDomHelper().create("td",null,this.getDomHelper().create("tr",null,r))),1==this.formType?(
e=this.getJtbValues(),t=this.getAllowanceValues(),s=this.getCouponValues(),a=this.getTicketValues(),i=this.getProvisionValues(),o=this.getDetailValues(),this.outputBase1(this.getDomHelper().create("td",null,this.getDomHelper().create("tr",null,r))),(this.useJtbSect()||e.length)&&this.outputJtb(this.getDomHelper().create("td",null,this.getDomHelper().create("tr",null,r)),e),(this.useAllowanceSect()||t.length
)&&this.outputAllowance(this.getDomHelper().create("td",null,this.getDomHelper().create("tr",null,r))),(this.useCouponTicketSect()||s.length)&&this.outputCoupon(this.getDomHelper().create("td",null,this.getDomHelper().create("tr",null,r))),(this.useTicketArrangeSect()||a.length)&&this.outputTicket(this.getDomHelper().create("td",null,this.getDomHelper().create("tr",null,r))),this.useOverseaTravel(
)&&this.outputOversea(this.getDomHelper().create("td",null,this.getDomHelper().create("tr",null,r))),(this.useProvisionalSect()||i.valid)&&this.outputProvision(this.getDomHelper().create("td",null,this.getDomHelper().create("tr",null,r))),(this.useFreeInputSect()||o.length)&&this.outputDetail2(this.getDomHelper().create("td",null,this.getDomHelper().create("tr",null,r)))):2==this.formType?(i=this.getProvisionValues()
,this.outputBase2(this.getDomHelper().create("td",null,this.getDomHelper().create("tr",null,r))),(this.useProvisionalSect()||i.valid)&&this.outputProvision(this.getDomHelper().create("td",null,this.getDomHelper().create("tr",null,r)))):3==this.formType?(i=this.getProvisionValues(),this.outputBase3(this.getDomHelper().create("td",null,this.getDomHelper().create("tr",null,r))),(this.useProvisionalSect()||i.valid
)&&this.outputProvision(this.getDomHelper().create("td",null,this.getDomHelper().create("tr",null,r))),this.outputDetail2(this.getDomHelper().create("td",null,this.getDomHelper().create("tr",null,r)))):4==this.formType?(this.outputBase4(this.getDomHelper().create("td",null,this.getDomHelper().create("tr",null,r))),this.outputProvision(this.getDomHelper().create("td",null,this.getDomHelper().create("tr",null,r)),!0)
):(this.objBase.getExpPreApplyId()&&this.outputExpPre(this.getDomHelper().create("td",null,this.getDomHelper().create("tr",null,r))),this.objBase.getId()&&this.outputBase0(this.getDomHelper().create("td",null,this.getDomHelper().create("tr",null,r))),this.outputDetail2(this.getDomHelper().create("td",null,this.getDomHelper().create("tr",null,r))),this.objBase.getRingiApplyId()&&this.outputRingi(this.getDomHelper(
).create("td",null,this.getDomHelper().create("tr",null,r)))),this.outputAttach(this.getDomHelper().create("td",null,this.getDomHelper().create("tr",null,r))),this.outputComment(this.getDomHelper().create("td",null,this.getDomHelper().create("tr",null,r))),this.outputAttr(this.getDomHelper().create("td",null,this.getDomHelper().create("tr",null,r))),this.outputImage(this.getDomHelper().create("td",null,
this.getDomHelper().create("tr",null,r))),0==this.formType&&this.outputReceiptArea()),teasp.Tsf.Dom.append(teasp.Tsf.Dom.byId(this.parentId),p),p},teasp.Tsf.FormExpPrint.prototype.createTop1=function(e){var e=this.getDomHelper().create("table",{className:"print-top1"},e),t=this.getDomHelper().create("tr",null,this.getDomHelper().create("tbody",null,e));return this.createTop1L(this.getDomHelper().create("td",{
style:"padding-right:4px;"},t)),this.isAttach()||this.createTop1R(this.getDomHelper().create("td",{style:"width:240px;"},t)),e},teasp.Tsf.FormExpPrint.prototype.createTop1L=function(e){var e=this.getDomHelper().create("table",{className:"print-top1L"},e),t=this.getDomHelper().create("tbody",null,e),s=this.getDomHelper().create("tr",null,t),a=this.getDomHelper().create("td",null,s);return this.createTop1LU(a),
this.isAttach()||(s=this.getDomHelper().create("tr",null,t),a=this.getDomHelper().create("td",null,s),this.createTop1LD(a)),e},teasp.Tsf.FormExpPrint.prototype.createTop1LU=function(e){var t=this.getDomHelper().create("table",null,e),s=this.getDomHelper().create("tbody",null,t),s=this.getDomHelper().create("tr",null,s),a=(this.isAttach()||(a=this.getDomHelper().create("button",{className:"std-button1"},
this.getDomHelper().create("td",{className:"buttons"},s)),this.getDomHelper().connect(a,"onclick",function(){return window.print(),!1}),this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("printOut_btn_title")},a),this.objBase.isPiwk()&&(a=this.getDomHelper().create("button",{className:"std-button3"},this.getDomHelper().create("td",{className:"buttons"},s)),this.getDomHelper().create("div",{
innerHTML:teasp.message.getLabel(this.objBase.isCancelApplyWait()?"tf10006250":"tf10000270")},a),this.domHelper.connect(a,"onclick",this,this.approveApply))),this.getDomHelper().create("button",{className:"std-button2"},this.getDomHelper().create("td",{className:"buttons"},s)));return this.getDomHelper().connect(a,"onclick",function(){return(window.open("","_top").opener=top).close(),!1}),this.getDomHelper().create(
"div",{innerHTML:teasp.message.getLabel("close_btn_title")},a),this.getDomHelper().create("div",{innerHTML:this.getBigTitle()},this.getDomHelper().create("td",{className:"big-title"},s)),teasp.Tsf.Dom.show(".buttons",e,!teasp.isSforce1()),t},teasp.Tsf.FormExpPrint.prototype.createCell=function(e,t){for(var s=t.rows||[],a=0;a<s.length;a++)for(var o=s[a],i=this.getDomHelper().create("tr",null,e),p=o.cells||[],
r=0;r<p.length;r++){var n=p[r],l=n.valueOnly?this.getDomHelper().create("td",{className:n.vStyle||"",colSpan:n.vSpan||1},i):(l=this.getDomHelper().create("td",{className:n.cStyle||"",colSpan:n.cSpan||1,rowSpan:n.rSpan||1},i),this.getDomHelper().create("div",{innerHTML:n.name||teasp.message.getLabel(n.msgId)},l),this.getDomHelper().create("td",{className:n.vStyle||"",colSpan:n.vSpan||1,rowSpan:n.rSpan||1},i));
this.getDomHelper().create("div",{innerHTML:n.value||""},l)}},teasp.Tsf.FormExpPrint.prototype.createDiv=function(e,t){e=this.getDomHelper().create("div",{className:"float-div"},e);this.getDomHelper().create("div",{className:t.cStyle||"",innerHTML:t.msgId?teasp.message.getLabel(t.msgId):t.name||""},e),this.getDomHelper().create("div",{className:t.vStyle||""},e)},teasp.Tsf.FormExpPrint.prototype.createTop1LD=function(
e){var e=this.getDomHelper().create("table",{className:"print-appno print-tops"},e),t=this.getDomHelper().create("tbody",null,e);return 0==this.formType?(this.createCell(t,{rows:[{cells:[{cStyle:"print-col-c",msgId:"tf10000550",vStyle:"print-apno",value:""},{cStyle:"print-col-c",msgId:"status_label",vStyle:"print-stat",value:""},{cStyle:"print-col-c",msgId:"payDate_label",vStyle:"print-payd",value:""}]}]}),
teasp.Tsf.Dom.html("td.print-apno   > div",e,this.objBase.getApplyNo()),teasp.Tsf.Dom.html("td.print-stat   > div",e,teasp.constant.getDisplayStatus(this.objBase.getStatusD(!0))),teasp.Tsf.Dom.html("td.print-payd   > div",e,this.objBase.getPayDate())):(this.createCell(t,{rows:[{cells:[{valueOnly:!0,vStyle:"print-aptype",value:""},{cStyle:"print-col-c",msgId:"tf10001100",vStyle:"print-apno",value:""},{
cStyle:"print-col-c",msgId:"status_label",vStyle:"print-stat",value:""}]}]}),teasp.Tsf.Dom.html("td.print-aptype > div",e,this.fp.getTitle()),teasp.Tsf.Dom.html("td.print-apno   > div",e,this.objBase.getApplyNo()),teasp.Tsf.Dom.html("td.print-stat   > div",e,teasp.constant.getDisplayStatus(this.objBase.getStatusD(!0)))),this.objBase.isRemoved()&&this.getDomHelper().create("div",{className:"print-removed",
innerHTML:teasp.message.getLabel("tf10007760")},e,"before"),e},teasp.Tsf.FormExpPrint.prototype.createTop1R=function(e){var e=this.getDomHelper().create("table",{className:"print-sign"},e),t=this.getDomHelper().create("tbody",null,e),t=this.getDomHelper().create("tr",null,t);return this.getDomHelper().create("td",null,t),this.getDomHelper().create("td",null,t),this.getDomHelper().create("td",null,t),
this.getDomHelper().create("td",null,t),e},teasp.Tsf.FormExpPrint.prototype.createTop2=function(e){var e=this.getDomHelper().create("table",{className:"print-who print-tops"},e),t=this.getDomHelper().create("tbody",null,e);return this.createCell(t,{rows:[{cells:[{cStyle:"print-col-c",msgId:"section_label",vStyle:"print-dept",value:""},{cStyle:"print-col-c",msgId:"empCode_label",vStyle:"print-code",value:""},{
cStyle:"print-col-c",msgId:"empName_label",vStyle:"print-emp",value:""}]}]}),teasp.Tsf.Dom.html("td.print-dept   > div",e,this.objBase.getDeptName(!0)),teasp.Tsf.Dom.html("td.print-code   > div",e,tsfManager.getTargetEmp().getEmpCode()),teasp.Tsf.Dom.html("td.print-emp    > div",e,tsfManager.getEmpName()),e},teasp.Tsf.FormExpPrint.prototype.getTotalAmount=function(){for(var e=this.objBase.getDataObj(),
t=e.ProvisionalPaymentAmount__c||0,e=e.AmountDueToPay__c||0,s=e-t,a=0,o=0,i=teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.sectionDetail),p=this.objBase.getSectionValues(i.getDiscernment()),r=0,n=0;n<p.length;n++){var l=p[n];l.PayeeId__r?"2"==l.PayeeId__r.PayeeType__c?o+=l.Cost__c||0:"3"==l.PayeeId__r.PayeeType__c?a+=l.Cost__c||0:r+=l.Cost__c||0:r+=l.Cost__c||0}return this.objBase.getId()||(s=e=r),{
total:teasp.Tsf.Currency.formatMoney(s,teasp.Tsf.Currency.V_YEN,!1,!0),provis:teasp.Tsf.Currency.formatMoney(t,teasp.Tsf.Currency.V_YEN,!1,!0),duetopay:teasp.Tsf.Currency.formatMoney(e,teasp.Tsf.Currency.V_YEN,!1,!0),credit:teasp.Tsf.Currency.formatMoney(a,teasp.Tsf.Currency.V_YEN,!1,!0),invoice:teasp.Tsf.Currency.formatMoney(o,teasp.Tsf.Currency.V_YEN,!1,!0)}},teasp.Tsf.FormExpPrint.prototype.createTop3=function(e){
var e=this.getDomHelper().create("table",{className:"print-sum print-tops"},e),t=this.getDomHelper().create("tbody",null,e);if(0==this.formType){var s=this.getDispValue("ExpenseType__c",teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.sectionExpAssist)),s=tsfManager.getPayeeTypeNums(s),a=[],o=(this.objBase.getId()?a.push({cStyle:"print-col-c",msgId:"tf10000530",vStyle:"print-provis",value:""}):a.push({cStyle:"print-col-c",
name:"",value:""}),a.push({cStyle:"print-col-c",msgId:"tf10000540",vStyle:"print-duetopay",value:""}),0<s[3]&&a.push({cStyle:"print-col-c",msgId:"tf10004930",vStyle:"print-credit",value:""}),0<s[2]&&a.push({cStyle:"print-col-c",msgId:"tf10004940",vStyle:"print-invoice",value:""}),a.length%2&&a.push({cStyle:"print-col-c",name:"",value:""}),0),i=0,p={rows:[]};for(p.rows.push({cells:[]}),p.rows[i].cells.push({
cStyle:"print-col-c",msgId:"tf10000520",vStyle:"print-total",value:"",rSpan:2<=a.length?2:1});o<a.length;)p.rows[i].cells.push(a[o++]),o&&o%2==0&&(p.rows.push({cells:[]}),i++);this.createCell(t,p);var s=this.getTotalAmount(),r=teasp.Tsf.Currency.formatMoney(0,teasp.Tsf.Currency.V_YEN,!1,!0);teasp.Tsf.Dom.html("td.print-total    > div",e,s.total||r),teasp.Tsf.Dom.html("td.print-provis   > div",e,s.provis||r),
teasp.Tsf.Dom.html("td.print-duetopay > div",e,s.duetopay||r),teasp.Tsf.Dom.html("td.print-credit   > div",e,s.credit||r),teasp.Tsf.Dom.html("td.print-invoice  > div",e,s.invoice||r)}else{this.createCell(t,{rows:[{cells:[{cStyle:"print-col-c",msgId:"tf10001110",vStyle:"print-total",value:""},{cStyle:"print-col-c",msgId:"tf10000530",vStyle:"print-provis",value:""}]}]});s=this.getDispValue("TotalAmount__c"),
t=this.getDispValue("ProvisionalPaymentAmount__c"),r=teasp.Tsf.Currency.formatMoney(0,teasp.Tsf.Currency.V_YEN,!1,!0);teasp.Tsf.Dom.html("td.print-total  > div",e,s||r),teasp.Tsf.Dom.html("td.print-provis > div",e,t||r)}return e},teasp.Tsf.FormExpPrint.prototype.appendAssist=function(e,t){var s=this.objBase.getTypeName(),a=this.objBase.getDataObj(),o=tsfManager.getInfo().getUseTitle(s,a),i=tsfManager.getInfo(
).isUseExpenseType(s,a),p=tsfManager.getInfo().isUsePayMethod(s,a),r=tsfManager.getInfo().isUseApplyDate(s,a),n=tsfManager.getInfo().isUsePayDate(s,a),l=tsfManager.getInfo().isUseProvisional(s,a),c=tsfManager.getInfo().isUseChargeJob(s,a),m=tsfManager.getInfo().isUseChargeDept(s,a),d=tsfManager.getInfo().isUseExtraItem1(s,a),s=tsfManager.getInfo().isUseExtraItem2(s,a);if(!(o||i||p||r||n||l||c||m||d||s))return!1;for(
var h=[],a=2==t?5:11,f=0,g=(o&&h.push({cStyle:"print-col-c",msgId:"tk10004320",vStyle:"exp-title",vSpan:11,value:""}),i&&(h.push({cStyle:"print-col-c",msgId:"tf10006080",vStyle:"expense-type",vSpan:a,value:""}),f++),p&&(h.push({cStyle:"print-col-c",msgId:"tf10006090",vStyle:"pay-expitem",vSpan:a,value:""}),f++),r&&(h.push({cStyle:"print-col-c",msgId:"tf10006100",vStyle:"apply-date",vSpan:a,value:""}),f++),n&&(h.push(
{cStyle:"print-col-c",msgId:"tf10006110",vStyle:"pay-date",vSpan:a,value:""}),f++),l&&(h.push({cStyle:"print-col-c",msgId:"tf10006120",vStyle:"provis-paym",vSpan:a,value:""}),f++),c&&(h.push({cStyle:"print-col-c",msgId:"job_label",vStyle:"job",vSpan:a,value:""}),f++),m&&(h.push({cStyle:"print-col-c",msgId:"tf10006000",vStyle:"charge-dept",vSpan:a,value:""}),f++),d&&(h.push({cStyle:"print-col-c",
name:tsfManager.getInfo().getExtraItemOutputDataName1()||"&nbsp;",vStyle:"extra-item1",vSpan:a,value:""}),f++),s&&(h.push({cStyle:"print-col-c",name:tsfManager.getInfo().getExtraItemOutputDataName2()||"&nbsp;",vStyle:"extra-item2",vSpan:a,value:""}),f++),2==t&&f%2!=0&&h.push({cStyle:"print-col-c",name:"",vStyle:null,vSpan:a,value:""}),0);g<h.length;){var u=h[g++],y={rows:[{cells:[]}]};y.rows[0].cells.push(u),
5==u.vSpan&&g<h.length&&y.rows[0].cells.push(h[g++]),this.createCell(e,y)}t=teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.sectionExpAssist);return o&&teasp.Tsf.Dom.html("td.exp-title   > div",e,this.getDispValue("Title__c",t)),i&&teasp.Tsf.Dom.html("td.expense-type> div",e,this.getDispValue("ExpenseType__c",t)),p&&teasp.Tsf.Dom.html("td.pay-expitem > div",e,this.getDispValue("PayExpItemId__c",t)),r&&teasp.Tsf.Dom.html(
"td.apply-date  > div",e,this.getDispValue("ApplyDate__c",t)),n&&teasp.Tsf.Dom.html("td.pay-date    > div",e,this.getDispValue("ExpectedPayDate__c",t)),l&&teasp.Tsf.Dom.html("td.provis-paym > div",e,this.getDispValue("ProvisionalPaymentId__c",t)),c&&teasp.Tsf.Dom.html("td.job         > div",e,this.getDispValue("ChargeJobId__c",t)),m&&teasp.Tsf.Dom.html("td.charge-dept > div",e,this.getDispValue("ChargeDeptId__c",t)),
d&&teasp.Tsf.Dom.html("td.extra-item1 > div",e,this.getDispValue("ExtraItem1__c",t)),s&&teasp.Tsf.Dom.html("td.extra-item2 > div",e,this.getDispValue("ExtraItem2__c",t)),!0},teasp.Tsf.FormExpPrint.prototype.outputBase0=function(e){var t=this.getDomHelper().create("table",{className:"print-base print-bodys"}),s=this.getDomHelper().create("tbody",null,t),a=this.getDomHelper().create("tr",null,s);
return this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10006410",teasp.message.getLabel("tf10002150"))},this.getDomHelper().create("td",{className:"print-bar",colSpan:12},a)),this.appendAssist(s,2)?(teasp.Tsf.Dom.append(e,t),t):null},teasp.Tsf.FormExpPrint.prototype.outputBase1=function(e){var e=this.getDomHelper().create("table",{className:"print-base print-bodys"},e),t=this.getDomHelper(
).create("tbody",null,e),s=this.getDomHelper().create("tr",null,t);return this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10006410",teasp.message.getLabel("tf10002150"))},this.getDomHelper().create("td",{className:"print-bar",colSpan:12},s)),this.createCell(t,{rows:[{cells:[{cStyle:"print-col-c",msgId:"tf10000760",vStyle:"print-type",vSpan:11,value:""}]}]}),this.createCell(t,{rows:[{cells:[{
cStyle:"print-col-c",msgId:"tk10004320",vStyle:"print-title",vSpan:11,value:""}]}]}),this.createCell(t,{rows:[{cells:[{cStyle:"print-col-c",msgId:"tk10000814",vStyle:"print-account",vSpan:11,value:""}]}]}),this.createCell(t,{rows:[{cells:[{cStyle:"print-col-c",msgId:"job_label",vStyle:"print-job",vSpan:11,value:""}]}]}),this.createCell(t,{rows:[{cells:[{cStyle:"print-col-c",msgId:"tf10000770",vStyle:"print-sd",
vSpan:3,value:""},{cStyle:"print-col-c",msgId:"tf10000780",vStyle:"print-st",vSpan:3,value:""},{cStyle:"print-col-c",msgId:"tf10000790",vStyle:"print-dt",vSpan:3,value:""}]}]}),this.createCell(t,{rows:[{cells:[{cStyle:"print-col-c",msgId:"tf10000800",vStyle:"print-ed",vSpan:3,value:""},{cStyle:"print-col-c",msgId:"tf10000810",vStyle:"print-et",vSpan:3,value:""},{cStyle:"print-col-c",msgId:"tf10000820",
vStyle:"print-rt",vSpan:3,value:""}]}]}),this.createCell(t,{rows:[{cells:[{cStyle:"print-col-c",msgId:"tf10000830",vStyle:"print-destc",vSpan:11,value:""}]}]}),this.createCell(t,{rows:[{cells:[{cStyle:"print-col-c",msgId:"tf10000840",vStyle:"print-desta",vSpan:11,value:""}]}]}),this.createCell(t,{rows:[{cells:[{cStyle:"print-col-c",msgId:"tf10000850",vStyle:"print-content",vSpan:11,value:""}]}]}),teasp.Tsf.Dom.html(
"td.print-type    > div",e,this.getDispValue("DestinationType__c")),teasp.Tsf.Dom.html("td.print-title   > div",e,this.getDispValue("Title__c")),teasp.Tsf.Dom.html("td.print-account > div",e,this.getDispValue("AccountName__c")),teasp.Tsf.Dom.html("td.print-job     > div",e,this.getDispValue("ChargeJobId__c")),teasp.Tsf.Dom.html("td.print-sd      > div",e,this.getDispValue("StartDate__c")),teasp.Tsf.Dom.html(
"td.print-st      > div",e,this.getDispValue("DepartureTime__c")),teasp.Tsf.Dom.html("td.print-dt      > div",e,this.getDispValue("DepartureType__c")),teasp.Tsf.Dom.html("td.print-ed      > div",e,this.getDispValue("EndDate__c")),teasp.Tsf.Dom.html("td.print-et      > div",e,this.getDispValue("ReturnTime__c")),teasp.Tsf.Dom.html("td.print-rt      > div",e,this.getDispValue("ReturnType__c")),teasp.Tsf.Dom.html(
"td.print-destc   > div",e,this.getDispValue("DestinationName__c")),teasp.Tsf.Dom.html("td.print-desta   > div",e,this.getDispValue("DestinationAddress__c")),teasp.Tsf.Dom.html("td.print-content > div",e,this.getDispValue("Content__c")),this.appendAssist(t,2),e},teasp.Tsf.FormExpPrint.prototype.outputBase2=function(e){var t=tsfManager.getExpItemById(this.getObjBase().getDataObj().SocialExpItemId__c),s=!1,a=!1,o=!1,
i=!1,p=!1,r=!1,e=this.getDomHelper().create("table",{className:"print-base print-bodys"},e),n=this.getDomHelper().create("tbody",null,e),l=this.getDomHelper().create("tr",null,n),l=(this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10006410",teasp.message.getLabel("tf10002150"))},this.getDomHelper().create("td",{className:"print-bar",colSpan:12},l)),this.createCell(n,{rows:[{cells:[{
cStyle:"print-col-c",msgId:"tk10004320",vStyle:"print-title",vSpan:11,value:""}]}]}),this.createCell(n,{rows:[{cells:[{cStyle:"print-col-c",msgId:"tk10000814",vStyle:"print-account",vSpan:11,value:""}]}]}),this.createCell(n,{rows:[{cells:[{cStyle:"print-col-c",msgId:"job_label",vStyle:"print-job",vSpan:11,value:""}]}]}),this.createCell(n,{rows:[{cells:[{cStyle:"print-col-c",msgId:"expItem_head",
vStyle:"print-expItem",vSpan:11,value:""}]}]}),this.createCell(n,{rows:[{cells:[{cStyle:"print-col-c",msgId:"tf10000620",vStyle:"print-date",vSpan:11,value:""}]}]}),this.createCell(n,{rows:[{cells:[{cStyle:"print-col-c",msgId:"tf10000850",vStyle:"print-content",vSpan:11,value:""}]}]}),this.createCell(n,{rows:[{cells:[{cStyle:"print-col-c",msgId:"tf10000950",vStyle:"print-amount",vSpan:11,value:""}]}]}),t&&(
t.isValidInternalParticipants()&&(a=!!t.isInternalParticipants()||1<=(teasp.Tsf.util.parseInt(this.getDispValue("OurNumber__c"))||0)),t.isValidExternalParticipants()&&(i=!!t.isExternalParticipants()||1<=(teasp.Tsf.util.parseInt(this.getDispValue("TheirNumber__c"))||0)),t.isValidInternalParticipants()||1<=(teasp.Tsf.util.parseInt(this.getDispValue("OurNumber__c"))||0)&&(a=!0),t.isValidExternalParticipants()||1<=(
teasp.Tsf.util.parseInt(this.getDispValue("TheirNumber__c"))||0)&&(i=!0),s=t.isInternalParticipants(),o=t.isExternalParticipants(),p=t.isPlace(),r=a||i),a&&this.createCell(n,{rows:[{cells:[{cStyle:"print-col-c",msgId:"tf10000860",vStyle:"print-pp1",vSpan:11,value:""}]}]}),s&&this.createCell(n,{rows:[{cells:[{cStyle:"print-col-c",msgId:"tf10011030",vStyle:"print-ppinfo1",vSpan:11,value:""}]}]}),i&&this.createCell(n,{
rows:[{cells:[{cStyle:"print-col-c",msgId:"tf10000870",vStyle:"print-pp2",vSpan:11,value:""}]}]}),o&&this.createCell(n,{rows:[{cells:[{cStyle:"print-col-c",msgId:"tf10011040",vStyle:"print-ppinfo2",vSpan:11,value:""}]}]}),r&&this.createCell(n,{rows:[{cells:[{cStyle:"print-col-c",msgId:"tf10000880",vStyle:"print-pp3",vSpan:11,value:""}]}]}),p&&(this.createCell(n,{rows:[{cells:[{cStyle:"print-col-c",msgId:"tf10011010",
vStyle:"print-place",vSpan:11,value:""}]}]}),this.createCell(n,{rows:[{cells:[{cStyle:"print-col-c",msgId:"tf10011020",vStyle:"print-placeAdr",vSpan:11,value:""}]}]})),this.getDispValue("OurNumber__c")),t=this.getDispValue("TheirNumber__c"),c=teasp.util.parseNumText(l,0),m=teasp.util.parseNumText(t,0),c=""+((null===c?"":c)+(null===m?"":m));return teasp.Tsf.Dom.html("td.print-title   > div",e,this.getDispValue(
"Title__c")),teasp.Tsf.Dom.html("td.print-account > div",e,this.getDispValue("AccountName__c")),teasp.Tsf.Dom.html("td.print-job     > div",e,this.getDispValue("ChargeJobId__c")),teasp.Tsf.Dom.html("td.print-expItem > div",e,this.getDispValue("SocialExpItemId__c")),teasp.Tsf.Dom.html("td.print-date    > div",e,this.getDispValue("StartDate__c")),teasp.Tsf.Dom.html("td.print-content > div",e,this.getDispValue(
"Content__c")),teasp.Tsf.Dom.html("td.print-amount  > div",e,this.getDispValue("TotalAmount__c")),a&&teasp.Tsf.Dom.html("td.print-pp1     > div",e,l),i&&teasp.Tsf.Dom.html("td.print-pp2     > div",e,t),r&&teasp.Tsf.Dom.html("td.print-pp3     > div",e,c),s&&teasp.Tsf.Dom.html("td.print-ppinfo1  > div",e,this.getDispValue("InternalParticipants__c")),o&&teasp.Tsf.Dom.html("td.print-ppinfo2  > div",e,this.getDispValue(
"ExternalParticipants__c")),p&&teasp.Tsf.Dom.html("td.print-place    > div",e,this.getDispValue("PlaceName__c")),p&&teasp.Tsf.Dom.html("td.print-placeAdr > div",e,this.getDispValue("PlaceAddress__c")),this.appendAssist(n,2),e},teasp.Tsf.FormExpPrint.prototype.outputBase3=function(e){var e=this.getDomHelper().create("table",{className:"print-base print-bodys"},e),t=this.getDomHelper().create("tbody",null,e),
s=this.getDomHelper().create("tr",null,t);return this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10006410",teasp.message.getLabel("tf10002150"))},this.getDomHelper().create("td",{className:"print-bar",colSpan:12},s)),this.createCell(t,{rows:[{cells:[{cStyle:"print-col-c",msgId:"tk10004320",vStyle:"print-title",vSpan:11,value:""}]}]}),this.createCell(t,{rows:[{cells:[{cStyle:"print-col-c",
msgId:"tk10000814",vStyle:"print-account",vSpan:11,value:""}]}]}),this.createCell(t,{rows:[{cells:[{cStyle:"print-col-c",msgId:"job_label",vStyle:"print-job",vSpan:11,value:""}]}]}),this.createCell(t,{rows:[{cells:[{cStyle:"print-col-c",msgId:"tf10000620",vStyle:"print-date",vSpan:11,value:""}]}]}),this.createCell(t,{rows:[{cells:[{cStyle:"print-col-c",msgId:"tf10000850",vStyle:"print-content",vSpan:11,value:""}]}]})
,teasp.Tsf.Dom.html("td.print-title   > div",e,this.getDispValue("Title__c")),teasp.Tsf.Dom.html("td.print-account > div",e,this.getDispValue("AccountName__c")),teasp.Tsf.Dom.html("td.print-job     > div",e,this.getDispValue("ChargeJobId__c")),teasp.Tsf.Dom.html("td.print-date    > div",e,this.getDispValue("StartDate__c")),teasp.Tsf.Dom.html("td.print-content > div",e,this.getDispValue("Content__c")),
this.appendAssist(t,2),e},teasp.Tsf.FormExpPrint.prototype.outputBase4=function(e){var e=this.getDomHelper().create("table",{className:"print-base print-bodys"},e),t=this.getDomHelper().create("tbody",null,e),s=this.getDomHelper().create("tr",null,t);return this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10006410",teasp.message.getLabel("tf10002150"))},this.getDomHelper().create("td",{
className:"print-bar",colSpan:12},s)),this.createCell(t,{rows:[{cells:[{cStyle:"print-col-c",msgId:"tk10004320",vStyle:"print-title",vSpan:11,value:""}]}]}),this.createCell(t,{rows:[{cells:[{cStyle:"print-col-c",msgId:"tk10000814",vStyle:"print-account",vSpan:11,value:""}]}]}),this.createCell(t,{rows:[{cells:[{cStyle:"print-col-c",msgId:"job_label",vStyle:"print-job",vSpan:11,value:""}]}]}),this.createCell(t,{rows:[{
cells:[{cStyle:"print-col-c",msgId:"tf10006100",vStyle:"print-date",vSpan:11,value:""}]}]}),this.createCell(t,{rows:[{cells:[{cStyle:"print-col-c",msgId:"tf10000850",vStyle:"print-content",vSpan:11,value:""}]}]}),teasp.Tsf.Dom.html("td.print-title   > div",e,this.getDispValue("Title__c")),teasp.Tsf.Dom.html("td.print-account > div",e,this.getDispValue("AccountName__c")),teasp.Tsf.Dom.html("td.print-job     > div",e,
this.getDispValue("ChargeJobId__c")),teasp.Tsf.Dom.html("td.print-date    > div",e,this.getDispValue("StartDate__c")),teasp.Tsf.Dom.html("td.print-content > div",e,this.getDispValue("Content__c")),this.appendAssist(t,2),e},teasp.Tsf.FormExpPrint.prototype.getJtbValues=function(){return this.objBase.obj.ExpJsNavi__r||[]},teasp.Tsf.FormExpPrint.prototype.getAllowanceValues=function(){var e=teasp.Tsf.Fp.createFp(
teasp.Tsf.formParams.sectionAllowance);return this.objBase.getSectionValues(e.getDiscernment())},teasp.Tsf.FormExpPrint.prototype.getCouponValues=function(){var e=teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.sectionCoupon);return this.objBase.getSectionValues(e.getDiscernment())},teasp.Tsf.FormExpPrint.prototype.getTicketValues=function(){var e=teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.sectionTicket);
return this.objBase.getSectionValues(e.getDiscernment())},teasp.Tsf.FormExpPrint.prototype.getProvisionValues=function(e){var t=teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.sectionProvisional),t={payDate:this.getDispValue("ExpectedPayDate__c",t),provisionalPaymentApplication:this.getDispValue("ProvisionalPaymentApplication__c",t),provisionalPaymentAmount:this.getDispValue("ProvisionalPaymentAmount__c",t)};
return t.valid=(e&&t.payDate||!e&&t.provisionalPaymentApplication)&&t.provisionalPaymentAmount,t},teasp.Tsf.FormExpPrint.prototype.getDetailValues=function(){var e=teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.sectionDetail);return this.objBase.getSectionValues(e.getDiscernment())},teasp.Tsf.FormExpPrint.prototype.outputJtb=function(e,t){var s=this.getDomHelper().create("table",{className:"print-jtb print-bodys"},e),
a=this.getDomHelper().create("tbody",null,s),o=this.getDomHelper().create("tr",null,a),i=(this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10006410",teasp.message.getLabel("jt12000060"))},this.getDomHelper().create("td",{className:"print-bar",colSpan:4,style:"border-bottom:0;"},o)),this.getDomHelper().create("tr",null,a)),i=this.getDomHelper().create("td",{colSpan:6,style:"border:0;"},i),
i=this.getDomHelper().create("table",{className:"print-sum print-tops",style:"margin-bottom:2px;"},i),i=this.getDomHelper().create("tbody",null,i),i=this.getDomHelper().create("tr",null,i),o=(this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("jt12000110")},this.getDomHelper().create("td",{className:"print-col-c",style:"width:120px; text-align:right;"},i)),this.getDomHelper().create("div",{
className:"planned-amount",innerHTML:teasp.Tsf.Currency.formatMoney(this.objBase.obj.PlannedAmount__c,teasp.Tsf.Currency.V_YEN,!1,!0)},this.getDomHelper().create("td",{className:"print-content"},i)),this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("jt12000120")},this.getDomHelper().create("td",{className:"print-col-c",style:"width:120px; text-align:right;"},i)),this.getDomHelper().create("div",{
className:"actual-amount",innerHTML:teasp.Tsf.Currency.formatMoney("0",teasp.Tsf.Currency.V_YEN,!1,!0)},this.getDomHelper().create("td",{className:"print-content"},i)),this.getDomHelper().create("tr",{className:"print-head"},a)),p=(this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("date_head")},this.getDomHelper().create("td",{className:"print-jtb-c1",style:"min-width:80px;"},o)),this.getDomHelper(
).create("div",{innerHTML:teasp.message.getLabel("jt12000090")},this.getDomHelper().create("td",{className:"print-jtb-c2"},o)),this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("status_btn_title")},this.getDomHelper().create("td",{className:"print-jtb-c3"},o)),this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10000950")},this.getDomHelper().create("td",{className:"print-jtb-c4"},o
)),this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10000850")},this.getDomHelper().create("td",{className:"print-jtb-c5"},o)),this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("expNote_head")},this.getDomHelper().create("td",{className:"print-jtb-c6"},o)),teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.sectionJtb)),r=0;if(t.length){for(l=0;l<t.length;l++){var o=this.getDomHelper(
).create("tr",null,a),n=t[l];this.getDomHelper().create("div",{innerHTML:this.getDispValue("Date__c",p,n)},this.getDomHelper().create("td",{className:"print-date"},o)),this.getDomHelper().create("div",{innerHTML:this.getDispValue("Transport__c",p,n)},this.getDomHelper().create("td",null,o)),this.getDomHelper().create("div",{innerHTML:this.getDispValue("Status__c",p,n)},this.getDomHelper().create("td",null,o)),
this.getDomHelper().create("div",{innerHTML:this.getDispValue("Cost__c",p,n)},this.getDomHelper().create("td",{className:"print-right"},o)),this.getDomHelper().create("div",{innerHTML:this.getDispValue("Content__c",p,n)},this.getDomHelper().create("td",null,o)),this.getDomHelper().create("div",{innerHTML:this.getDispValue("Note__c",p,n)},this.getDomHelper().create("td",null,o)),r+=teasp.Tsf.util.parseInt(
this.getDispValue("Cost__c",p,n).replace(/\\/g,"").split(",").join(""))}teasp.Tsf.Dom.node("div.actual-amount",e).innerHTML=teasp.Tsf.Currency.formatMoney(r,teasp.Tsf.Currency.V_YEN,!1,!0)}else for(var o=this.getDomHelper().create("tr",null,a),l=0;l<6;l++){var c=l?null:{style:"min-width:80px;"};this.getDomHelper().create("div",{innerHTML:"&nbsp;"},this.getDomHelper().create("td",c,o))}return s},
teasp.Tsf.FormExpPrint.prototype.outputAllowance=function(e){var e=this.getDomHelper().create("table",{className:"print-btpd print-bodys"},e),t=this.getDomHelper().create("tbody",null,e),s=this.getDomHelper().create("tr",null,t),s=(this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10006410",teasp.message.getLabel("tf10002180"))},this.getDomHelper().create("td",{className:"print-bar",colSpan:4},s))
,this.getDomHelper().create("tr",{className:"print-head"},t)),a=(this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("date_head")},this.getDomHelper().create("td",{className:"print-btpd-c1"},s)),this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10000890")},this.getDomHelper().create("td",{className:"print-btpd-c2"},s)),this.getDomHelper().create("div",{
innerHTML:teasp.message.getLabel("tf10000900")},this.getDomHelper().create("td",{className:"print-btpd-c3"},s)),this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("expNote_head")},this.getDomHelper().create("td",{className:"print-btpd-c4"},s)),teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.sectionAllowance)),o=this.objBase.getSectionValues(a.getDiscernment());console.log(o);for(var i=0;i<o.length;i++){
var s=this.getDomHelper().create("tr",null,t),p=o[i];this.getDomHelper().create("div",{innerHTML:this.getDispValue("Date__c",a,p)},this.getDomHelper().create("td",{className:"print-date"},s)),this.getDomHelper().create("div",{innerHTML:this.getDispValue("AllowanceItemId__c",a,p)},this.getDomHelper().create("td",null,s)),this.getDomHelper().create("div",{innerHTML:this.getDispValue("HotelItemId__c",a,p)},
this.getDomHelper().create("td",null,s)),this.getDomHelper().create("div",{innerHTML:this.getDispValue("Note__c",a,p)},this.getDomHelper().create("td",null,s))}return e},teasp.Tsf.FormExpPrint.prototype.outputCoupon=function(e){var e=this.getDomHelper().create("table",{className:"print-coupon print-bodys"},e),t=this.getDomHelper().create("tbody",null,e),s=this.getDomHelper().create("tr",null,t),s=(this.getDomHelper(
).create("div",{innerHTML:teasp.message.getLabel("tf10006410",teasp.message.getLabel("tf10002190"))},this.getDomHelper().create("td",{className:"print-bar",colSpan:4},s)),this.getDomHelper().create("tr",{className:"print-head"},t)),a=(this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10000910")},this.getDomHelper().create("td",{className:"print-coupon-c1"},s)),this.getDomHelper().create("div",{
innerHTML:teasp.message.getLabel("tf10000920")},this.getDomHelper().create("td",{className:"print-coupon-c2"},s)),this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10000930")},this.getDomHelper().create("td",{className:"print-coupon-c3"},s)),this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("expNote_head")},this.getDomHelper().create("td",{className:"print-coupon-c4"},s)),
teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.sectionCoupon)),o=this.objBase.getSectionValues(a.getDiscernment());if(o.length)for(p=0;p<o.length;p++){var s=this.getDomHelper().create("tr",null,t),i=o[p];this.getDomHelper().create("div",{innerHTML:this.getDispValue("couponDate",a,i)},this.getDomHelper().create("td",{className:"print-date"},s)),this.getDomHelper().create("div",{innerHTML:this.getDispValue("couponName",a,i
)},this.getDomHelper().create("td",null,s)),this.getDomHelper().create("div",{innerHTML:this.getDispValue("couponQuantity",a,i)},this.getDomHelper().create("td",{className:"print-right"},s)),this.getDomHelper().create("div",{innerHTML:this.getDispValue("couponNote",a,i)},this.getDomHelper().create("td",null,s))}else for(var s=this.getDomHelper().create("tr",null,t),p=0;p<4;p++)this.getDomHelper().create("div",{
innerHTML:"&nbsp;"},this.getDomHelper().create("td",null,s));return e},teasp.Tsf.FormExpPrint.prototype.outputTicket=function(e){var e=this.getDomHelper().create("table",{className:"print-ticket print-bodys"},e),t=this.getDomHelper().create("tbody",null,e),s=this.getDomHelper().create("tr",null,t),s=(this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10006410",teasp.message.getLabel("tf10002210"))}
,this.getDomHelper().create("td",{className:"print-bar",colSpan:7},s)),this.getDomHelper().create("tr",{className:"print-head"},t)),a=(this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10000910")},this.getDomHelper().create("td",{className:"print-ticket-c1"},s)),this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10001060")},this.getDomHelper().create("td",{
className:"print-ticket-c2"},s)),this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10001070")},this.getDomHelper().create("td",{className:"print-ticket-c3",colSpan:3},s)),this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10001080")},this.getDomHelper().create("td",{className:"print-ticket-c4"},s)),this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("expNote_head"
)},this.getDomHelper().create("td",{className:"print-ticket-c5"},s)),teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.sectionTicket)),o=this.objBase.getSectionValues(a.getDiscernment());if(o.length)for(p=0;p<o.length;p++){var s=this.getDomHelper().create("tr",null,t),i=o[p];this.getDomHelper().create("div",{innerHTML:this.getDispValue("ticketDate",a,i)},this.getDomHelper().create("td",{className:"print-date"},s)),
this.getDomHelper().create("div",{innerHTML:this.getDispValue("ticketRoute",a,i)},this.getDomHelper().create("td",null,s)),this.getDomHelper().create("div",{innerHTML:this.getDispValue("ticketRequest1",a,i)},this.getDomHelper().create("td",{className:"print-ticket-c31"},s)),this.getDomHelper().create("div",{innerHTML:this.getDispValue("ticketRequest2",a,i)},this.getDomHelper().create("td",{
className:"print-ticket-c31"},s)),this.getDomHelper().create("div",{innerHTML:this.getDispValue("ticketRequest3",a,i)},this.getDomHelper().create("td",{className:"print-ticket-c31"},s)),this.getDomHelper().create("div",{innerHTML:this.getDispValue("ticketSeat",a,i)},this.getDomHelper().create("td",null,s)),this.getDomHelper().create("div",{innerHTML:this.getDispValue("ticketNote",a,i)},this.getDomHelper().create("td"
,null,s))}else for(var s=this.getDomHelper().create("tr",null,t),p=0;p<7;p++)this.getDomHelper().create("div",{innerHTML:"&nbsp;"},this.getDomHelper().create("td",null,s));return e},teasp.Tsf.FormExpPrint.prototype.outputOversea=function(e){var e=this.getDomHelper().create("table",{className:"print-foreign print-bodys"},e),t=this.getDomHelper().create("tbody",null,e),s=this.getDomHelper().create("tr",null,t),s=(
this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10006410",teasp.message.getLabel("tf10001970"))},this.getDomHelper().create("td",{className:"print-bar",colSpan:4},s)),this.createCell(t,{rows:[{cells:[{cStyle:"print-col-c",msgId:"tf10000960",vStyle:"print-foreign1",vSpan:1,value:""},{cStyle:"print-col-c",msgId:"tf10001010",vStyle:"print-foreign6",vSpan:1,value:""}]}]}),this.createCell(t,{rows:[{
cells:[{cStyle:"print-col-c",msgId:"tf10000970",vStyle:"print-foreign2",vSpan:1,value:""},{cStyle:"print-col-c",msgId:"tf10001020",vStyle:"print-foreign7",vSpan:1,value:""}]}]}),this.createCell(t,{rows:[{cells:[{cStyle:"print-col-c",msgId:"tf10000980",vStyle:"print-foreign3",vSpan:1,value:""},{cStyle:"print-col-c",msgId:"tf10001030",vStyle:"print-foreign8",vSpan:1,value:""}]}]}),this.createCell(t,{rows:[{cells:[{
cStyle:"print-col-c",msgId:"tf10000990",vStyle:"print-foreign4",vSpan:1,value:""},{cStyle:"print-col-c",name:"",vStyle:null,vSpan:1,value:""}]}]}),this.createCell(t,{rows:[{cells:[{cStyle:"print-col-c",msgId:"tf10001000",vStyle:"print-foreign5",vSpan:1,value:""},{cStyle:"print-col-c",name:"",vStyle:null,vSpan:1,value:""}]}]}),teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.sectionForeign));return teasp.Tsf.Dom.html(
"td.print-foreign1 > div",e,this.getDispValue("OverseaOption1__c",s)),teasp.Tsf.Dom.html("td.print-foreign2 > div",e,this.getDispValue("OverseaCheckList1__c",s)),teasp.Tsf.Dom.html("td.print-foreign3 > div",e,this.getDispValue("OverseaCheckList3__c",s)),teasp.Tsf.Dom.html("td.print-foreign4 > div",e,this.getDispValue("OverseaCheckList4__c",s)),teasp.Tsf.Dom.html("td.print-foreign5 > div",e,this.getDispValue(
"TravelAllowance__c",s)),teasp.Tsf.Dom.html("td.print-foreign6 > div",e,this.getDispValue("OverseaOption2__c",s)),teasp.Tsf.Dom.html("td.print-foreign7 > div",e,this.getDispValue("OverseaCheckList2__c",s)),teasp.Tsf.Dom.html("td.print-foreign8 > div",e,this.getDispValue("OverseaCheckList5__c",s)),e},teasp.Tsf.FormExpPrint.prototype.outputProvision=function(e,t){var e=this.getDomHelper().create("table",{
className:"print-provis print-bodys"},e),s=this.getDomHelper().create("tbody",null,e),a=this.getDomHelper().create("tr",null,s),a=(this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10006410",teasp.message.getLabel("tf10002200"))},this.getDomHelper().create("td",{className:"print-bar",colSpan:4},a)),t?this.createCell(s,{rows:[{cells:[{cStyle:"print-col-c",msgId:"tf10006130",vStyle:"print-date",
vSpan:1,value:""},{cStyle:"print-col-c",msgId:"tf10001050",vStyle:"print-amount",vSpan:1,value:""}]}]}):this.createCell(s,{rows:[{cells:[{cStyle:"print-col-c",msgId:"tf10001040",vStyle:"print-content",vSpan:1,value:"",rSpan:2},{cStyle:"print-col-c",msgId:"tf10006130",vStyle:"print-date",vSpan:1,value:""}]},{cells:[{cStyle:"print-col-c",msgId:"tf10001050",vStyle:"print-amount",vSpan:1,value:""}]}]}),
teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.sectionProvisional));return teasp.Tsf.Dom.html("td.print-date > div",e,this.getDispValue("ExpectedPayDate__c",a)),t||teasp.Tsf.Dom.html("td.print-content > div",e,this.getDispValue("ProvisionalPaymentApplication__c",a)),teasp.Tsf.Dom.html("td.print-amount  > div",e,this.getDispValue("ProvisionalPaymentAmount__c",a)),e},teasp.Tsf.FormExpPrint.prototype.outputDetail=function(e
){var e=this.getDomHelper().create("table",{className:"print-detail print-bodys"},e),t=this.getDomHelper().create("tbody",null,e),s=this.getDomHelper().create("tr",null,t),a=teasp.message.getLabel("tf10006410",teasp.message.getLabel(this.formType?"tf10002160":"empExp_caption")),s=(this.expenseType&&(a+=teasp.message.getLabel("ci00000210",this.expenseType)),this.getDomHelper().create("div",{innerHTML:a},
this.getDomHelper().create("td",{className:"print-bar",colSpan:6},s)),this.getDomHelper().create("tr",{className:"print-head"},t)),o=(this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10000940")},this.getDomHelper().create("td",{className:"print-detail-c1"},s)),this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("expItem_head")},this.getDomHelper().create("td",{
className:"print-detail-c2"},s)),this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10000850")},this.getDomHelper().create("td",{className:"print-detail-c3"},s)),this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10000950")},this.getDomHelper().create("td",{className:"print-detail-c4"},s)),this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("job_label")},
this.getDomHelper().create("td",{className:"print-detail-c5"},s)),this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("expNote_head")},this.getDomHelper().create("td",{className:"print-detail-c6"},s)),teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.sectionDetail)),i=this.objBase.getSectionValues(o.getDiscernment());if(i.length)for(n=0;n<i.length;n++){var s=this.getDomHelper().create("tr",null,t),p=i[n],r=(
this.getDomHelper().create("div",{innerHTML:this.getDispValue("Date__c",o,p)},this.getDomHelper().create("td",{className:"print-date"},s)),this.getDomHelper().create("div",{innerHTML:this.getDispValue("ExpItemId__c",o,p)},this.getDomHelper().create("td",null,s)),this.getDomHelper().create("div",{className:"ts-form-route"},this.getDomHelper().create("td",{className:"ts-form-route"},s)));this.getDomHelper().create(
"div",{innerHTML:this.getDispValue("Cost__c",o,p)},this.getDomHelper().create("td",{className:"print-right"},s)),this.getDomHelper().create("div",{innerHTML:this.getDispValue("JobId__c",o,p)},this.getDomHelper().create("td",null,s)),this.getDomHelper().create("div",{innerHTML:this.getDispValue("Detail__c",o,p)},this.getDomHelper().create("td",null,s)),teasp.Tsf.Dom.append(r,this.getExpContent(p))}else for(
var s=this.getDomHelper().create("tr",null,t),n=0;n<6;n++)this.getDomHelper().create("div",{innerHTML:"&nbsp;"},this.getDomHelper().create("td",null,s));return e},teasp.Tsf.FormExpPrint.prototype.getGroupingDetails=function(e){for(var t=[],s={},a=0;a<e.length;a++){var o,i=e[a],p=(s[i.Date__c]||(s[i.Date__c]={jobs:[],jobMap:{}},t.push({date:i.Date__c})),s[i.Date__c]),r=i.JobId__c||"(null)";p.jobMap[r]||(p.jobMap[r]={
lines:[]},(o=i.JobId__r||{}).jobId=r,p.jobs.push(o)),p.jobMap[r].lines.push(i)}for(a=0;a<t.length;a++){for(var p=s[t[a].date],n=0,l=0;l<p.jobs.length;l++)n+=p.jobMap[p.jobs[l].jobId].lines.length+2;p.vSpan=n}return{dates:t,dmap:s}},teasp.Tsf.FormExpPrint.prototype.getAllAttachs=function(){for(var e=[],t=0,s=this.objBase.getAttachments()||[],a=0;a<s.length;a++)e.push({sn:++t,target:null,attach:s[a]});for(
var o=teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.sectionDetail),o=this.objBase.getSectionValues(o.getDiscernment()),i=this.getGroupingDetails(o),p=0;p<i.dates.length;p++)for(var r=i.dates[p],n=i.dmap[r.date],l=1,c=0;c<n.jobs.length;c++)for(var m=n.jobs[c],d=n.jobMap[m.jobId],h=0;h<d.lines.length;h++){for(var f=d.lines[h],s=f.Attachments||[],a=0;a<s.length;a++)e.push({sn:++t,target:teasp.util.date.formatDate(r.date,
"SLA")+"-"+l,receipt:!0,attach:s[a],uber:"uber"==f.Item__c&&"text/html"==s[a].ContentType});for(var g=f.ContentDocumentLinks||[],a=0;a<g.length;a++)e.push({sn:++t,target:teasp.util.date.formatDate(r.date,"SLA")+"-"+l,receipt:!0,attach:g[a]});l++}return e},teasp.Tsf.FormExpPrint.prototype.outputDetail2=function(e){var e=this.getDomHelper().create("table",{className:"print-detail print-bodys"},e),t=this.getDomHelper(
).create("tbody",null,e),s=this.getDomHelper().create("tr",null,t),a="",a=this.formType?1==this.formType?teasp.message.getLabel("tf10002160"):teasp.message.getLabel("tf10002170"):teasp.message.getLabel("empExp_caption"),a=teasp.message.getLabel("tf10006410",a),s=(this.expenseType&&(a+=teasp.message.getLabel("ci00000210",this.expenseType)),this.getDomHelper().create("div",{innerHTML:a},this.getDomHelper().create("td",
{className:"print-bar",colSpan:7},s)),this.getDomHelper().create("tr",{className:"print-head"},t)),o=(this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10000940")},this.getDomHelper().create("td",{className:"print-detail-c1",colSpan:2},s)),this.getDomHelper().create("div",{innerHTML:"#"},this.getDomHelper().create("td",{className:"print-detail-c2s"},s)),this.getDomHelper().create("div",{
innerHTML:teasp.message.getLabel("expItem_head")},this.getDomHelper().create("td",{className:"print-detail-c2"},s)),this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10000850")},this.getDomHelper().create("td",{className:"print-detail-c3"},s)),this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10000950")},this.getDomHelper().create("td",{className:"print-detail-c4"},s)),
this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("expNote_head")},this.getDomHelper().create("td",{className:"print-detail-c6"},s)),teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.sectionDetail)),a=this.objBase.getSectionValues(o.getDiscernment());if(a.length){for(var i=this.getGroupingDetails(a),p=0,r=dojo.isIE||0<=window.navigator.userAgent.toLowerCase().indexOf("trident"),n=0;n<i.dates.length;n++){
var l=i.dates[n],c=i.dmap[l.date],m=1;if(r)for(var d=teasp.util.date.formatDate(l.date,"SLA"),h=teasp.util.date.formatDate(l.date,"JPW"),f=0;f<c.jobs.length;f++){for(var g=c.jobs[f],u=c.jobMap[g.jobId],s=this.getDomHelper().create("tr",null,t),y=((g.JobCode__c||"")+" "+(g.Name||"")).trim(),_="border-bottom:none;"+(0<f?"border-top:none;":""),T=(this.getDomHelper().create("div",{innerHTML:y?d:""},this.getDomHelper(
).create("td",{style:"text-align:center;"+_},s)),this.getDomHelper().create("div",{innerHTML:y?h:""},this.getDomHelper().create("td",{style:"text-align:center;"+_},s)),this.getDomHelper().create("div",{innerHTML:y},this.getDomHelper().create("td",{colSpan:5},s)),y&&(d=h=""),0),D=0;D<u.lines.length;D++){var I=u.lines[D],E=(s=this.getDomHelper().create("tr",null,t),this.getDomHelper().create("div",{innerHTML:d},
this.getDomHelper().create("td",{style:"text-align:center;border-bottom:none;border-top:none;"},s)),this.getDomHelper().create("div",{innerHTML:h},this.getDomHelper().create("td",{style:"text-align:center;border-bottom:none;border-top:none;"},s)),d=h="",this.getDomHelper().create("div",{innerHTML:m++},this.getDomHelper().create("td",{style:"text-align:right;"},s)),this.getDomHelper().create("div",{
innerHTML:this.getDispValue("ExpItemId__c",o,I)},this.getDomHelper().create("td",null,s)),this.getDomHelper().create("div",{className:"ts-form-route"},this.getDomHelper().create("td",{className:"ts-form-route"},s)));this.getDomHelper().create("div",{innerHTML:this.getDispValue("Cost__c",o,I)},this.getDomHelper().create("td",{className:"print-right"},s)),this.getDomHelper().create("div",{innerHTML:this.getDispValue(
"Detail__c",o,I)},this.getDomHelper().create("td",null,s)),teasp.Tsf.Dom.append(E,this.getExpContent(I)),T+=I.Cost__c||0,p+=I.Cost__c||0}s=this.getDomHelper().create("tr",null,t),_="border-top:none;"+(f<c.jobs.length-1?"border-bottom:none;":""),this.getDomHelper().create("td",{style:"text-align:center;"+_},s),this.getDomHelper().create("td",{style:"text-align:center;"+_},s),this.getDomHelper().create("div",{
innerHTML:teasp.message.getLabel("tm30001050")},this.getDomHelper().create("td",{className:"print-total",colSpan:3},s)),this.getDomHelper().create("div",{innerHTML:teasp.Tsf.Currency.formatMoney(T,teasp.Tsf.Currency.V_YEN,!1,!0)},this.getDomHelper().create("td",{className:"print-right"},s)),this.getDomHelper().create("td",null,s)}else{s=this.getDomHelper().create("tr",null,t);this.getDomHelper().create("div",{
innerHTML:teasp.util.date.formatDate(l.date,"SLA")},this.getDomHelper().create("td",{rowSpan:c.vSpan,style:"text-align:center;"},s)),this.getDomHelper().create("div",{innerHTML:teasp.util.date.formatDate(l.date,"JPW")},this.getDomHelper().create("td",{rowSpan:c.vSpan,style:"text-align:center;"},s));for(f=0;f<c.jobs.length;f++){for(g=c.jobs[f],u=c.jobMap[g.jobId],y=(0<f&&(s=this.getDomHelper().create("tr",null,t)),(
g.JobCode__c||"")+" "+(g.Name||"")),T=(this.getDomHelper().create("div",{innerHTML:y},this.getDomHelper().create("td",{colSpan:5},s)),0),D=0;D<u.lines.length;D++){I=u.lines[D],E=(s=this.getDomHelper().create("tr",null,t),this.getDomHelper().create("div",{innerHTML:m++},this.getDomHelper().create("td",{style:"text-align:right;"},s)),this.getDomHelper().create("div",{innerHTML:this.getDispValue("ExpItemId__c",o,I)},
this.getDomHelper().create("td",null,s)),this.getDomHelper().create("div",{className:"ts-form-route"},this.getDomHelper().create("td",{className:"ts-form-route"},s)));this.getDomHelper().create("div",{innerHTML:this.getDispValue("Cost__c",o,I)},this.getDomHelper().create("td",{className:"print-right"},s)),this.getDomHelper().create("div",{innerHTML:this.getDispValue("Detail__c",o,I)},this.getDomHelper().create("td",
null,s)),teasp.Tsf.Dom.append(E,this.getExpContent(I)),T+=I.Cost__c||0,p+=I.Cost__c||0}s=this.getDomHelper().create("tr",null,t),this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tm30001050")},this.getDomHelper().create("td",{className:"print-total",colSpan:3},s)),this.getDomHelper().create("div",{innerHTML:teasp.Tsf.Currency.formatMoney(T,teasp.Tsf.Currency.V_YEN,!1,!0)},this.getDomHelper().create(
"td",{className:"print-right"},s)),this.getDomHelper().create("td",null,s)}}}s=this.getDomHelper().create("tr",null,t);this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("total_label")},this.getDomHelper().create("td",{className:"print-total",colSpan:5},s)),this.getDomHelper().create("div",{innerHTML:teasp.Tsf.Currency.formatMoney(p,teasp.Tsf.Currency.V_YEN,!1,!0)},this.getDomHelper().create("td",{
className:"print-right"},s)),this.getDomHelper().create("td",null,s)}else for(var s=this.getDomHelper().create("tr",null,t),n=0;n<7;n++){var i=n?null:{style:"min-width:80px;"};this.getDomHelper().create("div",{innerHTML:"&nbsp;"},this.getDomHelper().create("td",i,s))}return e},teasp.Tsf.FormExpPrint.prototype.outputExpPre=function(e){var e=this.getDomHelper().create("table",{className:"print-base print-bodys"},e),
t=this.getDomHelper().create("tbody",null,e),s=this.getDomHelper().create("tr",null,t),s=(this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10006410",teasp.message.getLabel("tf10006060"))},this.getDomHelper().create("td",{className:"print-bar",colSpan:6},s)),this.createCell(t,{rows:[{cells:[{cStyle:"print-col-c",msgId:"tf10001100",vStyle:"print-applyNo",vSpan:2,value:""},{cStyle:"print-col-c",
msgId:"tk10000262",vStyle:"print-type",vSpan:2,value:""}]}]}),this.createCell(t,{rows:[{cells:[{cStyle:"print-col-c",msgId:"tk10004320",vStyle:"print-title",vSpan:5,value:""}]}]}),this.createCell(t,{rows:[{cells:[{cStyle:"print-col-c",msgId:"tf10001110",vStyle:"print-total",vSpan:2,value:""},{cStyle:"print-col-c",msgId:"tf10001050",vStyle:"print-provis",vSpan:2,value:""}]}]}),teasp.Tsf.Fp.createFp(
teasp.Tsf.formParams.sectionExpHead)),a=(teasp.Tsf.Dom.html("td.print-applyNo > div",e,this.getDispValue("ExpPreApplyId__r.ExpPreApplyNo__c",s)),teasp.Tsf.Dom.html("td.print-type    > div",e,this.getDispValue("ExpPreApplyId__r.Type__c",s)),teasp.Tsf.Dom.html("td.print-title   > div",e,this.getDispValue("ExpPreApplyId__r.Title__c",s)),teasp.Tsf.Dom.html("td.print-total   > div",e,this.getDispValue(
"ExpPreApplyId__r.TotalAmount__c",s)),teasp.Tsf.Dom.html("td.print-provis  > div",e,this.getDispValue("ExpPreApplyId__r.ProvisionalPaymentAmount__c",s)),this.objBase.expPreApply?this.objBase.expPreApply.obj.Type__c:null);if(tsfManager.isUsingJsNaviSystem()&&a==teasp.constant.EXP_PRE_FORM1){s=teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.sectionExpHeadJtb),this.createCell(t,{rows:[{cells:[{cStyle:"print-col-c",
msgId:"jt13000080",vStyle:"print-jtbpre",vSpan:2,value:""},{cStyle:"print-col-c",msgId:"jt13000090",vStyle:"print-jtbact",vSpan:2,value:""}]}]}),teasp.Tsf.Dom.html("td.print-jtbpre  > div",e,this.getDispValue("ExpPreApplyId__r.PlannedAmount__c",s));for(var o=0,s=teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.sectionDetail),i=this.objBase.getSectionValues(s.getDiscernment()),p=0;p<i.length;p++){var r=i[p],
n=teasp.Tsf.util.parseInt(r.Cost__c)||0;"JTB"==r.Item__c&&(o+=n)}teasp.Tsf.Dom.html("td.print-jtbact  > div",e,teasp.Tsf.Currency.formatMoney(o,teasp.Tsf.Currency.V_YEN,!1,!0))}return e},teasp.Tsf.FormExpPrint.prototype.outputRingi=function(e){var e=this.getDomHelper().create("table",{className:"print-base print-bodys"},e),t=this.getDomHelper().create("tbody",null,e),s=this.getDomHelper().create("tr",null,t),s=(
this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10006410",teasp.message.getLabel("tk10004350"))},this.getDomHelper().create("td",{className:"print-bar",colSpan:6},s)),this.createCell(t,{rows:[{cells:[{cStyle:"print-col-c",msgId:"tk10004310",vStyle:"print-applyNo",vSpan:2,value:""},{cStyle:"print-col-c",msgId:"tk10000262",vStyle:"print-type",vSpan:2,value:""}]}]}),this.createCell(t,{rows:[{
cells:[{cStyle:"print-col-c",msgId:"tk10004320",vStyle:"print-title",vSpan:5,value:""}]}]}),teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.sectionExpRingi));return teasp.Tsf.Dom.html("td.print-applyNo > div",e,this.getDispValue("ApplyId__r.ApplicationNo__c",s)),teasp.Tsf.Dom.html("td.print-type    > div",e,this.getDispValue("ApplyId__r.Type__c",s)),teasp.Tsf.Dom.html("td.print-title   > div",e,this.getDispValue(
"ApplyId__r.Name",s)),e},teasp.Tsf.FormExpPrint.prototype.outputAttach=function(e){var t=this.getAllAttachs();if(!t.length)return null;var e=this.getDomHelper().create("table",{className:"print-attach print-bodys"},e),s=this.getDomHelper().create("tbody",null,e),a=this.getDomHelper().create("tr",null,s);this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10006410",teasp.message.getLabel("tk10000077"
))},this.getDomHelper().create("td",{className:"print-bar",colSpan:3},a)),a=this.getDomHelper().create("tr",{className:"print-head"},s),this.getDomHelper().create("div",{innerHTML:"#"},this.getDomHelper().create("td",{className:"print-detail-c1"},a)),0==this.formType&&this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10006700")},this.getDomHelper().create("td",{className:"print-detail-c2"},a)),
this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10006710")},this.getDomHelper().create("td",{className:"print-detail-c3"},a));for(var o=0;o<t.length;o++){var i=t[o],a=this.getDomHelper().create("tr",null,s),p=(this.getDomHelper().create("div",{innerHTML:i.sn},this.getDomHelper().create("td",{className:"print-no"},a)),0==this.formType&&this.getDomHelper().create("div",{innerHTML:i.target||"-"},
this.getDomHelper().create("td",{className:"print-target"},a)),this.getDomHelper().create("div",null,this.getDomHelper().create("td",{className:"print-fname"},a)));teasp.Tsf.FormExpPrint.isImage(i.attach)||i.uber?i.attach.ContentDocumentId?p.innerHTML=i.attach.ContentDocument.Title:p.innerHTML=i.attach.Name:i.attach.ContentDocumentId?this.getDomHelper().create("a",{
href:"/sfc/servlet.shepherd/document/download/"+i.attach.ContentDocumentId,innerHTML:i.attach.ContentDocument.Title,target:"_blank"},p):this.getDomHelper().create("a",{href:"/servlet/servlet.FileDownload?file="+i.attach.Id,innerHTML:i.attach.Name,target:"_blank"},p)}return e},teasp.Tsf.FormExpPrint.prototype.outputComment=function(e,t){var e=this.getDomHelper().create("table",{className:"print-comment print-bodys"},e
),s=this.getDomHelper().create("tbody",null,e),a=this.getDomHelper().create("tr",null,s),a=(this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("tf10006410",teasp.message.getLabel("comment_head"))},this.getDomHelper().create("td",{className:"print-bar",colSpan:1},a)),this.getDomHelper().create("tr",null,s));return this.getDomHelper().create("div",{innerHTML:teasp.Tsf.util.entitizg(
this.objBase.getComment(),!0)},this.getDomHelper().create("td",null,a)),e},teasp.Tsf.FormExpPrint.prototype.outputAttr=function(e,t){var e=this.getDomHelper().create("table",{className:"print-attr print-bodys"},e),s=this.getDomHelper().create("tbody",null,e);return this.createCell(s,{rows:[{cells:[{cStyle:"print-col-a",msgId:"lastApprovalDay_label",vStyle:"print-lastd",vSpan:1,value:""},{cStyle:"print-col-a",
msgId:"applicationDay_label",vStyle:"print-appld",vSpan:1,value:""}]}]}),this.createCell(s,{rows:[{cells:[{cStyle:"print-col-a",msgId:"lastRecognizer_label",vStyle:"print-actor",vSpan:1,value:""},{cStyle:"print-col-a",name:"",vStyle:null,vSpan:1,value:""}]}]}),teasp.Tsf.Dom.html("td.print-lastd > div",e,this.objBase.getLastApprovedTime()),teasp.Tsf.Dom.html("td.print-appld > div",e,this.objBase.getApplyTime()),
teasp.Tsf.Dom.html("td.print-actor > div",e,this.objBase.getLastApprover()),e},teasp.Tsf.FormExpPrint.prototype.outputImage=function(e,t){var s,a;if(this.getImageList().length||this.getReceiptImageList().length)return teasp.Tsf.Dom.style(e,"textAlign","left"),e=this.getDomHelper().create("div",{className:"print-image"},e),s=this.getDomHelper().create("label",null,e),a=this.getDomHelper().create("input",{
type:"checkbox"},s),this.getDomHelper().create("span",{innerHTML:" "+teasp.message.getLabel("tf10000510")},s),this.getDomHelper().connect(a,"onclick",this,this.showImage),e},teasp.Tsf.FormExpPrint.prototype.outputReceiptArea=function(){var e=teasp.Tsf.Dom.byId("attachExpView"),t=teasp.Tsf.Dom.nextSibling(e);return teasp.Tsf.Dom.hasClass(t,"receipt-area")?teasp.Tsf.Dom.empty(teasp.Tsf.Dom.byId("receiptsPlace")):(
t=this.getDomHelper().create("div",{className:"upload-area receipt-area"},e,"after"),e=this.getDomHelper().create("div",null,t),this.getDomHelper().create("div",{className:"receipt-mark",innerHTML:teasp.message.getLabel("receiptPastingColumn")},e),this.getDomHelper().create("div",{id:"receiptsPlace"},e)),t},teasp.Tsf.FormExpPrint.prototype.showImage=function(e){var t=teasp.Tsf.Dom.node(
'div.print-image input[type="checkbox"]',this.getArea()),s=teasp.Tsf.Dom.byId("attachExpView"),a=teasp.Tsf.Dom.byId("receiptsPlace");if(teasp.Tsf.Dom.show(s,null,t.checked),this.getDomHelper().freeBy(this.IMAGE_EVENT_KEY),teasp.Tsf.Dom.empty(a),t.checked){teasp.Tsf.Dom.empty(s);for(var o=this.getReceiptImageList(),i=[],p=0;p<o.length;p++){var r=o[p];"text/html"!=r.ContentType||r.body||i.push({Id:r.Id,pos:p})}var n=0,
l=null,l=teasp.Tsf.Dom.hitch(this,function(){tsfManager.getAttachmentBody(i[n].Id,teasp.Tsf.Dom.hitch(this,function(e,t){e?(o[i[n].pos].body=t.body,++n<i.length?l():this.showImage2()):teasp.Tsf.Error.showError(t)}))});0<i.length?l():this.showImage2()}},teasp.Tsf.FormExpPrint.prototype.showImage2=function(){for(var e=teasp.Tsf.Dom.byId("attachExpView"),t=teasp.Tsf.Dom.byId("receiptsPlace"),s=this.getImageList(),
a=0;a<s.length;a++){var o=s[a],i=(this.getDomHelper().create("div",{innerHTML:o.Name,className:"image-name"},e),this.getDomHelper().create("img",{src:"/servlet/servlet.FileDownload?file="+o.Id},this.getDomHelper().create("div",{className:"image-print"},e)));this.getDomHelper().connect(i,"onload",this,this.onLoadImage,this.IMAGE_EVENT_KEY)}for(s=this.getReceiptImageList(),a=0;a<s.length;a++)if((o=s[a]
).ContentDocumentId){this.getDomHelper().create("div",{innerHTML:o.ContentDocument.Title,className:"receipt-name"},t);const i=this.getDomHelper().create("img",{src:"/sfc/servlet.shepherd/document/download/"+o.ContentDocumentId},this.getDomHelper().create("div",{className:"receipt-print"},t));this.getDomHelper().connect(i,"onload",this,this.onLoadImage,this.IMAGE_EVENT_KEY)}else this.getDomHelper().create("div",{
innerHTML:o.Name,className:"receipt-name"},t),o.body?this.getDomHelper().create("div",{className:"receipt-print"},t).appendChild(teasp.Tsf.Dom.toDom(o.body)):(i=this.getDomHelper().create("img",{src:"/servlet/servlet.FileDownload?file="+o.Id},this.getDomHelper().create("div",{className:"receipt-print"},t)),this.getDomHelper().connect(i,"onload",this,this.onLoadImage,this.IMAGE_EVENT_KEY))},
teasp.Tsf.FormExpPrint.prototype.onLoadImage=function(e){var t=e.target;!this.imageDisped&&t.width&&(this.imageWidth=t.width,this.imageHeight=t.height,e=e.target.parentNode,this.zoom=Math.floor(e.offsetWidth/this.imageWidth*100),100<this.zoom&&(this.zoom=100),this.isAttach()||this.imageWidth<700?(console.log("zoom="+this.zoom),t.width=this.imageWidth*(this.zoom/100),t.height=this.imageHeight*(this.zoom/100)
):t.style.width="100%")},teasp.Tsf.FormCsvUpload=function(){this.sections=[],this.IMAGE_EVENT_KEY="expPrint",this.fp=teasp.Tsf.Fp.createFp(teasp.Tsf.formParams.csvUpload)},teasp.Tsf.FormCsvUpload.prototype=new teasp.Tsf.FormBase,teasp.Tsf.FormCsvUpload.prototype.initFp=function(e){},teasp.Tsf.FormCsvUpload.prototype.isReadOnly=function(){return tsfManager.isReadMode()},
teasp.Tsf.FormCsvUpload.prototype.isAttach=function(){return"attach"==tsfManager.getAction()},teasp.Tsf.FormCsvUpload.prototype.getOpenerToken=function(){var e=null;try{e=window.opener.tsfManager.getToken()}catch(e){}return e},teasp.Tsf.FormCsvUpload.prototype.checkOpenerToken=function(){var e=this.getOpenerToken();return this.token&&e&&this.token.csvImportToken==e.csvImportToken?(this.token=e,!0):(teasp.tsAlert(
teasp.message.getLabel("ci00000120")),!1)},teasp.Tsf.FormCsvUpload.prototype.initOpenerAssist=function(){this.assist=null,this.expenseType=null;try{this.assist=window.opener.tsfManager.getAssistParam(),this.assist&&(this.expenseType=this.assist.ExpenseType__c||null)}catch(e){}},teasp.Tsf.FormCsvUpload.prototype.refresh=function(){teasp.Tsf.Dom.show(teasp.Tsf.Dom.byId("attachExpView"),null,!1),
this.token=this.getOpenerToken(),this.init(),this.show(),setTimeout(teasp.Tsf.Dom.hitch(this,function(){this.token&&this.token.csvImportToken||teasp.tsAlert(teasp.message.getLabel("ci00000120"),this,function(){this.close()})}),100)},teasp.Tsf.FormCsvUpload.prototype.createBase=function(){var e=this.getDomHelper().create("table",{style:"width:100%;"}),t=this.getDomHelper().create("tbody",null,e);
return this.createTop1(this.getDomHelper().create("td",null,this.getDomHelper().create("tr",null,t))),teasp.Tsf.Dom.append(teasp.Tsf.Dom.byId(this.parentId),e),e},teasp.Tsf.FormCsvUpload.prototype.createTop1=function(e){var e=this.getDomHelper().create("table",{className:"print-top1"},e),t=this.getDomHelper().create("tr",null,this.getDomHelper().create("tbody",null,e));return this.createTop1L(this.getDomHelper(
).create("td",{style:"padding-right:4px;"},t)),e},teasp.Tsf.FormCsvUpload.prototype.createTop1L=function(e){var e=this.getDomHelper().create("table",{className:"print-top1L"},e),t=this.getDomHelper().create("tbody",null,e),t=this.getDomHelper().create("tr",null,t),t=this.getDomHelper().create("td",null,t);return this.createTop1LU(t),e},teasp.Tsf.FormCsvUpload.prototype.createTop1LU=function(e){
var e=this.getDomHelper().create("table",null,e),t=this.getDomHelper().create("tbody",null,e),t=this.getDomHelper().create("tr",null,t),t=(this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("ci00000010"),style:"margin-right:50px;"},this.getDomHelper().create("td",{style:"text-align:left;padding-left:15px;"},t)),this.getDomHelper().create("div",{style:"margin-right:50px;"},this.getDomHelper().create(
"td",{className:"csv-expense-type",style:"text-align:left;display:none;"},t)),this.getDomHelper().create("button",{className:"std-button2"},this.getDomHelper().create("td",{className:"buttons"},t)));return this.getDomHelper().connect(t,"onclick",this,this.close),this.getDomHelper().create("div",{innerHTML:teasp.message.getLabel("close_btn_title")},t),e},teasp.Tsf.FormCsvUpload.prototype.close=function(){
return tsfManager.closeCsvImport(),(window.open("","_top").opener=top).close(),!1},teasp.Tsf.FormCsvUpload.prototype.refExpenseType=function(){this.initOpenerAssist();var e=teasp.Tsf.Dom.node(".csv-expense-type",dojo.byId("tsfFormArea")),e=(teasp.Tsf.Dom.show(e,null,!!this.expenseType),teasp.Tsf.Dom.node("div",e));e&&(e.innerHTML=teasp.message.getLabel("ci00000040",this.expenseType||""))},
teasp.Tsf.FormCsvUpload.prototype.setCsvData=function(e,t,s,a,o,i){this.refExpenseType();var p,r,n=teasp.Tsf.Dom.byId("attachExpView"),l=teasp.Tsf.Dom.byId("csvResultList"),c=teasp.Tsf.Dom.byId("csvImport"),m=teasp.Tsf.Dom.byId("csvImportMsg");teasp.Tsf.Dom.show(n,null,!1),teasp.Tsf.Dom.show(l,null,!1),teasp.Tsf.Dom.show(c,null,!1),teasp.Tsf.Dom.show(m,null,!1),(e.length||t.length)&&((p=new teasp.Tsf.CsvImportLogic
).convertCsvData({headers:e,datas:t,payees:s,depts:a,jobs:o,fname:i,expenseType:this.expenseType,targetEmp:window.opener.tsfManager.getTargetEmp()}),teasp.Tsf.Dom.node("textarea",n).value=p.getDetails(),(r=p.getImportData()).recordCnt&&(r.valids.length?(teasp.Tsf.Dom.show(c,null,!0),this.getDomHelper().freeBy("csvImport"),(e=teasp.Tsf.Dom.node("button",c))&&this.getDomHelper().connect(e,"onclick",this,function(){
!window.opener||window.opener.closed?teasp.tsAlert(teasp.message.getLabel("ci00000140"),this,function(){this.close()}):(this.token.rowCount||0)+r.valids.length>tsfManager.getExpCountLimit()?teasp.tsAlert(teasp.message.getLabel("ci00000180",tsfManager.getExpCountLimit())):(window.opener.tsfManager.startCsvImport(),teasp.Tsf.Dom.setUIBlock(!0),setTimeout(this.doCsvImport(p.getCOL(),r),100))},"csvImport")):(
m.innerHTML=teasp.message.getLabel("ci00000080"),teasp.Tsf.Dom.show(m,null,!0)),teasp.Tsf.Dom.node(".csv-result-all",l).innerHTML=teasp.message.getLabel("ci00000090",r.recordCnt),teasp.Tsf.Dom.node(".csv-result-valid",l).innerHTML=teasp.message.getLabel("ci00000100",r.valids.length),teasp.Tsf.Dom.node(".csv-result-error",l).innerHTML=teasp.message.getLabel("ci00000110",r.errorCnt),teasp.Tsf.Dom.show(l,null,!0)),
teasp.Tsf.Dom.show(n,null,!0),teasp.Tsf.MainCsvUpload.resize())},teasp.Tsf.FormCsvUpload.prototype.doCsvImport=function(e,t){return teasp.Tsf.Dom.hitch(this,function(){if(!this.checkOpenerToken())return teasp.Tsf.Dom.setUIBlock(!1),void this.close();try{window.opener.tsfManager.appliedEmpExp(e,t),this.close()}catch(e){teasp.Tsf.Dom.setUIBlock(!1),teasp.tsAlert(teasp.message.getLabel("ci00000130")+"\n"+e.message)}})},
teasp.Tsf.MainBase=function(){},teasp.Tsf.MainBase.prototype.init=function(){this.domHelper=new teasp.Tsf.Dom,this.createBase(),this.show(!1),this.setResizeEvent(),window.onbeforeunload=teasp.Tsf.Dom.hitch(this,this.beforeUnload);var e=teasp.Tsf.Dom.byId(teasp.Tsf.HANDLEBAR_CONTAINER);e&&this.domHelper.connect(e,"onclick",null,function(){setTimeout(teasp.Tsf.MainBase.resize,50)}),teasp.Tsf.Dom.addClass(
teasp.Tsf.Dom.node(".ts-top-logo > div"),this.titleCss),teasp.Tsf.Dom.setAttr(teasp.Tsf.Dom.node(".ts-top-photo img"),"src",tsfManager.getSessionSmallPhotoUrl()),teasp.Tsf.Dom.html("#expHeadDeptNameLabel",null,teasp.message.getLabel("dept_label")),teasp.Tsf.Dom.html("#expHeadEmpTypeNameLabel",null,teasp.message.getLabel("empType_label")),teasp.Tsf.Dom.html("#expHeadEmpNameLabel",null,teasp.message.getLabel(
"empName_label")),teasp.Tsf.Dom.html("#expHeadDeptName",null,tsfManager.getSessionDeptName()),teasp.Tsf.Dom.html("#expHeadEmpTypeName",null,tsfManager.getSessionEmpTypeName()),teasp.Tsf.Dom.html("#expHeadEmpName",null,tsfManager.getSessionEmpName()),teasp.Tsf.Dom.html(".ts-form-back > button",null,teasp.message.getLabel("tf10001540")),teasp.Tsf.Dom.html(".ts-form-print > button",null,teasp.message.getLabel(
"print_btn_title")),teasp.Tsf.Dom.html(".ts-total-label > div",null,teasp.message.getLabel("total_label")),teasp.Tsf.Dom.html(".ts-form-save > button",null,teasp.message.getLabel("tk10000289")),teasp.Tsf.Dom.html(".ts-form-cancel > button",null,teasp.message.getLabel("cancel_btn_title")),teasp.Tsf.Dom.html(".ts-form-delete > button",null,teasp.message.getLabel("delete_btn_title")),teasp.Tsf.Dom.html(
".ts-form-copy > button",null,teasp.message.getLabel("tk10000297")),teasp.Tsf.Dom.html(".ts-edit-button > button",null,teasp.message.getLabel("tk10000240")),teasp.Tsf.Dom.html(".ts-approve-button > button",null,teasp.message.getLabel("tf10000270")),teasp.Tsf.Dom.html(".ts-applyno-label",null,teasp.message.getLabel("expApplyNo_label")),teasp.Tsf.Dom.html(".ts-status-label",null,teasp.message.getLabel("status_label")),
teasp.Tsf.Dom.setAttr(teasp.Tsf.Dom.node(".ts-top-button3 > a"),"href",tsfManager.getHelpLink()),this.domHelper.connect(teasp.Tsf.Dom.byId("empListButton"),"onclick",null,dojo.hitch(this,this.openEmpTable)),this.calendarDialog=new teasp.Tsf.Calendar,this.calendarDialog.eventCloseCalendar(this.domHelper,teasp.Tsf.ROOT_AREA_ID,"ts-form-cal"),this.viewPlus(),this.initEnd(tsfManager.getArea()),this.checkMinWidth(),
9==dojo.isIE&&this.domHelper.connect(tsfManager.getArea(),"onkeydown",this,function(e){return 13!==e.keyCode||e.target&&"TEXTAREA"==e.target.nodeName||dojo.stopEvent(e),!1})},teasp.Tsf.MainBase.prototype.setResizeEvent=function(){window.onresize=teasp.Tsf.MainBase.resize},teasp.Tsf.MainBase.prototype.checkMinWidth=function(){var e;teasp.isMobile()&&window.innerWidth<tsfManager.getInfo().getCommon(
).getExpenseAreaReferWidth()&&("number"==typeof(e=tsfManager.getInfo().getCommon().getExpenseAreaMinWidth())&&dojo.style("tsfArea","min-width",e+"px"))},teasp.Tsf.MainBase.prototype.initEnd=function(e){},teasp.Tsf.MainBase.prototype.viewPlus=function(e){var t;tsfManager.getTarget()!=teasp.Tsf.Manager.EXP_PRE_APPLY&&tsfManager.getTarget()!=teasp.Tsf.Manager.EXP_APPLY||this.isArgRead()&&(t=dojo.create("div",{
className:"reference-mark",innerHTML:teasp.message.getLabel("tf10007320"),title:teasp.message.getLabel("tf10007330")},dojo.byId("tsfArea")),dojo.connect(t,"onclick",function(){var e=(e=location.href).replace(/mode=read/,"mode=edit");teasp.locationHref(e),document.body.style.cursor="wait"}))},teasp.Tsf.MainBase.prototype.isArgRead=function(){return/mode=read/.test(location.href)},
teasp.Tsf.MainBase.prototype.show=function(e){var t=tsfManager.getArea();teasp.Tsf.Dom.show(".ts-form-header",t,e),teasp.Tsf.Dom.show(".ts-form-footer",t,e)},teasp.Tsf.MainBase.prototype.getDomHelper=function(){return this.domHelper},teasp.Tsf.MainBase.prototype.getViewConfig=function(){return[]},teasp.Tsf.MainBase.prototype.beforeUnload=function(e){return tsfManager.beforeUnload(e)},
teasp.Tsf.MainBase.prototype.eventOpenCalendar=function(e,t,s,a,o){this.calendarDialog.eventOpenCalendar(e,t,s,a,o)},teasp.Tsf.MainBase.prototype.eventOpenExpRoute=function(e,t,s,a,o){this.expRouteDialog.eventOpenExpRoute(e,t,s,a,o)},teasp.Tsf.MainBase.prototype.initViewEnd=function(){},teasp.Tsf.MainBase.prototype.createBase=function(){var e=teasp.Tsf.Dom.byId(teasp.Tsf.ROOT_AREA_ID);teasp.Tsf.Dom.append(e,
this.createCommonHeader()),teasp.Tsf.Dom.append(e,teasp.Tsf.Dom.toDom('<div id="tsfErrorArea" class="ts-error-area"><div></div></div>')),teasp.Tsf.Dom.append(e,teasp.Tsf.Dom.toDom('<div id="expListView"></div>')),teasp.Tsf.Dom.append(e,this.createFormHeader()),teasp.Tsf.Dom.append(e,teasp.Tsf.Dom.toDom('<div id="tsfFormArea"></div>')),teasp.Tsf.Dom.append(e,teasp.Tsf.Dom.toDom('<div class="ts-form-spacer"></div>')),
teasp.Tsf.Dom.append(e,this.createFormFooter())},teasp.Tsf.MainBase.prototype.createCommonHeader=function(){return teasp.Tsf.Dom.toDom(
'<div id="expTopView">    <table>        <tbody>            <tr>                <td class="ts-top-logo">                    <div></div>                </td>                <td class="ts-top-title">                    <div class="main-title"></div>                    <div class="sub-title"></div>                </td>                <td class="ts-top-empinfo">                    <table>                        <tbody>                        <tr>                            <td class="ts-top-info-l"><div id="expHeadDeptNameLabel">\x3c!--部署名：--\x3e</div></td><td class="ts-top-info-r"><div id="expHeadDeptName"   ></div></td>                            <td class="ts-top-info-l"><div></div></td><td class="ts-top-info-r"><div></div></td>                        </tr>                        <tr>                            <td class="ts-top-info-l"><div id="expHeadEmpTypeNameLabel">\x3c!--勤務体系名：--\x3e</div></td><td class="ts-top-info-r"><div id="expHeadEmpTypeName"></div></td>                            <td class="ts-top-info-l"><div id="expHeadEmpNameLabel"    >\x3c!--社員名：    --\x3e</div></td><td class="ts-top-info-r"><div id="expHeadEmpName"    ></div></td>                        </tr>                        </tbody>                    </table>                </td>                <td class="ts-top-emplist">                    <div class="pp_base pp_btn_elopen" id="empListButton"></div>                </td>                <td class="ts-top-photo" ><div><img /></div></td>                <td class="ts-top-button1"><a><div>\x3c!-- ボタン１   --\x3e</div></a></td>                <td class="ts-top-button2"><a><div>\x3c!-- ボタン３   --\x3e</div></a></td>                <td class="ts-top-button3"><a target="_blank"><div>\x3c!-- ボタン２   --\x3e</div></a></td>                <td class="ts-top-last"></td>            </tr>        </tbody>    </table></div>'
)},teasp.Tsf.MainBase.prototype.createFormHeader=function(){return teasp.Tsf.Dom.toDom(
'<div class="ts-form-header">    <div class="ts-form-edge-left">        <table class="ts-form-control">            <tbody>                <tr>                    <td class="ts-form-back ts-std-button"       ><button>\x3c!--＜一覧へ戻る--\x3e</button></td>                    <td class="ts-form-title-vbar"               ><div></div></td>                    <td class="ts-form-title"                    ><div></div></td>                    <td class="ts-form-change"                   ><div></div></td>                </tr>            </tbody>        </table>    </div>    <div class="ts-form-edge-right">        <table class="ts-form-control">            <tbody>                <tr>                    <td class="ts-form-label"                    ><div class="ts-applyno-label">\x3c!--申請番号  --\x3e</div></td>                    <td class="ts-form-value"                    ><div class="ts-apply-no"     >&nbsp;</div></td>                    <td class="ts-form-print ts-std-button"      ><button>\x3c!--印刷      --\x3e</button></td>                    <td class="ts-total-label"                   ><div>\x3c!--合計--\x3e</div></td>                    <td class="ts-total-value"                   ><div class="ts-total-amount" >&nbsp;</div></td>                    <td class="ts-form-status-label"             ><div class="ts-status-label" >\x3c!--ステータス--\x3e</div></td>                    <td class="ts-form-status"                   ><button></button></td>                    <td class="ts-form-delete ts-std-button"     ><button>\x3c!--削除      --\x3e</button></td>                    <td class="ts-form-copy ts-std-button"       ><button>\x3c!--コピー    --\x3e</button></td>                    <td class="ts-form-save ts-std-button"       ><button>\x3c!--保存      --\x3e</button></td>                    <td class="ts-form-cancel ts-std-button"     ><button>\x3c!--キャンセル--\x3e</button></td>                    <td class="ts-apply-button"                  ><button></button></td>                    <td class="ts-approve-button"                ><button>\x3c!--承認／却下--\x3e</button></td>                    <td class="ts-edit-button"                   ><button>\x3c!--編集      --\x3e</button></td>                </tr>            </tbody>        </table>    </div></div>'
)},teasp.Tsf.MainBase.prototype.createFormFooter=function(){return teasp.Tsf.Dom.toDom(
'<div class="ts-form-tail"></div><div class="ts-form-footer">    <div class="ts-form-edge-right">        <table class="ts-form-control">            <tbody>                <tr>                   <td class="ts-total-label"              ><div>\x3c!--合計--\x3e</div></td>                   <td class="ts-total-value"              ><div class="ts-total-amount">&nbsp;  </div></td>                   <td class="ts-form-save ts-std-button"  ><button>\x3c!-- 保存     --\x3e</button></td>                   <td class="ts-form-cancel ts-std-button"><button>\x3c!--キャンセル--\x3e</button></td>                   <td class="ts-apply-button"             ><button></button></td>                </tr>            </tbody>        </table>    </div></div><div style="display:none;"><a id="expTsfCsvDL">download</a></div><div class="ts-form-bottom"></div>'
)},teasp.Tsf.MainBase.resize=function(){var e,t=teasp.Tsf.Dom.getBox(),s=teasp.Tsf.Dom.node(".ts-uiblock"),s=(s&&(o=dojo.byId("contentWrapper"),a=Math.max(t.w,Math.max(o&&o.clientWidth||0,document.body.offsetWidth)),o=Math.max(t.h,Math.max(o&&o.clientHeight||0,document.body.offsetHeight)),dojo.style(s,"width",a+"px"),dojo.style(s,"height",o+"px")),teasp.Tsf.Dom.node(".ts-busy-panel")),a=(s&&(o=Math.max((t.w-240)/2,0)
,e=Math.max((t.h-80)/2,0),o+=document.documentElement&&document.documentElement.scrollLeft||document.body.scrollLeft||0,e+=document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop||0,dojo.style(s,"left",o+"px"),dojo.style(s,"top",e+"px")),t.w),o=teasp.Tsf.Dom.byId(teasp.Tsf.BODY_CELL);o&&(a-=o.offsetLeft),a<800&&(a=800),80<Math.abs(teasp.Tsf.Dom.byId(teasp.Tsf.ROOT_AREA_ID).offsetWidth-a
)&&teasp.Tsf.MainBase.adjustArea()},teasp.Tsf.MainBase.adjustArea=function(){0<navigator.userAgent.indexOf("Salesforce")&&(dojo.byId("tsfArea").style.height="1000px")},teasp.Tsf.MainExpPreApply=function(){this.titleCss="exp-pre-apply"},teasp.Tsf.MainExpPreApply.prototype=new teasp.Tsf.MainBase,teasp.Tsf.MainExpPreApply.prototype.init=function(){teasp.Tsf.MainBase.prototype.init.call(this);var e,t=teasp.Tsf.Dom.node(
".ts-top-button2");t&&tsfManager.isUsingJsNaviSystem()&&tsfManager.isUseJsNaviDummy()&&(this.getDomHelper().connect(t,"onclick",this,function(e){window.open(teasp.getPageUrl("timeSheetView")+"?support=jtb&z="+(new Date).getTime()+"#!menu","jsNaviDummy","width=800,height=750,resizable=yes,scrollbars=yes")}),(e=dojo.query("div",t)[0]).innerHTML="JsNAVI Dummy",dojo.style(e,"color","white"),dojo.style(e,"font-weight",
"bold"),dojo.style(t,"cursor","pointer"))},teasp.Tsf.MainExpPreApply.prototype.openJsNavi=function(){var s,e={method:"getJsNaviParameter",empId:tsfManager.getEmpId(),proxyEmpId:tsfManager.getSessionEmpId()};if(!teasp.Tsf.Dom.node(document.jtbform))for((s=document.createElement("form")).setAttribute("method","post"),s.name="jtbform",s.style.display="none",document.body.appendChild(s),dojo.create("input",{type:"text",
name:"TCKOPERATIONMODE",value:""},s),dojo.create("input",{type:"text",name:"action",value:""},s),dojo.create("input",{type:"text",name:"EbbaKey",value:""},s),dojo.create("input",{type:"text",name:"ENCRYPTMODE",value:""},s),dojo.create("input",{type:"text",name:"LOCATIONCODE",value:""},s),dojo.create("input",{type:"text",name:"LOCATIONPASSWORD",value:""},s),dojo.create("input",{type:"text",name:"USERID",value:""},s),
dojo.create("input",{type:"text",name:"USERPASSWORD",value:""},s),dojo.create("input",{type:"text",name:"DRIUSERID",value:""},s),dojo.create("input",{type:"text",name:"OPERATIONNUMBER",value:""},s),dojo.create("input",{type:"text",name:"SUBNUMBER",value:""},s),dojo.create("input",{type:"text",name:"BUSINESSNAME",value:""},s),dojo.create("input",{type:"text",name:"PAYINGCCCD",value:""},s),dojo.create("input",{
type:"text",name:"TRIPSTARTDAY",value:""},s),dojo.create("input",{type:"text",name:"TRIPENDDAY",value:""},s),i=1;i<=16;i++)dojo.create("input",{type:"text",name:"MEMO"+i,value:""},s);tsfManager.jtbAction(e,teasp.Tsf.Dom.hitch(this,function(e,t){e?(document.jtbform.TCKOPERATIONMODE.value="2",document.jtbform.action=t.mainUrl,document.jtbform.EbbaKey.value=t.EbbaKey,document.jtbform.ENCRYPTMODE.value=t.ENCRYPTMODE,
document.jtbform.LOCATIONCODE.value=t.LOCATIONCODE,document.jtbform.LOCATIONPASSWORD.value=t.LOCATIONPASSWORD,document.jtbform.USERID.value=t.USERID,document.jtbform.USERPASSWORD.value=t.USERPASSWORD,t.DRIUSERID&&(document.jtbform.DRIUSERID.value=t.DRIUSERID),teasp.Tsf.SectionJtb.jtbOpen()):teasp.Tsf.Error.showError(t),s&&dojo.destroy(s)}))},teasp.Tsf.MainExpPreApply.prototype.getViewConfig=function(){
return tsfManager.getInfo().getExpPreApplyConfigs().views},teasp.Tsf.MainExpPreApply.prototype.initEnd=function(e){teasp.Tsf.Dom.html("div.main-title",teasp.Tsf.Dom.byId("expTopView"),teasp.message.getLabel("tk10004031")),teasp.Tsf.Dom.html("div.sub-title",teasp.Tsf.Dom.byId("expTopView"),teasp.message.getLabel("tf10004590")),this.domHelper.connect(teasp.Tsf.Dom.node(".ts-form-control .ts-form-back > button"),
"onclick",this,function(){if(tsfManager.isUsingJsNaviSystem()&&tsfManager.getInfo().objects)for(var e=0;e<tsfManager.getInfo().objects.length;e++){var t=tsfManager.getInfo().objects[e];t.obj&&t.obj.ExpJsNavi__r&&(t.obj.ExpJsNavi__r=null)}tsfManager.checkDiff()?teasp.tsConfirm(teasp.message.getLabel("tf10001600"),this,function(e){e&&tsfManager.backToList()}):tsfManager.backToList()}),this.domHelper.connect(
teasp.Tsf.Dom.query(".ts-form-control .ts-form-delete > button"),"onclick",this,function(e){if(tsfManager.isUsingJsNaviSystem()&&tsfManager.getInfo().objects)for(var t=0;t<tsfManager.getInfo().objects.length;t++){var s=tsfManager.getInfo().objects[t];if(s.obj&&s.obj.ExpJsNavi__r&&0<s.obj.ExpJsNavi__r.length)return void teasp.tsAlert(teasp.message.getLabel("jt12000100"))}teasp.tsConfirm(teasp.message.getLabel(
"tf10001910"),this,function(e){e&&tsfManager.deleteExpPreApply(teasp.Tsf.Dom.hitch(this,function(e,t){e?(console.log(t),tsfManager.changeView()):teasp.Tsf.Error.showError(t)}))})})},teasp.Tsf.MainExpPreApply.prototype.openEmpTable=function(){var e=teasp.getPageUrl("deptRefView")+"?type=ExpPre&empId="+tsfManager.getSessionEmpId()+"&deptId="+tsfManager.getSessionDeptId();teasp.isSforce1()?sforce.one.navigateToURL(e):(
e=window.open(e,"empTable","width=690,height=340,resizable=yes,scrollbars=yes"))&&e.focus()},teasp.Tsf.MainExpApply=function(){this.titleCss="exp-apply"},teasp.Tsf.MainExpApply.prototype=new teasp.Tsf.MainBase,teasp.Tsf.MainExpApply.prototype.init=function(){teasp.Tsf.MainBase.prototype.init.call(this)},teasp.Tsf.MainExpApply.prototype.getViewConfig=function(){return[]},
teasp.Tsf.MainExpApply.prototype.initEnd=function(e){teasp.Tsf.Dom.html("div.main-title",teasp.Tsf.Dom.byId("expTopView"),teasp.message.getLabel("empExp_caption")),teasp.Tsf.Dom.html("div.sub-title",teasp.Tsf.Dom.byId("expTopView"),teasp.message.getLabel("tf10004580")),teasp.Tsf.Dom.html(".ts-form-back > button",null,teasp.message.getLabel("tf10006150")),teasp.Tsf.Dom.html(".ts-applyno-label",null,
teasp.message.getLabel("tf10000550")),teasp.Tsf.Dom.html(".ts-form-prev > button",null,teasp.message.getLabel("prev_btn_title")),teasp.Tsf.Dom.html(".ts-form-next > button",null,teasp.message.getLabel("next_btn_title")),teasp.Tsf.Dom.html(".ts-apply-list > button",null,teasp.message.getLabel("applyList_btn_title")),teasp.Tsf.Dom.html(".ts-form-print > button",null,teasp.message.getLabel("print_btn_title")),
teasp.Tsf.Dom.html(".ts-payValue-label > div",null,teasp.message.getLabel("tf10000520")),teasp.Tsf.Dom.html(".ts-provis-label > div",null,teasp.message.getLabel("tf10000530")),teasp.Tsf.Dom.html(".ts-dueToPay-label > div",null,teasp.message.getLabel("tf10000540")),teasp.Tsf.Dom.html(".ts-credit-label > div",null,teasp.message.getLabel("tf10004930")),teasp.Tsf.Dom.html(".ts-invoice-label > div",null,
teasp.message.getLabel("tf10004940")),teasp.Tsf.Dom.html(".ts-form-status-label > div",null,teasp.message.getLabel("status_label")),teasp.Tsf.Dom.html(".ts-form-save > button",null,teasp.message.getLabel("tk10000289")),teasp.Tsf.Dom.html(".ts-form-cancel > button",null,teasp.message.getLabel("cancel_btn_title")),teasp.Tsf.Dom.html(".ts-approve-button > button",null,teasp.message.getLabel("tf10000270")),
teasp.Tsf.Dom.html(".ts-edit-button > button",null,teasp.message.getLabel("tk10000240")),this.domHelper.connect(teasp.Tsf.Dom.node(".ts-form-control .ts-form-back > button"),"onclick",this,function(){tsfManager.checkDiff()?teasp.tsConfirm(teasp.message.getLabel("tf10001600"),this,function(e){e&&tsfManager.backToList(teasp.Tsf.Manager.EXP_LIST_VIEW)}):tsfManager.backToList(teasp.Tsf.Manager.EXP_LIST_VIEW)}),
this.domHelper.connect(teasp.Tsf.Dom.query(".ts-form-control .ts-form-delete > button"),"onclick",this,function(e){teasp.tsConfirm(teasp.message.getLabel("tf10001910"),this,function(e){e&&tsfManager.deleteExpApply(teasp.Tsf.Dom.hitch(this,function(e,t){e?(console.log(t),tsfManager.backToList(teasp.Tsf.Manager.EXP_LIST_VIEW)):teasp.Tsf.Error.showError(t)}))})})},teasp.Tsf.MainExpApply.prototype.openEmpTable=function(
){var e=teasp.getPageUrl("deptRefView")+"?type=Exp&empId="+tsfManager.getSessionEmpId()+"&deptId="+tsfManager.getSessionDeptId();teasp.isSforce1()?sforce.one.navigateToURL(e):(e=window.open(e,"empTable","width=690,height=340,resizable=yes,scrollbars=yes"))&&e.focus()},teasp.Tsf.MainExpApply.prototype.createFormHeader=function(){return teasp.Tsf.Dom.toDom(
'<div class="ts-form-header">    <div class="ts-form-edge-left">        <table class="ts-form-control">            <tbody>                <tr>                    <td class="ts-form-back ts-std-button"    ><button>\x3c!--＜一覧へ--\x3e</button></td>                    <td class="ts-form-label"><div class="ts-applyno-label">\x3c!--精算申請番号--\x3e</div></td>                    <td class="ts-form-pulldown"><select><option>--------------</option></select></td>                    <td class="ts-form-prev ts-std-button"    ><button>\x3c!--前へ--\x3e</button></td>                    <td class="ts-form-next ts-std-button"    ><button>\x3c!--次へ--\x3e</button></td>                </tr>            </tbody>        </table>    </div>    <div class="ts-form-edge-right">        <table class="ts-form-control">            <tbody>                <tr>                    <td class="ts-form-print ts-std-button"      ><button>\x3c!--印刷      --\x3e</button></td>                    <td class="ts-payValue-label"                ><div>\x3c!--精算金額     --\x3e</div></td>                    <td class="ts-payValue-value"                ><div>&nbsp;              </div></td>                    <td class="ts-form-status-label"             ><div>\x3c!--ステータス   --\x3e</div></td>                    <td class="ts-form-status"                   ><button></button></td>                    <td class="ts-form-delete ts-std-button"     ><button>\x3c!--削除      --\x3e</button></td>                    <td class="ts-form-copy ts-std-button"       ><button>\x3c!--コピー    --\x3e</button></td>                    <td class="ts-form-save ts-std-button"       ><button>\x3c!--保存      --\x3e</button></td>                    <td class="ts-form-cancel ts-std-button"     ><button>\x3c!--キャンセル--\x3e</button></td>                    <td class="ts-apply-button"                  ><button></button></td>                    <td class="ts-apply-start"                   ><button></button></td>                    <td class="ts-approve-button"                ><button>\x3c!--承認／却下--\x3e</button></td>                    <td class="ts-edit-button"                   ><button>\x3c!--編集      --\x3e</button></td>                </tr>            </tbody>        </table>    </div></div>'
)},teasp.Tsf.MainExpApply.prototype.createFormFooter=function(){return teasp.Tsf.Dom.toDom(
'<div class="ts-form-tail"></div><div class="ts-form-footer">    <div class="ts-form-edge-right">        <table class="ts-form-control">            <tbody>                <tr>                   <td class="ts-payValue-label"            ><div>\x3c!--精算金額        --\x3e</div></td>                   <td class="ts-payValue-value"            ><div>&nbsp;                 </div></td>                   <td class="ts-provis-label"              ><div>\x3c!--仮払金額        --\x3e</div></td>                   <td class="ts-provis-value"              ><div >&nbsp;                </div></td>                   <td class="ts-dueToPay-label"            ><div>\x3c!--本人立替分      --\x3e</div></td>                   <td class="ts-dueToPay-value"            ><div >&nbsp;                </div></td>                   <td class="ts-credit-label"              ><div>\x3c!--法人カード払い分--\x3e</div></td>                   <td class="ts-credit-value"              ><div >&nbsp;                </div></td>                   <td class="ts-invoice-label"             ><div>\x3c!--請求書払い分    --\x3e</div></td>                   <td class="ts-invoice-value"             ><div >&nbsp;                </div></td>                   <td class="ts-form-save ts-std-button"   ><button>\x3c!--保存      --\x3e</button></td>                    <td class="ts-form-cancel ts-std-button"><button>\x3c!--キャンセル--\x3e</button></td>                   <td class="ts-apply-button"              ><button></button></td>                   <td class="ts-apply-start"               ><button></button></td>                </tr>            </tbody>        </table>    </div></div><div class="ts-form-bottom"></div>'
)},teasp.Tsf.MainExpPay=function(){this.titleCss="exp-pay"},teasp.Tsf.MainExpPay.prototype=new teasp.Tsf.MainBase,teasp.Tsf.MainExpPay.prototype.init=function(){teasp.Tsf.MainBase.prototype.init.call(this)},teasp.Tsf.MainExpPay.prototype.initEnd=function(e){teasp.message.setLabelEx("headManageMenu","tk10000281"),teasp.message.setLabelEx("headGreaterThan","tk10000282"),teasp.message.setLabelEx("headSimpleTitle",
"tk10000766"),teasp.message.setLabelEx("headConfigName","tk10000778"),teasp.Tsf.Dom.setAttr("#headManageMenu","href",teasp.getPageUrl("manageView")),this.domHelper.connect(teasp.Tsf.Dom.node(".ts-form-control .ts-form-back > button"),"onclick",this,function(){tsfManager.backToList()})},teasp.Tsf.MainExpPay.prototype.createCommonHeader=function(){return teasp.Tsf.Dom.toDom(
'<div>    <table class="ts_config" style="width:96%;margin-left:auto;margin:4px auto;">    <tr>        <td class="pankz" style="text-align:left;">            <a href="/apex/AtkManageView" id="headManageMenu">\x3c!--管理メニュー--\x3e</a>            <span class="pankz_div" id="headGreaterThan">\x3c!--＞--\x3e</span>            <span class="pankz_str" id="headSimpleTitle">\x3c!--経費精算の消込--\x3e</span>        </td>    </tr>    \x3c!-- タイトルエリア --\x3e    <tr>        <td class="horiz_title">            <div id="headConfigName" style="float:left;font-size:20px;">\x3c!--経費精算の消込を行う--\x3e</div>            <div class="pb_base pb_btn_t_return" style="margin-left:640px;" onclick="clickReturn();"></div>        </td>    </tr>    </table></div>'
)},teasp.Tsf.MainExpJsNavi=function(){this.titleCss="exp-jsnavi"},teasp.Tsf.MainExpJsNavi.prototype=new teasp.Tsf.MainBase,teasp.Tsf.MainExpJsNavi.prototype.init=function(){teasp.Tsf.MainBase.prototype.init.call(this)},teasp.Tsf.MainExpJsNavi.prototype.initEnd=function(e){teasp.message.setLabelEx("headManageMenu","tk10000281"),teasp.message.setLabelEx("headGreaterThan","tk10000282"),teasp.message.setLabelEx(
"headSimpleTitle","jt18000020"),teasp.message.setLabelEx("headConfigName","jt18000010"),teasp.Tsf.Dom.setAttr("#headManageMenu","href",teasp.getPageUrl("manageView")),this.domHelper.connect(teasp.Tsf.Dom.node(".ts-form-control .ts-form-back > button"),"onclick",this,function(){tsfManager.backToList()})},teasp.Tsf.MainExpJsNavi.prototype.createCommonHeader=function(){return teasp.Tsf.Dom.toDom(
'<div>    <table class="ts_config" style="width:96%;margin-left:auto;margin:4px auto;">    <tr>        <td class="pankz" style="text-align:left;">            <a href="/apex/AtkManageView" id="headManageMenu">\x3c!--管理メニュー--\x3e</a>            <span class="pankz_div" id="headGreaterThan">\x3c!--＞--\x3e</span>            <span class="pankz_str" id="headSimpleTitle">\x3c!--J\'sNAVI Jr 請求データ参照--\x3e</span>        </td>    </tr>    \x3c!-- タイトルエリア --\x3e    <tr>        <td class="horiz_title">            <div id="headConfigName" style="float:left;font-size:20px;">\x3c!--J\'sNAVI Jrの請求データの読込を参照する--\x3e</div>            <div class="pb_base pb_btn_t_return" style="margin-left:640px;" onclick="clickReturn();"></div>        </td>    </tr>    </table></div>'
)},teasp.Tsf.MainExpJsNaviDetail=function(){this.titleCss="exp-jsnavi"},teasp.Tsf.MainExpJsNaviDetail.prototype=new teasp.Tsf.MainBase,teasp.Tsf.MainExpJsNaviDetail.prototype.init=function(){teasp.Tsf.MainBase.prototype.init.call(this)},teasp.Tsf.MainExpJsNaviDetail.prototype.initEnd=function(e){},teasp.Tsf.MainExpJsNaviDetail.prototype.createCommonHeader=function(){return""},teasp.Tsf.MainAttach=function(){
this.titleCss="exp-attach"},teasp.Tsf.MainAttach.prototype=new teasp.Tsf.MainBase,teasp.Tsf.MainAttach.prototype.init=function(){this.domHelper=new teasp.Tsf.Dom,this.createBase();var e=tsfManager.getInfo().getAttachments(),e=e&&0<e.length?e[0]:null,t=teasp.Tsf.Dom.byId("attachExpView"),e=(e&&e.isImage()?(this.domHelper.create("img",{src:"/servlet/servlet.FileDownload?file="+e.getId()},this.domHelper.create("div",{
className:"image-area"},t)),this.angle=null,this.zoom=100,this.domHelper.connect(teasp.Tsf.Dom.node("#attachExpCtrl .pb_btn_rotate_left"),"onclick",this,function(){this.controlImage("L")}),this.domHelper.connect(teasp.Tsf.Dom.node("#attachExpCtrl .pb_btn_rotate_right"),"onclick",this,function(){this.controlImage("R")}),this.domHelper.connect(teasp.Tsf.Dom.node("#attachExpCtrl .pb_btn_zoom_out"),"onclick",this,
function(){this.controlImage("Zo")}),this.domHelper.connect(teasp.Tsf.Dom.node("#attachExpCtrl .pb_btn_zoom_in"),"onclick",this,function(){this.controlImage("Zi")}),teasp.Tsf.Dom.node("#attachExpCtrl .pb_btn_rotate_left").title=teasp.message.getLabel("roleLeft_btn_title"),teasp.Tsf.Dom.node("#attachExpCtrl .pb_btn_rotate_right").title=teasp.message.getLabel("roleRight_btn_title"),teasp.Tsf.Dom.node(
"#attachExpCtrl .pb_btn_zoom_out").title=teasp.message.getLabel("zoomIn_btn_title"),teasp.Tsf.Dom.node("#attachExpCtrl .pb_btn_zoom_in").title=teasp.message.getLabel("zoomOut_btn_title")):(e?this.domHelper.create("a",{href:"/servlet/servlet.FileDownload?file="+e.getId(),innerHTML:e.getName()},this.domHelper.create("div",{className:"no-image-area"},t)):this.domHelper.create("div",{className:"no-image-area",
innerHTML:teasp.message.getLabel("tf10001580")},t),teasp.Tsf.Dom.show("td.pb_btns,td.zoomDisp",teasp.Tsf.Dom.byId("attachExpCtrl"),!1)),this.domHelper.connect(teasp.Tsf.Dom.node("#attachExpCtrl button.ts-close"),"onclick",this,function(){return(window.open("","_top").opener=top).close(),!1}),document.getElementsByTagName("head"));e&&0<e.length&&this.domHelper.create("title",{innerHTML:teasp.message.getLabel(
"tf10005070")},e[0]),teasp.Tsf.Dom.show("#attachExpCtrl td.ts-close",null,!teasp.isSforce1()),teasp.Tsf.MainAttach.resize(),window.onresize=teasp.Tsf.MainAttach.resize},teasp.Tsf.MainAttach.prototype.controlImage=function(e){var t=teasp.Tsf.Dom.node("#attachExpView img");if(null===this.angle&&(this.angle=0,this.imageWidth=t.width,this.imageHeight=t.height),"L"!=e&&"R"!=e||("L"==e?(this.angle-=90,this.angle<0&&(
this.angle+=360)):(this.angle+=90,360<this.angle&&(this.angle-=360)),this.rotateImage(t)),"Zi"==e||"Zo"==e){if("Zo"==e){if(this.zoom<=20)return;this.zoom-=20}else{if(200<=this.zoom)return;this.zoom+=20}t.width=this.imageWidth*(this.zoom/100),t.height=this.imageHeight*(this.zoom/100),teasp.Tsf.Dom.node("#attachExpCtrl input.zoomDisp").value=this.zoom+"%"}},teasp.Tsf.MainAttach.prototype.rotateImage=function(e){
var t=dojo.isIE<=8?"_ie8":"",t=(dojo.toggleClass(e,"rotate0"+t,0==this.angle),dojo.toggleClass(e,"rotate90"+t,90==this.angle),dojo.toggleClass(e,"rotate180"+t,180==this.angle),dojo.toggleClass(e,"rotate270"+t,270==this.angle),90==this.angle?this.imageHeight/this.imageWidth*50:50),s=270==this.angle?this.imageWidth/this.imageHeight*50:50;dojo.attr(e,"style",
"-webkit-transform-origin:"+t+"% "+s+"%;-moz-transform-origin:"+t+"% "+s+"%;-ms-transform-origin:"+t+"% "+s+"%;-o-transform-origin:"+t+"% "+s+"%;")},teasp.Tsf.MainAttach.prototype.createBase=function(){var e=teasp.Tsf.Dom.byId(teasp.Tsf.ROOT_AREA_ID);teasp.Tsf.Dom.append(e,teasp.Tsf.Dom.toDom('<div id="tsfErrorArea" class="ts-error-area" style="display:none;"><div></div></div>')),teasp.Tsf.Dom.append(e,
teasp.Tsf.Dom.toDom(
'<div id="attachExpCtrl">    <table>    <tr>        <td class="ts-close">            <button class="ts-close">閉じる</button>        </td>        <td>        </td>        <td class="pb_btns">            <input type="button" class="pb_base pb_btn_rotate_left"  />            <input type="button" class="pb_base pb_btn_rotate_right" />            <input type="button" class="pb_base pb_btn_zoom_out"     />            <input type="button" class="pb_base pb_btn_zoom_in"      />        </td>        <td class="zoomDisp">            <div>                <input type="text" value="100%" class="zoomDisp" readOnly="readOnly" />            </div>        </td>    </tr>    </table></div>'
)),teasp.Tsf.Dom.append(e,teasp.Tsf.Dom.toDom('<div id="attachExpView"></div>')),teasp.Tsf.Dom.append(e,teasp.Tsf.Dom.toDom('<div class="ts-form-spacer"></div>'))},teasp.Tsf.MainAttach.resize=function(){var e=teasp.Tsf.Dom.getBox(),t=teasp.Tsf.Dom.node("#attachExpView > div.image-area");t&&(t.style.width=e.w-20+"px",t.style.height=e.h-55+"px")},teasp.Tsf.MainCsvUpload=function(){this.titleCss="exp-attach"},
teasp.Tsf.MainCsvUpload.prototype=new teasp.Tsf.MainBase,teasp.Tsf.MainCsvUpload.prototype.init=function(){teasp.Tsf.MainBase.prototype.init.call(this)},teasp.Tsf.MainCsvUpload.prototype.beforeUnload=function(e){tsfManager.closeCsvImport()},teasp.Tsf.MainCsvUpload.prototype.setResizeEvent=function(){window.onresize=teasp.Tsf.MainCsvUpload.resize},teasp.Tsf.MainCsvUpload.prototype.initEnd=function(e){},
teasp.Tsf.MainCsvUpload.prototype.createBase=function(){var e=teasp.Tsf.Dom.byId(teasp.Tsf.ROOT_AREA_ID);teasp.Tsf.Dom.append(e,teasp.Tsf.Dom.toDom('<div id="tsfErrorArea" class="ts-error-area"><div></div></div>')),teasp.Tsf.Dom.append(e,teasp.Tsf.Dom.toDom('<div id="printExpView"></div>')),teasp.Tsf.Dom.append(e,teasp.Tsf.Dom.toDom('<div id="tsfFormArea"></div>')),teasp.Tsf.Dom.append(e,teasp.Tsf.Dom.toDom(
'<div class="ts-form-spacer"></div>')),teasp.Tsf.Dom.node("#attachToggle > div").innerHTML=teasp.message.getLabel("upload_btn_title"),teasp.Tsf.Dom.node("#attachSave   > div").innerHTML=teasp.message.getLabel("ci00000020"),teasp.Tsf.Dom.node("#attachCancel > div").innerHTML=teasp.message.getLabel("cancel_btn_title"),teasp.Tsf.Dom.byId("attachLabel").innerHTML=teasp.message.getLabel("tk10000761"),teasp.Tsf.Dom.node(
"#csvImport > button > div").innerHTML=teasp.message.getLabel("ci00000030")},teasp.Tsf.MainCsvUpload.prototype.initViewEnd=function(){tsfManager.setImageSrc(),"attach"==tsfManager.getAction()&&teasp.Tsf.Dom.show(teasp.Tsf.Dom.byId("tsfUploadArea"),null,!0),teasp.Tsf.MainCsvUpload.resize()},teasp.Tsf.MainCsvUpload.toggleUpload=function(){var e=teasp.Tsf.Dom.byId("tsfUploadArea");return teasp.Tsf.Dom.style(
teasp.Tsf.Dom.node(".upload-toggle",e),"display","none"),teasp.Tsf.Dom.style(teasp.Tsf.Dom.node(".upload-file",e),"display","table"),teasp.Tsf.MainCsvUpload.resize(),!1},teasp.Tsf.MainCsvUpload.cancelAttach=function(){var e=teasp.Tsf.Dom.byId("tsfUploadArea");return teasp.Tsf.Dom.style(teasp.Tsf.Dom.node(".upload-toggle",e),"display","table"),teasp.Tsf.Dom.style(teasp.Tsf.Dom.node(".upload-file",e),"display","none"),
teasp.Tsf.MainCsvUpload.resize(),!1},teasp.Tsf.MainCsvUpload.resize=function(){var e,t=teasp.Tsf.Dom.getBox(),s=teasp.Tsf.Dom.node(".ts-uiblock");s&&(dojo.style(s,"width",t.w+"px"),dojo.style(s,"height",t.h+"px")),t.w<200&&(t.w=200),"attach"==tsfManager.getAction()&&(teasp.Tsf.Dom.style(teasp.Tsf.ROOT_AREA_ID,"width",t.w+"px"),(s=teasp.Tsf.Dom.node("#attachExpView > textarea"))&&(e=teasp.Tsf.Dom.top(s),e=Math.max(
t.h-(e+120),100),s.style.width=t.w-30+"px",s.style.height=e+"px")),teasp.Tsf.MainBase.adjustArea()},teasp.Tsf.MainEmpTable=function(){this.titleCss="exp-empTable"},teasp.Tsf.MainEmpTable.prototype=new teasp.Tsf.MainBase,teasp.Tsf.MainEmpTable.prototype.init=function(){this.domHelper=new teasp.Tsf.Dom,this.createBase(),window.onresize=teasp.Tsf.MainEmpTable.resize},teasp.Tsf.MainEmpTable.prototype.createBase=function(
){var e=teasp.Tsf.Dom.byId(teasp.Tsf.ROOT_AREA_ID),t=(teasp.Tsf.Dom.append(e,teasp.Tsf.Dom.toDom('<div>    <table>    <tr>        <td>            <div class="ts-emp-table-title"></div>        </td>    </tr>    </table></div>')),teasp.Tsf.Dom.append(e,teasp.Tsf.Dom.toDom('<div id="expListView"></div>')),teasp.Tsf.Dom.append(e,teasp.Tsf.Dom.toDom('<div class="ts-form-spacer"></div>')),"");switch(tsfManager.getType()){
case"Exp":t=teasp.message.getLabel("tf10006280",teasp.message.getLabel("empExp_label"));break;case"ExpPre":t=teasp.message.getLabel("tf10006280",teasp.message.getLabel("tk10004031"));break;case"Time":t=teasp.message.getLabel("tf10006280",teasp.message.getLabel("workTable_label"));break;case"Job":t=teasp.message.getLabel("tf10006280",teasp.message.getLabel("empWork_label"))}teasp.Tsf.Dom.html("div.ts-emp-table-title",
e,t)},teasp.Tsf.MainEmpTable.resize=function(){var e=teasp.Tsf.Dom.getBox();tsfManager.resizedArea(e)},teasp.Tsf.MainPrintExpPay=function(){this.titleCss="exp-print"},teasp.Tsf.MainPrintExpPay.prototype=new teasp.Tsf.MainBase,teasp.Tsf.MainPrintExpPay.prototype.init=function(){teasp.Tsf.MainBase.prototype.init.call(this)},teasp.Tsf.MainPrintExpPay.prototype.initEnd=function(e){},
teasp.Tsf.MainPrintExpPay.prototype.createBase=function(){var e=teasp.Tsf.Dom.byId(teasp.Tsf.ROOT_AREA_ID);teasp.Tsf.Dom.append(e,teasp.Tsf.Dom.toDom('<div id="tsfErrorArea" class="ts-error-area"><div></div></div>')),teasp.Tsf.Dom.append(e,teasp.Tsf.Dom.toDom('<div id="printExpView" style="padding:0px 4px;"></div>')),teasp.Tsf.Dom.append(e,teasp.Tsf.Dom.toDom('<div class="ts-form-spacer"></div>'))},
teasp.Tsf.MainExpPrint=function(){this.titleCss="exp-print"},teasp.Tsf.MainExpPrint.prototype=new teasp.Tsf.MainBase,teasp.Tsf.MainExpPrint.prototype.init=function(){teasp.Tsf.MainBase.prototype.init.call(this)},teasp.Tsf.MainExpPrint.prototype.beforeUnload=function(e){},teasp.Tsf.MainExpPrint.prototype.setResizeEvent=function(){window.onresize=teasp.Tsf.MainExpPrint.resize},
teasp.Tsf.MainExpPrint.prototype.initEnd=function(e){},teasp.Tsf.MainExpPrint.prototype.createBase=function(){var e=teasp.Tsf.Dom.byId(teasp.Tsf.ROOT_AREA_ID);teasp.Tsf.Dom.append(e,teasp.Tsf.Dom.toDom('<div id="tsfErrorArea" class="ts-error-area"><div></div></div>')),teasp.Tsf.Dom.append(e,teasp.Tsf.Dom.toDom('<div id="printExpView"></div>')),teasp.Tsf.Dom.append(e,teasp.Tsf.Dom.toDom('<div id="tsfFormArea"></div>')
),teasp.Tsf.Dom.append(e,teasp.Tsf.Dom.toDom('<div class="ts-form-spacer"></div>')),teasp.Tsf.Dom.node("#attachToggle > div").innerHTML=teasp.message.getLabel("upload_btn_title"),teasp.Tsf.Dom.node("#attachSave   > div").innerHTML=teasp.message.getLabel("save_btn_title"),teasp.Tsf.Dom.node("#attachCancel > div").innerHTML=teasp.message.getLabel("cancel_btn_title"),teasp.Tsf.Dom.byId("attachLabel"
).innerHTML=teasp.message.getLabel("tk10000761")},teasp.Tsf.MainExpPrint.prototype.initViewEnd=function(){tsfManager.setImageSrc(),"attach"==tsfManager.getAction()&&teasp.Tsf.Dom.show(teasp.Tsf.Dom.byId("tsfUploadArea"),null,!0),teasp.Tsf.MainExpPrint.resize()},teasp.Tsf.MainExpPrint.toggleUpload=function(){var e=teasp.Tsf.Dom.byId("tsfUploadArea");return teasp.Tsf.Dom.style(teasp.Tsf.Dom.node(".upload-toggle",e),
"display","none"),teasp.Tsf.Dom.style(teasp.Tsf.Dom.node(".upload-file",e),"display","table"),teasp.Tsf.MainExpPrint.resize(),!1},teasp.Tsf.MainExpPrint.cancelAttach=function(){var e=teasp.Tsf.Dom.byId("tsfUploadArea");return teasp.Tsf.Dom.style(teasp.Tsf.Dom.node(".upload-toggle",e),"display","table"),teasp.Tsf.Dom.style(teasp.Tsf.Dom.node(".upload-file",e),"display","none"),teasp.Tsf.MainExpPrint.resize(),!1},
teasp.Tsf.MainExpPrint.resize=function(){var e,t,s=teasp.Tsf.Dom.getBox();s.w<200&&(s.w=200),"attach"==tsfManager.getAction()&&(console.log("box.w="+s.w),console.log("box.h="+s.h),teasp.Tsf.Dom.style(teasp.Tsf.ROOT_AREA_ID,"width",s.w+"px"),(e=teasp.Tsf.Dom.node("#attachExpView > div.image-area"))&&(t=teasp.Tsf.Dom.top(e),t=Math.max(s.h-(t+10),100),e.style.width=s.w-20+"px",e.style.height=t+"px")),
teasp.Tsf.MainBase.adjustArea()},teasp.Tsf.MainT=function(){this.titleCss="exp-apply"},teasp.Tsf.MainT.prototype=new teasp.Tsf.MainBase,teasp.Tsf.MainT.prototype.init=function(){this.domHelper=new teasp.Tsf.Dom,this.calendarDialog=new teasp.Tsf.Calendar,this.calendarDialog.eventCloseCalendar(this.domHelper,teasp.Tsf.ROOT_AREA_ID,"ts-form-cal")},teasp.Tsf.MainT.prototype.getViewConfig=function(){return[]},
teasp.Tsf.MainT.prototype.beforeUnload=function(e){},teasp.Tsf.MainT.prototype.createFormHeader=function(){return null},teasp.Tsf.MainT.prototype.createFormFooter=function(){return null},teasp.Tsf.Manager=function(){this.imageMap={}},teasp.Tsf.Manager.EXP_APPLY="ExpApply",teasp.Tsf.Manager.EXP_PRE_APPLY="ExpPreApply",teasp.Tsf.Manager.EXP_PAY="ExpPay",teasp.Tsf.Manager.EXP_PRINT="ExpPrint",
teasp.Tsf.Manager.EXP_JSNAVI="ExpJsNavi",teasp.Tsf.Manager.EXP_JSNAVI_DETAIL="ExpJsNaviDetail",teasp.Tsf.Manager.PRINT_EXP_PAY="PrintExpPay",teasp.Tsf.Manager.ATTACH="Attach",teasp.Tsf.Manager.EMP_TABLE="EmpTable",teasp.Tsf.Manager.CSV_UPLOAD="CsvUpload",teasp.Tsf.Manager.EXP_LIST_VIEW="_ExpListView_",teasp.Tsf.Manager.EXP_APPLY_NEW="_ExpApplyNew_",teasp.Tsf.Manager.prototype.init=function(e){this.dialogs={},
this.legacyDialogs={},this.target=teasp.Tsf.Manager.EXP_PRE_APPLY,this.expCsvImportFlag=!1,this.readParams(),this.loading=new teasp.Tsf.Loading,this.error=new teasp.Tsf.Error,this.info=new teasp.Tsf[this.getTargetInfo()],this.info.init(e),this.info.isOldRevi()&&teasp.locationHref(teasp.getPageUrl("convertView")+"?forwardURL="+encodeURIComponent(teasp.getHref(this.urlName))),this.processPayeeType()},
teasp.Tsf.Manager.prototype.readParams=function(){for(var e=location.pathname,t=(/ExpApply/.test(e)||/EmpExp/.test(e)||/TimeReport/.test(e)?this.target=teasp.Tsf.Manager.EXP_APPLY:/ExpPay/.test(e)?this.target=teasp.Tsf.Manager.EXP_PAY:/ExpPrint/.test(e)?this.target=teasp.Tsf.Manager.EXP_PRINT:/ExpJtbDetail/.test(e)?this.target=teasp.Tsf.Manager.EXP_JSNAVI_DETAIL:/ExpJtb/.test(e
)?this.target=teasp.Tsf.Manager.EXP_JSNAVI:/EmpRefView/.test(e)?this.target=teasp.Tsf.Manager.ATTACH:/AtkCsvUploadView/.test(e)?this.target=teasp.Tsf.Manager.CSV_UPLOAD:/DeptRefView/.test(e)&&(this.target=teasp.Tsf.Manager.EMP_TABLE),e.lastIndexOf("/")),s=(t&&(this.urlName=e.substring(t+1)),this.params={},teasp.Tsf.util.console(location.search),location.search.split("&")),a=0;a<s.length;a++){var o=s[a];1<(e=(
o=0==a?o.substring(1):o).split("=")).length?this.params[e[0].toLowerCase()]=e[1]:"expApplyId"==e[0]&&(this.params[e[0].toLowerCase()]=null)}this.target==teasp.Tsf.Manager.EXP_PRINT&&(t=this.params.target,/ExpPay/i.test(t)&&(this.target=teasp.Tsf.Manager.PRINT_EXP_PAY))},teasp.Tsf.Manager.prototype.setRedirectPage=function(e){teasp.Tsf.Dom.byId(e).value=location.pathname+location.search},
teasp.Tsf.Manager.prototype.getTarget=function(e){if(e){if("AtkExpPreApply__c"==e)return"ExpPreApply";if("AtkExpApply__c"==e)return"ExpApply"}return this.target},teasp.Tsf.Manager.prototype.getTargetMain=function(){return"Main"+this.target},teasp.Tsf.Manager.prototype.getTargetList=function(){return"List"+this.target},teasp.Tsf.Manager.prototype.getTargetInfo=function(){return"Info"+this.target},
teasp.Tsf.Manager.prototype.getArgId=function(){return this.isTargetExpApply()?this.params.expapplyid||null:this.params.id||null},teasp.Tsf.Manager.prototype.hasArgId=function(){return!!this.isTargetExpApply()&&this.params.hasOwnProperty("expapplyid")},teasp.Tsf.Manager.prototype.getListType=function(){return this.params.listtype||null},teasp.Tsf.Manager.prototype.getParams=function(){return this.params||{}},
teasp.Tsf.Manager.prototype.getMode=function(){var e=this.params.mode;return e&&/^read$/i.test(e)?"read":"edit"},teasp.Tsf.Manager.isReadMode=function(e){return"read"==e},teasp.Tsf.Manager.prototype.isReadMode=function(){return teasp.Tsf.Manager.isReadMode(this.getMode())},teasp.Tsf.Manager.prototype.isMainOnly=function(){return this.target==teasp.Tsf.Manager.ATTACH},
teasp.Tsf.Manager.prototype.isOpenReceipt=function(){return this.getParams().openreceipt},teasp.Tsf.Manager.prototype.getDebug=function(){return this.params.debug||null},teasp.Tsf.Manager.prototype.isTypeExp=function(){return"Exp"==this.getParams().type},teasp.Tsf.Manager.prototype.isTypeExpPre=function(){return"ExpPre"==this.getParams().type},teasp.Tsf.Manager.prototype.getType=function(){return this.getParams(
).type||null},teasp.Tsf.Manager.prototype.getArgEmpId=function(){return this.getParams().empid||null},teasp.Tsf.Manager.prototype.getArgAttachId=function(){return this.getParams().attachid||null},teasp.Tsf.Manager.prototype.getAction=function(){return this.getParams().action||this.getParams().argaction},teasp.Tsf.Manager.prototype.isTargetExpApply=function(){
return"ExpApply"==this.target||"ExpApply"==this.getParamByKey("target")},teasp.Tsf.Manager.prototype.isArgNarrow=function(){return!!this.getParams().narrow},teasp.Tsf.Manager.prototype.getParamByKey=function(e,t){e=this.getParams()[e.toLowerCase()]||null;return t&&e?decodeURIComponent(e):e},teasp.Tsf.Manager.prototype.setParam=function(e,t){this.params[e.toLowerCase()]=t},
teasp.Tsf.Manager.prototype.setLoadingOff=function(e){this.loading&&this.loading.setOff(e)},teasp.Tsf.Manager.prototype.initView=function(){this.main=new teasp.Tsf[this.getTargetMain()],this.main.init(),this.info.isLoadError()?teasp.Tsf.Error.showError(this.info.getLoadError()):this.isMainOnly()||(this.list=new teasp.Tsf[this.getTargetList()](this.getListType()),this.list.init(),this.changeView(
this.info.getStartView(this.getArgId(),this.hasArgId()),this.getArgId(),this.main.initViewEnd))},teasp.Tsf.Manager.prototype.showFormT=function(e,t){this.form&&(this.form=teasp.Tsf.FormBase.erase(this.form)),this.main||(this.main=new teasp.Tsf.MainT,this.main.init());var s=this.info.createObject();teasp.Tsf.EmpExp.convertExps(e),s.setEmpExpComplex(e),this.form=new teasp.Tsf.FormT(t),this.form.refresh(s)},
teasp.Tsf.Manager.prototype.refreshList=function(e){this.list&&(this.list.destroy(),delete this.list,this.list=null),this.list=new teasp.Tsf[this.getTargetList()](e),this.list.init(),this.changeView()},teasp.Tsf.Manager.prototype.changeView=function(e,t,s,a){teasp.Tsf.Error.showError(),/apex\//.test(e)?teasp.locationHref(e+(t?"?id="+t:"")):(e==teasp.Tsf.Manager.EXP_LIST_VIEW?(this.setDiffView(!1),this.showForm()
):e==teasp.Tsf.Manager.EXP_APPLY_NEW?this.showForm(this.info.createObject(e,!0)):e!=teasp.Tsf.Manager.CSV_UPLOAD&&(this.info.isValid(t)||e)?this.info.isValid(t)?this.getRecord(t,s,a):this.showForm(null,e):this.showForm(),teasp.Tsf.MainBase.adjustArea())},teasp.Tsf.Manager.prototype.getRecord=function(a,o,i){var p={id:a||null,empId:this.getEmpId(),mode:this.getMode(),reqSteps:this.target==teasp.Tsf.Manager.EXP_PRINT};
this.loading.show(),Visualforce.remoting.Manager.invokeAction(teasp.Tsf.Manager.API_GET_RECORDS,teasp.Tsf.util.toJson(p),teasp.Tsf.Dom.hitch(this,function(e,t){var s;this.loading.hide(),console.log(t),t.status&&"OK"==e.result?(teasp.util.excludeNameSpace(e),!(s=this.info.setRecords(e,p.id))&&a?teasp.Tsf.Error.showError(teasp.message.getLabel("tf10001580")):(this.showForm(s,null),o&&o())):i?i(!1,teasp.Tsf.Error.parse(
t.status?e:t)):teasp.Tsf.Error.showError(t.status?e:t)}),{escape:!1})},teasp.Tsf.Manager.prototype.showForm=function(e,t,s){if(this.form&&(this.form=teasp.Tsf.FormBase.erase(this.form)),this.target==teasp.Tsf.Manager.CSV_UPLOAD)return this.form=teasp.Tsf.FormBase.factory("FormCsvUpload"),this.form.refresh(),this.list.show(!1),void this.main.show(!0);e||t?(this.target==teasp.Tsf.Manager.EXP_PRINT?(
this.form=teasp.Tsf.FormBase.factory("FormExpPrint"),this.form.initFp(e)):this.form=teasp.Tsf.FormBase.factory(e?e.getConfig().view:t),this.form.refresh(e||this.info.createObject(t),s),this.target!=teasp.Tsf.Manager.EXP_PRINT&&this.form.savePoint(),this.list.show(!1),this.main.show(!0)):(this.main.show(!1),this.list.refresh())},teasp.Tsf.Manager.prototype.getArea=function(){return teasp.Tsf.Dom.byId(
teasp.Tsf.ROOT_AREA_ID)},teasp.Tsf.Manager.prototype.eventOpenCalendar=function(e,t,s,a){this.main.eventOpenCalendar(e,t,s,a)},teasp.Tsf.Manager.prototype.eventOpenExpRoute=function(e,t,s,a){this.main.eventOpenExpRoute(e,t,s,a)},teasp.Tsf.Manager.prototype.backToList=function(e){this.info.removeObject([{Id:null}]),this.changeView(e||null)},teasp.Tsf.Manager.prototype.beforeUnload=function(e){if(this.checkDiff()
)return teasp.message.getLabel("tf10001590");this.clearCsvImport()},teasp.Tsf.Manager.prototype.checkDiff=function(){return this.form&&this.form.checkDiff()},teasp.Tsf.Manager.prototype.getCurrentObjectId=function(){return this.form?this.form.getCurrentObjectId():null},teasp.Tsf.Manager.prototype.getCurrentObjectIdSet=function(){return this.form?this.form.getCurrentObjectIdSet():null},
teasp.Tsf.Manager.prototype.saveExpPreApply=function(e,s){var t;this.form&&(e||this.checkDiff()?0<(e=this.form.getDomValues(!1,2)).ngList.length?s(!1,teasp.Tsf.Error.messageFromNgList(e.ngList)):((t=e.values[0]).days=e.ExpPreApplyDay__r&&e.ExpPreApplyDay__r.values||[],t.exps=e.EmpExp__r&&e.EmpExp__r.values||[],e={method:"upsertExpPreApply",expPreApply:t},console.log("[Manager.saveExpPreApply] upsertExpPreApply"),
console.log(e),this.loading.show(),Visualforce.remoting.Manager.invokeAction(teasp.Tsf.Manager.API_POTAL_ACTION,teasp.Tsf.util.toJson(e),teasp.Tsf.Dom.hitch(this,function(e,t){console.log(t),t.status&&"OK"==e.result?(teasp.util.excludeNameSpace(e),this.info.removeObject([{Id:null}]),s(!0,e.id)):(this.loading.hide(),s(!1,teasp.Tsf.Error.parse(t.status?e:t)))}),{escape:!1})):s(!0,this.getCurrentObjectId()))},
teasp.Tsf.Manager.prototype.submitApply=function(e,t){this.form&&this.info.submitApply(this.form,this.getCurrentObjectId(),e,t)},teasp.Tsf.Manager.prototype.cancelApply=function(e,t){this.form&&this.info.cancelApply(this.getCurrentObjectIdSet(),e,t)},teasp.Tsf.Manager.prototype.approveApply=function(e,t,s){this.form&&(teasp.Tsf.util.mixin(e,this.getCurrentObjectIdSet()),this.info.approveApply(this.form,e,t,s))},
teasp.Tsf.Manager.prototype.generateExpFromPreApply=function(e){var t={method:"generateExpFromPreApply",id:this.getCurrentObjectId()};e&&(t.generateFlag=!0),console.log("[Manager.generateExpFromPreApply] "+t.method),console.log(t),teasp.tsConfirm(teasp.message.getLabel("tf10001890"),this,function(e){e&&((e=this.form.getObjBase().obj.PlannedAmount__c)&&0<e&&this.jtbSynchro(),this.loading.show(),
Visualforce.remoting.Manager.invokeAction(teasp.Tsf.Manager.API_POTAL_ACTION,teasp.Tsf.util.toJson(t),teasp.Tsf.Dom.hitch(this,function(e,t){this.loading.hide(),console.log(t),t.status&&"OK"==e.result?(teasp.util.excludeNameSpace(e),this.jumpExpApplyView(e.expApplyId)):teasp.Tsf.Error.showError(t.status?e:t)}),{escape:!1}))})},teasp.Tsf.Manager.prototype.jumpExpApplyView=function(e){e=teasp.getPageUrl("empExpView"
)+"?expApplyId="+e;teasp.locationHref(e)},teasp.Tsf.Manager.prototype.deleteExpPreApply=function(s){var a;this.form&&(a={method:"deleteExpPreApply",id:this.getCurrentObjectId()},console.log(a),this.loading.show(),Visualforce.remoting.Manager.invokeAction(teasp.Tsf.Manager.API_POTAL_ACTION,teasp.Tsf.util.toJson(a),teasp.Tsf.Dom.hitch(this,function(e,t){this.loading.hide(),console.log(t),t.status&&"NG"!=e.result?(
teasp.util.excludeNameSpace(e),this.info.removeObject([{Id:a.id}]),s(!0,e)):s(!1,"NG"==e.result?e:t)}),{escape:!1}))},teasp.Tsf.Manager.prototype.deleteExpApply=function(s){var a;this.form&&(a={method:"deleteExpApply",id:this.getCurrentObjectId()},console.log(a),this.loading.show(),Visualforce.remoting.Manager.invokeAction(teasp.Tsf.Manager.API_POTAL_ACTION,teasp.Tsf.util.toJson(a),teasp.Tsf.Dom.hitch(this,function(e
,t){this.loading.hide(),console.log(t),t.status&&"NG"!=e.result?(teasp.util.excludeNameSpace(e),this.info.removeObject([{Id:a.id}]),s(!0,e)):s(!1,"NG"==e.result?e:t)}),{escape:!1}))},teasp.Tsf.Manager.prototype.copyExpApply=function(t){var e,s;this.form&&(e=this.form.getObjBase().getAttachmentAllCount(),s=teasp.message.getLabel("tf10006830"),this.isTargetExpApply()&&this.info.isUseScannerStorage()&&(
s+=teasp.message.getLabel("ex00000150")),tsfManager.showDialog("MessageBox",{title:teasp.message.getLabel("tk10000297"),message:s,option:0<e?{type:"check",name:teasp.message.getLabel("tf10006850"),checked:!0}:null},teasp.Tsf.Dom.hitch(this,function(e){this.copyExpApplyReal(e,t)})))},teasp.Tsf.Manager.prototype.copyExpApplyReal=function(e,s){var a={method:this.isTargetExpApply()?"copyExpApply":"copyExpPreApply",
id:this.getCurrentObjectId(),attachCopy:e};console.log(a),this.loading.show(),Visualforce.remoting.Manager.invokeAction(teasp.Tsf.Manager.API_POTAL_ACTION,teasp.Tsf.util.toJson(a),teasp.Tsf.Dom.hitch(this,function(e,t){this.loading.hide(),console.log(t),t.status&&"NG"!=e.result?(teasp.util.excludeNameSpace(e),this.info.removeObject([{Id:a.id}]),this.changeView(null,e.id)):(this.loading.hide(),s?s(!1,
teasp.Tsf.Error.parse(t.status?e:t)):teasp.Tsf.Error.showError(t.status?e:t))}),{escape:!1})},teasp.Tsf.Manager.prototype.saveExpApply=function(e,s){var t;this.form&&(e||this.checkDiff()?((t=(e=this.form.getDomValues(!1,2)).values[0]).ExpApplyId__c=t.Id,t.exps=e.EmpExp__r&&e.EmpExp__r.values||[],t.exps=t.exps.sort(function(e,t){return e.Date__c==t.Date__c?0:e.Date__c<t.Date__c?-1:1}),t.Id||(
t.removeExpIds=this.form.getObjBase().getRemoveExpIds(t.exps)),e={method:"upsertEmpExp",expApply:t,expsFlag:!0},console.log(e),this.loading.show(),Visualforce.remoting.Manager.invokeAction(teasp.Tsf.Manager.API_POTAL_ACTION,teasp.Tsf.util.toJson(e),teasp.Tsf.Dom.hitch(this,function(e,t){console.log(t),t.status&&"OK"==e.result?(teasp.util.excludeNameSpace(e),this.info.removeObject([{Id:null}]),s(!0,e)):(
this.loading.hide(),s(!1,teasp.Tsf.Error.parse(t.status?e:t)))}),{escape:!1})):s(!0,{id:this.getCurrentObjectId()}))},teasp.Tsf.Manager.prototype.startCreateExpApply=function(){this.form&&this.form.createExpApply()},teasp.Tsf.Manager.prototype.createExpApply=function(e,s){e={method:"upsertEmpExp",expApply:e,expsFlag:!0};console.log(e),this.loading.show(),Visualforce.remoting.Manager.invokeAction(
teasp.Tsf.Manager.API_POTAL_ACTION,teasp.Tsf.util.toJson(e),teasp.Tsf.Dom.hitch(this,function(e,t){console.log(t),t.status&&"OK"==e.result?(teasp.util.excludeNameSpace(e),this.info.removeObject([{Id:null}]),s(!0,e)):(this.loading.hide(),s(!1,teasp.Tsf.Error.parse(t.status?e:t)))}),{escape:!1})},teasp.Tsf.Manager.prototype.saveEmpExp=function(e,s){e={method:"upsertEmpExpNoApply",expApply:e};console.log(e),
this.loading.show(),Visualforce.remoting.Manager.invokeAction(teasp.Tsf.Manager.API_POTAL_ACTION,teasp.Tsf.util.toJson(e),teasp.Tsf.Dom.hitch(this,function(e,t){this.loading.hide(),console.log(t),t.status&&"OK"==e.result?(teasp.util.excludeNameSpace(e),s(!0,e)):s(!1,teasp.Tsf.Error.parse(t.status?e:t))}),{escape:!1})},teasp.Tsf.Manager.prototype.deleteEmpExp=function(e,s){e.method="deleteEmpExp",console.log(e),
this.loading.show(),Visualforce.remoting.Manager.invokeAction(teasp.Tsf.Manager.API_POTAL_ACTION,teasp.Tsf.util.toJson(e),teasp.Tsf.Dom.hitch(this,function(e,t){this.loading.hide(),console.log(t),t.status&&"OK"==e.result?(teasp.util.excludeNameSpace(e),s(!0,e)):s(!1,teasp.Tsf.Error.parse(t.status?e:t))}),{escape:!1})},teasp.Tsf.Manager.prototype.searchRoute=function(e,t,s,a,o){s=teasp.Tsf.util.mixin({
empId:this.getEmpId(),expDate:s||teasp.util.date.formatDate(teasp.util.date.getToday()),mode:e,config:a?teasp.Tsf.util.toJson(a):null,ICCardMode:this.getICCardMode()},t);this.loading.show(),console.log(s),Visualforce.remoting.Manager.invokeAction(teasp.Tsf.Manager.API_SEARCH_ROUTE,dojo.toJson(s),teasp.Tsf.Dom.hitch(this,function(e,t){this.loading.hide(),console.log(t),t.status&&"OK"==e.result?(
teasp.util.excludeNameSpace(e),o(!0,e)):o(!1,t.status?e:t)}),{escape:!1})},teasp.Tsf.Manager.prototype.getList=function(e,s){this.loading.show(),console.log(e),Visualforce.remoting.Manager.invokeAction(teasp.Tsf.Manager.API_GET_LIST,dojo.toJson(e),teasp.Tsf.Dom.hitch(this,function(e,t){this.loading.hide(),console.log(t),t.status&&"OK"==e.result?(teasp.util.excludeNameSpace(e),s(!0,e)):s(!1,t.status?e:t)}),{escape:!1}
)},teasp.Tsf.Manager.prototype.getJobList=function(e,s){this.loading.show(),console.log(e),Visualforce.remoting.Manager.invokeAction(teasp.Tsf.Manager.API_GET_JOB_LIST,dojo.toJson(e),teasp.Tsf.Dom.hitch(this,function(e,t){this.loading.hide(),console.log(t),t.status&&"OK"==e.result?(teasp.util.excludeNameSpace(e),s(!0,e)):s(!1,t.status?e:t)}),{escape:!1})},teasp.Tsf.Manager.prototype.searchData=function(e,s){
this.loading.show(),console.log(e),Visualforce.remoting.Manager.invokeAction(teasp.Tsf.Manager.API_SEARCH_DATA,dojo.toJson(e),teasp.Tsf.Dom.hitch(this,function(e,t){this.loading.hide(),console.log(t),t.status&&"OK"==e.result?(teasp.util.excludeNameSpace(e),s(!0,e)):s(!1,t.status?e:t)}),{escape:!1})},teasp.Tsf.Manager.prototype.submitCommuterPass=function(e,s){this.loading.show(),console.log(e),
Visualforce.remoting.Manager.invokeAction(teasp.Tsf.Manager.API_AROUND_COMMUTER_PASS,dojo.toJson(e),teasp.Tsf.Dom.hitch(this,function(e,t){this.loading.hide(),console.log(t),t.status&&"OK"==e.result?(teasp.util.excludeNameSpace(e),s(!0,e)):s(!1,t.status?e:t)}),{escape:!1})},teasp.Tsf.Manager.prototype.getApproverSet=function(e,s){this.loading.show(),console.log(e),Visualforce.remoting.Manager.invokeAction(
teasp.Tsf.Manager.API_GET_APPROVER_SET,dojo.toJson(e),teasp.Tsf.Dom.hitch(this,function(e,t){this.loading.hide(),console.log(t),t.status&&"OK"==e.result?(teasp.util.excludeNameSpace(e),s(!0,e)):s(!1,t.status?e:t)}),{escape:!1})},teasp.Tsf.Manager.prototype.getViewConfig=function(){return this.main.getViewConfig()},teasp.Tsf.Manager.prototype.showDialog=function(e,t,s){this.dialogs[e]||(
this.dialogs[e]=new teasp.Tsf[e]),this.dialogs[e].show(t,s)},teasp.Tsf.Manager.prototype.removeDialog=function(e){this.dialogs[e]&&(delete this.dialogs[e],this.dialogs[e]=null)},teasp.Tsf.Manager.prototype.showSearchListDialog=function(e,t,s){this.searchList||(this.searchList={}),this.searchList[e.discernment]||(this.searchList[e.discernment]=new teasp.Tsf[e.dialog||"SearchList"],this.searchList[e.discernment].init(
teasp.Tsf.formParams[e.discernment])),this.searchList[e.discernment].setOption(t),this.searchList[e.discernment].show(e,s)},teasp.Tsf.Manager.prototype.removeSearchListDialog=function(e){this.searchList&&this.searchList[e]&&(delete this.searchList[e],this.searchList[e]=null)},teasp.Tsf.Manager.prototype.showProcessInstanceSteps=function(e,t){var s,a=teasp.Tsf.util.mixin({discernment:"processInstanceSteps",
dialog:"ProcessInstanceSteps"},e),o=e.cancelApplyId?teasp.Tsf.util.formatString("ProcessInstance.TargetObjectId in ('{0}', '{1}')",e.id,e.cancelApplyId):teasp.Tsf.util.formatString("ProcessInstance.TargetObjectId = '{0}'",e.id),o={filts:[{filtVal:o}],cancelCallback:e.cancelable?e.cancelCallback:null,dataProcessingExt:(s=e.cancelApplyId,function(e){dojo.forEach(e,function(e){
s&&e.ProcessInstance&&teasp.Tsf.util.equalId(e.ProcessInstance.TargetObjectId,s)&&(e.isCancelApply=!0)})})};this.showSearchListDialog(a,o,t)},teasp.Tsf.Manager.prototype.dialogOpen=function(e,t,s,a,o){this.legacyDialogs[e]||(this.legacyDialogs[e]=new teasp.Tsf.dialog[e]),this.legacyDialogs[e].open(s,t,o,a)},teasp.Tsf.Manager.prototype.dialogClose=function(e){this.legacyDialogs[e]&&this.legacyDialogs[e].close()},
teasp.Tsf.Manager.loading=function(e){(e?tsfManager.loading.show:tsfManager.loading.hide).apply(tsfManager.loading)},teasp.Tsf.Manager.prototype.setImage=function(e,t){this.imageMap[e]=t},teasp.Tsf.Manager.prototype.getImage=function(e){return this.imageMap[e]},teasp.Tsf.Manager.prototype.setImageSrc=function(){for(var e in this.imageMap){var t;this.imageMap.hasOwnProperty(e)&&(t=this.imageMap[e],teasp.Tsf.Dom.query(
"img."+e).forEach(function(e){e.src=t}))}},teasp.Tsf.Manager.prototype.getExpItemById=function(e){return this.info.getExpItemById(e)},teasp.Tsf.Manager.prototype.getExpItemByItemCode=function(e){return this.info.getExpItemByItemCode(e)},teasp.Tsf.Manager.prototype.getForeignById=function(e){return this.info.getForeignById(e)},teasp.Tsf.Manager.prototype.getForeignByName=function(e){return this.info.getForeignByName(e
)},teasp.Tsf.Manager.prototype.getInfo=function(){return this.info},teasp.Tsf.Manager.prototype.getLoadRes=function(){return this.info.getLoadRes()},teasp.Tsf.Manager.prototype.getSessionEmp=function(){return this.info.getSessionEmp()},teasp.Tsf.Manager.prototype.getSessionFullPhotoUrl=function(){return this.info.getSessionFullPhotoUrl()},teasp.Tsf.Manager.prototype.getSessionSmallPhotoUrl=function(){
return this.info.getSessionSmallPhotoUrl()},teasp.Tsf.Manager.prototype.getSessionEmpId=function(){return this.info.getSessionEmpId()},teasp.Tsf.Manager.prototype.getSessionEmpCode=function(){return this.info.getSessionEmpCode()},teasp.Tsf.Manager.prototype.getSessionEmpName=function(){return this.info.getSessionEmpName()},teasp.Tsf.Manager.prototype.getSessionDeptId=function(){return this.info.getSessionDeptId()},
teasp.Tsf.Manager.prototype.getSessionDeptCode=function(){return this.info.getSessionDeptCode()},teasp.Tsf.Manager.prototype.getSessionDeptName=function(){return this.info.getSessionDeptName()},teasp.Tsf.Manager.prototype.getSessionEmpTypeName=function(){return this.info.getSessionEmpTypeName()},teasp.Tsf.Manager.prototype.getTargetEmp=function(){return this.info.getTargetEmp()},
teasp.Tsf.Manager.prototype.getFullPhotoUrl=function(){return this.info.getFullPhotoUrl()},teasp.Tsf.Manager.prototype.getDeptName=function(){return this.info.getDeptName()},teasp.Tsf.Manager.prototype.getEmpTypeName=function(){return this.info.getEmpTypeName()},teasp.Tsf.Manager.prototype.getEmpId=function(){return this.info.getEmpId()},teasp.Tsf.Manager.prototype.getEmpName=function(){return this.info.getEmpName()}
,teasp.Tsf.Manager.prototype.getEmpExpHistory=function(){return this.info.getEmpExpHistory()},teasp.Tsf.Manager.prototype.getEmpExpConfig=function(e){return this.info.getEmpExpConfig(e)},teasp.Tsf.Manager.prototype.getEmpJobAssigns=function(){return this.info.getEmpJobAssigns()},teasp.Tsf.Manager.prototype.getEmpUserId=function(){return this.info.getEmpUserId()},
teasp.Tsf.Manager.prototype.isUsingReceiptSystem=function(){return this.info.isUsingReceiptSystem()},teasp.Tsf.Manager.prototype.isUsingJsNaviSystem=function(){return this.info.isUsingJsNaviSystem()},teasp.Tsf.Manager.prototype.isUseConnectICExpense=function(){return this.info.isUseConnectICExpense()},teasp.Tsf.Manager.prototype.isUseScannerStorage=function(){return this.info.isUseScannerStorage()},
teasp.Tsf.Manager.prototype.getEmpJobSearchCondition=function(){return this.info.getEmpJobSearchCondition()},teasp.Tsf.Manager.prototype.getStationFromHist=function(){return this.info.getStationFromHist()},teasp.Tsf.Manager.prototype.getStationToHist=function(){return this.info.getStationToHist()},teasp.Tsf.Manager.prototype.getDepts=function(){return this.info.getDepts()},
teasp.Tsf.Manager.prototype.getUnderDeptIds=function(e){return this.info.getUnderDeptIds(e)},teasp.Tsf.Manager.prototype.getForeigns=function(){return this.info.getForeigns()},teasp.Tsf.Manager.prototype.getExpCouponList=function(){return this.info.getExpCouponList()},teasp.Tsf.Manager.prototype.getExpApplyNoList=function(){return this.info.getExpApplyNoList()},teasp.Tsf.Manager.prototype.getPayItems=function(){
return this.info.getPayItems()},teasp.Tsf.Manager.prototype.getZgAccounts=function(){return this.info.getZgAccounts()},teasp.Tsf.Manager.prototype.getHelpLink=function(){return this.info.getHelpLink()},teasp.Tsf.Manager.prototype.isSysAdmin=function(){return this.info.isSysAdmin()},teasp.Tsf.Manager.prototype.isExpAdmin=function(){return this.info.isExpAdmin()},teasp.Tsf.Manager.prototype.isManager=function(){
return this.info.isManager()},teasp.Tsf.Manager.prototype.isAllowEditExpAdmin=function(){return this.info.isAllowEditExpAdmin()},teasp.Tsf.Manager.prototype.isAllowEditManager=function(){return this.info.isAllowEditManager()},teasp.Tsf.Manager.prototype.isRequireChargeJob=function(){return this.info.isRequireChargeJob()},teasp.Tsf.Manager.prototype.isRequireChargeDept=function(){return this.info.isRequireChargeDept()
},teasp.Tsf.Manager.prototype.getExpCountLimit=function(){return this.info.getExpCountLimit()},teasp.Tsf.Manager.prototype.getDefaultChargeDept=function(){return this.info.getDefaultChargeDept()},teasp.Tsf.Manager.prototype.isExpLinkDocument=function(){return this.info.isExpLinkDocument()},teasp.Tsf.Manager.prototype.getAtkApplyTypeList=function(){return this.info.getAtkApplyTypeList()},
teasp.Tsf.Manager.prototype.isAllowMinusApply=function(){return this.info.isAllowMinusApply()},teasp.Tsf.Manager.prototype.getExpStartDate=function(){return this.info.getExpStartDate()},teasp.Tsf.Manager.prototype.isUseExpApproverSet=function(){return this.info.isUseExpApproverSet()},teasp.Tsf.Manager.prototype.getSocialExpenseItemId=function(){return this.info.getSocialExpenseItemId()},
teasp.Tsf.Manager.prototype.isRequireNote=function(e){return this.info.isRequireNote(e)},teasp.Tsf.Manager.prototype.isDisabledTimeReport=function(){return this.info.isDisabledTimeReport()},teasp.Tsf.Manager.prototype.isUseExpCancelApply=function(){return this.info.isUseExpCancelApply()},teasp.Tsf.Manager.prototype.getJtbExpItems=function(){return this.info.getJtbExpItems()},
teasp.Tsf.Manager.prototype.isDoNotCopyExtraItem=function(){return this.info.isDoNotCopyExtraItem()},teasp.Tsf.Manager.prototype.isUseJsNaviDummy=function(){return this.info.isUseJsNaviDummy()},teasp.Tsf.Manager.prototype.getTaxRoundFlag=function(){return this.info.getTaxRoundFlag()},teasp.Tsf.Manager.prototype.isDiffView=function(){return!(!this.form||!this.form.canDiffView())&&this.diffView},
teasp.Tsf.Manager.prototype.setDiffView=function(e){this.diffView=e},teasp.Tsf.Manager.prototype.isOthers=function(){return this.isEmpTargetMode()||!teasp.Tsf.util.equalId(this.getSessionEmpId(),this.getEmpId())},teasp.Tsf.Manager.prototype.getCurrentFormType=function(){return this.form?this.form.formType:null},teasp.Tsf.Manager.prototype.getExpItems=function(e){return this.info.getExpItems(e)},
teasp.Tsf.Manager.prototype.getExpPreApplyConfigByName=function(e){return this.info.getExpPreApplyConfigByName(e)},teasp.Tsf.Manager.prototype.getExpPreApplyConfigByView=function(e){return this.info.getExpPreApplyConfigByView(e)},teasp.Tsf.Manager.prototype.getTicketPeriod=function(){return this.info.getTicketPeriod()},teasp.Tsf.Manager.prototype.isExpWorkflow=function(){return this.info.isExpWorkflow()},
teasp.Tsf.Manager.prototype.isCommuterPassWorkflow=function(){return this.info.isCommuterPassWorkflow()},teasp.Tsf.Manager.prototype.getUseEkitan=function(){return this.info.getUseEkitan()},teasp.Tsf.Manager.prototype.isOutputJournal=function(){return this.info.isOutputJournal()},teasp.Tsf.Manager.prototype.getICCardMode=function(){return 2==this.getUseEkitan()?"1":null},
teasp.Tsf.Manager.prototype.setExpHistory=function(e,t){this.info.setExpHistory(e,t);e={empId:this.getEmpId(),expHistory:dojo.toJson(this.getEmpExpHistory())};Visualforce.remoting.Manager.invokeAction(teasp.Tsf.Manager.API_UPDATE_EXPHISTORY,teasp.Tsf.util.toJson(e),teasp.Tsf.Dom.hitch(this,function(e,t){console.log(t)}),{escape:!1})},teasp.Tsf.Manager.prototype.setExpConfig=function(s,a){var e={empId:this.getEmpId(),
expConfig:dojo.toJson(s)};Visualforce.remoting.Manager.invokeAction(teasp.Tsf.Manager.API_UPDATE_EXPCONFIG,teasp.Tsf.util.toJson(e),teasp.Tsf.Dom.hitch(this,function(e,t){this.loading.hide(),t.status&&"OK"==e.result?(teasp.util.excludeNameSpace(e),this.info.setEmpExpConfig(s),a(!0)):a(!1,teasp.Tsf.Error.parse(t.status?e:t))}),{escape:!1})},teasp.Tsf.Manager.prototype.setPaid=function(e,s){console.log(
"[teasp.Tsf.Manager.prototype.setPaid]"),console.log(e),this.loading.show(),Visualforce.remoting.Manager.invokeAction(teasp.Tsf.Manager.API_POTAL_ACTION,teasp.Tsf.util.toJson(e),teasp.Tsf.Dom.hitch(this,function(e,t){console.log(t),this.loading.hide(),t.status&&"OK"==e.result?(teasp.util.excludeNameSpace(e),s(!0)):s(!1,t.status?e:t)}),{escape:!1})},teasp.Tsf.Manager.prototype.resetPaid=function(e,s){console.log(
"[teasp.Tsf.Manager.prototype.resetPaid]"),console.log(e),this.loading.show(),Visualforce.remoting.Manager.invokeAction(teasp.Tsf.Manager.API_POTAL_ACTION,teasp.Tsf.util.toJson(e),teasp.Tsf.Dom.hitch(this,function(e,t){console.log(t),this.loading.hide(),t.status&&"OK"==e.result?(teasp.util.excludeNameSpace(e),s(!0)):s(!1,t.status?e:t)}),{escape:!1})},teasp.Tsf.Manager.prototype.openExpImageView=function(e,t){
this.form?(s=!this.form.isReadOnly(),this.form instanceof teasp.Tsf.FormT&&(s=s&&!t)):s=!t;var s,a,t=teasp.getPageUrl("expImageView")+"?expLogId="+e+"&openerObj=view&mode="+(s?"edit":"view"),o=screen.availHeight||800;800<o&&(o=800),teasp.isSforce1()?sforce.one.navigateToURL(t):(a=window.open(t,"attachments","width=800,height="+o+",resizable=yes,scrollbars=yes"),setTimeout(function(){a&&(a.resizeTo(810,o),a.focus())},
100))},teasp.Tsf.Manager.prototype.openReceiptImageView=function(e,t){e=teasp.getPageUrl("empRefView")+"?id="+e+"&parentId="+t;teasp.isSforce1()?sforce.one.navigateToURL(e):(t=window.open(e,"attachment","width=700,height=600,resizable=yes,scrollbars=yes"))&&t.focus()},teasp.Tsf.Manager.prototype.openExpHistoryView=function(e){var e=teasp.getPageUrl("expHistoryView")+"?empExpId="+e;teasp.isSforce1(
)?sforce.one.navigateToURL(e):(e=window.open(e,"attachments","width=900,height=400,resizable=yes,scrollbars=yes"))&&e.focus()},teasp.Tsf.Manager.prototype.appliedReceipt=function(e,t,s){this.info.setAttachmentExist(e,t),this.form.setAttachmentExist(e,t),this.dialogs.ExpDetail&&this.dialogs.ExpDetail.setAttachmentExist(e,t)},teasp.Tsf.Manager.prototype.appliedAttach=function(e){var a={id:e.id,attachs:[],deleted:[]};
dojo.forEach(e.attachs,function(e){var t,s={};for(t in e)s[t]=e[t];a.attachs.push(s)}),dojo.forEach(e.deleted,function(e){a.deleted.push(e)}),this.form.setAttachmentInfo(a)},teasp.Tsf.Manager.prototype.appliedEmpExp=function(e,t){this.form.importEmpExps(e,t)},teasp.Tsf.Manager.prototype.processPayeeType=function(){var e,t=this.getLoadRes(),s=t.payees||{},a={};for(e in s)if(s.hasOwnProperty(e))if(!e||e.indexOf(",")<0
)a[e]=(a[e]||[]).concat(s[e]||[]);else for(var o=s[e],i=e.split(/,/),p=0;p<i.length;p++){var r=i[p];r&&(a[r]=(a[r]||[]).concat(o||[]))}for(e in a){for(var n=a[e]||[],l={},p=n.length-1;0<=p;p--){var c=n[p];l[c]?n.splice(p,1):l[c]=1}a[e]=n}t.payees=a},teasp.Tsf.Manager.prototype.getPayeeTypeNums=function(e){var t=this.getLoadRes().payees||{},s={};if(e)for(var a=t[e]||[],o=0;o<a.length;o++)s[i=a[o]]=1;for(var i,
a=t[""]||[],o=0;o<a.length;o++)"number"==typeof s[i=a[o]]?s[i]=s[i]+1:s[i]=1;return s},teasp.Tsf.Manager.prototype.actionReceipt=function(e,s){this.loading.show(),Visualforce.remoting.Manager.invokeAction(teasp.Tsf.Manager.API_ACTION_RECEIPT,teasp.Tsf.util.toJson(e),teasp.Tsf.Dom.hitch(this,function(e,t){console.log(t),this.loading.hide(),t.status?s("NG"!=e.result,e):s(!1,t)}),{escape:!1})},
teasp.Tsf.Manager.prototype.actionExternal=function(e,s){this.loading.show(),Visualforce.remoting.Manager.invokeAction(teasp.Tsf.Manager.API_ACTION_EXTERNAL,teasp.Tsf.util.toJson(e),teasp.Tsf.Dom.hitch(this,function(e,t){console.log(t),this.loading.hide(),t.status?s("NG"!=e.result,e):s(!1,t)}),{escape:!1})},teasp.Tsf.Manager.prototype.getDeptList=function(s,a){console.log("[teasp.Tsf.Manager.prototype.getDeptList]"),
console.log(s),s.waitOn&&this.loading.show(),Visualforce.remoting.Manager.invokeAction(teasp.Tsf.Manager.API_POTAL_ACTION,teasp.Tsf.util.toJson(s),teasp.Tsf.Dom.hitch(this,function(e,t){console.log(t),s.waitOn&&this.loading.hide(),t.status&&"OK"==e.result?(teasp.util.excludeNameSpace(e),a(!0,e)):a(!1,t.status?e:t)}),{escape:!1})},teasp.Tsf.Manager.prototype.getEmpList=function(e,s){this.loading.show(),console.log(e),
Visualforce.remoting.Manager.invokeAction(teasp.Tsf.Manager.API_GET_EMP_LIST,dojo.toJson(e),teasp.Tsf.Dom.hitch(this,function(e,t){this.loading.hide(),console.log(t),t.status&&"OK"==e.result?(teasp.util.excludeNameSpace(e),s(!0,e)):s(!1,t.status?e:t)}),{escape:!1})},teasp.Tsf.Manager.prototype.resizedArea=function(e){this.list&&this.list.resizedArea(e)},teasp.Tsf.Manager.prototype.isEmpTargetMode=function(){
var e=this.getArgEmpId();return!!this.getArgId()||!(!e||teasp.Tsf.util.equalId(this.getSessionEmpId(),e))},teasp.Tsf.Manager.prototype.potalAction=function(s,a){console.log("[teasp.Tsf.Manager.prototype.potalAction]"),console.log(s),s.hideBusy||this.loading.show(),Visualforce.remoting.Manager.invokeAction(teasp.Tsf.Manager.API_POTAL_ACTION,teasp.Tsf.util.toJson(s),teasp.Tsf.Dom.hitch(this,function(e,t){console.log(t)
,s.hideBusy||this.loading.hide(),t.status&&"OK"==e.result?(teasp.util.excludeNameSpace(e),a(!0,e)):a(!1,t.status?e:t)}),{escape:!1})},teasp.Tsf.Manager.prototype.jtbAction=function(s,a){console.log("[teasp.Tsf.Manager.prototype.jtbAction]"),console.log(s),s.hideBusy||this.loading.show(),Visualforce.remoting.Manager.invokeAction(teasp.Tsf.Manager.API_JTB_ACTION,teasp.Tsf.util.toJson(s),teasp.Tsf.Dom.hitch(this,
function(e,t){console.log(t),s.hideBusy||this.loading.hide(),t.status&&"OK"==e.result?(teasp.util.excludeNameSpace(e),a(!0,e)):a(!1,t.status?e:t)}),{escape:!1})},teasp.Tsf.Manager.prototype.getAttachmentBody=function(e,s){console.log("[teasp.Tsf.Manager.prototype.getAttachmentBody]"),console.log(e),Visualforce.remoting.Manager.invokeAction(teasp.Tsf.Manager.API_GET_ATTACHMENT_BODY,e,teasp.Tsf.Dom.hitch(this,function(
e,t){console.log(t),t.status?(teasp.util.excludeNameSpace(e),s(!0,e)):s(!1,t.status?e:t)}),{escape:!1})},teasp.Tsf.Manager.prototype.openPrintView=function(){this.form&&this.form.openPrintView()},teasp.Tsf.Manager.prototype.restoreCheck=function(e){this.form&&this.form.restoreCheck(e)},teasp.Tsf.Manager.prototype.moveStart=function(){this.form&&this.form.moveStart()},teasp.Tsf.Manager.prototype.isEditable=function(){
return 0!=(this.info.getRights()&(teasp.constant.P_E|teasp.constant.P_AX))},teasp.Tsf.Manager.prototype.setCsvData=function(e,t,s,a,o,i){this.target==teasp.Tsf.Manager.CSV_UPLOAD&&this.form.setCsvData(e,t,s,a,o,i)},teasp.Tsf.Manager.prototype.getAssistParam=function(){return this.form.getAssistParam()},teasp.Tsf.Manager.prototype.getToken=function(){return this.form?this.form.getToken():null},
teasp.Tsf.Manager.prototype.startCsvImport=function(){var e=teasp.Tsf.Dom.node(".ts-busy-panel");e&&(e=teasp.Tsf.Dom.node("button",e))&&teasp.Tsf.Dom.style(e,"display","none")},teasp.Tsf.Manager.prototype.closedCsvImport=function(){teasp.Tsf.Dom.setBusyPanel(!1),this.setCsvImportFlag(!1)},teasp.Tsf.Manager.prototype.setKeepCsvImport=function(e){this.keepCsvImport=e},
teasp.Tsf.Manager.prototype.closeCsvImport=function(){var e;this.keepCsvImport||(e=window.opener)&&e.tsfManager.closedCsvImport()},teasp.Tsf.Manager.prototype.setCsvImportFlag=function(e){this.expCsvImportFlag=e},teasp.Tsf.Manager.prototype.clearCsvImport=function(){this.expCsvImportFlag&&(window.open("","expCsvUpload").close(),this.setCsvImportFlag(!1))},teasp.Tsf.Manager.prototype.setJtbForm=function(e){
this.jtbform=e},teasp.Tsf.Manager.prototype.getJtbForm=function(){return this.jtbform},teasp.Tsf.Manager.prototype.openJtbWindow=function(e){this.form&&this.form.getSectionByDiscernment(teasp.Tsf.formParams.sectionJtb.discernment).openJtbWindow(e)},teasp.Tsf.Manager.prototype.jtbSynchro=function(){return this.form?this.form.jtbSynchro():null};