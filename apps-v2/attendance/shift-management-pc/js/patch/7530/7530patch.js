if(typeof(teasp) == 'object' && !teasp.resolved['7530'] && teasp.logic && teasp.logic.EmpTime){
teasp.logic.EmpTime.prototype.mergeCalendar=function(){var e=this.pouch.getObj(),t=teasp.util.date.getDateList(e.params.startLdate,e.params.endLdate);e.params.dateList&&e.params.dateList.length>0&&(t=t.concat(e.params.dateList),t=t.sort(function(e,t){return t>e?-1:e>t?1:0}));for(var a=[],o=0;o<t.length;o++){
var s=t[o];if(e.days[s])e.days[s].date=s,a.push(e.days[s]);else{var i={date:s};a.push(i),e.days[s]=i}}for(var o=0;o<a.length;o++){var n=a[o],r=o>0?a[o-1]:null;n.dbDayType=n.dayType;var l=this.getMonthByDate(e.empMonthMap,n.date);if(this.isFixedMonth(e,n.date)){var p=l&&l.config&&"number"==typeof l.config.defaultLegalHoliday;if(!(this.pouch.isUseLegalHoliday()&&1!=n.dbOrgDayType||p||teasp.util.time.isValidRange(n.startTime,n.endTime)||r&&"number"==typeof r.endTime&&!(r.endTime<=1440)||n.dayType!=teasp.constant.DAY_TYPE_LEGAL_HOLIDAY)){
var d=e.cals[n.date];d&&d.type&&d.type!=teasp.constant.DAY_TYPE_NORMAL?!d||d.type!=teasp.constant.DAY_TYPE_NORMAL_HOLIDAY&&d.type!=teasp.constant.DAY_TYPE_PUBLIC_HOLIDAY||(n.dayType=teasp.constant.DAY_TYPE_NORMAL_HOLIDAY):l.fixHolidays[n.date]||1==n.dbOrgDayType||3==n.dbOrgDayType?n.dayType=teasp.constant.DAY_TYPE_NORMAL_HOLIDAY:(n.dayType=teasp.constant.DAY_TYPE_NORMAL,n.zanteiDayType=!0)}n.holiday1&&n.holiday1.plannedHoliday&&(n.plannedHoliday=!0),
n.dayType==teasp.constant.DAY_TYPE_LEGAL_HOLIDAY&&(teasp.util.time.isValidRange(n.startTime,n.endTime)?n.workFlag=!0:r&&"number"==typeof r.endTime&&r.endTime>1440&&0==n.dbOrgDayType&&(n.autoLH=!0));var c=l.fixHolidays[n.date];if(l&&null!==l.config.defaultLegalHoliday&&n.dayType!=teasp.constant.DAY_TYPE_NORMAL){var m=teasp.util.date.parseDate(n.date);m.getDay()==l.config.defaultLegalHoliday&&(n.defaultLegalHolidayFlag=!0);
}}else{this.clearDayElements(n),n.dayType=teasp.constant.DAY_TYPE_NORMAL,n.plannedHoliday=!1;var m=teasp.util.date.parseDate(n.date);if(l){var c=l.fixHolidays[n.date];n.dayType=c?c.dayType:teasp.constant.DAY_TYPE_NORMAL,null!==l.config.defaultLegalHoliday&&n.dayType!=teasp.constant.DAY_TYPE_NORMAL&&m.getDay()==l.config.defaultLegalHoliday&&(n.defaultLegalHolidayFlag=!0);var d=e.cals[n.date];if(d?(d.type&&(n.dayType="string"==typeof d.type?parseInt(d.type,10):d.type,
n.plannedHoliday=d.plannedHoliday),d.pattern&&(n.pattern=d.pattern),n.event=c&&c.title?"("+c.title+")":"",n.event+=(""!=(n.event||"")&&d.event?teasp.message.getLabel("tm10001470"):"")+(d.event||"")):n.event=c&&c.title?"("+c.title+")":"",!n.pattern){var h=teasp.logic.EmpTime.getPatternByDate(e.empTypePatterns,m);h&&(n.pattern=h.pattern)}n.explicDayType=n.dayType}}}return e};
}
